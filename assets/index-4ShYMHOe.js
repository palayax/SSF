import{j as e,R as ra,T as na,P as ia,C as la,A as oa,a as ca,b as da,I as ma,c as xa,d as ua,O as ha,e as pa,f as ga,D as fa,g as ba}from"./radix-uGlnZHxF.js";import{a as ja,r as v,c as Be,L as va,u as ne,d as ya,e as K,N as wa,B as Na}from"./vendor-DrAsnYEO.js";import{c as ka,A as Sa,m as Zt,a as Yt,T as Ca,L as Ge,U as De,b as qt,G as we,B as Da,C as Ke,d as Pa,e as B,S as Y,N as Ne,f as pe,g as Wt,K as ft,h as Ia,F as bt,E as jt,X as Qe,i as he,j as re,k as Aa,l as Ta,n as xt,o as Ns,M as Ma,P as Ea,R as ct,p as es,q as dt,H as Pe,r as Ie,s as q,t as Ra,W as Oa,u as zt,D as $e,v as _t,w as Fa,x as St,y as La,z as Wa,I as Ye,J as za,O as _a,Q as ut,V as Ba,Y as He,Z as qe,_ as Xt,$ as Va,a0 as Ha,a1 as ks,a2 as ts,a3 as Ua,a4 as Ss,a5 as Te,a6 as Ga,a7 as ss,a8 as Bt,a9 as Vt,aa as Cs,ab as Ds,ac as $a,ad as Ya,ae as Ps,af as Is,ag as qa,ah as Xa,ai as Ka,aj as Qa,ak as Ht,al as Ja,am as as,an as rs,ao as Za,ap as er}from"./ui-C5wcxGp_.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function a(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=a(n);fetch(n.href,i)}})();var Ut={},ns=ja;Ut.createRoot=ns.createRoot,Ut.hydrateRoot=ns.hydrateRoot;const Kt="-",tr=t=>{const s=ar(t),{conflictingClassGroups:a,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:o=>{const l=o.split(Kt);return l[0]===""&&l.length!==1&&l.shift(),As(l,s)||sr(o)},getConflictingClassGroupIds:(o,l)=>{const c=a[o]||[];return l&&r[o]?[...c,...r[o]]:c}}},As=(t,s)=>{var o;if(t.length===0)return s.classGroupId;const a=t[0],r=s.nextPart.get(a),n=r?As(t.slice(1),r):void 0;if(n)return n;if(s.validators.length===0)return;const i=t.join(Kt);return(o=s.validators.find(({validator:l})=>l(i)))==null?void 0:o.classGroupId},is=/^\[(.+)\]$/,sr=t=>{if(is.test(t)){const s=is.exec(t)[1],a=s==null?void 0:s.substring(0,s.indexOf(":"));if(a)return"arbitrary.."+a}},ar=t=>{const{theme:s,prefix:a}=t,r={nextPart:new Map,validators:[]};return nr(Object.entries(t.classGroups),a).forEach(([i,o])=>{Gt(o,r,i,s)}),r},Gt=(t,s,a,r)=>{t.forEach(n=>{if(typeof n=="string"){const i=n===""?s:ls(s,n);i.classGroupId=a;return}if(typeof n=="function"){if(rr(n)){Gt(n(r),s,a,r);return}s.validators.push({validator:n,classGroupId:a});return}Object.entries(n).forEach(([i,o])=>{Gt(o,ls(s,i),a,r)})})},ls=(t,s)=>{let a=t;return s.split(Kt).forEach(r=>{a.nextPart.has(r)||a.nextPart.set(r,{nextPart:new Map,validators:[]}),a=a.nextPart.get(r)}),a},rr=t=>t.isThemeGetter,nr=(t,s)=>s?t.map(([a,r])=>{const n=r.map(i=>typeof i=="string"?s+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,l])=>[s+o,l])):i);return[a,n]}):t,ir=t=>{if(t<1)return{get:()=>{},set:()=>{}};let s=0,a=new Map,r=new Map;const n=(i,o)=>{a.set(i,o),s++,s>t&&(s=0,r=a,a=new Map)};return{get(i){let o=a.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return n(i,o),o},set(i,o){a.has(i)?a.set(i,o):n(i,o)}}},Ts="!",lr=t=>{const{separator:s,experimentalParseClassName:a}=t,r=s.length===1,n=s[0],i=s.length,o=l=>{const c=[];let m=0,p=0,f;for(let w=0;w<l.length;w++){let D=l[w];if(m===0){if(D===n&&(r||l.slice(w,w+i)===s)){c.push(l.slice(p,w)),p=w+i;continue}if(D==="/"){f=w;continue}}D==="["?m++:D==="]"&&m--}const g=c.length===0?l:l.substring(p),S=g.startsWith(Ts),y=S?g.substring(1):g,b=f&&f>p?f-p:void 0;return{modifiers:c,hasImportantModifier:S,baseClassName:y,maybePostfixModifierPosition:b}};return a?l=>a({className:l,parseClassName:o}):o},or=t=>{if(t.length<=1)return t;const s=[];let a=[];return t.forEach(r=>{r[0]==="["?(s.push(...a.sort(),r),a=[]):a.push(r)}),s.push(...a.sort()),s},cr=t=>({cache:ir(t.cacheSize),parseClassName:lr(t),...tr(t)}),dr=/\s+/,mr=(t,s)=>{const{parseClassName:a,getClassGroupId:r,getConflictingClassGroupIds:n}=s,i=[],o=t.trim().split(dr);let l="";for(let c=o.length-1;c>=0;c-=1){const m=o[c],{modifiers:p,hasImportantModifier:f,baseClassName:g,maybePostfixModifierPosition:S}=a(m);let y=!!S,b=r(y?g.substring(0,S):g);if(!b){if(!y){l=m+(l.length>0?" "+l:l);continue}if(b=r(g),!b){l=m+(l.length>0?" "+l:l);continue}y=!1}const w=or(p).join(":"),D=f?w+Ts:w,h=D+b;if(i.includes(h))continue;i.push(h);const N=n(b,y);for(let d=0;d<N.length;++d){const C=N[d];i.push(D+C)}l=m+(l.length>0?" "+l:l)}return l};function xr(){let t=0,s,a,r="";for(;t<arguments.length;)(s=arguments[t++])&&(a=Ms(s))&&(r&&(r+=" "),r+=a);return r}const Ms=t=>{if(typeof t=="string")return t;let s,a="";for(let r=0;r<t.length;r++)t[r]&&(s=Ms(t[r]))&&(a&&(a+=" "),a+=s);return a};function ur(t,...s){let a,r,n,i=o;function o(c){const m=s.reduce((p,f)=>f(p),t());return a=cr(m),r=a.cache.get,n=a.cache.set,i=l,l(c)}function l(c){const m=r(c);if(m)return m;const p=mr(c,a);return n(c,p),p}return function(){return i(xr.apply(null,arguments))}}const F=t=>{const s=a=>a[t]||[];return s.isThemeGetter=!0,s},Es=/^\[(?:([a-z-]+):)?(.+)\]$/i,hr=/^\d+\/\d+$/,pr=new Set(["px","full","screen"]),gr=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,fr=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,br=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,jr=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,vr=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,se=t=>Ae(t)||pr.has(t)||hr.test(t),me=t=>Me(t,"length",Pr),Ae=t=>!!t&&!Number.isNaN(Number(t)),Ct=t=>Me(t,"number",Ae),Oe=t=>!!t&&Number.isInteger(Number(t)),yr=t=>t.endsWith("%")&&Ae(t.slice(0,-1)),A=t=>Es.test(t),xe=t=>gr.test(t),wr=new Set(["length","size","percentage"]),Nr=t=>Me(t,wr,Rs),kr=t=>Me(t,"position",Rs),Sr=new Set(["image","url"]),Cr=t=>Me(t,Sr,Ar),Dr=t=>Me(t,"",Ir),Fe=()=>!0,Me=(t,s,a)=>{const r=Es.exec(t);return r?r[1]?typeof s=="string"?r[1]===s:s.has(r[1]):a(r[2]):!1},Pr=t=>fr.test(t)&&!br.test(t),Rs=()=>!1,Ir=t=>jr.test(t),Ar=t=>vr.test(t),Tr=()=>{const t=F("colors"),s=F("spacing"),a=F("blur"),r=F("brightness"),n=F("borderColor"),i=F("borderRadius"),o=F("borderSpacing"),l=F("borderWidth"),c=F("contrast"),m=F("grayscale"),p=F("hueRotate"),f=F("invert"),g=F("gap"),S=F("gradientColorStops"),y=F("gradientColorStopPositions"),b=F("inset"),w=F("margin"),D=F("opacity"),h=F("padding"),N=F("saturate"),d=F("scale"),C=F("sepia"),W=F("skew"),I=F("space"),x=F("translate"),O=()=>["auto","contain","none"],ie=()=>["auto","hidden","clip","visible","scroll"],U=()=>["auto",A,s],M=()=>[A,s],le=()=>["",se,me],oe=()=>["auto",Ae,A],ee=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ce=()=>["solid","dashed","dotted","double","none"],te=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],de=()=>["start","end","center","between","around","evenly","stretch"],G=()=>["","0",A],fe=()=>["auto","avoid","all","avoid-page","page","left","right","column"],V=()=>[Ae,A];return{cacheSize:500,separator:":",theme:{colors:[Fe],spacing:[se,me],blur:["none","",xe,A],brightness:V(),borderColor:[t],borderRadius:["none","","full",xe,A],borderSpacing:M(),borderWidth:le(),contrast:V(),grayscale:G(),hueRotate:V(),invert:G(),gap:M(),gradientColorStops:[t],gradientColorStopPositions:[yr,me],inset:U(),margin:U(),opacity:V(),padding:M(),saturate:V(),scale:V(),sepia:G(),skew:V(),space:M(),translate:M()},classGroups:{aspect:[{aspect:["auto","square","video",A]}],container:["container"],columns:[{columns:[xe]}],"break-after":[{"break-after":fe()}],"break-before":[{"break-before":fe()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ee(),A]}],overflow:[{overflow:ie()}],"overflow-x":[{"overflow-x":ie()}],"overflow-y":[{"overflow-y":ie()}],overscroll:[{overscroll:O()}],"overscroll-x":[{"overscroll-x":O()}],"overscroll-y":[{"overscroll-y":O()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Oe,A]}],basis:[{basis:U()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",A]}],grow:[{grow:G()}],shrink:[{shrink:G()}],order:[{order:["first","last","none",Oe,A]}],"grid-cols":[{"grid-cols":[Fe]}],"col-start-end":[{col:["auto",{span:["full",Oe,A]},A]}],"col-start":[{"col-start":oe()}],"col-end":[{"col-end":oe()}],"grid-rows":[{"grid-rows":[Fe]}],"row-start-end":[{row:["auto",{span:[Oe,A]},A]}],"row-start":[{"row-start":oe()}],"row-end":[{"row-end":oe()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",A]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",A]}],gap:[{gap:[g]}],"gap-x":[{"gap-x":[g]}],"gap-y":[{"gap-y":[g]}],"justify-content":[{justify:["normal",...de()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...de(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...de(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[h]}],px:[{px:[h]}],py:[{py:[h]}],ps:[{ps:[h]}],pe:[{pe:[h]}],pt:[{pt:[h]}],pr:[{pr:[h]}],pb:[{pb:[h]}],pl:[{pl:[h]}],m:[{m:[w]}],mx:[{mx:[w]}],my:[{my:[w]}],ms:[{ms:[w]}],me:[{me:[w]}],mt:[{mt:[w]}],mr:[{mr:[w]}],mb:[{mb:[w]}],ml:[{ml:[w]}],"space-x":[{"space-x":[I]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[I]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",A,s]}],"min-w":[{"min-w":[A,s,"min","max","fit"]}],"max-w":[{"max-w":[A,s,"none","full","min","max","fit","prose",{screen:[xe]},xe]}],h:[{h:[A,s,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[A,s,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[A,s,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[A,s,"auto","min","max","fit"]}],"font-size":[{text:["base",xe,me]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Ct]}],"font-family":[{font:[Fe]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",A]}],"line-clamp":[{"line-clamp":["none",Ae,Ct]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",se,A]}],"list-image":[{"list-image":["none",A]}],"list-style-type":[{list:["none","disc","decimal",A]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[D]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[D]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ce(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",se,me]}],"underline-offset":[{"underline-offset":["auto",se,A]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:M()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",A]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",A]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[D]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ee(),kr]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Nr]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Cr]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[y]}],"gradient-via-pos":[{via:[y]}],"gradient-to-pos":[{to:[y]}],"gradient-from":[{from:[S]}],"gradient-via":[{via:[S]}],"gradient-to":[{to:[S]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[D]}],"border-style":[{border:[...ce(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[D]}],"divide-style":[{divide:ce()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-s":[{"border-s":[n]}],"border-color-e":[{"border-e":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["",...ce()]}],"outline-offset":[{"outline-offset":[se,A]}],"outline-w":[{outline:[se,me]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:le()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[D]}],"ring-offset-w":[{"ring-offset":[se,me]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",xe,Dr]}],"shadow-color":[{shadow:[Fe]}],opacity:[{opacity:[D]}],"mix-blend":[{"mix-blend":[...te(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":te()}],filter:[{filter:["","none"]}],blur:[{blur:[a]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",xe,A]}],grayscale:[{grayscale:[m]}],"hue-rotate":[{"hue-rotate":[p]}],invert:[{invert:[f]}],saturate:[{saturate:[N]}],sepia:[{sepia:[C]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[a]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[m]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[p]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[D]}],"backdrop-saturate":[{"backdrop-saturate":[N]}],"backdrop-sepia":[{"backdrop-sepia":[C]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",A]}],duration:[{duration:V()}],ease:[{ease:["linear","in","out","in-out",A]}],delay:[{delay:V()}],animate:[{animate:["none","spin","ping","pulse","bounce",A]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[d]}],"scale-x":[{"scale-x":[d]}],"scale-y":[{"scale-y":[d]}],rotate:[{rotate:[Oe,A]}],"translate-x":[{"translate-x":[x]}],"translate-y":[{"translate-y":[x]}],"skew-x":[{"skew-x":[W]}],"skew-y":[{"skew-y":[W]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",A]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",A]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":M()}],"scroll-mx":[{"scroll-mx":M()}],"scroll-my":[{"scroll-my":M()}],"scroll-ms":[{"scroll-ms":M()}],"scroll-me":[{"scroll-me":M()}],"scroll-mt":[{"scroll-mt":M()}],"scroll-mr":[{"scroll-mr":M()}],"scroll-mb":[{"scroll-mb":M()}],"scroll-ml":[{"scroll-ml":M()}],"scroll-p":[{"scroll-p":M()}],"scroll-px":[{"scroll-px":M()}],"scroll-py":[{"scroll-py":M()}],"scroll-ps":[{"scroll-ps":M()}],"scroll-pe":[{"scroll-pe":M()}],"scroll-pt":[{"scroll-pt":M()}],"scroll-pr":[{"scroll-pr":M()}],"scroll-pb":[{"scroll-pb":M()}],"scroll-pl":[{"scroll-pl":M()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",A]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[se,me,Ct]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Mr=ur(Tr);function u(...t){return Mr(ka(t))}const Er=ca;function k({content:t,children:s,side:a="top",align:r="center",delayDuration:n=300,disabled:i=!1,className:o}){return i||!t?e.jsx(e.Fragment,{children:s}):e.jsxs(ra,{delayDuration:n,children:[e.jsx(na,{asChild:!0,children:s}),e.jsx(ia,{children:e.jsxs(la,{side:a,align:r,sideOffset:5,className:u("z-50 overflow-hidden rounded-md px-3 py-1.5 text-sm","bg-slate-900 text-slate-50 dark:bg-slate-50 dark:text-slate-900","shadow-md animate-fade-in","max-w-xs",o),children:[t,e.jsx(oa,{className:"fill-slate-900 dark:fill-slate-50",width:10,height:5})]})})]})}function Os({content:t,icon:s,className:a}){return e.jsx(k,{content:t,children:e.jsx("span",{className:u("inline-flex items-center justify-center","text-slate-400 hover:text-slate-600 dark:text-slate-500 dark:hover:text-slate-300","cursor-help",a),children:s||e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),e.jsx("path",{d:"M12 17h.01"})]})})})}const Rr={primary:u("bg-forensic-500 hover:bg-forensic-600 active:bg-forensic-700","text-white","border border-transparent","shadow-sm"),secondary:u("bg-slate-100 hover:bg-slate-200 active:bg-slate-300","dark:bg-slate-700 dark:hover:bg-slate-600 dark:active:bg-slate-500","text-slate-900 dark:text-slate-100","border border-transparent"),ghost:u("bg-transparent hover:bg-slate-100 active:bg-slate-200","dark:hover:bg-slate-800 dark:active:bg-slate-700","text-slate-700 dark:text-slate-300","border border-transparent"),danger:u("bg-red-500 hover:bg-red-600 active:bg-red-700","text-white","border border-transparent","shadow-sm"),outline:u("bg-transparent hover:bg-slate-50 active:bg-slate-100","dark:hover:bg-slate-800 dark:active:bg-slate-700","text-slate-700 dark:text-slate-300","border border-slate-300 dark:border-slate-600")},Or={sm:"h-8 px-3 text-sm gap-1.5",md:"h-10 px-4 text-sm gap-2",lg:"h-12 px-6 text-base gap-2.5"},P=v.forwardRef(({className:t,variant:s="primary",size:a="md",leftIcon:r,rightIcon:n,isLoading:i,tooltip:o,fullWidth:l,disabled:c,children:m,...p},f)=>{const g=e.jsxs("button",{ref:f,disabled:c||i,className:u("inline-flex items-center justify-center","font-medium rounded-lg","transition-colors duration-200","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-forensic-500 focus-visible:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none",Rr[s],Or[a],l&&"w-full",t),...p,children:[i?e.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):r,m,!i&&n]});return o?e.jsx(k,{content:o,children:g}):g});P.displayName="Button";const Fr=v.forwardRef(({className:t,size:s="md",icon:a,...r},n)=>{const i={sm:"h-8 w-8",md:"h-10 w-10",lg:"h-12 w-12"};return e.jsx(P,{ref:n,size:s,className:u("!p-0",i[s],t),...r,children:a})});Fr.displayName="IconButton";const Lr={none:"",sm:"p-3",md:"p-4",lg:"p-6"},T=v.forwardRef(({className:t,hoverable:s=!1,selected:a=!1,padding:r="md",children:n,...i},o)=>e.jsx("div",{ref:o,className:u("bg-white dark:bg-slate-800","rounded-lg","border border-slate-200 dark:border-slate-700","shadow-sm",Lr[r],s&&["transition-all duration-200","hover:shadow-md hover:border-slate-300 dark:hover:border-slate-600","cursor-pointer"],a&&["ring-2 ring-forensic-500 ring-offset-2 dark:ring-offset-slate-900","border-forensic-500"],t),...i,children:n}));T.displayName="Card";function H({className:t,title:s,description:a,action:r,children:n,...i}){return e.jsxs("div",{className:u("flex items-start justify-between gap-4",t),...i,children:[e.jsxs("div",{className:"space-y-1",children:[s&&e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:s}),a&&e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:a}),n]}),r&&e.jsx("div",{className:"flex-shrink-0",children:r})]})}const Wr={default:"bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300",primary:"bg-forensic-100 text-forensic-800 dark:bg-forensic-900/30 dark:text-forensic-400",secondary:"bg-slate-100 text-slate-600 dark:bg-slate-700 dark:text-slate-400",success:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",warning:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",danger:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",info:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",critical:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",high:"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",low:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400"},zr={sm:"px-1.5 py-0.5 text-xs",md:"px-2.5 py-0.5 text-xs",lg:"px-3 py-1 text-sm"},_r={default:"bg-slate-500",primary:"bg-forensic-500",secondary:"bg-slate-400",success:"bg-green-500",warning:"bg-yellow-500",danger:"bg-red-500",info:"bg-blue-500",critical:"bg-red-500",high:"bg-orange-500",medium:"bg-yellow-500",low:"bg-green-500"};function Q({className:t,variant:s="default",size:a="md",icon:r,dot:n,dotColor:i,children:o,...l}){return e.jsxs("span",{className:u("inline-flex items-center gap-1.5 font-medium rounded-full",Wr[s],zr[a],t),...l,children:[n&&e.jsx("span",{className:u("w-1.5 h-1.5 rounded-full",i||_r[s])}),r&&e.jsx("span",{className:"flex-shrink-0",children:r}),o]})}function Qt({severity:t,size:s="md",className:a}){const r={critical:"Critical",high:"High",medium:"Medium",low:"Low",info:"Info"},n={critical:"critical",high:"high",medium:"medium",low:"low",info:"info"};return e.jsx(Q,{variant:n[t],size:s,className:a,children:r[t]})}const Br={sm:"h-1",md:"h-2",lg:"h-3"},Vr={default:"bg-forensic-500",success:"bg-green-500",warning:"bg-yellow-500",danger:"bg-red-500"};function ht({value:t,max:s=100,size:a="md",variant:r="default",showLabel:n=!1,animated:i=!0,className:o}){const l=Math.min(Math.max(t/s*100,0),100);return e.jsxs("div",{className:u("w-full",o),children:[n&&e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Progress"}),e.jsxs("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:[Math.round(l),"%"]})]}),e.jsx(da,{value:t,max:s,className:u("w-full overflow-hidden rounded-full bg-slate-200 dark:bg-slate-700",Br[a]),children:e.jsx(ma,{className:u("h-full rounded-full",Vr[r],i&&"transition-all duration-300 ease-out"),style:{width:`${l}%`}})})]})}const Hr={default:"stroke-forensic-500",success:"stroke-green-500",warning:"stroke-yellow-500",danger:"stroke-red-500"};function Ur({value:t,size:s=120,strokeWidth:a=8,showLabel:r=!0,variant:n="default",label:i,className:o}){const l=Math.min(Math.max(t,0),100),c=(s-a)/2,m=c*2*Math.PI,p=m-l/100*m;return e.jsxs("div",{className:u("relative inline-flex",o),children:[e.jsxs("svg",{width:s,height:s,className:"transform -rotate-90",children:[e.jsx("circle",{cx:s/2,cy:s/2,r:c,fill:"none",strokeWidth:a,className:"stroke-slate-200 dark:stroke-slate-700"}),e.jsx("circle",{cx:s/2,cy:s/2,r:c,fill:"none",strokeWidth:a,strokeLinecap:"round",className:u(Hr[n],"transition-all duration-500 ease-out"),style:{strokeDasharray:m,strokeDashoffset:p}})]}),r&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:i||e.jsxs("span",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:[Math.round(l),"%"]})})]})}const Gr={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"};function $r({size:t="md",className:s}){return e.jsxs("svg",{className:u("animate-spin text-forensic-500",Gr[t],s),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}const Yr={sm:"h-8 text-sm px-2",md:"h-10 text-sm px-3",lg:"h-12 text-base px-4"},Ue=v.forwardRef(({className:t,label:s,helperText:a,error:r,tooltip:n,required:i,leftAddon:o,rightAddon:l,inputSize:c="md",disabled:m,id:p,...f},g)=>{const S=p||v.useId();return e.jsxs("div",{className:u("w-full",t),children:[s&&e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsxs("label",{htmlFor:S,className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:[s,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),n&&e.jsx(Os,{content:n})]}),e.jsxs("div",{className:"relative",children:[o&&e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none text-slate-400",children:o}),e.jsx("input",{ref:g,id:S,disabled:m,className:u("w-full rounded-lg","bg-white dark:bg-slate-800","border border-slate-300 dark:border-slate-600","text-slate-900 dark:text-slate-100","placeholder:text-slate-400 dark:placeholder:text-slate-500","focus:ring-2 focus:ring-forensic-500 focus:border-transparent","disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-slate-50 dark:disabled:bg-slate-900","transition-colors duration-200",Yr[c],o&&"pl-10",l&&"pr-10",r&&"border-red-500 focus:ring-red-500"),"aria-invalid":!!r,"aria-describedby":r?`${S}-error`:void 0,...f}),l&&e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-slate-400",children:l})]}),(a||r)&&e.jsx("p",{id:r?`${S}-error`:void 0,className:u("mt-1 text-sm",r?"text-red-500":"text-slate-500 dark:text-slate-400"),children:r||a})]})});Ue.displayName="Input";const Fs=v.forwardRef(({className:t,label:s,helperText:a,error:r,tooltip:n,required:i,minRows:o=3,disabled:l,id:c,...m},p)=>{const f=c||v.useId();return e.jsxs("div",{className:u("w-full",t),children:[s&&e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsxs("label",{htmlFor:f,className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:[s,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),n&&e.jsx(Os,{content:n})]}),e.jsx("textarea",{ref:p,id:f,disabled:l,rows:o,className:u("w-full rounded-lg px-3 py-2","bg-white dark:bg-slate-800","border border-slate-300 dark:border-slate-600","text-slate-900 dark:text-slate-100","placeholder:text-slate-400 dark:placeholder:text-slate-500","focus:ring-2 focus:ring-forensic-500 focus:border-transparent","disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-slate-50 dark:disabled:bg-slate-900","transition-colors duration-200","resize-y",r&&"border-red-500 focus:ring-red-500"),"aria-invalid":!!r,"aria-describedby":r?`${f}-error`:void 0,...m}),(a||r)&&e.jsx("p",{id:r?`${f}-error`:void 0,className:u("mt-1 text-sm",r?"text-red-500":"text-slate-500 dark:text-slate-400"),children:r||a})]})});Fs.displayName="Textarea";function qr({onSearch:t,onKeyDown:s,...a}){const r=n=>{n.key==="Enter"&&t&&t(n.currentTarget.value),s==null||s(n)};return e.jsx(Ue,{type:"search",leftAddon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),onKeyDown:r,...a})}const Xr={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl",full:"max-w-4xl"};function Dt({open:t,onOpenChange:s,title:a,description:r,children:n,size:i="md",closeOnOverlayClick:o=!0,showCloseButton:l=!0,footer:c}){return e.jsx(xa,{open:t,onOpenChange:s,children:e.jsx(Sa,{children:t&&e.jsxs(ua,{forceMount:!0,children:[e.jsx(ha,{asChild:!0,children:e.jsx(Zt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm",onClick:o?()=>s(!1):void 0})}),e.jsx(pa,{asChild:!0,children:e.jsx(Zt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2,ease:"easeOut"},className:u("fixed z-50 inset-0","flex items-center justify-center","pointer-events-none"),onClick:m=>m.stopPropagation(),children:e.jsxs("div",{className:u("w-full pointer-events-auto","bg-white dark:bg-slate-800","rounded-xl shadow-xl","border border-slate-200 dark:border-slate-700","focus:outline-none","max-h-[85vh] overflow-hidden flex flex-col",Xr[i]),children:[(a||l)&&e.jsxs("div",{className:"flex items-start justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{children:[a&&e.jsx(ga,{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:a}),r&&e.jsx(fa,{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:r})]}),l&&e.jsx(ba,{asChild:!0,children:e.jsx("button",{className:u("rounded-lg p-1.5","text-slate-400 hover:text-slate-600 dark:text-slate-500 dark:hover:text-slate-300","hover:bg-slate-100 dark:hover:bg-slate-700","transition-colors duration-200","focus:outline-none focus:ring-2 focus:ring-forensic-500"),"aria-label":"Close",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:n}),c&&e.jsx("div",{className:"flex items-center justify-end gap-2 p-4 border-t border-slate-200 dark:border-slate-700",children:c})]})})})]})})})}const os=t=>{let s;const a=new Set,r=(m,p)=>{const f=typeof m=="function"?m(s):m;if(!Object.is(f,s)){const g=s;s=p??(typeof f!="object"||f===null)?f:Object.assign({},s,f),a.forEach(S=>S(s,g))}},n=()=>s,l={setState:r,getState:n,getInitialState:()=>c,subscribe:m=>(a.add(m),()=>a.delete(m))},c=s=t(r,n,l);return l},Kr=t=>t?os(t):os,Qr=t=>t;function Jr(t,s=Qr){const a=Be.useSyncExternalStore(t.subscribe,Be.useCallback(()=>s(t.getState()),[t,s]),Be.useCallback(()=>s(t.getInitialState()),[t,s]));return Be.useDebugValue(a),a}const cs=t=>{const s=Kr(t),a=r=>Jr(s,r);return Object.assign(a,s),a},vt=t=>t?cs(t):cs;function Zr(t,s){let a;try{a=t()}catch{return}return{getItem:n=>{var i;const o=c=>c===null?null:JSON.parse(c,void 0),l=(i=a.getItem(n))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(n,i)=>a.setItem(n,JSON.stringify(i,void 0)),removeItem:n=>a.removeItem(n)}}const $t=t=>s=>{try{const a=t(s);return a instanceof Promise?a:{then(r){return $t(r)(a)},catch(r){return this}}}catch(a){return{then(r){return this},catch(r){return $t(r)(a)}}}},en=(t,s)=>(a,r,n)=>{let i={storage:Zr(()=>window.localStorage),partialize:w=>w,version:0,merge:(w,D)=>({...D,...w}),...s},o=!1,l=0;const c=new Set,m=new Set;let p=i.storage;if(!p)return t((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),a(...w)},r,n);const f=()=>{const w=i.partialize({...r()});return p.setItem(i.name,{state:w,version:i.version})},g=n.setState;n.setState=(w,D)=>(g(w,D),f());const S=t((...w)=>(a(...w),f()),r,n);n.getInitialState=()=>S;let y;const b=()=>{var w,D;if(!p)return;const h=++l;o=!1,c.forEach(d=>{var C;return d((C=r())!=null?C:S)});const N=((D=i.onRehydrateStorage)==null?void 0:D.call(i,(w=r())!=null?w:S))||void 0;return $t(p.getItem.bind(p))(i.name).then(d=>{if(d)if(typeof d.version=="number"&&d.version!==i.version){if(i.migrate){const C=i.migrate(d.state,d.version);return C instanceof Promise?C.then(W=>[!0,W]):[!0,C]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,d.state];return[!1,void 0]}).then(d=>{var C;if(h!==l)return;const[W,I]=d;if(y=i.merge(I,(C=r())!=null?C:S),a(y,!0),W)return f()}).then(()=>{h===l&&(N==null||N(y,void 0),y=r(),o=!0,m.forEach(d=>d(y)))}).catch(d=>{h===l&&(N==null||N(void 0,d))})};return n.persist={setOptions:w=>{i={...i,...w},w.storage&&(p=w.storage)},clearStorage:()=>{p==null||p.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>b(),hasHydrated:()=>o,onHydrate:w=>(c.add(w),()=>{c.delete(w)}),onFinishHydration:w=>(m.add(w),()=>{m.delete(w)})},i.skipHydration||b(),y||S},Ls=en,Ws={THEME:"forensic-theme",SESSION:"forensic-session"},ds=[{id:"endpoints",name:"Endpoints",description:"Collect data from workstations and servers",connectors:["windows","linux","macos"]},{id:"cloud",name:"Cloud Services",description:"Connect to cloud platforms and SaaS applications",connectors:["aws","azure","gcp","o365","gsuite"]},{id:"peripherals",name:"Network & Peripherals",description:"Access network devices and security appliances",connectors:["firewall","storage","email_gateway","proxy_waf"]}],ms={windows:{name:"Windows",icon:"Monitor",description:"Windows Event Logs, Registry, File System"},linux:{name:"Linux",icon:"Terminal",description:"Auth logs, Syslog, File System artifacts"},macos:{name:"macOS",icon:"Apple",description:"Unified Logs, FSEvents, Keychain"},aws:{name:"AWS",icon:"Cloud",description:"CloudTrail, CloudWatch, VPC Flow Logs"},azure:{name:"Azure",icon:"Cloud",description:"Activity Logs, Azure AD, Sentinel"},gcp:{name:"Google Cloud",icon:"Cloud",description:"Cloud Audit Logs, VPC Flow Logs"},o365:{name:"Microsoft 365",icon:"Mail",description:"Unified Audit Logs, Exchange, SharePoint"},gsuite:{name:"Google Workspace",icon:"Mail",description:"Admin Reports, Gmail, Drive Activity"},firewall:{name:"Firewall",icon:"Shield",description:"Traffic logs, Rule changes, Threat events"},storage:{name:"Storage/NAS",icon:"HardDrive",description:"Access logs, File activity, Quota changes"},email_gateway:{name:"Email Gateway",icon:"MailWarning",description:"Message tracking, Threat filtering"},proxy_waf:{name:"Proxy/WAF",icon:"Globe",description:"Web traffic, Blocked requests, Attacks"}},tn={ping:{name:"Ping/ICMP",description:"Send ICMP echo request to verify host is reachable"},dns:{name:"DNS Resolution",description:"Verify hostname resolves to documented IP address"},spn:{name:"SPN Check",description:"Validate Service Principal Name in Active Directory"},ad_lookup:{name:"AD Lookup",description:"Verify computer object exists in Active Directory"},port_scan:{name:"Port Scan",description:"Check if expected services are listening"},cert_check:{name:"Certificate Check",description:"Validate SSL/TLS certificate is valid"}},sn={pdf:{name:"PDF",icon:"FileText",color:"text-red-500"},docx:{name:"Word",icon:"FileText",color:"text-blue-500"},xlsx:{name:"Excel",icon:"FileSpreadsheet",color:"text-green-500"},json:{name:"JSON",icon:"FileJson",color:"text-yellow-500"},yaml:{name:"YAML",icon:"FileCode",color:"text-purple-500"},visio:{name:"Visio",icon:"Network",color:"text-blue-600"}},an={github:{name:"GitHub",icon:"Github"},gitlab:{name:"GitLab",icon:"GitBranch"},sharepoint:{name:"SharePoint",icon:"FileStack"},bitbucket:{name:"Bitbucket",icon:"GitBranch"}},Se=[{id:"data_collection",name:"Data Collection",description:"Gathering logs and artifacts from configured sources",estimatedDuration:3e3,steps:5},{id:"log_analysis",name:"Log Analysis",description:"Parsing and analyzing collected log data",estimatedDuration:4e3,steps:8},{id:"artifact_extraction",name:"Artifact Extraction",description:"Extracting forensic artifacts from systems",estimatedDuration:2500,steps:4},{id:"correlation",name:"Correlation Engine",description:"Correlating events and building timeline",estimatedDuration:3500,steps:6},{id:"anomaly_detection",name:"Anomaly Detection",description:"Identifying suspicious patterns and behaviors",estimatedDuration:2e3,steps:3}];function rn(){return typeof window>"u"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Pt(t){if(typeof document>"u")return;const s=document.documentElement;t==="dark"?s.classList.add("dark"):s.classList.remove("dark")}function xs(t){return t==="auto"?rn():t}const zs=vt()(Ls((t,s)=>({mode:"auto",effectiveTheme:"light",setMode:a=>{const r=xs(a);Pt(r),t({mode:a,effectiveTheme:r})},initializeTheme:()=>{const{mode:a}=s(),r=xs(a);Pt(r),t({effectiveTheme:r}),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",i=>{const{mode:o}=s();if(o==="auto"){const l=i.matches?"dark":"light";Pt(l),t({effectiveTheme:l})}})}}),{name:Ws.THEME,partialize:t=>({mode:t.mode})})),be=["dashboard","organization_context","incident_description","connector_config","infrastructure_validation","triage","timeline","verification","report"];function nn(){return`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function ln(t){const s=new Date;return{id:nn(),createdAt:s,lastModified:s,scenarioType:t||"custom",currentStep:1,isComplete:!1,connectors:[],timelineEvents:[],findings:[],verificationDecisions:[]}}const Z=vt()(Ls((t,s)=>({currentSession:null,recentSessions:[],currentStep:"dashboard",createSession:a=>{const r=ln(a);t(n=>({currentSession:r,currentStep:"organization_context",recentSessions:[r,...n.recentSessions.slice(0,9)]}))},loadSession:a=>{const{recentSessions:r}=s(),n=r.find(i=>i.id===a);if(n){const i=n.currentStep,o=be[i]||"dashboard";t({currentSession:{...n,lastModified:new Date},currentStep:o})}},updateSession:a=>{t(r=>{if(!r.currentSession)return r;const n={...r.currentSession,...a,lastModified:new Date};return{currentSession:n,recentSessions:r.recentSessions.map(i=>i.id===n.id?n:i)}})},deleteSession:a=>{t(r=>{var n;return{currentSession:((n=r.currentSession)==null?void 0:n.id)===a?null:r.currentSession,recentSessions:r.recentSessions.filter(i=>i.id!==a)}})},clearRecentSessions:()=>{t({recentSessions:[],currentSession:null})},setCurrentStep:a=>{const r=be.indexOf(a);t(n=>({currentStep:a,currentSession:n.currentSession?{...n.currentSession,currentStep:r,lastModified:new Date}:null}))},goToNextStep:()=>{const{currentStep:a}=s(),r=be.indexOf(a);if(r<be.length-1){const n=be[r+1];t(i=>({currentStep:n,currentSession:i.currentSession?{...i.currentSession,currentStep:r+1,lastModified:new Date}:null}))}},goToPreviousStep:()=>{const{currentStep:a}=s(),r=be.indexOf(a);if(r>0){const n=be[r-1];t(i=>({currentStep:n,currentSession:i.currentSession?{...i.currentSession,currentStep:r-1,lastModified:new Date}:null}))}},updateIncidentDescription:a=>{t(r=>{if(!r.currentSession)return r;const n=r.currentSession.incidentDescription||{naturalLanguage:"",startDate:new Date,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,patientZero:{hostname:"",type:"workstation"},iocs:[],criticalSystems:[],compromisedCredentials:[]};return{currentSession:{...r.currentSession,incidentDescription:{...n,...a},lastModified:new Date}}})},updateConnectors:a=>{t(r=>r.currentSession?{currentSession:{...r.currentSession,connectors:a,lastModified:new Date}}:r)},updateTriageState:a=>{t(r=>{if(!r.currentSession)return r;const n=r.currentSession.triageState||{status:"idle",overallProgress:0,phases:[],activityLog:[],findings:[],errors:[]};return{currentSession:{...r.currentSession,triageState:{...n,...a},lastModified:new Date}}})},addTimelineEvent:a=>{t(r=>r.currentSession?{currentSession:{...r.currentSession,timelineEvents:[...r.currentSession.timelineEvents,a],lastModified:new Date}}:r)},addFinding:a=>{t(r=>r.currentSession?{currentSession:{...r.currentSession,findings:[...r.currentSession.findings,a],lastModified:new Date}}:r)},addVerificationDecision:a=>{t(r=>r.currentSession?{currentSession:{...r.currentSession,verificationDecisions:[...r.currentSession.verificationDecisions,a],lastModified:new Date}}:r)}}),{name:Ws.SESSION,partialize:t=>({currentSession:t.currentSession,recentSessions:t.recentSessions})})),us={systems:[],networks:[],processes:[],compliance:[],recoveryObjectives:[]};function ae(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function on(t){await new Promise(i=>setTimeout(i,2e3+Math.random()*2e3));const s=[{id:ae(),hostname:"DC-MAIN-01",ip:"10.0.1.10",role:"Domain Controller",criticality:"critical",sourceDocument:t.filename,os:"Windows Server 2022"},{id:ae(),hostname:"FS-FINANCE-01",ip:"10.0.2.20",role:"File Server",criticality:"high",sourceDocument:t.filename,os:"Windows Server 2019"},{id:ae(),hostname:"WEB-APP-01",ip:"10.0.3.30",role:"Web Application Server",criticality:"high",sourceDocument:t.filename,os:"Ubuntu 22.04"}],a=[{id:ae(),name:"Corporate LAN",cidr:"10.0.0.0/16",vlan:10,description:"Main corporate network",sourceDocument:t.filename},{id:ae(),name:"DMZ",cidr:"192.168.1.0/24",vlan:50,description:"Demilitarized zone for public services",sourceDocument:t.filename}],r=[{id:ae(),name:"Financial Reporting",description:"Monthly financial reporting and compliance",criticality:"critical",rto:4,rpo:1,dependentSystems:["FS-FINANCE-01","DC-MAIN-01"],sourceDocument:t.filename}],n=[{id:ae(),framework:"SOC2",requirement:"CC6.1",description:"Logical and physical access controls",applicableSystems:["DC-MAIN-01"],sourceDocument:t.filename}];return{systems:s,networks:a,processes:r,compliance:n,recoveryObjectives:r.map(i=>({processId:i.id,processName:i.name,rto:i.rto,rpo:i.rpo,tier:i.criticality==="critical"?1:i.criticality==="high"?2:3}))}}const _s=vt((t,s)=>({documents:[],repositories:[],extractedEntities:us,isParsingDocument:!1,isSyncingRepo:!1,addDocument:async a=>{var o;const r=ae(),n=(o=a.name.split(".").pop())==null?void 0:o.toLowerCase(),i={id:r,filename:a.name,type:n||"pdf",size:a.size,uploadedAt:new Date,status:"uploading"};t(l=>({documents:[...l.documents,i]})),await new Promise(l=>setTimeout(l,500)),t(l=>({documents:l.documents.map(c=>c.id===r?{...c,status:"parsing"}:c),isParsingDocument:!0}));try{const l=await on(i);t(c=>({documents:c.documents.map(m=>m.id===r?{...m,status:"parsed",extractedData:l}:m),extractedEntities:{systems:[...c.extractedEntities.systems,...l.systems],networks:[...c.extractedEntities.networks,...l.networks],processes:[...c.extractedEntities.processes,...l.processes],compliance:[...c.extractedEntities.compliance,...l.compliance],recoveryObjectives:[...c.extractedEntities.recoveryObjectives,...l.recoveryObjectives]},isParsingDocument:!1}))}catch{t(l=>({documents:l.documents.map(c=>c.id===r?{...c,status:"error",errorMessage:"Failed to parse document"}:c),isParsingDocument:!1}))}},removeDocument:a=>{const r=s().documents.find(n=>n.id===a);r&&t(n=>({documents:n.documents.filter(i=>i.id!==a),extractedEntities:{systems:n.extractedEntities.systems.filter(i=>i.sourceDocument!==r.filename),networks:n.extractedEntities.networks.filter(i=>i.sourceDocument!==r.filename),processes:n.extractedEntities.processes.filter(i=>i.sourceDocument!==r.filename),compliance:n.extractedEntities.compliance.filter(i=>i.sourceDocument!==r.filename),recoveryObjectives:n.extractedEntities.recoveryObjectives.filter(i=>{const o=n.extractedEntities.processes.find(l=>l.id===i.processId);return(o==null?void 0:o.sourceDocument)!==r.filename})}}))},updateDocumentStatus:(a,r,n)=>{t(i=>({documents:i.documents.map(o=>o.id===a?{...o,status:r,errorMessage:n}:o)}))},connectRepository:async(a,r,n)=>{const i=ae(),o={id:i,type:a,name:n,url:r,status:"syncing"};t(l=>({repositories:[...l.repositories,o],isSyncingRepo:!0})),await new Promise(l=>setTimeout(l,2e3)),t(l=>({repositories:l.repositories.map(c=>c.id===i?{...c,status:"connected",lastSync:new Date,filesCount:Math.floor(Math.random()*50)+10}:c),isSyncingRepo:!1}))},disconnectRepository:a=>{t(r=>({repositories:r.repositories.filter(n=>n.id!==a)}))},syncRepository:async a=>{t(r=>({repositories:r.repositories.map(n=>n.id===a?{...n,status:"syncing"}:n),isSyncingRepo:!0})),await new Promise(r=>setTimeout(r,1500)),t(r=>({repositories:r.repositories.map(n=>n.id===a?{...n,status:"connected",lastSync:new Date}:n),isSyncingRepo:!1}))},addExtractedSystem:a=>{t(r=>({extractedEntities:{...r.extractedEntities,systems:[...r.extractedEntities.systems,a]}}))},addExtractedNetwork:a=>{t(r=>({extractedEntities:{...r.extractedEntities,networks:[...r.extractedEntities.networks,a]}}))},addBusinessProcess:a=>{t(r=>({extractedEntities:{...r.extractedEntities,processes:[...r.extractedEntities.processes,a]}}))},addComplianceRequirement:a=>{t(r=>({extractedEntities:{...r.extractedEntities,compliance:[...r.extractedEntities.compliance,a]}}))},loadScenarioContext:a=>{t({documents:a.documents,repositories:a.repositories,extractedEntities:a.extractedEntities})},resetContext:()=>{t({documents:[],repositories:[],extractedEntities:us,isParsingDocument:!1,isSyncingRepo:!1})}}));function cn(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function dn(t,s){await new Promise(i=>setTimeout(i,500+Math.random()*1e3));const a=Math.random()>.2,r={method:s,status:a?"success":"failed",timestamp:new Date,message:a?mn(s,t):xn(s,t),details:a?un(s,t):hn(s,t)};let n;return a||(n={id:cn(),systemId:t.systemId,hostname:t.hostname,type:pn(s),severity:s==="ad_lookup"||s==="cert_check"?"critical":"warning",description:r.message||"Validation failed",documented:t.documentedIP,actual:gn(s)}),{result:r,discrepancy:n}}function mn(t,s){return{ping:`Host ${s.hostname} (${s.documentedIP}) is reachable`,dns:`Hostname ${s.hostname} resolves to ${s.documentedIP}`,spn:`SPN registered for ${s.hostname} in Active Directory`,ad_lookup:`Computer object ${s.hostname} found in Active Directory`,port_scan:`Expected services responding on ${s.hostname}`,cert_check:`SSL/TLS certificate valid for ${s.hostname}`}[t]}function xn(t,s){return{ping:`Host ${s.hostname} (${s.documentedIP}) is not responding`,dns:`Hostname ${s.hostname} does not resolve to documented IP`,spn:`No SPN found for ${s.hostname} in Active Directory`,ad_lookup:`Computer object ${s.hostname} not found in Active Directory`,port_scan:`Expected services not responding on ${s.hostname}`,cert_check:`SSL/TLS certificate expired or invalid for ${s.hostname}`}[t]}function un(t,s){return{ping:{latency:`${Math.floor(Math.random()*50)+1}ms`,packetLoss:"0%"},dns:{resolvedIP:s.documentedIP,ttl:3600},spn:{spn:`HOST/${s.hostname}`,realm:"CORP.LOCAL"},ad_lookup:{ou:"OU=Servers,DC=corp,DC=local",enabled:!0},port_scan:{openPorts:[22,80,443],closedPorts:[]},cert_check:{issuer:"Corp Internal CA",expiresIn:"180 days"}}[t]}function hn(t,s){return{ping:{packetLoss:"100%",timeout:"3000ms"},dns:{resolvedIP:`10.0.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`,expected:s.documentedIP},spn:{searched:`HOST/${s.hostname}`,found:null},ad_lookup:{searched:s.hostname,found:!1},port_scan:{openPorts:[],expectedPorts:[22,80,443]},cert_check:{error:"Certificate expired",expiredDays:Math.floor(Math.random()*30)+1}}[t]}function pn(t){return{ping:"ip_mismatch",dns:"dns_mismatch",spn:"missing_spn",ad_lookup:"not_in_ad",port_scan:"missing_service",cert_check:"cert_expired"}[t]}function gn(t,s){return{ping:"No response",dns:`10.0.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`,spn:"Not found",ad_lookup:"Not found",port_scan:"No services responding",cert_check:"Expired"}[t]}function fn(t){return t==="critical"?["ping","dns","ad_lookup","spn","port_scan","cert_check"]:t==="high"?["ping","dns","ad_lookup","port_scan"]:["ping","dns"]}function bn(t){return t.length===0||t.some(s=>s.status==="pending")?"pending":t.every(s=>s.status==="success")?"verified":t.some(s=>s.status==="failed")?"failed":"unknown"}const jn=vt((t,s)=>({systems:[],autoValidateEnabled:!1,discrepancies:[],isValidating:!1,initializeFromSystems:a=>{const r=a.map(n=>({systemId:n.id,hostname:n.hostname,documentedIP:n.ip||"N/A",role:n.role,criticality:n.criticality,validationMethods:fn(n.criticality),results:[],overallStatus:"pending"}));t({systems:r,discrepancies:[]})},setAutoValidate:a=>{t({autoValidateEnabled:a}),a&&s().validateAllSystems()},validateSystem:async(a,r)=>{const n=s().systems.find(o=>o.systemId===a);if(!n)return;const i=r||n.validationMethods;t({isValidating:!0}),t(o=>({systems:o.systems.map(l=>l.systemId===a?{...l,results:l.results.filter(c=>!i.includes(c.method)),overallStatus:"pending"}:l),discrepancies:o.discrepancies.filter(l=>l.systemId!==a)}));for(const o of i){const{result:l,discrepancy:c}=await dn(n,o);t(m=>{const p=m.systems.map(g=>{if(g.systemId!==a)return g;const S=[...g.results,l];return{...g,results:S,overallStatus:bn(S),lastChecked:new Date}}),f=c?[...m.discrepancies,c]:m.discrepancies;return{systems:p,discrepancies:f}})}t({isValidating:!1,lastFullValidation:new Date})},validateAllSystems:async()=>{const{systems:a}=s();t({isValidating:!0});for(const r of a)await s().validateSystem(r.systemId);t({isValidating:!1,lastFullValidation:new Date})},revalidateFailed:async()=>{const{systems:a}=s(),r=a.filter(n=>n.overallStatus==="failed");t({isValidating:!0});for(const n of r){const i=n.results.filter(o=>o.status==="failed").map(o=>o.method);await s().validateSystem(n.systemId,i)}t({isValidating:!1})},clearValidation:a=>{t(r=>({systems:r.systems.map(n=>n.systemId===a?{...n,results:[],overallStatus:"pending",lastChecked:void 0}:n),discrepancies:r.discrepancies.filter(n=>n.systemId!==a)}))},resetValidation:()=>{t({systems:[],autoValidateEnabled:!1,discrepancies:[],isValidating:!1,lastFullValidation:void 0})}})),vn={sm:"h-8 w-8",md:"h-10 w-10",lg:"h-12 w-12"},It={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"};function yn({size:t="md",className:s}){const{mode:a,setMode:r}=zs(),n=()=>{const l=["light","dark","auto"],m=(l.indexOf(a)+1)%l.length;r(l[m])},i={light:"Switch to dark mode",dark:"Switch to auto mode",auto:"Switch to light mode"},o={light:e.jsx("svg",{className:It[t],fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),dark:e.jsx("svg",{className:It[t],fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),auto:e.jsx("svg",{className:It[t],fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})};return e.jsx(k,{content:i[a],children:e.jsx("button",{onClick:n,className:u("inline-flex items-center justify-center","rounded-lg","text-slate-600 dark:text-slate-400","hover:bg-slate-100 dark:hover:bg-slate-800","hover:text-slate-900 dark:hover:text-slate-100","transition-colors duration-200","focus:outline-none focus:ring-2 focus:ring-forensic-500 focus:ring-offset-2 dark:focus:ring-offset-slate-900",vn[t],s),"aria-label":`Current theme: ${a}. Click to change.`,children:o[a]})})}const Ve=[{step:"organization_context",label:"Context",number:1},{step:"incident_description",label:"Incident",number:2},{step:"connector_config",label:"Connectors",number:3},{step:"infrastructure_validation",label:"Validation",number:4},{step:"triage",label:"Triage",number:5},{step:"timeline",label:"Timeline",number:6},{step:"verification",label:"Verify",number:7},{step:"report",label:"Report",number:8}];function Bs({showProgress:t=!0,className:s}){var o;const{currentSession:a,currentStep:r}=Z(),n=Ve.findIndex(l=>l.step===r),i=n>=0;return e.jsxs("header",{className:u("sticky top-0 z-40","bg-white/80 dark:bg-slate-900/80 backdrop-blur-md","border-b border-slate-200 dark:border-slate-700",s),children:[e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs(va,{to:"/",className:"flex items-center gap-2 text-slate-900 dark:text-slate-100 hover:opacity-80 transition-opacity",children:[e.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-forensic-500",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"m21 21-4.3-4.3"}),e.jsx("path",{d:"M11 8v6",className:"text-red-500",stroke:"currentColor"}),e.jsx("path",{d:"M8 11h6",className:"text-red-500",stroke:"currentColor"})]})}),e.jsx("span",{className:"font-semibold text-lg hidden sm:inline",children:"Forensic Triage"})]}),t&&i&&a&&e.jsx("div",{className:"hidden md:flex items-center",children:e.jsx(wn,{currentStepIndex:n,totalSteps:Ve.length})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{content:"Get help and documentation",children:e.jsx(P,{variant:"ghost",size:"sm","aria-label":"Help",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),e.jsx(yn,{size:"sm"})]})]})}),t&&i&&a&&e.jsx("div",{className:"md:hidden px-4 pb-3",children:e.jsx(Nn,{currentStepIndex:n,currentStepLabel:((o=Ve[n])==null?void 0:o.label)||"",totalSteps:Ve.length})})]})}function wn({currentStepIndex:t,totalSteps:s}){return e.jsx("div",{className:"flex items-center gap-1",children:Ve.map((a,r)=>e.jsxs(v.Fragment,{children:[e.jsx(k,{content:a.label,children:e.jsx("div",{className:u("w-3 h-3 rounded-full transition-colors duration-200",r<t?"bg-forensic-500":r===t?"bg-forensic-500 ring-2 ring-forensic-200 dark:ring-forensic-800":"bg-slate-200 dark:bg-slate-700")})}),r<s-1&&e.jsx("div",{className:u("w-4 h-0.5",r<t?"bg-forensic-500":"bg-slate-200 dark:bg-slate-700")})]},a.step))})}function Nn({currentStepIndex:t,currentStepLabel:s,totalSteps:a}){return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-1 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-forensic-500 transition-all duration-300",style:{width:`${(t+1)/a*100}%`}})}),e.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400 whitespace-nowrap",children:["Step ",t+1,"/",a,": ",s]})]})}const hs={sm:"max-w-2xl",md:"max-w-4xl",lg:"max-w-5xl",xl:"max-w-6xl","2xl":"max-w-7xl",full:"max-w-full"};function ge({title:t,subtitle:s,showProgress:a=!0,actions:r,footer:n,children:i,maxWidth:o="2xl",className:l}){return e.jsxs("div",{className:"min-h-screen flex flex-col bg-slate-50 dark:bg-slate-900",children:[e.jsx(Bs,{showProgress:a}),e.jsxs("main",{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:u("flex-1 w-full mx-auto px-4 sm:px-6 lg:px-8 py-6",hs[o],l),children:[(t||r)&&e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[t&&e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:t}),s&&e.jsx("p",{className:"mt-1 text-slate-500 dark:text-slate-400",children:s})]}),r&&e.jsx("div",{className:"flex items-center gap-2 flex-shrink-0",children:r})]})}),e.jsx("div",{className:"flex-1",children:i})]}),n&&e.jsx("div",{className:"sticky bottom-0 bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-slate-700",children:e.jsx("div",{className:u("w-full mx-auto px-4 sm:px-6 lg:px-8 py-4",hs[o]),children:n})})]})]})}function ke({onBack:t,backLabel:s="Back",onContinue:a,continueLabel:r="Continue",continueDisabled:n,continueLoading:i,middleContent:o}){return e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{children:t&&e.jsxs("button",{onClick:t,className:u("inline-flex items-center gap-2","px-4 py-2 text-sm font-medium","text-slate-600 dark:text-slate-400","hover:text-slate-900 dark:hover:text-slate-100","transition-colors duration-200"),children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),s]})}),o&&e.jsx("div",{className:"flex-1 flex justify-center",children:o}),e.jsx("div",{children:a&&e.jsxs("button",{onClick:a,disabled:n||i,className:u("inline-flex items-center gap-2","px-6 py-2 text-sm font-medium","bg-forensic-500 hover:bg-forensic-600 text-white","rounded-lg","transition-colors duration-200","disabled:opacity-50 disabled:cursor-not-allowed"),children:[i?e.jsxs("svg",{className:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):null,r,e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]})})]})}function kn({icon:t,title:s,description:a,action:r,className:n}){return e.jsxs("div",{className:u("flex flex-col items-center justify-center text-center py-12",n),children:[t&&e.jsx("div",{className:"w-16 h-16 flex items-center justify-center text-slate-400 dark:text-slate-500 mb-4",children:t}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-1",children:s}),a&&e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 max-w-sm mb-4",children:a}),r]})}const Vs=6048e5,Sn=864e5,Hs=6e4,Us=36e5,et=43200,ps=1440,gs=Symbol.for("constructDateFrom");function J(t,s){return typeof t=="function"?t(s):t&&typeof t=="object"&&gs in t?t[gs](s):t instanceof Date?new t.constructor(s):new Date(s)}function z(t,s){return J(s||t,t)}let Cn={};function Je(){return Cn}function Xe(t,s){var l,c,m,p;const a=Je(),r=(s==null?void 0:s.weekStartsOn)??((c=(l=s==null?void 0:s.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??a.weekStartsOn??((p=(m=a.locale)==null?void 0:m.options)==null?void 0:p.weekStartsOn)??0,n=z(t,s==null?void 0:s.in),i=n.getDay(),o=(i<r?7:0)+i-r;return n.setDate(n.getDate()-o),n.setHours(0,0,0,0),n}function pt(t,s){return Xe(t,{...s,weekStartsOn:1})}function Gs(t,s){const a=z(t,s==null?void 0:s.in),r=a.getFullYear(),n=J(a,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const i=pt(n),o=J(a,0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);const l=pt(o);return a.getTime()>=i.getTime()?r+1:a.getTime()>=l.getTime()?r:r-1}function gt(t){const s=z(t),a=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return a.setUTCFullYear(s.getFullYear()),+t-+a}function yt(t,...s){const a=J.bind(null,t||s.find(r=>typeof r=="object"));return s.map(a)}function fs(t,s){const a=z(t,s==null?void 0:s.in);return a.setHours(0,0,0,0),a}function Dn(t,s,a){const[r,n]=yt(a==null?void 0:a.in,t,s),i=fs(r),o=fs(n),l=+i-gt(i),c=+o-gt(o);return Math.round((l-c)/Sn)}function Pn(t,s){const a=Gs(t,s),r=J(t,0);return r.setFullYear(a,0,4),r.setHours(0,0,0,0),pt(r)}function mt(t,s){const a=+z(t)-+z(s);return a<0?-1:a>0?1:a}function In(t){return J(t,Date.now())}function An(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function Tn(t){return!(!An(t)&&typeof t!="number"||isNaN(+z(t)))}function Mn(t,s,a){const[r,n]=yt(a==null?void 0:a.in,t,s),i=r.getFullYear()-n.getFullYear(),o=r.getMonth()-n.getMonth();return i*12+o}function En(t){return s=>{const r=(t?Math[t]:Math.trunc)(s);return r===0?0:r}}function Rn(t,s){return+z(t)-+z(s)}function On(t,s){const a=z(t,s==null?void 0:s.in);return a.setHours(23,59,59,999),a}function Fn(t,s){const a=z(t,s==null?void 0:s.in),r=a.getMonth();return a.setFullYear(a.getFullYear(),r+1,0),a.setHours(23,59,59,999),a}function Ln(t,s){const a=z(t,s==null?void 0:s.in);return+On(a,s)==+Fn(a,s)}function Wn(t,s,a){const[r,n,i]=yt(a==null?void 0:a.in,t,t,s),o=mt(n,i),l=Math.abs(Mn(n,i));if(l<1)return 0;n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-o*l);let c=mt(n,i)===-o;Ln(r)&&l===1&&mt(r,i)===1&&(c=!1);const m=o*(l-+c);return m===0?0:m}function zn(t,s,a){const r=Rn(t,s)/1e3;return En(a==null?void 0:a.roundingMethod)(r)}function _n(t,s){const a=z(t,s==null?void 0:s.in);return a.setFullYear(a.getFullYear(),0,1),a.setHours(0,0,0,0),a}const Bn={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Vn=(t,s,a)=>{let r;const n=Bn[t];return typeof n=="string"?r=n:s===1?r=n.one:r=n.other.replace("{{count}}",s.toString()),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"in "+r:r+" ago":r};function At(t){return(s={})=>{const a=s.width?String(s.width):t.defaultWidth;return t.formats[a]||t.formats[t.defaultWidth]}}const Hn={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Un={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Gn={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},$n={date:At({formats:Hn,defaultWidth:"full"}),time:At({formats:Un,defaultWidth:"full"}),dateTime:At({formats:Gn,defaultWidth:"full"})},Yn={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},qn=(t,s,a,r)=>Yn[t];function Le(t){return(s,a)=>{const r=a!=null&&a.context?String(a.context):"standalone";let n;if(r==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=a!=null&&a.width?String(a.width):o;n=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=a!=null&&a.width?String(a.width):t.defaultWidth;n=t.values[l]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(s):s;return n[i]}}const Xn={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Kn={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Qn={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Jn={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Zn={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},ei={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ti=(t,s)=>{const a=Number(t),r=a%100;if(r>20||r<10)switch(r%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},si={ordinalNumber:ti,era:Le({values:Xn,defaultWidth:"wide"}),quarter:Le({values:Kn,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Le({values:Qn,defaultWidth:"wide"}),day:Le({values:Jn,defaultWidth:"wide"}),dayPeriod:Le({values:Zn,defaultWidth:"wide",formattingValues:ei,defaultFormattingWidth:"wide"})};function We(t){return(s,a={})=>{const r=a.width,n=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],i=s.match(n);if(!i)return null;const o=i[0],l=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?ri(l,f=>f.test(o)):ai(l,f=>f.test(o));let m;m=t.valueCallback?t.valueCallback(c):c,m=a.valueCallback?a.valueCallback(m):m;const p=s.slice(o.length);return{value:m,rest:p}}}function ai(t,s){for(const a in t)if(Object.prototype.hasOwnProperty.call(t,a)&&s(t[a]))return a}function ri(t,s){for(let a=0;a<t.length;a++)if(s(t[a]))return a}function ni(t){return(s,a={})=>{const r=s.match(t.matchPattern);if(!r)return null;const n=r[0],i=s.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=a.valueCallback?a.valueCallback(o):o;const l=s.slice(n.length);return{value:o,rest:l}}}const ii=/^(\d+)(th|st|nd|rd)?/i,li=/\d+/i,oi={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},ci={any:[/^b/i,/^(a|c)/i]},di={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},mi={any:[/1/i,/2/i,/3/i,/4/i]},xi={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},ui={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},hi={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},pi={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},gi={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},fi={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},bi={ordinalNumber:ni({matchPattern:ii,parsePattern:li,valueCallback:t=>parseInt(t,10)}),era:We({matchPatterns:oi,defaultMatchWidth:"wide",parsePatterns:ci,defaultParseWidth:"any"}),quarter:We({matchPatterns:di,defaultMatchWidth:"wide",parsePatterns:mi,defaultParseWidth:"any",valueCallback:t=>t+1}),month:We({matchPatterns:xi,defaultMatchWidth:"wide",parsePatterns:ui,defaultParseWidth:"any"}),day:We({matchPatterns:hi,defaultMatchWidth:"wide",parsePatterns:pi,defaultParseWidth:"any"}),dayPeriod:We({matchPatterns:gi,defaultMatchWidth:"any",parsePatterns:fi,defaultParseWidth:"any"})},$s={code:"en-US",formatDistance:Vn,formatLong:$n,formatRelative:qn,localize:si,match:bi,options:{weekStartsOn:0,firstWeekContainsDate:1}};function ji(t,s){const a=z(t,s==null?void 0:s.in);return Dn(a,_n(a))+1}function vi(t,s){const a=z(t,s==null?void 0:s.in),r=+pt(a)-+Pn(a);return Math.round(r/Vs)+1}function Ys(t,s){var p,f,g,S;const a=z(t,s==null?void 0:s.in),r=a.getFullYear(),n=Je(),i=(s==null?void 0:s.firstWeekContainsDate)??((f=(p=s==null?void 0:s.locale)==null?void 0:p.options)==null?void 0:f.firstWeekContainsDate)??n.firstWeekContainsDate??((S=(g=n.locale)==null?void 0:g.options)==null?void 0:S.firstWeekContainsDate)??1,o=J((s==null?void 0:s.in)||t,0);o.setFullYear(r+1,0,i),o.setHours(0,0,0,0);const l=Xe(o,s),c=J((s==null?void 0:s.in)||t,0);c.setFullYear(r,0,i),c.setHours(0,0,0,0);const m=Xe(c,s);return+a>=+l?r+1:+a>=+m?r:r-1}function yi(t,s){var l,c,m,p;const a=Je(),r=(s==null?void 0:s.firstWeekContainsDate)??((c=(l=s==null?void 0:s.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??a.firstWeekContainsDate??((p=(m=a.locale)==null?void 0:m.options)==null?void 0:p.firstWeekContainsDate)??1,n=Ys(t,s),i=J((s==null?void 0:s.in)||t,0);return i.setFullYear(n,0,r),i.setHours(0,0,0,0),Xe(i,s)}function wi(t,s){const a=z(t,s==null?void 0:s.in),r=+Xe(a,s)-+yi(a,s);return Math.round(r/Vs)+1}function R(t,s){const a=t<0?"-":"",r=Math.abs(t).toString().padStart(s,"0");return a+r}const ue={y(t,s){const a=t.getFullYear(),r=a>0?a:1-a;return R(s==="yy"?r%100:r,s.length)},M(t,s){const a=t.getMonth();return s==="M"?String(a+1):R(a+1,2)},d(t,s){return R(t.getDate(),s.length)},a(t,s){const a=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];case"aaaa":default:return a==="am"?"a.m.":"p.m."}},h(t,s){return R(t.getHours()%12||12,s.length)},H(t,s){return R(t.getHours(),s.length)},m(t,s){return R(t.getMinutes(),s.length)},s(t,s){return R(t.getSeconds(),s.length)},S(t,s){const a=s.length,r=t.getMilliseconds(),n=Math.trunc(r*Math.pow(10,a-3));return R(n,s.length)}},Ce={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},bs={G:function(t,s,a){const r=t.getFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"});case"GGGGG":return a.era(r,{width:"narrow"});case"GGGG":default:return a.era(r,{width:"wide"})}},y:function(t,s,a){if(s==="yo"){const r=t.getFullYear(),n=r>0?r:1-r;return a.ordinalNumber(n,{unit:"year"})}return ue.y(t,s)},Y:function(t,s,a,r){const n=Ys(t,r),i=n>0?n:1-n;if(s==="YY"){const o=i%100;return R(o,2)}return s==="Yo"?a.ordinalNumber(i,{unit:"year"}):R(i,s.length)},R:function(t,s){const a=Gs(t);return R(a,s.length)},u:function(t,s){const a=t.getFullYear();return R(a,s.length)},Q:function(t,s,a){const r=Math.ceil((t.getMonth()+1)/3);switch(s){case"Q":return String(r);case"QQ":return R(r,2);case"Qo":return a.ordinalNumber(r,{unit:"quarter"});case"QQQ":return a.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,s,a){const r=Math.ceil((t.getMonth()+1)/3);switch(s){case"q":return String(r);case"qq":return R(r,2);case"qo":return a.ordinalNumber(r,{unit:"quarter"});case"qqq":return a.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,s,a){const r=t.getMonth();switch(s){case"M":case"MM":return ue.M(t,s);case"Mo":return a.ordinalNumber(r+1,{unit:"month"});case"MMM":return a.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(r,{width:"wide",context:"formatting"})}},L:function(t,s,a){const r=t.getMonth();switch(s){case"L":return String(r+1);case"LL":return R(r+1,2);case"Lo":return a.ordinalNumber(r+1,{unit:"month"});case"LLL":return a.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(r,{width:"wide",context:"standalone"})}},w:function(t,s,a,r){const n=wi(t,r);return s==="wo"?a.ordinalNumber(n,{unit:"week"}):R(n,s.length)},I:function(t,s,a){const r=vi(t);return s==="Io"?a.ordinalNumber(r,{unit:"week"}):R(r,s.length)},d:function(t,s,a){return s==="do"?a.ordinalNumber(t.getDate(),{unit:"date"}):ue.d(t,s)},D:function(t,s,a){const r=ji(t);return s==="Do"?a.ordinalNumber(r,{unit:"dayOfYear"}):R(r,s.length)},E:function(t,s,a){const r=t.getDay();switch(s){case"E":case"EE":case"EEE":return a.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(r,{width:"short",context:"formatting"});case"EEEE":default:return a.day(r,{width:"wide",context:"formatting"})}},e:function(t,s,a,r){const n=t.getDay(),i=(n-r.weekStartsOn+8)%7||7;switch(s){case"e":return String(i);case"ee":return R(i,2);case"eo":return a.ordinalNumber(i,{unit:"day"});case"eee":return a.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(n,{width:"short",context:"formatting"});case"eeee":default:return a.day(n,{width:"wide",context:"formatting"})}},c:function(t,s,a,r){const n=t.getDay(),i=(n-r.weekStartsOn+8)%7||7;switch(s){case"c":return String(i);case"cc":return R(i,s.length);case"co":return a.ordinalNumber(i,{unit:"day"});case"ccc":return a.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(n,{width:"narrow",context:"standalone"});case"cccccc":return a.day(n,{width:"short",context:"standalone"});case"cccc":default:return a.day(n,{width:"wide",context:"standalone"})}},i:function(t,s,a){const r=t.getDay(),n=r===0?7:r;switch(s){case"i":return String(n);case"ii":return R(n,s.length);case"io":return a.ordinalNumber(n,{unit:"day"});case"iii":return a.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(r,{width:"short",context:"formatting"});case"iiii":default:return a.day(r,{width:"wide",context:"formatting"})}},a:function(t,s,a){const n=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(t,s,a){const r=t.getHours();let n;switch(r===12?n=Ce.noon:r===0?n=Ce.midnight:n=r/12>=1?"pm":"am",s){case"b":case"bb":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(t,s,a){const r=t.getHours();let n;switch(r>=17?n=Ce.evening:r>=12?n=Ce.afternoon:r>=4?n=Ce.morning:n=Ce.night,s){case"B":case"BB":case"BBB":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(t,s,a){if(s==="ho"){let r=t.getHours()%12;return r===0&&(r=12),a.ordinalNumber(r,{unit:"hour"})}return ue.h(t,s)},H:function(t,s,a){return s==="Ho"?a.ordinalNumber(t.getHours(),{unit:"hour"}):ue.H(t,s)},K:function(t,s,a){const r=t.getHours()%12;return s==="Ko"?a.ordinalNumber(r,{unit:"hour"}):R(r,s.length)},k:function(t,s,a){let r=t.getHours();return r===0&&(r=24),s==="ko"?a.ordinalNumber(r,{unit:"hour"}):R(r,s.length)},m:function(t,s,a){return s==="mo"?a.ordinalNumber(t.getMinutes(),{unit:"minute"}):ue.m(t,s)},s:function(t,s,a){return s==="so"?a.ordinalNumber(t.getSeconds(),{unit:"second"}):ue.s(t,s)},S:function(t,s){return ue.S(t,s)},X:function(t,s,a){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(s){case"X":return vs(r);case"XXXX":case"XX":return ye(r);case"XXXXX":case"XXX":default:return ye(r,":")}},x:function(t,s,a){const r=t.getTimezoneOffset();switch(s){case"x":return vs(r);case"xxxx":case"xx":return ye(r);case"xxxxx":case"xxx":default:return ye(r,":")}},O:function(t,s,a){const r=t.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+js(r,":");case"OOOO":default:return"GMT"+ye(r,":")}},z:function(t,s,a){const r=t.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+js(r,":");case"zzzz":default:return"GMT"+ye(r,":")}},t:function(t,s,a){const r=Math.trunc(+t/1e3);return R(r,s.length)},T:function(t,s,a){return R(+t,s.length)}};function js(t,s=""){const a=t>0?"-":"+",r=Math.abs(t),n=Math.trunc(r/60),i=r%60;return i===0?a+String(n):a+String(n)+s+R(i,2)}function vs(t,s){return t%60===0?(t>0?"-":"+")+R(Math.abs(t)/60,2):ye(t,s)}function ye(t,s=""){const a=t>0?"-":"+",r=Math.abs(t),n=R(Math.trunc(r/60),2),i=R(r%60,2);return a+n+s+i}const ys=(t,s)=>{switch(t){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},qs=(t,s)=>{switch(t){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},Ni=(t,s)=>{const a=t.match(/(P+)(p+)?/)||[],r=a[1],n=a[2];if(!n)return ys(t,s);let i;switch(r){case"P":i=s.dateTime({width:"short"});break;case"PP":i=s.dateTime({width:"medium"});break;case"PPP":i=s.dateTime({width:"long"});break;case"PPPP":default:i=s.dateTime({width:"full"});break}return i.replace("{{date}}",ys(r,s)).replace("{{time}}",qs(n,s))},ki={p:qs,P:Ni},Si=/^D+$/,Ci=/^Y+$/,Di=["D","DD","YY","YYYY"];function Pi(t){return Si.test(t)}function Ii(t){return Ci.test(t)}function Ai(t,s,a){const r=Ti(t,s,a);if(console.warn(r),Di.includes(t))throw new RangeError(r)}function Ti(t,s,a){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${s}\`) for formatting ${r} to the input \`${a}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Mi=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ei=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ri=/^'([^]*?)'?$/,Oi=/''/g,Fi=/[a-zA-Z]/;function Xs(t,s,a){var p,f,g,S;const r=Je(),n=r.locale??$s,i=r.firstWeekContainsDate??((f=(p=r.locale)==null?void 0:p.options)==null?void 0:f.firstWeekContainsDate)??1,o=r.weekStartsOn??((S=(g=r.locale)==null?void 0:g.options)==null?void 0:S.weekStartsOn)??0,l=z(t,a==null?void 0:a.in);if(!Tn(l))throw new RangeError("Invalid time value");let c=s.match(Ei).map(y=>{const b=y[0];if(b==="p"||b==="P"){const w=ki[b];return w(y,n.formatLong)}return y}).join("").match(Mi).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const b=y[0];if(b==="'")return{isToken:!1,value:Li(y)};if(bs[b])return{isToken:!0,value:y};if(b.match(Fi))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:y}});n.localize.preprocessor&&(c=n.localize.preprocessor(l,c));const m={firstWeekContainsDate:i,weekStartsOn:o,locale:n};return c.map(y=>{if(!y.isToken)return y.value;const b=y.value;(Ii(b)||Pi(b))&&Ai(b,s,String(t));const w=bs[b[0]];return w(l,b,n.localize,m)}).join("")}function Li(t){const s=t.match(Ri);return s?s[1].replace(Oi,"'"):t}function Wi(t,s,a){const r=Je(),n=(a==null?void 0:a.locale)??r.locale??$s,i=2520,o=mt(t,s);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},a,{addSuffix:a==null?void 0:a.addSuffix,comparison:o}),[c,m]=yt(a==null?void 0:a.in,...o>0?[s,t]:[t,s]),p=zn(m,c),f=(gt(m)-gt(c))/1e3,g=Math.round((p-f)/60);let S;if(g<2)return a!=null&&a.includeSeconds?p<5?n.formatDistance("lessThanXSeconds",5,l):p<10?n.formatDistance("lessThanXSeconds",10,l):p<20?n.formatDistance("lessThanXSeconds",20,l):p<40?n.formatDistance("halfAMinute",0,l):p<60?n.formatDistance("lessThanXMinutes",1,l):n.formatDistance("xMinutes",1,l):g===0?n.formatDistance("lessThanXMinutes",1,l):n.formatDistance("xMinutes",g,l);if(g<45)return n.formatDistance("xMinutes",g,l);if(g<90)return n.formatDistance("aboutXHours",1,l);if(g<ps){const y=Math.round(g/60);return n.formatDistance("aboutXHours",y,l)}else{if(g<i)return n.formatDistance("xDays",1,l);if(g<et){const y=Math.round(g/ps);return n.formatDistance("xDays",y,l)}else if(g<et*2)return S=Math.round(g/et),n.formatDistance("aboutXMonths",S,l)}if(S=Wn(m,c),S<12){const y=Math.round(g/et);return n.formatDistance("xMonths",y,l)}else{const y=S%12,b=Math.trunc(S/12);return y<3?n.formatDistance("aboutXYears",b,l):y<9?n.formatDistance("overXYears",b,l):n.formatDistance("almostXYears",b+1,l)}}function zi(t,s){return Wi(t,In(t),s)}function Jt(t,s){const a=()=>J(s==null?void 0:s.in,NaN),n=Hi(t);let i;if(n.date){const m=Ui(n.date,2);i=Gi(m.restDateString,m.year)}if(!i||isNaN(+i))return a();const o=+i;let l=0,c;if(n.time&&(l=$i(n.time),isNaN(l)))return a();if(n.timezone){if(c=Yi(n.timezone),isNaN(c))return a()}else{const m=new Date(o+l),p=z(0,s==null?void 0:s.in);return p.setFullYear(m.getUTCFullYear(),m.getUTCMonth(),m.getUTCDate()),p.setHours(m.getUTCHours(),m.getUTCMinutes(),m.getUTCSeconds(),m.getUTCMilliseconds()),p}return z(o+l+c,s==null?void 0:s.in)}const tt={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},_i=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Bi=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Vi=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Hi(t){const s={},a=t.split(tt.dateTimeDelimiter);let r;if(a.length>2)return s;if(/:/.test(a[0])?r=a[0]:(s.date=a[0],r=a[1],tt.timeZoneDelimiter.test(s.date)&&(s.date=t.split(tt.timeZoneDelimiter)[0],r=t.substr(s.date.length,t.length))),r){const n=tt.timezone.exec(r);n?(s.time=r.replace(n[1],""),s.timezone=n[1]):s.time=r}return s}function Ui(t,s){const a=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+s)+"})|(\\d{2}|[+-]\\d{"+(2+s)+"})$)"),r=t.match(a);if(!r)return{year:NaN,restDateString:""};const n=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:i===null?n:i*100,restDateString:t.slice((r[1]||r[2]).length)}}function Gi(t,s){if(s===null)return new Date(NaN);const a=t.match(_i);if(!a)return new Date(NaN);const r=!!a[4],n=ze(a[1]),i=ze(a[2])-1,o=ze(a[3]),l=ze(a[4]),c=ze(a[5])-1;if(r)return Ji(s,l,c)?qi(s,l,c):new Date(NaN);{const m=new Date(0);return!Ki(s,i,o)||!Qi(s,n)?new Date(NaN):(m.setUTCFullYear(s,i,Math.max(n,o)),m)}}function ze(t){return t?parseInt(t):1}function $i(t){const s=t.match(Bi);if(!s)return NaN;const a=Tt(s[1]),r=Tt(s[2]),n=Tt(s[3]);return Zi(a,r,n)?a*Us+r*Hs+n*1e3:NaN}function Tt(t){return t&&parseFloat(t.replace(",","."))||0}function Yi(t){if(t==="Z")return 0;const s=t.match(Vi);if(!s)return 0;const a=s[1]==="+"?-1:1,r=parseInt(s[2]),n=s[3]&&parseInt(s[3])||0;return el(r,n)?a*(r*Us+n*Hs):NaN}function qi(t,s,a){const r=new Date(0);r.setUTCFullYear(t,0,4);const n=r.getUTCDay()||7,i=(s-1)*7+a+1-n;return r.setUTCDate(r.getUTCDate()+i),r}const Xi=[31,null,31,30,31,30,31,31,30,31,30,31];function Ks(t){return t%400===0||t%4===0&&t%100!==0}function Ki(t,s,a){return s>=0&&s<=11&&a>=1&&a<=(Xi[s]||(Ks(t)?29:28))}function Qi(t,s){return s>=1&&s<=(Ks(t)?366:365)}function Ji(t,s,a){return s>=1&&s<=53&&a>=0&&a<=6}function Zi(t,s,a){return t===24?s===0&&a===0:a>=0&&a<60&&s>=0&&s<60&&t>=0&&t<25}function el(t,s){return s>=0&&s<=59}function tl(t){const s=typeof t=="string"?Jt(t):t;return Xs(s,"PPP p")}function Qs(t){const s=typeof t=="string"?Jt(t):t;return Xs(s,"HH:mm:ss")}function sl(t){const s=typeof t=="string"?Jt(t):t;return zi(s,{addSuffix:!0})}function al(t){if(t===0)return"0 Bytes";const s=1024,a=["Bytes","KB","MB","GB","TB"],r=Math.floor(Math.log(t)/Math.log(s));return`${parseFloat((t/Math.pow(s,r)).toFixed(2))} ${a[r]}`}function rl(){const t=ne(),{createSession:s,recentSessions:a,loadSession:r,clearRecentSessions:n}=Z(),i=()=>{s(),t("/context")},o=c=>{s(c),t("/context")},l=c=>{r(c),t("/context")};return e.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900",children:[e.jsx(Bs,{showProgress:!1}),e.jsxs("main",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-slate-900 dark:text-slate-100 mb-4",children:"Self-Service Forensic Triage"}),e.jsx("p",{className:"text-lg text-slate-600 dark:text-slate-400 max-w-2xl mx-auto mb-8",children:"Quick diagnostic before professional incident response. Upload organizational context, configure data sources, and get actionable insights."}),e.jsx(k,{content:"Begin a new forensic investigation from scratch",children:e.jsx(P,{size:"lg",onClick:i,rightIcon:e.jsx(Yt,{className:"w-5 h-5"}),children:"Start New Investigation"})})]}),e.jsxs("section",{className:"mb-12",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-4",children:"Select a Scenario"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-6",children:"Choose a pre-populated scenario to see the full workflow with realistic demo data."}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:nl.map(c=>e.jsx(il,{scenario:c,onSelect:()=>o(c.id)},c.id))})]}),a.length>0&&e.jsxs("section",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Recent Sessions"}),e.jsx(k,{content:"Remove all saved session history",children:e.jsx(P,{variant:"ghost",size:"sm",onClick:n,leftIcon:e.jsx(Ca,{className:"w-4 h-4"}),children:"Clear"})})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:a.slice(0,6).map(c=>e.jsx(ll,{session:c,onResume:()=>l(c.id)},c.id))})]})]})]})}const nl=[{id:"ransomware",title:"Ransomware Attack",description:"Enterprise ransomware infection with lateral movement and file encryption",icon:e.jsx(Ge,{className:"w-8 h-8"}),difficulty:"intermediate"},{id:"data_exfiltration",title:"Data Exfiltration",description:"Sensitive data theft via compromised cloud storage and sync tools",icon:e.jsx(De,{className:"w-8 h-8"}),difficulty:"advanced"},{id:"insider_threat",title:"Insider Threat",description:"Malicious activity by authorized user with privileged access",icon:e.jsx(qt,{className:"w-8 h-8"}),difficulty:"advanced"},{id:"web_dos",title:"Web Resource DOS",description:"Application-layer denial of service attack on public web services",icon:e.jsx(we,{className:"w-8 h-8"}),difficulty:"beginner"},{id:"ai_breach",title:"AI-Related Breach",description:"Security incident involving AI/ML systems and data poisoning",icon:e.jsx(Da,{className:"w-8 h-8"}),difficulty:"advanced"}];function il({scenario:t,onSelect:s}){const a={beginner:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",intermediate:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",advanced:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"};return e.jsx(k,{content:`Load ${t.title} scenario with pre-populated data`,children:e.jsx(T,{hoverable:!0,onClick:s,className:"cursor-pointer text-center h-full",children:e.jsxs("div",{className:"flex flex-col items-center gap-3 p-2",children:[e.jsx("div",{className:"text-forensic-500 dark:text-forensic-400",children:t.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-slate-100",children:t.title}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1 line-clamp-2",children:t.description})]}),e.jsx("span",{className:u("px-2 py-0.5 rounded-full text-xs font-medium capitalize",a[t.difficulty]),children:t.difficulty})]})})})}function ll({session:t,onResume:s}){const a={ransomware:"Ransomware Attack",data_exfiltration:"Data Exfiltration",insider_threat:"Insider Threat",web_dos:"Web Resource DOS",ai_breach:"AI-Related Breach",custom:"Custom Investigation"};return e.jsx(k,{content:"Continue this investigation session",children:e.jsx(T,{hoverable:!0,onClick:s,className:"cursor-pointer",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-slate-900 dark:text-slate-100 truncate",children:a[t.scenarioType]||"Investigation"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-sm text-slate-500 dark:text-slate-400",children:[e.jsx(Ke,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:sl(t.lastModified)})]})]}),e.jsx("div",{className:"flex flex-col items-end gap-1",children:e.jsx("span",{className:u("px-2 py-0.5 rounded text-xs font-medium",t.isComplete?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"),children:t.isComplete?"Complete":`Step ${t.currentStep+1}`})})]})})})}function ol(){const t=ne(),{goToNextStep:s,goToPreviousStep:a}=Z(),{documents:r,repositories:n,extractedEntities:i,addDocument:o,removeDocument:l}=_s(),c=v.useRef(null),m=()=>{a(),t("/")},p=()=>{s(),t("/incident")},f=v.useCallback(async h=>{const N=h.target.files;if(N){for(const d of Array.from(N))await o(d);c.current&&(c.current.value="")}},[o]),g=v.useCallback(async h=>{h.preventDefault();const N=h.dataTransfer.files;for(const d of Array.from(N))await o(d)},[o]),S=h=>{h.preventDefault()},y=i.systems.length,b=i.networks.length,w=i.processes.length,D=i.compliance.length;return e.jsxs(ge,{title:"Organization Context",subtitle:"Upload documents to help AI understand your environment",footer:e.jsx(ke,{onBack:m,backLabel:"Dashboard",onContinue:p,continueLabel:"Continue"}),children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs(T,{children:[e.jsx(H,{title:"Upload Documents",description:"Drag and drop or browse files"}),e.jsxs("div",{className:"mt-4",children:[e.jsx(k,{content:"Drag and drop files or click to browse. Supports PDF, DOCX, XLSX, JSON, YAML, Visio",children:e.jsxs("div",{onDrop:g,onDragOver:S,onClick:()=>{var h;return(h=c.current)==null?void 0:h.click()},className:u("border-2 border-dashed rounded-lg p-8 text-center cursor-pointer","border-slate-300 dark:border-slate-600","hover:border-forensic-400 dark:hover:border-forensic-500","transition-colors duration-200"),children:[e.jsx(De,{className:"w-10 h-10 mx-auto text-slate-400 mb-3"}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Drag & Drop or"," ",e.jsx("span",{className:"text-forensic-500 font-medium",children:"Browse"})]}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"PDF, DOCX, XLSX, JSON, YAML, Visio"})]})}),e.jsx("input",{ref:c,type:"file",multiple:!0,accept:".pdf,.docx,.xlsx,.json,.yaml,.yml,.vsdx",onChange:f,className:"hidden"})]})]}),e.jsxs(T,{children:[e.jsx(H,{title:"Connect Repository",description:"Access documentation from code repos"}),e.jsx("div",{className:"mt-4 grid grid-cols-2 gap-3",children:["github","gitlab","sharepoint","bitbucket"].map(h=>{const N=an[h],d=n.some(C=>C.type===h&&C.status==="connected");return e.jsx(k,{content:`Connect to ${N.name} for infrastructure documentation`,children:e.jsxs("button",{className:u("flex items-center gap-2 p-3 rounded-lg border","transition-colors duration-200",d?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-slate-200 dark:border-slate-700 hover:border-forensic-400"),children:[e.jsx(Pa,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:N.name}),d&&e.jsx(B,{className:"w-4 h-4 text-green-500 ml-auto"})]})},h)})})]})]}),r.length>0&&e.jsxs("section",{className:"mb-8",children:[e.jsxs("h3",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:["Uploaded Documents (",r.length,")"]}),e.jsx("div",{className:"space-y-2",children:r.map(h=>e.jsx(cl,{document:h,onRemove:()=>l(h.id)},h.id))})]}),(y>0||b>0||w>0||D>0)&&e.jsxs("section",{children:[e.jsx("h3",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Extracted Context"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsx(st,{icon:e.jsx(Y,{className:"w-5 h-5"}),label:"Systems",count:y,tooltip:"Systems, servers, and workstations identified"}),e.jsx(st,{icon:e.jsx(Ne,{className:"w-5 h-5"}),label:"Networks",count:b,tooltip:"Network segments and VLANs identified"}),e.jsx(st,{icon:e.jsx(Ke,{className:"w-5 h-5"}),label:"Processes",count:w,tooltip:"Critical business processes identified"}),e.jsx(st,{icon:e.jsx(pe,{className:"w-5 h-5"}),label:"Compliance",count:D,tooltip:"Compliance requirements identified"})]})]}),(y>0||r.length>0)&&e.jsxs("section",{className:"mt-8 mb-8",children:[e.jsx("h3",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Identity & Access Management"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(Mt,{icon:e.jsx(Wt,{className:"w-6 h-6"}),title:"Active Directory",subtitle:"On-Premises AD",status:"detected",details:[{label:"Domain Controllers",value:"2 detected"},{label:"Forest",value:"corp.local"},{label:"Functional Level",value:"2016"},{label:"User Accounts",value:"~1,250"},{label:"Service Accounts",value:"~45"},{label:"Group Policies",value:"38 linked"}]}),e.jsx(Mt,{icon:e.jsx(ft,{className:"w-6 h-6"}),title:"Azure AD / Entra ID",subtitle:"Cloud Identity",status:"detected",details:[{label:"Tenant",value:"company.onmicrosoft.com"},{label:"Synced Users",value:"~1,180"},{label:"Cloud-Only Users",value:"~70"},{label:"MFA Enforced",value:"62%"},{label:"Conditional Access",value:"8 policies"},{label:"App Registrations",value:"24"}]}),e.jsx(Mt,{icon:e.jsx(Ia,{className:"w-6 h-6"}),title:"Hybrid Identity",subtitle:"AD Connect Sync",status:"synced",details:[{label:"Sync Status",value:"Healthy"},{label:"Last Sync",value:"12 min ago"},{label:"Sync Method",value:"Password Hash"},{label:"Privileged Roles",value:"15 Global Admins"},{label:"Guest Accounts",value:"34"},{label:"Stale Accounts (90d)",value:"127"}]})]})]}),r.length===0&&n.length===0&&e.jsx(kn,{icon:e.jsx(bt,{className:"w-12 h-12"}),title:"No context uploaded yet",description:"Upload documents or connect repositories to provide organizational context for better analysis."})]})}function cl({document:t,onRemove:s}){const a=sn[t.type]||{name:"File",color:"text-slate-500"},r={uploading:e.jsx(xt,{className:"w-4 h-4 animate-spin text-blue-500"}),parsing:e.jsx(xt,{className:"w-4 h-4 animate-spin text-yellow-500"}),parsed:e.jsx(B,{className:"w-4 h-4 text-green-500"}),error:e.jsx(Ta,{className:"w-4 h-4 text-red-500"})},n={uploading:"Uploading...",parsing:"Parsing...",parsed:"Parsed",error:"Error"};return e.jsxs("div",{className:u("flex items-center gap-3 p-3 rounded-lg","bg-slate-50 dark:bg-slate-800/50","border border-slate-200 dark:border-slate-700"),children:[e.jsx(bt,{className:u("w-5 h-5",a.color)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100 truncate",children:t.filename}),e.jsxs("p",{className:"text-xs text-slate-500",children:[al(t.size)," "," ",e.jsx("span",{className:"capitalize",children:a.name})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{content:"Document is being analyzed to extract context",children:e.jsxs("div",{className:"flex items-center gap-1",children:[r[t.status],e.jsx("span",{className:"text-xs text-slate-500",children:n[t.status]})]})}),t.status==="parsed"&&e.jsx(k,{content:"Preview extracted data",children:e.jsx("button",{className:"p-1 hover:bg-slate-200 dark:hover:bg-slate-700 rounded",children:e.jsx(jt,{className:"w-4 h-4 text-slate-500"})})}),e.jsx(k,{content:"Remove document",children:e.jsx("button",{onClick:s,className:"p-1 hover:bg-red-100 dark:hover:bg-red-900/30 rounded text-slate-400 hover:text-red-500",children:e.jsx(Qe,{className:"w-4 h-4"})})})]})]})}function st({icon:t,label:s,count:a,tooltip:r}){return e.jsx(k,{content:r,children:e.jsx(T,{className:"text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"text-forensic-500",children:t}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:a}),e.jsx("p",{className:"text-xs text-slate-500",children:s})]})]})})})}function Mt({icon:t,title:s,subtitle:a,status:r,details:n}){var p,f;const[i,o]=v.useState(!1),l={detected:"border-green-400 dark:border-green-600",synced:"border-blue-400 dark:border-blue-600",error:"border-red-400 dark:border-red-600",not_found:"border-slate-300 dark:border-slate-600"},c={detected:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",synced:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",error:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",not_found:"bg-slate-100 text-slate-600 dark:bg-slate-800 dark:text-slate-400"},m={detected:"Detected",synced:"Synced",error:"Error",not_found:"Not Found"};return e.jsx(T,{className:u("relative border-2 transition-all duration-300 cursor-pointer","hover:shadow-lg hover:-translate-y-0.5","bg-gradient-to-br from-white to-slate-50 dark:from-slate-800 dark:to-slate-800/50",l[r]),children:e.jsxs("div",{onClick:()=>o(!i),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:u("p-2 rounded-lg",r==="detected"?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":r==="synced"?"bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":"bg-slate-100 text-slate-500 dark:bg-slate-700 dark:text-slate-400"),children:t}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100 text-sm",children:s}),e.jsx("p",{className:"text-xs text-slate-500",children:a})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:u("px-2 py-0.5 rounded-full text-xs font-medium",c[r]),children:m[r]}),i?e.jsx(he,{className:"w-4 h-4 text-slate-400"}):e.jsx(re,{className:"w-4 h-4 text-slate-400"})]})]}),!i&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[e.jsx(Aa,{className:"w-3 h-3"}),e.jsx("span",{children:(p=n[0])==null?void 0:p.value}),e.jsx("span",{className:"text-slate-300 dark:text-slate-600",children:"|"}),e.jsx("span",{children:(f=n[1])==null?void 0:f.value})]}),i&&e.jsx("div",{className:"mt-3 pt-3 border-t border-slate-200 dark:border-slate-700 space-y-2",children:n.map((g,S)=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-slate-500",children:g.label}),e.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:g.value})]},S))})]})})}function dl(){var W;const t=ne(),{goToNextStep:s,goToPreviousStep:a,updateIncidentDescription:r,currentSession:n}=Z(),[i,o]=v.useState(((W=n==null?void 0:n.incidentDescription)==null?void 0:W.naturalLanguage)||""),[l,c]=v.useState(""),[m,p]=v.useState(""),[f,g]=v.useState([]),[S,y]=v.useState("hash"),[b,w]=v.useState(""),D=()=>{a(),t("/context")},h=()=>{r({naturalLanguage:i,startDate:l?new Date(l):new Date,patientZero:{hostname:m,type:"workstation"},iocs:f.map((I,x)=>({id:`ioc-${x}`,type:I.type,value:I.value,confidence:"medium"}))}),s(),t("/connectors")},N=()=>{b.trim()&&(g([...f,{type:S,value:b}]),w(""))},d=I=>{g(f.filter((x,O)=>O!==I))},C=["Ransomware detected","Unauthorized access","Data exfiltration suspected","Malicious email received","System compromise"];return e.jsx(ge,{title:"Incident Description",subtitle:"Describe the security incident in detail",footer:e.jsx(ke,{onBack:D,backLabel:"Context",onContinue:h,continueLabel:"Continue"}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(T,{children:[e.jsx(H,{title:"Describe the Incident",description:"Provide a detailed description of what happened"}),e.jsxs("div",{className:"mt-4",children:[e.jsx(Fs,{value:i,onChange:I=>o(I.target.value),placeholder:"Our finance department reported that multiple file servers became inaccessible around 2:30 AM on Tuesday. Users discovered ransom notes demanding Bitcoin payment...",minRows:5,tooltip:"Describe the incident in your own words. Include what happened, when it was discovered, and any initial observations."}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:C.map(I=>e.jsx(k,{content:"Click to add this common phrase",children:e.jsx("button",{onClick:()=>o(x=>x?`${x} ${I}.`:I),className:u("px-3 py-1 text-sm rounded-full","bg-slate-100 dark:bg-slate-700","text-slate-600 dark:text-slate-300","hover:bg-forensic-100 dark:hover:bg-forensic-900/30","hover:text-forensic-700 dark:hover:text-forensic-300","transition-colors duration-200"),children:I})},I))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(T,{children:[e.jsx(H,{title:"Incident Start Date",description:"When was the incident first discovered?"}),e.jsx("div",{className:"mt-4",children:e.jsx(Ue,{type:"datetime-local",value:l,onChange:I=>c(I.target.value),leftAddon:e.jsx(Ns,{className:"w-4 h-4"}),tooltip:"When did the first indicator of the incident appear?"})})]}),e.jsxs(T,{children:[e.jsx(H,{title:"Patient Zero",description:"First affected system identified"}),e.jsx("div",{className:"mt-4",children:e.jsx(Ue,{value:m,onChange:I=>p(I.target.value),placeholder:"e.g., ACCT-WS-042 or 10.20.30.42",leftAddon:e.jsx(Ma,{className:"w-4 h-4"}),tooltip:"Enter the hostname or IP of the first affected system"})})]})]}),e.jsxs(T,{children:[e.jsx(H,{title:"Indicators of Compromise (IOCs)",description:"Add known IOCs associated with this incident"}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{content:"Type of Indicator of Compromise",children:e.jsxs("select",{value:S,onChange:I=>y(I.target.value),className:"input w-32",children:[e.jsx("option",{value:"hash",children:"Hash"}),e.jsx("option",{value:"ip",children:"IP Address"}),e.jsx("option",{value:"domain",children:"Domain"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"url",children:"URL"}),e.jsx("option",{value:"file_path",children:"File Path"})]})}),e.jsx(Ue,{value:b,onChange:I=>w(I.target.value),placeholder:"Enter IOC value...",className:"flex-1",tooltip:"Enter the IOC value"}),e.jsx(k,{content:"Add another Indicator of Compromise to the list",children:e.jsx(P,{onClick:N,leftIcon:e.jsx(Ea,{className:"w-4 h-4"}),children:"Add"})})]}),f.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:f.map((I,x)=>e.jsxs(Q,{variant:"secondary",children:[e.jsxs("span",{className:"font-medium capitalize",children:[I.type,":"]})," ",e.jsx("span",{className:"font-mono text-xs",children:I.value}),e.jsx("button",{onClick:()=>d(x),className:"ml-1 hover:text-red-500",children:e.jsx(Qe,{className:"w-3 h-3"})})]},x))})]})]})]})})}const ml={servers:[{id:"d1",name:"DC-MAIN-01",type:"Domain Controller",ip:"10.0.1.10",os:"Windows Server 2022",status:"online",ports:[53,88,389,445,636],services:["DNS","Kerberos","LDAP","SMB"],risk:"critical"},{id:"d2",name:"DC-BACKUP-01",type:"Domain Controller",ip:"10.0.1.11",os:"Windows Server 2022",status:"online",ports:[53,88,389,445],services:["DNS","Kerberos","LDAP","SMB"],risk:"critical"},{id:"d3",name:"FS-FINANCE-01",type:"File Server",ip:"10.0.2.20",os:"Windows Server 2019",status:"online",ports:[445,3389],services:["SMB","RDP"],risk:"high"},{id:"d4",name:"SQL-DB-01",type:"Database Server",ip:"10.0.3.30",os:"Windows Server 2019",status:"online",ports:[1433,3389],services:["MSSQL","RDP"],risk:"high"},{id:"d5",name:"WEB-APP-01",type:"Web Server",ip:"10.0.4.40",os:"Ubuntu 22.04",status:"online",ports:[80,443,22],services:["HTTP","HTTPS","SSH"],risk:"medium"},{id:"d6",name:"EXCH-01",type:"Exchange Server",ip:"10.0.1.15",os:"Windows Server 2019",status:"online",ports:[25,443,587],services:["SMTP","HTTPS","Submission"],risk:"high"}],endpoints:[{id:"e1",name:"WS-FIN-042",type:"Workstation",ip:"10.0.10.42",os:"Windows 11 Pro",status:"online",ports:[135,445],services:["RPC","SMB"],risk:"high"},{id:"e2",name:"WS-HR-015",type:"Workstation",ip:"10.0.10.15",os:"Windows 11 Pro",status:"online",ports:[135,445],services:["RPC","SMB"],risk:"medium"},{id:"e3",name:"WS-IT-001",type:"Workstation",ip:"10.0.10.1",os:"Windows 11 Pro",status:"online",ports:[135,445,3389],services:["RPC","SMB","RDP"],risk:"medium"},{id:"e4",name:"LPT-EXEC-003",type:"Laptop",ip:"10.0.11.3",os:"macOS Sonoma",status:"offline",ports:[],services:[],risk:"low"}],peripherals:[{id:"p1",name:"FW-EDGE-01",type:"Firewall",ip:"10.0.0.1",status:"online",ports:[443,8443],services:["HTTPS Mgmt","VPN"],risk:"critical"},{id:"p2",name:"SW-CORE-01",type:"Core Switch",ip:"10.0.0.2",status:"online",ports:[22,443],services:["SSH","HTTPS"],risk:"high"},{id:"p3",name:"WAF-01",type:"Web App Firewall",ip:"10.0.0.5",status:"online",ports:[443,8443],services:["HTTPS","Mgmt"],risk:"high"},{id:"p4",name:"IDS-01",type:"IDS/IPS",ip:"10.0.0.6",status:"online",ports:[443],services:["HTTPS Mgmt"],risk:"medium"}],cloud:[{id:"c1",name:"AWS Account (Prod)",type:"AWS",ip:"aws:123456789012",status:"online",ports:[],services:["EC2","S3","RDS","Lambda","CloudTrail"],risk:"high"},{id:"c2",name:"Azure Tenant",type:"Azure",ip:"azure:tenant-abc-123",status:"online",ports:[],services:["Azure AD","VMs","Storage","Key Vault"],risk:"critical"},{id:"c3",name:"O365 Tenant",type:"Office 365",ip:"o365:tenant-abc-123",status:"online",ports:[],services:["Exchange Online","SharePoint","Teams","OneDrive"],risk:"high"}],internet:[{id:"i1",name:"mail.company.com",type:"SMTP Gateway",ip:"203.0.113.10",status:"online",ports:[25,443,587],services:["SMTP","HTTPS","Submission"],risk:"high"},{id:"i2",name:"vpn.company.com",type:"VPN Gateway",ip:"203.0.113.11",status:"online",ports:[443,1194],services:["HTTPS","OpenVPN"],risk:"critical"},{id:"i3",name:"app.company.com",type:"Web Application",ip:"203.0.113.20",status:"online",ports:[80,443],services:["HTTP","HTTPS"],risk:"high"},{id:"i4",name:"api.company.com",type:"REST API",ip:"203.0.113.21",status:"online",ports:[443],services:["HTTPS"],risk:"medium"},{id:"i5",name:"ftp.company.com",type:"FTP Server",ip:"203.0.113.30",status:"filtered",ports:[21,990],services:["FTP","FTPS"],risk:"high"}]};function xl(){const t=ne(),{goToNextStep:s,goToPreviousStep:a}=Z(),[r,n]=v.useState("endpoints"),[i,o]=v.useState(new Set),[l,c]=v.useState(!1),[m,p]=v.useState(null),[f,g]=v.useState("credentials"),[S,y]=v.useState(!1),[b,w]=v.useState("windows"),[D,h]=v.useState(!1),[N,d]=v.useState([]),[C,W]=v.useState(!1),[I,x]=v.useState(!1),[O,ie]=v.useState({}),[U,M]=v.useState(""),[le,oe]=v.useState(null),[ee,ce]=v.useState("servers"),[te,de]=v.useState(!1),[G,fe]=v.useState([]),[V,E]=v.useState(""),[L,X]=v.useState(""),[_,Ze]=v.useState(null),wt=()=>{a(),t("/incident")},Ee=()=>{s(),t("/validation")},Js=j=>{p(j),c(!0)},Zs=()=>{m&&o(new Set([...i,m])),c(!1),p(null)},ea=j=>{if(U.trim()){const $=O[j]||[];$.includes(U.trim())||ie({...O,[j]:[...$,U.trim()]}),M("")}},ta=(j,$)=>{const kt=O[j]||[];ie({...O,[j]:kt.filter(Re=>Re!==$)})},sa=()=>{de(!0),fe([]),setTimeout(()=>{fe(ml[ee]||[]),de(!1)},3e3)},aa=j=>({windows:e.jsx(Ie,{className:"w-6 h-6"}),linux:e.jsx(St,{className:"w-6 h-6"}),macos:e.jsx(za,{className:"w-6 h-6"}),aws:e.jsx(q,{className:"w-6 h-6"}),azure:e.jsx(q,{className:"w-6 h-6"}),gcp:e.jsx(q,{className:"w-6 h-6"}),o365:e.jsx(Ye,{className:"w-6 h-6"}),gsuite:e.jsx(Ye,{className:"w-6 h-6"}),firewall:e.jsx(pe,{className:"w-6 h-6"}),storage:e.jsx(Pe,{className:"w-6 h-6"}),email_gateway:e.jsx(Wa,{className:"w-6 h-6"}),proxy_waf:e.jsx(we,{className:"w-6 h-6"})})[j],Nt=ds.find(j=>j.id===r);return e.jsxs(ge,{title:"Connector Configuration",subtitle:"Configure data sources for forensic analysis",footer:e.jsx(ke,{onBack:wt,backLabel:"Incident",onContinue:Ee,continueLabel:"Continue",middleContent:e.jsxs("span",{className:"text-sm text-slate-500",children:[i.size," connector",i.size!==1?"s":""," configured"]})}),children:[e.jsxs("div",{className:"flex gap-2 mb-6 border-b border-slate-200 dark:border-slate-700 overflow-x-auto",children:[ds.map(j=>e.jsx(k,{content:j.description,children:e.jsx("button",{onClick:()=>n(j.id),className:u("px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors whitespace-nowrap",r===j.id?"border-forensic-500 text-forensic-600 dark:text-forensic-400":"border-transparent text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"),children:j.name})},j.id)),e.jsx(k,{content:"Agentless collection via portable tools or disk images",children:e.jsx("button",{onClick:()=>n("collector"),className:u("px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors whitespace-nowrap",r==="collector"?"border-forensic-500 text-forensic-600 dark:text-forensic-400":"border-transparent text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"),children:"Agentless / Offline"})}),e.jsx(k,{content:"Auto-discover servers, endpoints, peripherals, cloud, and internet-facing assets",children:e.jsxs("button",{onClick:()=>n("discovery"),className:u("px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors whitespace-nowrap flex items-center gap-1.5",r==="discovery"?"border-forensic-500 text-forensic-600 dark:text-forensic-400":"border-transparent text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"),children:[e.jsx(ct,{className:"w-3.5 h-3.5"}),"Auto-Discovery"]})})]}),r!=="collector"&&r!=="discovery"&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:Nt==null?void 0:Nt.connectors.map(j=>{const $=ms[j],kt=i.has(j);return e.jsx(ul,{type:j,name:$.name,description:$.description,icon:aa(j),isConfigured:kt,onConfigure:()=>Js(j),tags:O[j]||[],isEditingTags:le===j,onToggleEditTags:()=>oe(le===j?null:j),tagInput:le===j?U:"",onTagInputChange:Re=>M(Re),onAddTag:()=>ea(j),onRemoveTag:Re=>ta(j,Re)},j)})}),r==="collector"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(T,{className:"border-2 border-dashed border-slate-300 dark:border-slate-600 hover:border-forensic-400 dark:hover:border-forensic-500 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-forensic-100 dark:bg-forensic-900/30 rounded-lg",children:e.jsx(es,{className:"w-8 h-8 text-forensic-600 dark:text-forensic-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Craft Portable Collector"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1 mb-3",children:"Build a lightweight executable that collects forensic artifacts without installing an agent. Run on any Windows or Linux system via USB or network share."}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsx("span",{className:"px-2 py-0.5 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 text-xs rounded-full",children:"No Installation"}),e.jsx("span",{className:"px-2 py-0.5 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 text-xs rounded-full",children:"USB Portable"}),e.jsx("span",{className:"px-2 py-0.5 bg-purple-50 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400 text-xs rounded-full",children:"Customizable"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(k,{content:"Configure and build a portable forensic collector",children:e.jsx(P,{size:"sm",onClick:()=>y(!0),leftIcon:e.jsx(dt,{className:"w-4 h-4"}),children:"Configure & Build"})})})]})]})}),e.jsx(T,{className:"border-2 border-dashed border-slate-300 dark:border-slate-600 hover:border-forensic-400 dark:hover:border-forensic-500 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-900/30 rounded-lg",children:e.jsx(Y,{className:"w-8 h-8 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Upload Disk Image"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1 mb-3",children:"Upload VM disk images or forensic images for triage without connecting to live systems. Supports VMDK, VHD, VHDX, E01, RAW, and more."}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsx("span",{className:"px-2 py-0.5 bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 text-xs rounded-full",children:"VMDK"}),e.jsx("span",{className:"px-2 py-0.5 bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 text-xs rounded-full",children:"VHD/VHDX"}),e.jsx("span",{className:"px-2 py-0.5 bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 text-xs rounded-full",children:"E01"}),e.jsx("span",{className:"px-2 py-0.5 bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 text-xs rounded-full",children:"RAW/DD"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(k,{content:"Upload a forensic disk image for offline analysis",children:e.jsx(P,{size:"sm",onClick:()=>h(!0),leftIcon:e.jsx(De,{className:"w-4 h-4"}),children:"Upload Image"})})})]})]})})]}),N.length>0&&e.jsxs(T,{children:[e.jsxs("h4",{className:"font-medium text-slate-900 dark:text-slate-100 mb-3",children:["Uploaded Images (",N.length,")"]}),e.jsx("div",{className:"space-y-2",children:N.map((j,$)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsx(Pe,{className:"w-5 h-5 text-slate-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:j}),e.jsx("p",{className:"text-xs text-slate-500",children:"VMDK  42.5 GB  Uploaded just now"})]}),e.jsx(B,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-xs text-green-600 dark:text-green-400",children:"Ready for triage"})]},$))})]})]}),r==="discovery"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(T,{className:"bg-gradient-to-br from-forensic-50 to-white dark:from-forensic-900/20 dark:to-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-forensic-100 dark:bg-forensic-900/30 rounded-lg",children:e.jsx(ct,{className:"w-6 h-6 text-forensic-600 dark:text-forensic-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:"Auto-Discovery"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Discover assets automatically based on domain, IP ranges, and credentials"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Domain / Tenant"}),e.jsx("input",{type:"text",className:"input",placeholder:"e.g., company.com or Azure Tenant ID",value:V,onChange:j=>E(j.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"IP Range / CIDR"}),e.jsx("input",{type:"text",className:"input",placeholder:"e.g., 10.0.0.0/16 or 192.168.1.0/24",value:L,onChange:j=>X(j.target.value)})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"label mb-2 block",children:"Discovery Scope"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-2",children:[{id:"servers",label:"Servers",icon:e.jsx(Y,{className:"w-4 h-4"}),desc:"DCs, File Servers, DBs"},{id:"endpoints",label:"Endpoints",icon:e.jsx(Ie,{className:"w-4 h-4"}),desc:"Workstations, Laptops"},{id:"peripherals",label:"Peripherals",icon:e.jsx(pe,{className:"w-4 h-4"}),desc:"Firewalls, Switches, IDS"},{id:"cloud",label:"Cloud Services",icon:e.jsx(q,{className:"w-4 h-4"}),desc:"AWS, Azure, O365, GCP"},{id:"internet",label:"Internet-Facing",icon:e.jsx(we,{className:"w-4 h-4"}),desc:"Public IPs & Services"}].map(j=>e.jsxs("button",{onClick:()=>ce(j.id),className:u("flex flex-col items-center gap-1.5 p-3 rounded-lg border text-xs font-medium transition-colors",ee===j.id?"border-forensic-500 bg-forensic-50 text-forensic-700 dark:bg-forensic-900/20 dark:text-forensic-300":"border-slate-200 dark:border-slate-700 text-slate-500 hover:border-slate-300"),children:[j.icon,j.label,e.jsx("span",{className:"text-[10px] text-slate-400 font-normal",children:j.desc})]},j.id))})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Username / Access Key"}),e.jsx("input",{type:"text",className:"input",placeholder:"Discovery account credentials"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Password / Secret Key"}),e.jsx("input",{type:"password",className:"input",placeholder:"Authentication secret"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(k,{content:`Run discovery scan for ${ee}`,children:e.jsx(P,{onClick:sa,isLoading:te,leftIcon:e.jsx(Ra,{className:"w-4 h-4"}),className:"w-full",children:te?"Scanning...":"Run Discovery"})})})]})]}),te&&e.jsx(T,{className:"border-forensic-200 dark:border-forensic-800",children:e.jsxs("div",{className:"flex items-center gap-3 p-2",children:[e.jsx(xt,{className:"w-5 h-5 animate-spin text-forensic-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:["Scanning network for ",ee,"..."]}),e.jsxs("div",{className:"flex gap-4 mt-1 text-xs text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Oa,{className:"w-3 h-3"})," Sending probes"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(zt,{className:"w-3 h-3"})," Resolving hostnames"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(jt,{className:"w-3 h-3"})," Fingerprinting services"]})]})]})]})}),G.length>0&&e.jsxs(T,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5 text-forensic-500"}),e.jsxs("h3",{className:"font-semibold text-slate-900 dark:text-slate-100",children:["Discovery Results  ",G.length," assets found"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{size:"sm",variant:"outline",leftIcon:e.jsx($e,{className:"w-3 h-3"}),children:"Export"}),e.jsx(P,{size:"sm",leftIcon:e.jsx(dt,{className:"w-3 h-3"}),children:"Configure All"})]})]}),e.jsx("div",{className:"space-y-2",children:G.map(j=>e.jsxs("div",{className:u("border rounded-lg transition-all",j.risk==="critical"?"border-red-200 dark:border-red-900/50":j.risk==="high"?"border-orange-200 dark:border-orange-900/50":"border-slate-200 dark:border-slate-700"),children:[e.jsxs("button",{onClick:()=>Ze(_===j.id?null:j.id),className:"w-full flex items-center gap-3 p-3 text-left",children:[e.jsx("div",{className:u("w-2 h-2 rounded-full",j.status==="online"?"bg-green-500":j.status==="filtered"?"bg-yellow-500":"bg-slate-300")}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-sm text-slate-900 dark:text-slate-100",children:j.name}),e.jsx("span",{className:"text-xs text-slate-400",children:j.type})]}),e.jsx("span",{className:"text-xs font-mono text-slate-500",children:j.ip})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:u("px-2 py-0.5 rounded text-xs font-medium",j.risk==="critical"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":j.risk==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":j.risk==="medium"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"),children:j.risk}),e.jsx("span",{className:u("px-2 py-0.5 rounded text-xs",j.status==="online"?"bg-green-50 text-green-600 dark:bg-green-900/20 dark:text-green-400":j.status==="filtered"?"bg-yellow-50 text-yellow-600":"bg-slate-100 text-slate-400"),children:j.status}),_===j.id?e.jsx(he,{className:"w-4 h-4 text-slate-400"}):e.jsx(re,{className:"w-4 h-4 text-slate-400"})]})]}),_===j.id&&e.jsx("div",{className:"px-3 pb-3 pt-0",children:e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg space-y-2 text-xs",children:[j.os&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-slate-500 w-20",children:"OS:"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:j.os})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-slate-500 w-20",children:"Open Ports:"}),e.jsx("span",{className:"font-mono text-slate-700 dark:text-slate-300",children:j.ports.length>0?j.ports.join(", "):"N/A (Cloud)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-slate-500 w-20",children:"Services:"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:j.services.join(", ")})]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(P,{size:"sm",variant:"outline",leftIcon:e.jsx(dt,{className:"w-3 h-3"}),children:"Configure Connector"}),e.jsx(P,{size:"sm",variant:"ghost",leftIcon:e.jsx(_t,{className:"w-3 h-3"}),children:"Add Tags"})]})]})})]},j.id))})]}),!te&&G.length===0&&e.jsxs(T,{className:"text-center py-12",children:[e.jsx(ct,{className:"w-12 h-12 mx-auto text-slate-300 mb-3"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Configure domain, IP range, and credentials above, then run discovery"}),e.jsx("p",{className:"text-slate-400 text-xs mt-1",children:"Scans for servers, endpoints, peripherals, cloud services, and internet-facing assets"})]})]}),e.jsx(Dt,{open:l,onOpenChange:c,title:`Configure ${m?ms[m].name:""}`,description:"Enter connection details for this data source",size:"md",footer:e.jsxs(e.Fragment,{children:[e.jsx(P,{variant:"secondary",onClick:()=>c(!1),children:"Cancel"}),e.jsx(k,{content:"Verify connectivity to this system (simulated)",children:e.jsx(P,{variant:"outline",children:"Test Connection"})}),e.jsx(P,{onClick:Zs,children:"Save"})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Hostname / IP"}),e.jsx("input",{type:"text",className:"input",placeholder:"e.g., 10.0.1.10 or server.domain.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label mb-2 block",children:"Authentication Method"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("button",{onClick:()=>g("credentials"),className:u("flex flex-col items-center gap-1.5 p-3 rounded-lg border text-xs font-medium transition-colors",f==="credentials"?"border-forensic-500 bg-forensic-50 text-forensic-700 dark:bg-forensic-900/20 dark:text-forensic-300":"border-slate-200 dark:border-slate-700 text-slate-500 hover:border-slate-300"),children:[e.jsx(ft,{className:"w-4 h-4"}),"Credentials"]}),e.jsxs("button",{onClick:()=>g("certificate"),className:u("flex flex-col items-center gap-1.5 p-3 rounded-lg border text-xs font-medium transition-colors",f==="certificate"?"border-forensic-500 bg-forensic-50 text-forensic-700 dark:bg-forensic-900/20 dark:text-forensic-300":"border-slate-200 dark:border-slate-700 text-slate-500 hover:border-slate-300"),children:[e.jsx(Fa,{className:"w-4 h-4"}),"Certificate"]}),e.jsxs("button",{onClick:()=>g("ssh_key"),className:u("flex flex-col items-center gap-1.5 p-3 rounded-lg border text-xs font-medium transition-colors",f==="ssh_key"?"border-forensic-500 bg-forensic-50 text-forensic-700 dark:bg-forensic-900/20 dark:text-forensic-300":"border-slate-200 dark:border-slate-700 text-slate-500 hover:border-slate-300"),children:[e.jsx(St,{className:"w-4 h-4"}),"SSH Key"]})]})]}),f==="credentials"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Username"}),e.jsx("input",{type:"text",className:"input",placeholder:"Service account username"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Password"}),e.jsx("input",{type:"password",className:"input",placeholder:"Service account password"})]})]}),f==="certificate"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Certificate File (.pem, .pfx, .p12)"}),e.jsxs("div",{className:u("border-2 border-dashed rounded-lg p-4 text-center cursor-pointer","border-slate-300 dark:border-slate-600","hover:border-forensic-400 dark:hover:border-forensic-500","transition-colors duration-200"),children:[e.jsx(De,{className:"w-6 h-6 mx-auto text-slate-400 mb-2"}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Drag & drop or ",e.jsx("span",{className:"text-forensic-500 font-medium",children:"browse"})," certificate file"]}),e.jsx("input",{type:"file",accept:".pem,.pfx,.p12,.cer,.crt",className:"hidden"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Certificate Password (if applicable)"}),e.jsx("input",{type:"password",className:"input",placeholder:"Private key passphrase"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"CA Bundle (optional)"}),e.jsx("input",{type:"text",className:"input",placeholder:"Path to CA bundle or paste CA cert"})]})]}),f==="ssh_key"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Username"}),e.jsx("input",{type:"text",className:"input",placeholder:"SSH username (e.g., root, forensic-svc)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"SSH Private Key"}),e.jsxs("div",{className:u("border-2 border-dashed rounded-lg p-4 text-center cursor-pointer","border-slate-300 dark:border-slate-600","hover:border-forensic-400 dark:hover:border-forensic-500","transition-colors duration-200"),children:[e.jsx(De,{className:"w-6 h-6 mx-auto text-slate-400 mb-2"}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Upload ",e.jsx("span",{className:"text-forensic-500 font-medium",children:"id_rsa"}),", ",e.jsx("span",{className:"text-forensic-500 font-medium",children:"id_ed25519"}),", or other key file"]}),e.jsx("input",{type:"file",accept:".pem,.key,.pub",className:"hidden"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Key Passphrase (if applicable)"}),e.jsx("input",{type:"password",className:"input",placeholder:"SSH key passphrase"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"SSH Port"}),e.jsx("input",{type:"number",className:"input",placeholder:"22",defaultValue:22})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"mockMode",className:"rounded",defaultChecked:!0}),e.jsx("label",{htmlFor:"mockMode",className:"text-sm text-slate-600 dark:text-slate-400",children:"Use simulated data for demo"})]})]})}),e.jsx(Dt,{open:S,onOpenChange:y,title:"Craft Portable Collector",description:"Build a lightweight forensic collector for offline triage",size:"md",footer:e.jsxs(e.Fragment,{children:[e.jsx(P,{variant:"secondary",onClick:()=>y(!1),children:"Cancel"}),e.jsx(k,{content:"Generate a portable collector package",children:e.jsx(P,{onClick:()=>{x(!0),setTimeout(()=>{x(!1),W(!0)},2e3)},isLoading:I,leftIcon:e.jsx(es,{className:"w-4 h-4"}),children:"Build Collector"})})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label mb-2 block",children:"Target Platform"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>w("windows"),className:u("flex items-center gap-3 p-4 rounded-lg border transition-colors",b==="windows"?"border-forensic-500 bg-forensic-50 dark:bg-forensic-900/20":"border-slate-200 dark:border-slate-700 hover:border-slate-300"),children:[e.jsx(Ie,{className:"w-6 h-6"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-sm font-medium",children:"Windows"}),e.jsx("p",{className:"text-xs text-slate-500",children:".exe portable"})]})]}),e.jsxs("button",{onClick:()=>w("linux"),className:u("flex items-center gap-3 p-4 rounded-lg border transition-colors",b==="linux"?"border-forensic-500 bg-forensic-50 dark:bg-forensic-900/20":"border-slate-200 dark:border-slate-700 hover:border-slate-300"),children:[e.jsx(St,{className:"w-6 h-6"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-sm font-medium",children:"Linux"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Shell script / binary"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label mb-2 block",children:"Collection Scope"}),e.jsx("div",{className:"space-y-2",children:[{id:"evtlogs",label:"Event Logs / Syslog",checked:!0},{id:"registry",label:b==="windows"?"Registry Hives":"Config Files (/etc)",checked:!0},{id:"filesystem",label:"File System Metadata (MFT / Inodes)",checked:!0},{id:"memory",label:"Memory Dump (RAM)",checked:!1},{id:"network",label:"Network Connections & ARP Table",checked:!0},{id:"processes",label:"Running Processes & Services",checked:!0},{id:"persistence",label:"Persistence Mechanisms (Startup, Cron, Tasks)",checked:!0},{id:"browser",label:"Browser Artifacts",checked:!1}].map(j=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",defaultChecked:j.checked,className:"rounded"}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:j.label})]},j.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Output Format"}),e.jsxs("select",{className:"input",defaultValue:"zip",children:[e.jsx("option",{value:"zip",children:"ZIP Archive (compressed)"}),e.jsx("option",{value:"tar",children:"TAR.GZ Archive"}),e.jsx("option",{value:"raw",children:"Raw directory structure"})]})]}),C&&e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(B,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Collector Ready"})]}),e.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 mb-2",children:[b==="windows"?"forensic-collector-win-x64.exe":"forensic-collector-linux-x64.sh"," (2.4 MB)"]}),e.jsx(P,{size:"sm",variant:"outline",leftIcon:e.jsx($e,{className:"w-3 h-3"}),children:"Download Collector"})]})]})}),e.jsx(Dt,{open:D,onOpenChange:h,title:"Upload Disk Image",description:"Upload a forensic disk image for offline triage analysis",size:"md",footer:e.jsxs(e.Fragment,{children:[e.jsx(P,{variant:"secondary",onClick:()=>h(!1),children:"Cancel"}),e.jsx(P,{onClick:()=>{d([...N,"server-backup-2024.vmdk"]),h(!1)},leftIcon:e.jsx(De,{className:"w-4 h-4"}),children:"Upload & Analyze"})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label mb-2 block",children:"Supported Formats"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{format:"VMDK",desc:"VMware disk"},{format:"VHD",desc:"Hyper-V (Gen1)"},{format:"VHDX",desc:"Hyper-V (Gen2)"},{format:"E01",desc:"EnCase image"},{format:"RAW/DD",desc:"Raw disk image"},{format:"QCOW2",desc:"QEMU disk"},{format:"OVA",desc:"Open Virtual"},{format:"ISO",desc:"Disk image"}].map(j=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-slate-50 dark:bg-slate-800/50 rounded text-xs",children:[e.jsx(Pe,{className:"w-3 h-3 text-slate-400"}),e.jsx("span",{className:"font-medium",children:j.format}),e.jsxs("span",{className:"text-slate-400",children:["- ",j.desc]})]},j.format))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Disk Image File"}),e.jsxs("div",{className:u("border-2 border-dashed rounded-lg p-8 text-center cursor-pointer","border-slate-300 dark:border-slate-600","hover:border-forensic-400 dark:hover:border-forensic-500","transition-colors duration-200"),children:[e.jsx(La,{className:"w-10 h-10 mx-auto text-slate-400 mb-3"}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Drag & Drop or ",e.jsx("span",{className:"text-forensic-500 font-medium",children:"browse"})]}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"VMDK, VHD, VHDX, E01, RAW, QCOW2, OVA, ISO"}),e.jsx("input",{type:"file",accept:".vmdk,.vhd,.vhdx,.e01,.dd,.raw,.qcow2,.ova,.iso",className:"hidden"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Image Description"}),e.jsx("input",{type:"text",className:"input",placeholder:"e.g., Finance Server backup from Jan 15"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Source System Hostname (optional)"}),e.jsx("input",{type:"text",className:"input",placeholder:"e.g., FS-FINANCE-01"})]}),N.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"label",children:"Uploaded Images"}),N.map((j,$)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 dark:bg-green-900/20 rounded text-sm",children:[e.jsx(B,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-green-700 dark:text-green-300",children:j})]},$))]})]})})]})}function ul({name:t,description:s,icon:a,isConfigured:r,onConfigure:n,tags:i,isEditingTags:o,onToggleEditTags:l,tagInput:c,onTagInputChange:m,onAddTag:p,onRemoveTag:f}){return e.jsxs(T,{className:u(r&&"ring-2 ring-green-500 ring-offset-2 dark:ring-offset-slate-900"),children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:u("text-slate-400",r&&"text-green-500"),children:a}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100",children:t}),r&&e.jsx(B,{className:"w-4 h-4 text-green-500"})]}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:s}),i.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:i.map(g=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-forensic-50 dark:bg-forensic-900/20 text-forensic-600 dark:text-forensic-400 text-xs rounded-full border border-forensic-200 dark:border-forensic-800",children:[e.jsx(_t,{className:"w-2.5 h-2.5"}),g,e.jsx("button",{onClick:S=>{S.stopPropagation(),f(g)},className:"hover:text-red-500 transition-colors ml-0.5",children:e.jsx(Qe,{className:"w-2.5 h-2.5"})})]},g))}),o&&e.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[e.jsx("input",{type:"text",value:c,onChange:g=>m(g.target.value),onKeyDown:g=>{g.key==="Enter"&&(g.preventDefault(),p())},placeholder:"Add tag...",className:"flex-1 text-xs px-2 py-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 focus:outline-none focus:border-forensic-400"}),e.jsx(P,{size:"sm",variant:"ghost",onClick:p,children:e.jsx(B,{className:"w-3 h-3"})})]})]})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[e.jsx(k,{content:"Open configuration form for this data source",children:e.jsx(P,{size:"sm",variant:r?"secondary":"primary",onClick:n,leftIcon:e.jsx(dt,{className:"w-4 h-4"}),children:r?"Reconfigure":"Configure"})}),e.jsx(k,{content:"Add tags to categorize this resource",children:e.jsx(P,{size:"sm",variant:"ghost",onClick:l,leftIcon:e.jsx(_t,{className:"w-3.5 h-3.5"}),children:"Tags"})}),e.jsx(k,{content:"Use simulated data instead of real connection",children:e.jsxs("label",{className:"flex items-center gap-1 text-xs text-slate-500 cursor-pointer ml-auto",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded w-3 h-3"}),"Mock"]})})]})]})}const at=[{id:"sys-1",hostname:"DC-MAIN-01",ip:"10.0.1.10",role:"Primary Domain Controller",os:"Windows Server 2022",criticality:"critical",status:"verified",services:["DNS","Kerberos","LDAP","GPO"],lastSeen:"2 min ago",cpu:12,memory:68,disk:45},{id:"sys-2",hostname:"DC-BACKUP-01",ip:"10.0.1.11",role:"Backup Domain Controller",os:"Windows Server 2022",criticality:"critical",status:"verified",services:["DNS","Kerberos","LDAP"],lastSeen:"2 min ago",cpu:8,memory:52,disk:38},{id:"sys-3",hostname:"FS-FINANCE-01",ip:"10.0.2.20",role:"Finance File Server",os:"Windows Server 2019",criticality:"high",status:"verified",services:["SMB","DFS"],lastSeen:"2 min ago",cpu:25,memory:71,disk:82},{id:"sys-4",hostname:"SQL-DB-01",ip:"10.0.3.30",role:"Primary Database Server",os:"Windows Server 2019",criticality:"high",status:"verified",services:["MSSQL","SQL Agent"],lastSeen:"2 min ago",cpu:45,memory:85,disk:67},{id:"sys-5",hostname:"WEB-APP-01",ip:"10.0.4.40",role:"Web Application Server",os:"Ubuntu 22.04 LTS",criticality:"medium",status:"verified",services:["Apache","Node.js","Redis"],lastSeen:"2 min ago",cpu:18,memory:45,disk:34},{id:"sys-6",hostname:"EXCH-01",ip:"10.0.1.15",role:"Exchange Server",os:"Windows Server 2019",criticality:"high",status:"failed",services:["SMTP","IMAP","OWA"],lastSeen:"15 min ago",cpu:0,memory:0,disk:72},{id:"sys-7",hostname:"BKP-SERVER-01",ip:"10.0.5.50",role:"Backup Server",os:"Windows Server 2022",criticality:"high",status:"verified",services:["Veeam B&R","SMB"],lastSeen:"2 min ago",cpu:5,memory:32,disk:89},{id:"sys-8",hostname:"PRINT-SRV-01",ip:"10.0.1.25",role:"Print Server",os:"Windows Server 2016",criticality:"low",status:"verified",services:["Spooler"],lastSeen:"5 min ago",cpu:2,memory:18,disk:12}],rt=[{id:"net-1",name:"Corporate LAN",cidr:"10.0.0.0/16",vlan:"10",description:"Main corporate network segment",devices:342,gateway:"10.0.0.1",dhcp:!0},{id:"net-2",name:"Server VLAN",cidr:"10.0.1.0/24",vlan:"20",description:"Server and infrastructure VLAN",devices:28,gateway:"10.0.1.1",dhcp:!1},{id:"net-3",name:"Finance VLAN",cidr:"10.0.2.0/24",vlan:"30",description:"Isolated finance department network",devices:45,gateway:"10.0.2.1",dhcp:!0},{id:"net-4",name:"DMZ",cidr:"10.0.4.0/24",vlan:"40",description:"De-militarized zone for public-facing services",devices:8,gateway:"10.0.4.1",dhcp:!1},{id:"net-5",name:"Guest WiFi",cidr:"192.168.100.0/24",vlan:"99",description:"Isolated guest wireless network",devices:12,gateway:"192.168.100.1",dhcp:!0}],nt=[{id:"cld-1",name:"AWS Production",type:"AWS",region:"us-east-1",services:["EC2 (12)","S3 (8 buckets)","RDS (3)","Lambda (15)","CloudTrail"],status:"active",risk:"high"},{id:"cld-2",name:"Azure AD Tenant",type:"Azure",region:"Global",services:["Azure AD (1,250 users)","Conditional Access","MFA","PIM"],status:"active",risk:"critical"},{id:"cld-3",name:"Office 365",type:"O365",region:"Global",services:["Exchange Online","SharePoint","Teams","OneDrive"],status:"active",risk:"high"},{id:"cld-4",name:"GCP Analytics",type:"GCP",region:"us-central1",services:["BigQuery","Cloud Functions (4)","Storage (2 buckets)"],status:"active",risk:"medium"}],Et=[{id:"ds-1",name:"Finance Share",path:"\\\\FS-FINANCE-01\\Finance",type:"SMB File Share",size:"2.3 TB",classification:"Confidential",encryption:"No",backup:"Daily"},{id:"ds-2",name:"SQL-DB-01\\Production",path:"MSSQL Instance",type:"SQL Database",size:"450 GB",classification:"Highly Confidential",encryption:"TDE Enabled",backup:"Hourly"},{id:"ds-3",name:"SharePoint Docs",path:"SharePoint Online",type:"Cloud Storage",size:"850 GB",classification:"Internal",encryption:"At Rest",backup:"Continuous"},{id:"ds-4",name:"Backup Repository",path:"\\\\BKP-SERVER-01\\Backups",type:"Backup Storage",size:"8.5 TB",classification:"Critical",encryption:"AES-256",backup:"Immutable"},{id:"ds-5",name:"AWS S3 - Reports",path:"s3://company-reports",type:"Object Storage",size:"120 GB",classification:"Internal",encryption:"SSE-S3",backup:"Versioned"}],it=[{name:"John Smith",role:"IT Director",dept:"IT",access:"Domain Admin",risk:"high",lastLogon:"2024-01-15 02:15",mfa:!0},{name:"Sarah Johnson",role:"CISO",dept:"Security",access:"Security Admin",risk:"high",lastLogon:"2024-01-14 18:30",mfa:!0},{name:"Mike Chen",role:"Sr. Network Engineer",dept:"IT",access:"Network Admin",risk:"medium",lastLogon:"2024-01-15 01:45",mfa:!0},{name:"Lisa Williams",role:"Finance Manager",dept:"Finance",access:"Finance Share (RW)",risk:"medium",lastLogon:"2024-01-14 17:00",mfa:!0},{name:"svc-backup",role:"Service Account",dept:"System",access:"Backup Operator",risk:"high",lastLogon:"2024-01-15 02:30",mfa:!1},{name:"svc-sql",role:"Service Account",dept:"System",access:"SQL Server Agent",risk:"high",lastLogon:"2024-01-15 02:00",mfa:!1},{name:"admin.jsmith",role:"Privileged Account",dept:"IT",access:"Domain Admin",risk:"critical",lastLogon:"2024-01-15 02:28",mfa:!0},{name:"helpdesk-svc",role:"Service Account",dept:"IT",access:"Password Reset",risk:"medium",lastLogon:"2024-01-14 16:00",mfa:!1}],Rt=[{id:"sc-1",name:"Endpoint Protection",vendor:"CrowdStrike Falcon",coverage:"92%",status:"active",lastUpdate:"2024-01-14",health:"good"},{id:"sc-2",name:"Firewall (Edge)",vendor:"Palo Alto PA-5220",coverage:"100%",status:"active",lastUpdate:"2024-01-13",health:"good"},{id:"sc-3",name:"SIEM",vendor:"Splunk Enterprise",coverage:"85%",status:"active",lastUpdate:"2024-01-15",health:"warning"},{id:"sc-4",name:"Email Security",vendor:"Proofpoint",coverage:"100%",status:"active",lastUpdate:"2024-01-14",health:"good"},{id:"sc-5",name:"WAF",vendor:"AWS WAF + CloudFront",coverage:"100%",status:"active",lastUpdate:"2024-01-12",health:"good"},{id:"sc-6",name:"Backup Solution",vendor:"Veeam B&R v12",coverage:"95%",status:"active",lastUpdate:"2024-01-15",health:"critical"},{id:"sc-7",name:"PAM",vendor:"CyberArk",coverage:"78%",status:"degraded",lastUpdate:"2024-01-10",health:"warning"}],Ot=[{id:"comp-1",framework:"PCI-DSS",requirement:"Requirement 10 - Logging",description:"Track all access to network resources and cardholder data",applicableSystems:["DC-MAIN-01","SQL-DB-01","FS-FINANCE-01"],status:"partial"},{id:"comp-2",framework:"SOX",requirement:"Section 404 - IT Controls",description:"Internal controls over financial reporting systems",applicableSystems:["SQL-DB-01","FS-FINANCE-01","EXCH-01"],status:"compliant"},{id:"comp-3",framework:"GDPR",requirement:"Article 32 - Security",description:"Appropriate technical measures for data protection",applicableSystems:["All Systems"],status:"partial"},{id:"comp-4",framework:"NIST 800-53",requirement:"IR-4 Incident Handling",description:"Implement incident handling capability",applicableSystems:["SIEM","All Servers"],status:"compliant"}];function hl(){const t=ne(),{goToNextStep:s,goToPreviousStep:a}=Z(),{extractedEntities:r}=_s(),{systems:n,autoValidateEnabled:i,discrepancies:o,isValidating:l,initializeFromSystems:c,setAutoValidate:m,validateSystem:p,validateAllSystems:f}=jn(),[g,S]=v.useState(!1),[y,b]=v.useState(null);v.useEffect(()=>{r.systems.length>0&&n.length===0&&c(r.systems)},[r.systems,n.length,c]);const w=()=>{if(g){S(!1);return}a(),t("/connectors")},D=()=>{if(!g){S(!0);return}s(),t("/triage")},h=n.filter(x=>x.overallStatus==="verified").length,N=n.filter(x=>x.overallStatus==="failed").length,d=n.filter(x=>x.overallStatus==="pending").length,C=n.filter(x=>x.overallStatus==="unknown").length,W=Math.max(r.systems.length,at.length),I=Math.max(r.networks.length,rt.length);return e.jsxs(ge,{title:"Infrastructure Validation",subtitle:"Verify documented systems exist and match reality",actions:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{content:"Automatically validate all documented systems when page loads",children:e.jsxs("button",{onClick:()=>m(!i),className:u("flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors",i?"bg-forensic-100 text-forensic-700 dark:bg-forensic-900/30 dark:text-forensic-300":"bg-slate-100 text-slate-600 dark:bg-slate-800 dark:text-slate-400"),children:[i?e.jsx(Va,{className:"w-5 h-5"}):e.jsx(Ha,{className:"w-5 h-5"}),"Auto-Validate"]})}),e.jsx(k,{content:"Run validation checks on all documented systems",children:e.jsx(P,{variant:"primary",size:"sm",onClick:f,isLoading:l,leftIcon:e.jsx(ks,{className:"w-4 h-4"}),children:"Validate All"})}),e.jsx(k,{content:"Export validation results as CSV",children:e.jsx(P,{variant:"secondary",size:"sm",leftIcon:e.jsx($e,{className:"w-4 h-4"}),children:"Export"})})]}),footer:e.jsx(ke,{onBack:w,backLabel:g?"Back to Validation":"Connectors",onContinue:D,continueLabel:g?"Proceed to Triage":"View Summary"}),children:[g&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(T,{className:"bg-gradient-to-br from-forensic-50 to-white dark:from-forensic-900/20 dark:to-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-forensic-100 dark:bg-forensic-900/30 rounded-lg",children:e.jsx(_a,{className:"w-6 h-6 text-forensic-600 dark:text-forensic-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:"Infrastructure Summary"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Complete overview of discovered resources before triage begins"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-8 gap-3",children:[e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(Y,{className:"w-5 h-5 mx-auto text-blue-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:W}),e.jsx("p",{className:"text-xs text-slate-500",children:"Systems"})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(Ne,{className:"w-5 h-5 mx-auto text-green-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:I}),e.jsx("p",{className:"text-xs text-slate-500",children:"Networks"})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(q,{className:"w-5 h-5 mx-auto text-cyan-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:nt.length}),e.jsx("p",{className:"text-xs text-slate-500",children:"Cloud"})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(Wt,{className:"w-5 h-5 mx-auto text-purple-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"1,250"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Users"})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(ut,{className:"w-5 h-5 mx-auto text-orange-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:Et.length}),e.jsx("p",{className:"text-xs text-slate-500",children:"Data Stores"})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(pe,{className:"w-5 h-5 mx-auto text-indigo-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:Rt.length}),e.jsx("p",{className:"text-xs text-slate-500",children:"Security"})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(Ba,{className:"w-5 h-5 mx-auto text-amber-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:it.length}),e.jsx("p",{className:"text-xs text-slate-500",children:"Accounts"})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(Ge,{className:"w-5 h-5 mx-auto text-red-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:Ot.length}),e.jsx("p",{className:"text-xs text-slate-500",children:"Compliance"})]})]})]}),e.jsx(je,{title:"Systems & Servers",icon:e.jsx(Y,{className:"w-5 h-5 text-blue-500"}),count:at.length,isExpanded:y==="systems",onToggle:()=>b(y==="systems"?null:"systems"),children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-slate-500 uppercase",children:[e.jsx("th",{className:"pb-2",children:"Hostname"}),e.jsx("th",{className:"pb-2",children:"IP"}),e.jsx("th",{className:"pb-2",children:"Role"}),e.jsx("th",{className:"pb-2",children:"OS"}),e.jsx("th",{className:"pb-2",children:"Services"}),e.jsx("th",{className:"pb-2",children:"Criticality"}),e.jsx("th",{className:"pb-2",children:"CPU"}),e.jsx("th",{className:"pb-2",children:"Memory"}),e.jsx("th",{className:"pb-2",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:at.map(x=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30",children:[e.jsx("td",{className:"py-2 font-medium",children:x.hostname}),e.jsx("td",{className:"py-2 font-mono text-xs text-slate-500",children:x.ip}),e.jsx("td",{className:"py-2 text-slate-600 dark:text-slate-400 text-xs",children:x.role}),e.jsx("td",{className:"py-2 text-slate-500 text-xs",children:x.os}),e.jsx("td",{className:"py-2",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[x.services.slice(0,3).map(O=>e.jsx("span",{className:"px-1.5 py-0.5 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 text-[10px] rounded",children:O},O)),x.services.length>3&&e.jsxs("span",{className:"text-[10px] text-slate-400",children:["+",x.services.length-3]})]})}),e.jsx("td",{className:"py-2",children:e.jsx("span",{className:u("px-2 py-0.5 rounded-full text-xs font-medium",x.criticality==="critical"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":x.criticality==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":x.criticality==="medium"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-slate-100 text-slate-700 dark:bg-slate-700 dark:text-slate-300"),children:x.criticality})}),e.jsx("td",{className:"py-2",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-12 h-1.5 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:u("h-full rounded-full",x.cpu>80?"bg-red-500":x.cpu>50?"bg-yellow-500":"bg-green-500"),style:{width:`${x.cpu}%`}})}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:[x.cpu,"%"]})]})}),e.jsx("td",{className:"py-2",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-12 h-1.5 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:u("h-full rounded-full",x.memory>80?"bg-red-500":x.memory>60?"bg-yellow-500":"bg-green-500"),style:{width:`${x.memory}%`}})}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:[x.memory,"%"]})]})}),e.jsx("td",{className:"py-2",children:e.jsxs("span",{className:u("flex items-center gap-1 text-xs",x.status==="verified"?"text-green-600":"text-red-600"),children:[x.status==="verified"?e.jsx(B,{className:"w-3 h-3"}):e.jsx(He,{className:"w-3 h-3"}),x.status]})})]},x.id))})]})})}),e.jsx(je,{title:"Network Segments",icon:e.jsx(Ne,{className:"w-5 h-5 text-green-500"}),count:rt.length,isExpanded:y==="networks",onToggle:()=>b(y==="networks"?null:"networks"),children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-slate-500 uppercase",children:[e.jsx("th",{className:"pb-2",children:"Name"}),e.jsx("th",{className:"pb-2",children:"CIDR"}),e.jsx("th",{className:"pb-2",children:"VLAN"}),e.jsx("th",{className:"pb-2",children:"Gateway"}),e.jsx("th",{className:"pb-2",children:"Devices"}),e.jsx("th",{className:"pb-2",children:"DHCP"}),e.jsx("th",{className:"pb-2",children:"Description"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:rt.map(x=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30",children:[e.jsx("td",{className:"py-2 font-medium",children:x.name}),e.jsx("td",{className:"py-2 font-mono text-xs text-slate-500",children:x.cidr}),e.jsx("td",{className:"py-2",children:e.jsxs("span",{className:"px-1.5 py-0.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 text-xs rounded",children:["VLAN ",x.vlan]})}),e.jsx("td",{className:"py-2 font-mono text-xs text-slate-500",children:x.gateway}),e.jsx("td",{className:"py-2 text-sm font-semibold",children:x.devices}),e.jsx("td",{className:"py-2",children:x.dhcp?e.jsx(B,{className:"w-3 h-3 text-green-500"}):e.jsx(He,{className:"w-3 h-3 text-slate-300"})}),e.jsx("td",{className:"py-2 text-xs text-slate-400",children:x.description})]},x.id))})]})})}),e.jsx(je,{title:"Cloud Services & Tenants",icon:e.jsx(q,{className:"w-5 h-5 text-cyan-500"}),count:nt.length,isExpanded:y==="cloud",onToggle:()=>b(y==="cloud"?null:"cloud"),children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:nt.map(x=>e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-cyan-500"}),e.jsx("span",{className:"font-medium text-sm",children:x.name})]}),e.jsx("span",{className:u("px-2 py-0.5 rounded text-xs font-medium",x.risk==="critical"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":x.risk==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"),children:x.risk})]}),e.jsxs("p",{className:"text-xs text-slate-500 mb-2",children:["Region: ",x.region]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:x.services.map(O=>e.jsx("span",{className:"px-1.5 py-0.5 bg-cyan-50 dark:bg-cyan-900/20 text-cyan-600 dark:text-cyan-400 text-[10px] rounded",children:O},O))})]},x.id))})}),e.jsx(je,{title:"Data Stores & Repositories",icon:e.jsx(ut,{className:"w-5 h-5 text-orange-500"}),count:Et.length,isExpanded:y==="datastores",onToggle:()=>b(y==="datastores"?null:"datastores"),children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-slate-500 uppercase",children:[e.jsx("th",{className:"pb-2",children:"Name"}),e.jsx("th",{className:"pb-2",children:"Type"}),e.jsx("th",{className:"pb-2",children:"Size"}),e.jsx("th",{className:"pb-2",children:"Classification"}),e.jsx("th",{className:"pb-2",children:"Encryption"}),e.jsx("th",{className:"pb-2",children:"Backup"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:Et.map(x=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30",children:[e.jsx("td",{className:"py-2 font-medium text-xs",children:x.name}),e.jsx("td",{className:"py-2 text-xs text-slate-500",children:x.type}),e.jsx("td",{className:"py-2 text-xs font-semibold",children:x.size}),e.jsx("td",{className:"py-2",children:e.jsx("span",{className:u("px-2 py-0.5 rounded text-[10px] font-medium",x.classification==="Highly Confidential"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":x.classification==="Confidential"||x.classification==="Critical"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"),children:x.classification})}),e.jsx("td",{className:"py-2 text-xs",children:x.encryption==="No"?e.jsx("span",{className:"text-red-500 font-medium",children:"None"}):e.jsx("span",{className:"text-green-600",children:x.encryption})}),e.jsx("td",{className:"py-2 text-xs text-slate-500",children:x.backup})]},x.id))})]})})}),e.jsx(je,{title:"Key Personnel & Privileged Accounts",icon:e.jsx(Wt,{className:"w-5 h-5 text-purple-500"}),count:it.length,isExpanded:y==="employees",onToggle:()=>b(y==="employees"?null:"employees"),children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-slate-500 uppercase",children:[e.jsx("th",{className:"pb-2",children:"Account"}),e.jsx("th",{className:"pb-2",children:"Role"}),e.jsx("th",{className:"pb-2",children:"Dept"}),e.jsx("th",{className:"pb-2",children:"Access Level"}),e.jsx("th",{className:"pb-2",children:"Last Logon"}),e.jsx("th",{className:"pb-2",children:"MFA"}),e.jsx("th",{className:"pb-2",children:"Risk"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:it.map((x,O)=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30",children:[e.jsx("td",{className:"py-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:u("w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-medium",x.role.includes("Service")||x.role.includes("Privileged")?"bg-orange-100 text-orange-600 dark:bg-orange-900/30":"bg-blue-100 text-blue-600 dark:bg-blue-900/30"),children:x.name.slice(0,2).toUpperCase()}),e.jsx("span",{className:"font-medium text-xs",children:x.name})]})}),e.jsx("td",{className:"py-2 text-xs text-slate-500",children:x.role}),e.jsx("td",{className:"py-2 text-xs text-slate-500",children:x.dept}),e.jsx("td",{className:"py-2 text-xs",children:x.access}),e.jsx("td",{className:"py-2 text-xs font-mono text-slate-400",children:x.lastLogon}),e.jsx("td",{className:"py-2",children:x.mfa?e.jsx(B,{className:"w-3 h-3 text-green-500"}):e.jsx(qe,{className:"w-3 h-3 text-yellow-500"})}),e.jsx("td",{className:"py-2",children:e.jsx("span",{className:u("px-1.5 py-0.5 rounded text-xs font-medium",x.risk==="critical"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":x.risk==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"),children:x.risk})})]},O))})]})})}),e.jsx(je,{title:"Security Controls & Tools",icon:e.jsx(pe,{className:"w-5 h-5 text-indigo-500"}),count:Rt.length,isExpanded:y==="security",onToggle:()=>b(y==="security"?null:"security"),children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-slate-500 uppercase",children:[e.jsx("th",{className:"pb-2",children:"Control"}),e.jsx("th",{className:"pb-2",children:"Vendor / Product"}),e.jsx("th",{className:"pb-2",children:"Coverage"}),e.jsx("th",{className:"pb-2",children:"Status"}),e.jsx("th",{className:"pb-2",children:"Last Update"}),e.jsx("th",{className:"pb-2",children:"Health"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:Rt.map(x=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30",children:[e.jsx("td",{className:"py-2 font-medium text-xs",children:x.name}),e.jsx("td",{className:"py-2 text-xs text-slate-500",children:x.vendor}),e.jsx("td",{className:"py-2",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-16 h-1.5 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:u("h-full rounded-full",parseInt(x.coverage)>90?"bg-green-500":parseInt(x.coverage)>80?"bg-yellow-500":"bg-orange-500"),style:{width:x.coverage}})}),e.jsx("span",{className:"text-[10px] text-slate-400",children:x.coverage})]})}),e.jsx("td",{className:"py-2",children:e.jsx("span",{className:u("px-1.5 py-0.5 rounded text-[10px] font-medium",x.status==="active"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"),children:x.status})}),e.jsx("td",{className:"py-2 text-xs font-mono text-slate-400",children:x.lastUpdate}),e.jsx("td",{className:"py-2",children:e.jsxs("span",{className:u("flex items-center gap-1 text-xs",x.health==="good"?"text-green-600":x.health==="warning"?"text-yellow-600":"text-red-600"),children:[e.jsx("span",{className:u("w-2 h-2 rounded-full",x.health==="good"?"bg-green-500":x.health==="warning"?"bg-yellow-500":"bg-red-500")}),x.health]})})]},x.id))})]})})}),e.jsx(je,{title:"Compliance & Regulatory",icon:e.jsx(Ge,{className:"w-5 h-5 text-red-500"}),count:Ot.length,isExpanded:y==="compliance",onToggle:()=>b(y==="compliance"?null:"compliance"),children:Ot.map(x=>e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"px-2 py-0.5 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 text-xs font-medium rounded",children:x.framework}),e.jsx("span",{className:"font-medium text-sm",children:x.requirement}),e.jsx("span",{className:u("ml-auto px-2 py-0.5 rounded text-xs font-medium",x.status==="compliant"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"),children:x.status})]}),e.jsx("p",{className:"text-xs text-slate-500",children:x.description}),e.jsxs("p",{className:"text-xs text-slate-400 mt-1",children:["Applies to: ",x.applicableSystems.join(", ")]})]},x.id))}),e.jsx(T,{className:"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border-green-200 dark:border-green-800",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(B,{className:"w-8 h-8 text-green-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-green-800 dark:text-green-200",children:"Ready for Triage"}),e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400",children:[at.length," systems, ",rt.length," networks, ",nt.length," cloud services, and ",it.length,' privileged accounts documented. All key resources have been validated. Click "Proceed to Triage" to begin forensic analysis.']})]}),e.jsx(Yt,{className:"w-5 h-5 text-green-500"})]})})]}),!g&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6",children:[e.jsx(lt,{icon:e.jsx(B,{className:"w-5 h-5"}),count:h,label:"Verified",color:"green"}),e.jsx(lt,{icon:e.jsx(He,{className:"w-5 h-5"}),count:N,label:"Failed",color:"red"}),e.jsx(lt,{icon:e.jsx(Ke,{className:"w-5 h-5"}),count:d,label:"Pending",color:"yellow"}),e.jsx(lt,{icon:e.jsx(Xt,{className:"w-5 h-5"}),count:C,label:"Unknown",color:"slate"})]}),o.length>0&&e.jsx(T,{className:"mb-6 border-yellow-300 dark:border-yellow-700 bg-yellow-50 dark:bg-yellow-900/20",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(qe,{className:"w-5 h-5 text-yellow-500 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:["Discrepancy Alerts (",o.length,")"]}),e.jsxs("ul",{className:"mt-2 space-y-1 text-sm text-yellow-700 dark:text-yellow-300",children:[o.slice(0,3).map(x=>e.jsxs("li",{children:[e.jsxs("span",{className:"font-medium",children:[x.hostname,":"]})," ",x.description]},x.id)),o.length>3&&e.jsxs("li",{className:"text-yellow-600 dark:text-yellow-400",children:["+",o.length-3," more discrepancies"]})]})]})]})}),e.jsx(T,{padding:"none",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 dark:bg-slate-800/50 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"System"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"IP"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Methods"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:n.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-4 py-12 text-center",children:[e.jsx(Y,{className:"w-10 h-10 mx-auto text-slate-300 mb-3"}),e.jsx("p",{className:"text-slate-500",children:"No systems to validate"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Upload documents with system information first"})]})}):n.map(x=>e.jsx(pl,{system:x,onValidate:()=>p(x.systemId),isValidating:l},x.systemId))})]})})})]})]})}function je({title:t,icon:s,count:a,isExpanded:r,onToggle:n,children:i}){return e.jsxs(T,{children:[e.jsxs("button",{onClick:n,className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s,e.jsx("span",{className:"font-semibold text-slate-900 dark:text-slate-100",children:t}),e.jsx("span",{className:"text-xs bg-slate-100 dark:bg-slate-700 px-2 py-0.5 rounded-full text-slate-500",children:a})]}),r?e.jsx(he,{className:"w-5 h-5 text-slate-400"}):e.jsx(re,{className:"w-5 h-5 text-slate-400"})]}),r&&e.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200 dark:border-slate-700",children:i})]})}function lt({icon:t,count:s,label:a,color:r}){const n={green:"text-green-500 bg-green-50 dark:bg-green-900/20",red:"text-red-500 bg-red-50 dark:bg-red-900/20",yellow:"text-yellow-500 bg-yellow-50 dark:bg-yellow-900/20",slate:"text-slate-400 bg-slate-50 dark:bg-slate-800/50"};return e.jsx(T,{className:u("text-center",n[r]),children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[t,e.jsx("span",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:s}),e.jsx("span",{className:"text-xs text-slate-500",children:a})]})})}function pl({system:t,onValidate:s,isValidating:a}){const r={verified:e.jsx(B,{className:"w-4 h-4 text-green-500"}),failed:e.jsx(He,{className:"w-4 h-4 text-red-500"}),pending:e.jsx(Ke,{className:"w-4 h-4 text-yellow-500"}),unknown:e.jsx(Xt,{className:"w-4 h-4 text-slate-400"})};return e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"font-medium text-slate-900 dark:text-slate-100",children:t.hostname})}),e.jsx("td",{className:"px-4 py-3 font-mono text-sm text-slate-600 dark:text-slate-400",children:t.documentedIP}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-400",children:t.role}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-1",children:[t.validationMethods.slice(0,3).map(n=>e.jsx(k,{content:tn[n].description,children:e.jsx(Q,{variant:"secondary",size:"sm",children:n.toUpperCase().slice(0,3)})},n)),t.validationMethods.length>3&&e.jsxs(Q,{variant:"secondary",size:"sm",children:["+",t.validationMethods.length-3]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[r[t.overallStatus],e.jsx("span",{className:u("text-sm capitalize",t.overallStatus==="verified"&&"text-green-600",t.overallStatus==="failed"&&"text-red-600",t.overallStatus==="pending"&&"text-yellow-600",t.overallStatus==="unknown"&&"text-slate-500"),children:t.overallStatus})]})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx(k,{content:"Run validation checks on this system",children:e.jsx(P,{variant:"ghost",size:"sm",onClick:s,disabled:a,leftIcon:a&&t.overallStatus==="pending"?e.jsx($r,{size:"sm"}):e.jsx(ks,{className:"w-3 h-3"}),children:"Validate"})})})]})}const ws=[{id:"cti-1",type:"leaked_credentials",source:"BreachDB (OSINT)",severity:"critical",title:"Compromised credentials found in 2024 data breach",description:"12 corporate email addresses with password hashes found in recent breach dump. Includes admin accounts.",date:"2024-01-10",indicators:["admin.jsmith@company.com","svc-backup@company.com","sarah.j@company.com"]},{id:"cti-2",type:"darknet_mention",source:"Darknet Forum Monitoring",severity:"high",title:"Company network access for sale on darknet forum",description:"Initial access broker offering VPN credentials and internal network maps. Listed 3 days before the incident.",date:"2024-01-12",indicators:["vpn.company.com","RDP access - Finance segment","$5,000 asking price"]},{id:"cti-3",type:"pii_exposure",source:"Public Paste Sites",severity:"high",title:"Employee PII leaked on paste site",description:"Partial employee directory with names, email addresses, phone numbers, and department info found on public paste site.",date:"2024-01-08",indicators:["~250 employee records","Names, emails, phone numbers","Department structure"]},{id:"cti-4",type:"breach_database",source:"Have I Been Pwned (OSINT)",severity:"medium",title:"Domain appears in 3 known breach databases",description:"company.com domain found across multiple breach databases with varying dates and data types exposed.",date:"2023-11-15",indicators:["LinkedIn breach (2023)","Third-party SaaS breach (2024)","Marketing platform leak (2023)"]},{id:"cti-5",type:"paste_site",source:"GitHub/Gist OSINT",severity:"medium",title:"Internal API keys found in public GitHub repos",description:"AWS access keys and internal API tokens committed to public repositories by developers.",date:"2024-01-05",indicators:["AWS Access Key: AKIA****","Slack webhook URL","Internal API bearer token"]}];function gl(){var V;const t=ne(),{goToNextStep:s,goToPreviousStep:a}=Z(),[r,n]=v.useState(!1),[i,o]=v.useState(!1),[l,c]=v.useState(0),[m,p]=v.useState(0),[f,g]=v.useState(Se.map(()=>0)),[S,y]=v.useState([]),[b,w]=v.useState({critical:0,high:0,medium:0,low:0,ambiguous:0}),[D,h]=v.useState(""),[N,d]=v.useState(!1),[C,W]=v.useState([]),[I,x]=v.useState("all"),[O,ie]=v.useState(!1),U=v.useRef(null),M=v.useRef(null);v.useEffect(()=>{U.current&&(U.current.scrollTop=U.current.scrollHeight)},[S]),v.useEffect(()=>{if(!r||i){M.current&&clearInterval(M.current);return}return M.current=setInterval(()=>{if(c(E=>{const L=E+1;return L>=100?(n(!1),100):L}),g(E=>{const L=[...E],X=100/Se.length;for(let _=0;_<Se.length;_++){const Ze=_*X,wt=(_+1)*X,Ee=l+1;Ee>=wt?L[_]=100:Ee>Ze&&(L[_]=(Ee-Ze)/X*100,p(_))}return L}),Math.random()>.5){const E=[{message:"Collecting Windows Security Event Logs...",severity:"info"},{message:"Analyzing authentication patterns...",severity:"info"},{message:"Found suspicious process execution",severity:"warning"},{message:"Extracting registry artifacts...",severity:"info"},{message:"Correlating network connections...",severity:"info"},{message:"Detected potential lateral movement",severity:"warning"},{message:"Identified scheduled task persistence",severity:"warning"},{message:"Phase completed successfully",severity:"success"}],L=E[Math.floor(Math.random()*E.length)];y(X=>{var _;return[...X.slice(-49),{id:`${Date.now()}-${Math.random()}`,timestamp:new Date,phase:((_=Se[m])==null?void 0:_.name)||"Analysis",...L}]}),Math.random()>.85&&w(X=>{const _=["critical","high","medium","low","ambiguous"][Math.floor(Math.random()*5)];return{...X,[_]:X[_]+1}})}},200),()=>{M.current&&clearInterval(M.current)}},[r,i,l,m]);const le=()=>{a(),t("/validation")},oe=()=>{s(),t("/timeline")},ee=()=>{n(!0),o(!1)},ce=()=>{o(!i)},te=E=>{const L=[e.jsx(ut,{className:"w-5 h-5"},"db"),e.jsx(Ss,{className:"w-5 h-5"},"search"),e.jsx(Te,{className:"w-5 h-5"},"activity"),e.jsx(Ga,{className:"w-5 h-5"},"git"),e.jsx(ct,{className:"w-5 h-5"},"radar")];return L[E]||L[0]},de=E=>f[E]>=100?"complete":f[E]>0?"running":"pending",G=v.useCallback(()=>{d(!0),W([]),setTimeout(()=>{const E=I==="all"?ws:ws.filter(L=>I==="credentials"?L.type==="leaked_credentials"||L.type==="breach_database":I==="pii"?L.type==="pii_exposure"||L.type==="paste_site":I==="darknet"?L.type==="darknet_mention":!0);W(E),d(!1)},2500)},[I]),fe=b.critical+b.high+b.medium+b.low;return e.jsxs(ge,{title:"Triage Process",subtitle:"Automated forensic analysis in progress",footer:e.jsx(ke,{onBack:le,backLabel:"Validation",onContinue:oe,continueLabel:"View Timeline",continueDisabled:l<100}),children:[e.jsxs(T,{className:"mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-6",children:[e.jsx(Ur,{value:l,size:140,variant:l>=100?"success":"default"}),e.jsxs("div",{className:"flex-1 text-center sm:text-left",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:l>=100?"Analysis Complete":i?"Paused":r?((V=Se[m])==null?void 0:V.name)||"Analyzing...":"Ready to Start"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:l>=100?`Found ${fe} findings (${b.ambiguous} require verification)`:r?"Processing forensic data...":"Click Start to begin the automated triage process"}),e.jsxs("div",{className:"mt-4 flex gap-2 justify-center sm:justify-start flex-wrap",children:[!r&&l<100&&e.jsx(k,{content:"Begin automated forensic triage",children:e.jsx(P,{onClick:ee,leftIcon:e.jsx(ts,{className:"w-4 h-4"}),children:"Start Triage"})}),r&&e.jsx(k,{content:i?"Resume the triage process":"Pause the triage process",children:e.jsx(P,{variant:"secondary",onClick:ce,leftIcon:i?e.jsx(ts,{className:"w-4 h-4"}):e.jsx(Ua,{className:"w-4 h-4"}),children:i?"Resume":"Pause"})}),e.jsx(k,{content:"Open Cyber Threat Intelligence (CTI) OSINT search",children:e.jsx(P,{variant:O?"primary":"outline",onClick:()=>ie(!O),leftIcon:e.jsx(we,{className:"w-4 h-4"}),children:"CTI / OSINT"})})]})]})]}),O&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(we,{className:"w-5 h-5 text-forensic-500"}),e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Cyber Threat Intelligence (CTI)"}),e.jsx("span",{className:"text-xs text-slate-400",children:"OSINT search for PII, credentials, darknet mentions"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[e.jsxs("div",{className:"flex-1 min-w-[200px] relative",children:[e.jsx(zt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",value:D,onChange:E=>h(E.target.value),placeholder:"Search domain, email, IP, or keyword...",className:"input pl-10"})]}),e.jsx("div",{className:"flex gap-1",children:[{id:"all",label:"All Sources",icon:e.jsx(we,{className:"w-3 h-3"})},{id:"pii",label:"PII / Leaks",icon:e.jsx(qt,{className:"w-3 h-3"})},{id:"credentials",label:"Credentials",icon:e.jsx(ft,{className:"w-3 h-3"})},{id:"darknet",label:"Darknet",icon:e.jsx(jt,{className:"w-3 h-3"})}].map(E=>e.jsx(k,{content:`Search ${E.label}`,children:e.jsxs("button",{onClick:()=>x(E.id),className:u("flex items-center gap-1.5 px-3 py-2 rounded-lg text-xs font-medium transition-colors",I===E.id?"bg-forensic-100 text-forensic-700 dark:bg-forensic-900/30 dark:text-forensic-300":"bg-slate-100 dark:bg-slate-800 text-slate-500 hover:text-slate-700"),children:[E.icon,E.label]})},E.id))}),e.jsx(k,{content:"Search public OSINT sources and darknet databases",children:e.jsx(P,{onClick:G,isLoading:N,leftIcon:e.jsx(zt,{className:"w-4 h-4"}),size:"sm",children:"Search CTI"})})]}),N&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg mb-3",children:[e.jsx(xt,{className:"w-5 h-5 animate-spin text-forensic-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Searching threat intelligence sources..."}),e.jsx("p",{className:"text-xs text-slate-500",children:"Querying OSINT databases, breach databases, paste sites, darknet forums"})]})]}),C.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[e.jsx(qe,{className:"w-4 h-4 text-yellow-500"}),e.jsxs("span",{children:[C.length," results found across open and dark sources"]})]}),C.map(E=>e.jsx(fl,{result:E},E.id))]}),!N&&C.length===0&&e.jsxs("div",{className:"text-center py-4 text-slate-400",children:[e.jsx(we,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Run a CTI search to discover exposed data, leaked credentials, and darknet mentions"}),e.jsx("p",{className:"text-xs mt-1",children:"Sources: OSINT databases, breach databases, paste sites, darknet forums, public repos"})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:Se.map((E,L)=>e.jsx(bl,{name:E.name,icon:te(L),progress:f[L],status:de(L)},E.id))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(T,{className:"h-[400px] flex flex-col",children:[e.jsx(H,{title:"Activity Feed",description:"Real-time log of triage operations"}),e.jsx("div",{ref:U,className:"flex-1 overflow-y-auto mt-4 space-y-2",children:S.length===0?e.jsx("p",{className:"text-sm text-slate-400 text-center py-8",children:"Activity will appear here when triage starts..."}):S.map(E=>e.jsx(jl,{log:E},E.id))})]})}),e.jsx("div",{children:e.jsxs(T,{className:"h-[400px]",children:[e.jsx(H,{title:"Findings",description:"Detected issues and anomalies"}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx(_e,{label:"Critical",count:b.critical,color:"red"}),e.jsx(_e,{label:"High",count:b.high,color:"orange"}),e.jsx(_e,{label:"Medium",count:b.medium,color:"yellow"}),e.jsx(_e,{label:"Low",count:b.low,color:"green"}),e.jsx("hr",{className:"border-slate-200 dark:border-slate-700"}),e.jsx(_e,{label:"Ambiguous",count:b.ambiguous,color:"purple",tooltip:"Findings requiring manual review"})]})]})})]})]})}function fl({result:t}){const[s,a]=v.useState(!1),r={pii_exposure:e.jsx(qt,{className:"w-4 h-4"}),leaked_credentials:e.jsx(ft,{className:"w-4 h-4"}),darknet_mention:e.jsx(jt,{className:"w-4 h-4"}),paste_site:e.jsx(Ss,{className:"w-4 h-4"}),breach_database:e.jsx(ut,{className:"w-4 h-4"})},n={pii_exposure:"PII Exposure",leaked_credentials:"Leaked Credentials",darknet_mention:"Darknet Mention",paste_site:"Paste Site",breach_database:"Breach Database"},i={critical:"border-l-red-500 bg-red-50/50 dark:bg-red-900/10",high:"border-l-orange-500 bg-orange-50/50 dark:bg-orange-900/10",medium:"border-l-yellow-500 bg-yellow-50/50 dark:bg-yellow-900/10",low:"border-l-green-500 bg-green-50/50 dark:bg-green-900/10"};return e.jsx("div",{className:u("border-l-4 rounded-lg p-3 cursor-pointer transition-colors",i[t.severity]),onClick:()=>a(!s),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-slate-400 mt-0.5",children:r[t.type]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("span",{className:u("px-2 py-0.5 rounded text-xs font-medium",t.severity==="critical"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":t.severity==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"),children:t.severity}),e.jsx("span",{className:"text-xs text-slate-400 bg-slate-100 dark:bg-slate-700 px-2 py-0.5 rounded",children:n[t.type]}),e.jsx("span",{className:"text-xs text-slate-400 ml-auto",children:t.date}),s?e.jsx(he,{className:"w-3 h-3 text-slate-400"}):e.jsx(re,{className:"w-3 h-3 text-slate-400"})]}),e.jsx("h4",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:t.title}),e.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:t.description}),e.jsxs("p",{className:"text-xs text-slate-400 mt-0.5",children:["Source: ",t.source]}),s&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase mb-1",children:"Indicators Found"}),e.jsx("div",{className:"space-y-1",children:t.indicators.map((o,l)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-red-400"}),e.jsx("span",{className:"font-mono text-slate-600 dark:text-slate-400",children:o})]},l))})]})]})]})})}function bl({name:t,icon:s,progress:a,status:r}){return e.jsx(T,{className:u("text-center",r==="complete"&&"ring-2 ring-green-500 ring-offset-2 dark:ring-offset-slate-900"),children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:u(r==="complete"&&"text-green-500",r==="running"&&"text-forensic-500 animate-pulse",r==="pending"&&"text-slate-300 dark:text-slate-600"),children:r==="complete"?e.jsx(B,{className:"w-5 h-5"}):s}),e.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:t}),e.jsx(ht,{value:a,size:"sm",variant:r==="complete"?"success":"default"})]})})}function jl({log:t}){const s={info:"text-slate-400",warning:"text-yellow-500",success:"text-green-500",error:"text-red-500"};return e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx("span",{className:"text-xs font-mono text-slate-400 whitespace-nowrap",children:Qs(t.timestamp)}),e.jsx("span",{className:u("flex-1",s[t.severity]),children:t.message})]})}function _e({label:t,count:s,color:a,tooltip:r}){const n={red:"bg-red-500",orange:"bg-orange-500",yellow:"bg-yellow-500",green:"bg-green-500",purple:"bg-purple-500"},i=e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:u("w-2 h-2 rounded-full",n[a])}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:t})]}),e.jsx("span",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:s})]});return r?e.jsx(k,{content:r,children:i}):i}const Ft=[{id:"atk-1",date:"2024-01-15",time:"02:15",timestamp:new Date("2024-01-15T02:15:00"),phase:"Initial Access",phaseIndex:0,title:"Phishing Email Delivered",description:"Spear-phishing email with malicious attachment delivered to jsmith@company.com",riskScore:85,severity:"high",icon:e.jsx(Ye,{className:"w-4 h-4"}),color:"bg-red-500",iocs:[{type:"Email",value:"invoice-update@mail-service.xyz"},{type:"Hash (SHA256)",value:"a1b2c3d4e5f6...9876543210ab"},{type:"Domain",value:"mail-service.xyz"},{type:"IP",value:"198.51.100.23"}],ttps:[{id:"T1566.001",name:"Spear-phishing Attachment",tactic:"Initial Access"},{id:"T1204.002",name:"User Execution: Malicious File",tactic:"Execution"}],affectedAssets:["WS-FIN-042","jsmith@company.com"],details:"Email impersonated a vendor invoice. Contained a macro-enabled Excel document (.xlsm) that executed PowerShell on open. The macro was obfuscated using string concatenation and base64 encoding. Email passed SPF/DKIM checks as the sending domain was newly registered."},{id:"atk-2",date:"2024-01-15",time:"02:18",timestamp:new Date("2024-01-15T02:18:00"),phase:"Execution",phaseIndex:1,title:"Macro Execution  PowerShell Stager",description:"Malicious macro spawned PowerShell process downloading second-stage payload",riskScore:90,severity:"critical",icon:e.jsx(Te,{className:"w-4 h-4"}),color:"bg-red-600",iocs:[{type:"Process",value:"powershell.exe -enc <base64>"},{type:"URL",value:"https://cdn-update.xyz/payload.ps1"},{type:"IP",value:"185.220.101.42"},{type:"Hash",value:"payload.ps1: e7f8a9b0c1d2..."}],ttps:[{id:"T1059.001",name:"PowerShell",tactic:"Execution"},{id:"T1105",name:"Ingress Tool Transfer",tactic:"Command and Control"}],affectedAssets:["WS-FIN-042"],details:"Excel macro used WMI to spawn powershell.exe with encoded command. The stager connected to cdn-update.xyz over HTTPS (port 443) to download the main payload. Cobalt Strike beacon was loaded in memory via reflective DLL injection. Process tree: EXCEL.EXE  cmd.exe  powershell.exe."},{id:"atk-3",date:"2024-01-15",time:"02:22",timestamp:new Date("2024-01-15T02:22:00"),phase:"Command & Control",phaseIndex:2,title:"C2 Channel Established",description:"Cobalt Strike beacon established HTTPS C2 channel to attacker infrastructure",riskScore:92,severity:"critical",icon:e.jsx(Ne,{className:"w-4 h-4"}),color:"bg-purple-600",iocs:[{type:"C2 Domain",value:"update-service.xyz"},{type:"C2 IP",value:"185.220.101.42"},{type:"C2 Port",value:"443 (HTTPS)"},{type:"Beacon Config",value:"Sleep: 60s, Jitter: 25%"},{type:"User-Agent",value:"Mozilla/5.0 (compatible)"}],ttps:[{id:"T1071.001",name:"Web Protocols (HTTPS)",tactic:"Command and Control"},{id:"T1573.002",name:"Encrypted Channel: Asymmetric",tactic:"Command and Control"}],affectedAssets:["WS-FIN-042"],details:"Cobalt Strike beacon configured with HTTPS C2 profile mimicking legitimate web traffic. Beacon sleep interval: 60 seconds with 25% jitter. JA3 fingerprint matches known Cobalt Strike malleable profile. DNS over HTTPS used for domain resolution. Traffic blended with legitimate web browsing."},{id:"atk-4",date:"2024-01-15",time:"02:25",timestamp:new Date("2024-01-15T02:25:00"),phase:"Persistence",phaseIndex:3,title:"Scheduled Task Persistence",description:'Created "WindowsUpdate" scheduled task for persistence across reboots',riskScore:75,severity:"high",icon:e.jsx(Ps,{className:"w-4 h-4"}),color:"bg-orange-500",iocs:[{type:"Task Name",value:"WindowsUpdate"},{type:"Executable",value:"C:\\Users\\Public\\update.exe"},{type:"Trigger",value:"At system startup"},{type:"Hash",value:"update.exe: c3d4e5f6a7b8..."}],ttps:[{id:"T1053.005",name:"Scheduled Task/Job",tactic:"Persistence"},{id:"T1036.005",name:"Masquerading: Match Name",tactic:"Defense Evasion"}],affectedAssets:["WS-FIN-042"],details:'Scheduled task "WindowsUpdate" created via schtasks.exe with SYSTEM privileges. Executable placed in C:\\Users\\Public\\ to avoid UAC. Task configured to run at system startup with highest privileges. File was timestomped to match legitimate system files. The binary is a packed Cobalt Strike loader.'},{id:"atk-5",date:"2024-01-15",time:"02:28",timestamp:new Date("2024-01-15T02:28:00"),phase:"Privilege Escalation",phaseIndex:4,title:"Credential Theft via Mimikatz",description:"Mimikatz DCSync attack harvested Domain Admin credentials",riskScore:98,severity:"critical",icon:e.jsx(Is,{className:"w-4 h-4"}),color:"bg-orange-600",iocs:[{type:"Tool",value:"Mimikatz 2.2.0"},{type:"Technique",value:"DCSync (lsadump::dcsync)"},{type:"Account",value:"admin.jsmith (Domain Admin)"},{type:"Account",value:"svc-backup (Backup Operator)"},{type:"Hash Type",value:"NTLM, Kerberos AES256"}],ttps:[{id:"T1003.006",name:"DCSync",tactic:"Credential Access"},{id:"T1078.002",name:"Domain Accounts",tactic:"Privilege Escalation"}],affectedAssets:["WS-FIN-042","DC-MAIN-01","admin.jsmith","svc-backup"],details:"Attacker used in-memory Mimikatz to perform DCSync attack against DC-MAIN-01. Replicated password hashes for all domain admin accounts. The DCSync required replication permissions - attacker exploited the initial user's existing DACL permissions. NTLM hashes and Kerberos AES256 keys were extracted for admin.jsmith and svc-backup accounts."},{id:"atk-6",date:"2024-01-15",time:"02:30",timestamp:new Date("2024-01-15T02:30:00"),phase:"Lateral Movement",phaseIndex:5,title:"PsExec Lateral Movement",description:"Used PsExec with admin credentials to move to DC-MAIN-01 and FS-FINANCE-01",riskScore:95,severity:"critical",icon:e.jsx(Ne,{className:"w-4 h-4"}),color:"bg-yellow-500",iocs:[{type:"Tool",value:"PsExec.exe (SysInternals)"},{type:"Source",value:"WS-FIN-042 (10.0.10.42)"},{type:"Target 1",value:"DC-MAIN-01 (10.0.1.10)"},{type:"Target 2",value:"FS-FINANCE-01 (10.0.2.20)"},{type:"Port",value:"TCP 445 (SMB)"}],ttps:[{id:"T1570",name:"Lateral Tool Transfer",tactic:"Lateral Movement"},{id:"T1021.002",name:"SMB/Windows Admin Shares",tactic:"Lateral Movement"},{id:"T1047",name:"WMI Execution",tactic:"Execution"}],affectedAssets:["WS-FIN-042","DC-MAIN-01","FS-FINANCE-01"],details:"PsExec.exe used admin.jsmith credentials to create remote services on DC-MAIN-01 and FS-FINANCE-01 via SMB (port 445). New PSEXESVC service installed on both targets. WMI was also used as backup execution method. Lateral movement completed in under 90 seconds across both targets."},{id:"atk-7",date:"2024-01-15",time:"02:33",timestamp:new Date("2024-01-15T02:33:00"),phase:"Discovery",phaseIndex:6,title:"Internal Reconnaissance",description:"Network scanning and AD enumeration from compromised domain controller",riskScore:70,severity:"high",icon:e.jsx(Ds,{className:"w-4 h-4"}),color:"bg-yellow-600",iocs:[{type:"Tool",value:"ADFind.exe, SharpHound"},{type:"Queries",value:"Domain Trust, GPO, OU mapping"},{type:"Output",value:"C:\\Windows\\Temp\\ad_enum.json"}],ttps:[{id:"T1018",name:"Remote System Discovery",tactic:"Discovery"},{id:"T1087.002",name:"Domain Account Discovery",tactic:"Discovery"},{id:"T1482",name:"Domain Trust Discovery",tactic:"Discovery"}],affectedAssets:["DC-MAIN-01"],details:"From DC-MAIN-01, attacker ran ADFind.exe and SharpHound (BloodHound collector) to enumerate the entire Active Directory. Mapped domain trusts, Group Policy Objects, OUs, and high-value targets. Output saved to C:\\Windows\\Temp\\ad_enum.json. This provided the attacker with a complete map of the environment."},{id:"atk-8",date:"2024-01-15",time:"02:35",timestamp:new Date("2024-01-15T02:35:00"),phase:"Collection",phaseIndex:7,title:"Finance Data Harvested",description:"Bulk file download of 1,247 files from Finance share and SharePoint",riskScore:88,severity:"critical",icon:e.jsx(Pe,{className:"w-4 h-4"}),color:"bg-purple-500",iocs:[{type:"File Count",value:"1,247 files"},{type:"Total Size",value:"~4.2 GB"},{type:"Source 1",value:"\\\\FS-FINANCE-01\\Finance"},{type:"Source 2",value:"SharePoint Online - Finance"},{type:"Staging Dir",value:"C:\\Windows\\Temp\\exfil\\"}],ttps:[{id:"T1005",name:"Data from Local System",tactic:"Collection"},{id:"T1039",name:"Data from Network Shared Drive",tactic:"Collection"},{id:"T1074.001",name:"Local Data Staging",tactic:"Collection"}],affectedAssets:["FS-FINANCE-01","SharePoint Online","jsmith@company.com"],details:"Files collected from Finance share (\\\\FS-FINANCE-01\\Finance) and SharePoint Online using jsmith's credentials. Includes financial reports, customer PII, contracts, and internal strategy docs. Files staged in C:\\Windows\\Temp\\exfil\\ and compressed into split RAR archives for exfiltration. Total data: 1,247 files, approximately 4.2 GB."},{id:"atk-9",date:"2024-01-15",time:"02:37",timestamp:new Date("2024-01-15T02:37:00"),phase:"Exfiltration",phaseIndex:8,title:"Data Exfiltrated via C2",description:"Compressed data exfiltrated through Cobalt Strike C2 channel",riskScore:93,severity:"critical",icon:e.jsx(q,{className:"w-4 h-4"}),color:"bg-purple-600",iocs:[{type:"Method",value:"HTTPS via C2 channel"},{type:"Destination",value:"185.220.101.42:443"},{type:"Protocol",value:"Cobalt Strike HTTP malleable"},{type:"Volume",value:"~1.8 GB (compressed)"},{type:"Duration",value:"~15 minutes"}],ttps:[{id:"T1041",name:"Exfiltration Over C2 Channel",tactic:"Exfiltration"},{id:"T1560.001",name:"Archive via Utility (RAR)",tactic:"Collection"}],affectedAssets:["FS-FINANCE-01","WS-FIN-042"],details:"Data exfiltrated through the existing Cobalt Strike HTTPS C2 channel to 185.220.101.42. Split RAR archives transferred in chunks to blend with normal HTTPS traffic. Total exfiltrated volume: ~1.8 GB compressed (4.2 GB uncompressed). Transfer took approximately 15 minutes. DNS beaconing used as backup exfiltration channel."},{id:"atk-10",date:"2024-01-15",time:"02:40",timestamp:new Date("2024-01-15T02:40:00"),phase:"Impact",phaseIndex:9,title:"Ransomware Deployment",description:"File encryption initiated across domain via Group Policy Object",riskScore:100,severity:"critical",icon:e.jsx(Ge,{className:"w-4 h-4"}),color:"bg-red-700",iocs:[{type:"Ransomware",value:"BlackCat/ALPHV variant"},{type:"Extension",value:".encrypted"},{type:"Ransom Note",value:"RECOVER-FILES.txt"},{type:"GPO Name",value:"Windows Update Policy"},{type:"Bitcoin Address",value:"bc1q...xyz"}],ttps:[{id:"T1486",name:"Data Encrypted for Impact",tactic:"Impact"},{id:"T1484.001",name:"Domain Policy Modification: GPO",tactic:"Defense Evasion"},{id:"T1490",name:"Inhibit System Recovery",tactic:"Impact"}],affectedAssets:["DC-MAIN-01","FS-FINANCE-01","SQL-DB-01","WEB-APP-01","EXCH-01","BKP-SERVER-01"],details:'Ransomware deployed via malicious GPO "Windows Update Policy" pushed from DC-MAIN-01. BlackCat/ALPHV variant with .encrypted extension. Ransom note (RECOVER-FILES.txt) dropped in every directory. Volume shadow copies deleted (vssadmin delete shadows /all). Backup server (BKP-SERVER-01) specifically targeted first. Recovery inhibited by disabling Windows Recovery Environment.'}],Lt=["02:10","02:15","02:20","02:25","02:30","02:35","02:40","02:45"],vl=[{id:"1",timestamp:new Date("2024-01-15T02:30:15"),source:"windows_security",severity:"critical",title:"Suspicious Process Execution",summary:"PsExec.exe executed with SYSTEM privileges",category:"process_execution",rawLog:`EventID: 4688
Process Name: C:\\Windows\\System32\\PsExec.exe
User: NT AUTHORITY\\SYSTEM`,relatedCount:3},{id:"2",timestamp:new Date("2024-01-15T02:31:00"),source:"firewall",severity:"high",title:"Outbound Connection to Known C2",summary:"Connection to 185.220.101.42:443 blocked",category:"network_connection",rawLog:`Action: Block
Direction: Outbound
Dest IP: 185.220.101.42
Dest Port: 443`,relatedCount:5},{id:"3",timestamp:new Date("2024-01-15T02:32:30"),source:"windows_security",severity:"medium",title:"Scheduled Task Created",summary:'New scheduled task "WindowsUpdate" created',category:"persistence",rawLog:`Task Name: WindowsUpdate
Action: C:\\Users\\Public\\update.exe
Trigger: At startup`,relatedCount:1},{id:"4",timestamp:new Date("2024-01-15T02:35:00"),source:"azure_activity",severity:"high",title:"Bulk File Download",summary:"1,247 files downloaded from SharePoint",category:"data_exfiltration",rawLog:`Operation: FileDownloaded
Count: 1247
User: jsmith@company.com`,relatedCount:2},{id:"5",timestamp:new Date("2024-01-15T02:40:00"),source:"windows_security",severity:"critical",title:"Lateral Movement Detected",summary:"Remote WMI execution on DC-MAIN-01",category:"lateral_movement",rawLog:`EventID: 4624
Logon Type: 3
Target: DC-MAIN-01
Source: ACCT-WS-042`,relatedCount:8}];function yl(){const t=ne(),{goToNextStep:s,goToPreviousStep:a}=Z(),[r,n]=v.useState(null),[i,o]=v.useState(null),[l,c]=v.useState(""),[m,p]=v.useState(1),[f,g]=v.useState(!0),S=()=>{a(),t("/triage")},y=()=>{s(),t("/verification")},b=vl.filter(d=>d.title.toLowerCase().includes(l.toLowerCase())||d.summary.toLowerCase().includes(l.toLowerCase())),w=d=>d.includes("windows")?e.jsx(Ie,{className:"w-4 h-4"}):d.includes("azure")||d.includes("cloud")?e.jsx(q,{className:"w-4 h-4"}):d.includes("firewall")?e.jsx(pe,{className:"w-4 h-4"}):e.jsx(Te,{className:"w-4 h-4"}),D=d=>{const C={critical:"bg-red-500",high:"bg-orange-500",medium:"bg-yellow-500",low:"bg-green-500",info:"bg-blue-500"};return C[d]||C.info},h=d=>d>=90?{bg:"bg-red-500",text:"text-red-700 dark:text-red-400",ring:"ring-red-500"}:d>=75?{bg:"bg-orange-500",text:"text-orange-700 dark:text-orange-400",ring:"ring-orange-500"}:d>=50?{bg:"bg-yellow-500",text:"text-yellow-700 dark:text-yellow-400",ring:"ring-yellow-500"}:{bg:"bg-green-500",text:"text-green-700 dark:text-green-400",ring:"ring-green-500"},N=d=>{const[C,W]=d.split(":").map(Number),I=C*60+W,x=2*60+10,O=2*60+45;return(I-x)/(O-x)*100};return e.jsxs(ge,{title:"Timeline View",subtitle:"Interactive timeline of security events",actions:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{content:"Zoom out on timeline",children:e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>p(Math.max(.5,m-.25)),children:e.jsx($a,{className:"w-4 h-4"})})}),e.jsxs("span",{className:"text-sm text-slate-500",children:[Math.round(m*100),"%"]}),e.jsx(k,{content:"Zoom in on timeline",children:e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>p(Math.min(2,m+.25)),children:e.jsx(Ya,{className:"w-4 h-4"})})})]}),footer:e.jsx(ke,{onBack:S,backLabel:"Triage",onContinue:y,continueLabel:"Proceed to Review"}),children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[e.jsx("div",{className:"flex-1 min-w-[200px] max-w-md",children:e.jsx(qr,{value:l,onChange:d=>c(d.target.value),placeholder:"Search events...",tooltip:"Search events by keyword"})}),e.jsx(k,{content:"Filter by data source",children:e.jsx(P,{variant:"outline",size:"sm",leftIcon:e.jsx(ss,{className:"w-4 h-4"}),children:"Source"})}),e.jsx(k,{content:"Filter by severity level",children:e.jsx(P,{variant:"outline",size:"sm",leftIcon:e.jsx(ss,{className:"w-4 h-4"}),children:"Severity"})}),e.jsx(k,{content:"Filter events by date range",children:e.jsx(P,{variant:"outline",size:"sm",leftIcon:e.jsx(Ns,{className:"w-4 h-4"}),children:"Date Range"})})]}),e.jsxs(T,{className:"mb-6",children:[e.jsxs("button",{onClick:()=>g(!f),className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bt,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Attack Flow Timeline"}),e.jsx("span",{className:"text-xs bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 px-2 py-0.5 rounded-full",children:"Multi-Dimensional"})]}),f?e.jsx(he,{className:"w-5 h-5 text-slate-400"}):e.jsx(re,{className:"w-5 h-5 text-slate-400"})]}),f&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-slate-500",children:"AXIS:"}),e.jsx("span",{className:"text-slate-400",children:"Vertical = Date/Phase"}),e.jsx("span",{className:"text-slate-300",children:"|"}),e.jsx("span",{className:"text-slate-400",children:"Horizontal = Time"})]}),e.jsxs("div",{className:"flex items-center gap-3 ml-auto",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-red-500"})," Critical"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-orange-500"})," High"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-yellow-500"})," Medium"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-slate-200 dark:bg-slate-700 px-1 font-bold text-slate-600",children:"95"})," Risk Score"]})]})]}),e.jsxs("div",{className:"relative overflow-x-auto",children:[e.jsx("div",{className:"flex items-end mb-1 ml-[140px]",children:Lt.map(d=>e.jsx("div",{className:"flex-1 text-center",children:e.jsx("span",{className:"text-[10px] font-mono text-slate-400",children:d})},d))}),e.jsx("div",{className:"ml-[140px] mb-2 h-px bg-slate-200 dark:bg-slate-700"}),e.jsx("div",{className:"space-y-1",children:Ft.map(d=>{const C=N(d.time),W=h(d.riskScore),I=(i==null?void 0:i.id)===d.id;return e.jsxs("div",{className:"flex items-center gap-0 group",children:[e.jsxs("div",{className:"w-[140px] flex-shrink-0 pr-2 text-right",children:[e.jsx("span",{className:"text-[10px] font-medium text-slate-500 leading-none",children:d.phase}),e.jsx("br",{}),e.jsx("span",{className:"text-[9px] font-mono text-slate-400",children:d.time})]}),e.jsxs("div",{className:"flex-1 relative h-12 bg-slate-50 dark:bg-slate-800/30 rounded border border-slate-100 dark:border-slate-800",children:[Lt.map((x,O)=>e.jsx("div",{className:"absolute top-0 bottom-0 w-px bg-slate-100 dark:bg-slate-800",style:{left:`${O/(Lt.length-1)*100}%`}},O)),d.phaseIndex>0&&e.jsx("div",{className:"absolute top-0 h-px bg-red-300 dark:bg-red-700 z-0",style:{left:`${N(Ft[d.phaseIndex-1].time)}%`,width:`${C-N(Ft[d.phaseIndex-1].time)}%`}}),e.jsx(k,{content:e.jsxs("div",{className:"max-w-xs",children:[e.jsx("div",{className:"font-semibold",children:d.title}),e.jsx("div",{className:"text-xs mt-1 opacity-80",children:d.description}),e.jsxs("div",{className:"text-xs mt-1 font-mono opacity-60",children:["Risk Score: ",d.riskScore,"/100"]}),e.jsxs("div",{className:"text-xs opacity-60",children:["TTPs: ",d.ttps.map(x=>x.id).join(", ")]}),e.jsx("div",{className:"text-xs mt-1 opacity-60",children:"Click for full details "})]}),children:e.jsx("button",{onClick:()=>o(I?null:d),className:"absolute top-1/2 -translate-y-1/2 -translate-x-1/2 z-10 transition-all duration-200",style:{left:`${C}%`},children:e.jsxs("div",{className:u("flex items-center gap-1.5 px-2 py-1 rounded-lg border-2 transition-all",I?"scale-110 shadow-lg":"hover:scale-105",d.severity==="critical"?"bg-red-50 border-red-400 dark:bg-red-900/20 dark:border-red-600":d.severity==="high"?"bg-orange-50 border-orange-400 dark:bg-orange-900/20 dark:border-orange-600":"bg-yellow-50 border-yellow-400 dark:bg-yellow-900/20 dark:border-yellow-600",I&&"ring-2 ring-offset-1 "+W.ring),children:[e.jsx("div",{className:u("w-5 h-5 rounded-full flex items-center justify-center text-white flex-shrink-0",d.color),children:d.icon}),e.jsx("span",{className:u("text-sm font-black tabular-nums leading-none",W.text),children:d.riskScore})]})})})]})]},d.id)})})]}),i&&e.jsxs("div",{className:"border-2 border-forensic-300 dark:border-forensic-700 rounded-xl overflow-hidden",children:[e.jsx("div",{className:u("p-4",i.severity==="critical"?"bg-red-50 dark:bg-red-900/10":i.severity==="high"?"bg-orange-50 dark:bg-orange-900/10":"bg-yellow-50 dark:bg-yellow-900/10"),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:u("w-10 h-10 rounded-full flex items-center justify-center text-white",i.color),children:i.icon}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-slate-100",children:i.title}),e.jsx("span",{className:u("px-2 py-0.5 rounded text-xs font-bold",i.severity==="critical"?"bg-red-200 text-red-800 dark:bg-red-900/40 dark:text-red-300":i.severity==="high"?"bg-orange-200 text-orange-800 dark:bg-orange-900/40 dark:text-orange-300":"bg-yellow-200 text-yellow-800"),children:i.severity.toUpperCase()})]}),e.jsxs("p",{className:"text-sm text-slate-500 mt-0.5",children:[i.phase,"  ",i.date," at ",i.time]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:u("text-3xl font-black tabular-nums",h(i.riskScore).text),children:i.riskScore}),e.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-medium",children:"Risk Score"})]}),e.jsx("button",{onClick:()=>o(null),className:"p-1 hover:bg-white/50 rounded",children:e.jsx(Qe,{className:"w-5 h-5 text-slate-400"})})]})]})}),e.jsxs("div",{className:"p-4 bg-white dark:bg-slate-800 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-semibold text-slate-500 uppercase mb-1 flex items-center gap-1",children:[e.jsx(Vt,{className:"w-3 h-3"})," Description"]}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:i.details})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-semibold text-slate-500 uppercase mb-2 flex items-center gap-1",children:[e.jsx(Cs,{className:"w-3 h-3"})," Indicators of Compromise (",i.iocs.length,")"]}),e.jsx("div",{className:"space-y-1",children:i.iocs.map((d,C)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-slate-50 dark:bg-slate-700/50 rounded text-xs",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-red-400 flex-shrink-0"}),e.jsxs("span",{className:"text-slate-500 w-20 flex-shrink-0",children:[d.type,":"]}),e.jsx("span",{className:"font-mono text-slate-700 dark:text-slate-300 truncate",children:d.value})]},C))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-semibold text-slate-500 uppercase mb-2 flex items-center gap-1",children:[e.jsx(Ds,{className:"w-3 h-3"})," MITRE ATT&CK TTPs (",i.ttps.length,")"]}),e.jsx("div",{className:"space-y-1",children:i.ttps.map((d,C)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-slate-50 dark:bg-slate-700/50 rounded text-xs",children:[e.jsx("span",{className:"px-1.5 py-0.5 bg-forensic-100 dark:bg-forensic-900/30 text-forensic-700 dark:text-forensic-300 rounded font-mono font-bold text-[10px]",children:d.id}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300 flex-1",children:d.name}),e.jsx("span",{className:"text-slate-400 text-[10px]",children:d.tactic})]},C))})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-semibold text-slate-500 uppercase mb-2 flex items-center gap-1",children:[e.jsx(Y,{className:"w-3 h-3"})," Affected Assets (",i.affectedAssets.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:i.affectedAssets.map((d,C)=>e.jsx("span",{className:"px-2 py-1 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 text-xs rounded-lg border border-red-200 dark:border-red-800 font-mono",children:d},C))})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 uppercase mb-3",children:"Affected Resources"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:[{name:"WS-FIN-042",role:"Patient Zero",severity:"critical",icon:e.jsx(Ie,{className:"w-4 h-4"})},{name:"DC-MAIN-01",role:"Domain Controller",severity:"critical",icon:e.jsx(Y,{className:"w-4 h-4"})},{name:"FS-FINANCE-01",role:"File Server",severity:"high",icon:e.jsx(Pe,{className:"w-4 h-4"})},{name:"BKP-SERVER-01",role:"Backup Server",severity:"high",icon:e.jsx(Y,{className:"w-4 h-4"})},{name:"WEB-APP-01",role:"Web Server",severity:"medium",icon:e.jsx(q,{className:"w-4 h-4"})},{name:"EXCH-01",role:"Exchange Server",severity:"medium",icon:e.jsx(Ye,{className:"w-4 h-4"})},{name:"PRINT-SRV-01",role:"Print Server",severity:"low",icon:e.jsx(Y,{className:"w-4 h-4"})},{name:"VPN Gateway",role:"Network Device",severity:"high",icon:e.jsx(pe,{className:"w-4 h-4"})}].map((d,C)=>e.jsxs("div",{className:u("p-2 rounded-lg border text-xs",d.severity==="critical"?"border-red-300 bg-red-50 dark:bg-red-900/10 dark:border-red-900/50":d.severity==="high"?"border-orange-300 bg-orange-50 dark:bg-orange-900/10 dark:border-orange-900/50":d.severity==="medium"?"border-yellow-300 bg-yellow-50 dark:bg-yellow-900/10 dark:border-yellow-900/50":"border-slate-200 bg-slate-50 dark:bg-slate-800/50 dark:border-slate-700"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-slate-400",children:d.icon}),e.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:d.name})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-500",children:d.role}),e.jsx("span",{className:u("px-1 py-0.5 rounded text-[10px] font-medium",d.severity==="critical"?"bg-red-200 text-red-700 dark:bg-red-900/40 dark:text-red-400":d.severity==="high"?"bg-orange-200 text-orange-700 dark:bg-orange-900/40 dark:text-orange-400":"bg-yellow-200 text-yellow-700 dark:bg-yellow-900/40 dark:text-yellow-400"),children:d.severity})]})]},C))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(T,{className:"min-h-[500px]",children:[e.jsx(H,{title:"Event Timeline",description:`${b.length} events  Jan 15, 2024`}),e.jsxs("div",{className:"mt-6 relative",children:[e.jsxs("div",{className:"flex justify-between text-xs text-slate-400 mb-4",children:[e.jsx("span",{children:"02:30"}),e.jsx("span",{children:"02:35"}),e.jsx("span",{children:"02:40"}),e.jsx("span",{children:"02:45"})]}),e.jsx("div",{className:"space-y-4",children:["Windows","Cloud","Network"].map(d=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-16 text-xs text-slate-500 text-right",children:d}),e.jsx("div",{className:"flex-1 h-10 bg-slate-100 dark:bg-slate-800 rounded relative",children:b.filter(C=>d==="Windows"?C.source.includes("windows"):d==="Cloud"?C.source.includes("azure"):C.source.includes("firewall")).map(C=>e.jsx(k,{content:C.title,children:e.jsx("button",{onClick:()=>n(C),className:u("absolute top-1/2 -translate-y-1/2 w-4 h-4 rounded-full","transition-transform hover:scale-150","ring-2 ring-white dark:ring-slate-900",D(C.severity),(r==null?void 0:r.id)===C.id&&"ring-4 ring-forensic-400"),style:{left:`${(C.timestamp.getMinutes()-30)/15*100}%`}})},C.id))})]},d))}),e.jsx("svg",{className:"absolute inset-0 pointer-events-none opacity-30",children:e.jsx("line",{x1:"20%",y1:"30%",x2:"40%",y2:"70%",stroke:"currentColor",strokeDasharray:"4",className:"text-forensic-500"})})]}),e.jsx("div",{className:"mt-8 space-y-2",children:b.map(d=>e.jsx(wl,{event:d,isSelected:(r==null?void 0:r.id)===d.id,onClick:()=>n(d),sourceIcon:w(d.source)},d.id))})]})}),e.jsx("div",{children:e.jsx(T,{className:"sticky top-24 min-h-[500px]",children:r?e.jsx(Nl,{event:r,onClose:()=>n(null)}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center py-12",children:[e.jsx(Te,{className:"w-12 h-12 text-slate-300 mb-3"}),e.jsx("p",{className:"text-slate-500",children:"Select an event to view details"})]})})})]})]})}function wl({event:t,isSelected:s,onClick:a,sourceIcon:r}){return e.jsxs("button",{onClick:a,className:u("w-full flex items-center gap-3 p-3 rounded-lg text-left transition-colors",s?"bg-forensic-50 dark:bg-forensic-900/20 ring-1 ring-forensic-500":"hover:bg-slate-50 dark:hover:bg-slate-800/50"),children:[e.jsx("span",{className:"text-slate-400",children:r}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100 truncate",children:t.title}),e.jsx("p",{className:"text-xs text-slate-500 truncate",children:t.summary})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qt,{severity:t.severity,size:"sm"}),e.jsx("span",{className:"text-xs text-slate-400",children:Qs(t.timestamp)})]})]})}function Nl({event:t,onClose:s}){const[a,r]=v.useState(!1);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-slate-100",children:t.title}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:tl(t.timestamp)})]}),e.jsx("button",{onClick:s,className:"p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded",children:e.jsx(Qe,{className:"w-4 h-4 text-slate-400"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsx(Qt,{severity:t.severity})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 uppercase mb-1",children:"Summary"}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:t.summary})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 uppercase mb-1",children:"Source"}),e.jsx(Q,{variant:"secondary",children:t.source.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 uppercase mb-1",children:"Category"}),e.jsx(Q,{variant:"info",children:t.category.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 uppercase mb-1",children:"Related Events"}),e.jsxs("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:[t.relatedCount," correlated event",t.relatedCount!==1?"s":""]})]}),e.jsxs("div",{children:[e.jsx(k,{content:"View full raw log data",children:e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>r(!a),fullWidth:!0,children:[a?"Hide":"View"," Raw Log"]})}),a&&e.jsxs("div",{className:"mt-3 relative",children:[e.jsx("pre",{className:"text-xs bg-slate-900 text-slate-100 p-3 rounded-lg overflow-x-auto",children:t.rawLog}),e.jsx(k,{content:"Copy raw log to clipboard",children:e.jsx("button",{onClick:()=>navigator.clipboard.writeText(t.rawLog),className:"absolute top-2 right-2 p-1 hover:bg-slate-700 rounded",children:e.jsx(qa,{className:"w-3 h-3 text-slate-400"})})})]})]})]})]})}const ve=[{id:"1",title:"PsExec Remote Execution",category:"dual_use_tool",severity:"medium",confidence:65,description:"PsExec was used to execute commands on remote systems. This tool has legitimate administrative uses but is commonly abused by attackers.",evidence:[{type:"Event Log",content:"EventID 4688: Process PsExec.exe created"},{type:"Process",content:"Parent: cmd.exe, User: CORP\\admin_jsmith"}],historicalContext:"This user has used PsExec 3 times in the past month for legitimate patching.",expertGuidance:"Review the target systems and timing. PsExec usage outside maintenance windows is suspicious.",legitimateUseCases:["System patching","Remote administration","Incident response"],suspiciousIndicators:["Unusual timing (2:30 AM)","Multiple targets in sequence","SYSTEM privilege usage"]},{id:"2",title:"Bulk File Access",category:"data_theft",severity:"high",confidence:72,description:"Large number of files accessed from finance share in short timeframe.",evidence:[{type:"File Access",content:"1,247 files accessed in 15 minutes"},{type:"User Activity",content:"User: jsmith, Time: 02:35-02:50 AM"}],historicalContext:"User typically accesses 20-30 files per day during business hours.",expertGuidance:"This is a significant deviation from baseline. Check if there was authorized backup or migration.",legitimateUseCases:["Quarter-end reporting","Authorized backup","Department migration"],suspiciousIndicators:["Off-hours activity","6000% above baseline","Sensitive file types"]},{id:"3",title:"Scheduled Task Persistence",category:"persistence_mechanism",severity:"high",confidence:85,description:"New scheduled task created pointing to executable in Public folder.",evidence:[{type:"Task Details",content:"Task: WindowsUpdate, Action: C:\\Users\\Public\\update.exe"},{type:"Timing",content:"Created 3 minutes after initial compromise indicator"}],historicalContext:"No legitimate tasks have been created in Public folder in past year.",expertGuidance:"Tasks in Public folder are highly suspicious. Likely malicious persistence mechanism.",legitimateUseCases:["IT deployment scripts","Third-party installers"],suspiciousIndicators:["Public folder location","Generic task name","Timing correlation"]}];function kl(){const t=ne(),{goToNextStep:s,goToPreviousStep:a}=Z(),[r,n]=v.useState(0),[i,o]=v.useState({}),[l,c]=v.useState(""),m=ve[r],p=ve.length,f=Object.keys(i).length,g=()=>{a(),t("/timeline")},S=()=>{s(),t("/report")},y=()=>{r>0&&(n(r-1),c(""))},b=()=>{r<p-1&&(n(r+1),c(""))},w=N=>{o({...i,[m.id]:N})},D=()=>{const N={...i};ve.forEach(d=>{N[d.id]||(N[d.id]="needs_investigation")}),o(N)},h=i[m.id];return e.jsxs(ge,{title:"Verification Wizard",subtitle:"Review and classify ambiguous findings",footer:e.jsx(ke,{onBack:g,backLabel:"Timeline",onContinue:S,continueLabel:"Generate Report",continueDisabled:f<p}),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:["Finding ",r+1," of ",p]}),e.jsx(ht,{value:f/p*100,className:"w-32"}),e.jsxs("span",{className:"text-sm text-slate-500",children:[f," reviewed"]})]}),e.jsx(k,{content:"Accept defaults for remaining items",children:e.jsx(P,{variant:"ghost",size:"sm",onClick:D,leftIcon:e.jsx(Xa,{className:"w-4 h-4"}),children:"Skip All"})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(T,{className:"min-h-[500px]",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs(Q,{variant:"secondary",children:["#",r+1]}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:m.title})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qt,{severity:m.severity}),e.jsx(Q,{variant:"info",children:m.category.replace("_"," ")})]})]}),e.jsx("div",{className:"text-right",children:e.jsx(k,{content:"Automated confidence level",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-slate-500",children:"Confidence"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ht,{value:m.confidence,size:"sm",className:"w-16",variant:m.confidence>75?"danger":m.confidence>50?"warning":"default"}),e.jsxs("span",{className:"text-sm font-medium",children:[m.confidence,"%"]})]})]})})})]}),e.jsx("div",{className:"mb-6",children:e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:m.description})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Evidence"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:m.evidence.map((N,d)=>e.jsx(k,{content:"View complete evidence",children:e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(bt,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:N.type})]}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300 line-clamp-2",children:N.content})]})},d))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Classification"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(k,{content:"Confirm this activity as malicious based on evidence",children:e.jsxs("button",{onClick:()=>w("malicious"),className:u("flex-1 flex items-center justify-center gap-2 p-3 rounded-lg border-2 transition-colors",h==="malicious"?"border-red-500 bg-red-50 dark:bg-red-900/20":"border-slate-200 dark:border-slate-700 hover:border-red-300"),children:[e.jsx(He,{className:u("w-5 h-5",h==="malicious"?"text-red-500":"text-slate-400")}),e.jsx("span",{className:u("font-medium",h==="malicious"?"text-red-700 dark:text-red-300":"text-slate-600 dark:text-slate-400"),children:"Malicious"})]})}),e.jsx(k,{content:"Mark as legitimate activity",children:e.jsxs("button",{onClick:()=>w("benign"),className:u("flex-1 flex items-center justify-center gap-2 p-3 rounded-lg border-2 transition-colors",h==="benign"?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-slate-200 dark:border-slate-700 hover:border-green-300"),children:[e.jsx(B,{className:u("w-5 h-5",h==="benign"?"text-green-500":"text-slate-400")}),e.jsx("span",{className:u("font-medium",h==="benign"?"text-green-700 dark:text-green-300":"text-slate-600 dark:text-slate-400"),children:"Benign"})]})}),e.jsx(k,{content:"Flag for deeper analysis",children:e.jsxs("button",{onClick:()=>w("needs_investigation"),className:u("flex-1 flex items-center justify-center gap-2 p-3 rounded-lg border-2 transition-colors",h==="needs_investigation"?"border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20":"border-slate-200 dark:border-slate-700 hover:border-yellow-300"),children:[e.jsx(Xt,{className:u("w-5 h-5",h==="needs_investigation"?"text-yellow-500":"text-slate-400")}),e.jsx("span",{className:u("font-medium",h==="needs_investigation"?"text-yellow-700 dark:text-yellow-300":"text-slate-600 dark:text-slate-400"),children:"Investigate"})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 block",children:"Justification (optional)"}),e.jsx("textarea",{value:l,onChange:N=>c(N.target.value),placeholder:"Add notes for your decision...",className:"input min-h-[80px]"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(P,{variant:"ghost",onClick:y,disabled:r===0,leftIcon:e.jsx(Ka,{className:"w-4 h-4"}),children:"Previous"}),e.jsx("div",{className:"flex gap-1",children:ve.map((N,d)=>e.jsx("button",{onClick:()=>n(d),className:u("w-3 h-3 rounded-full transition-colors",d===r?"bg-forensic-500":i[ve[d].id]?i[ve[d].id]==="malicious"?"bg-red-500":i[ve[d].id]==="benign"?"bg-green-500":"bg-yellow-500":"bg-slate-300 dark:bg-slate-600")},d))}),e.jsx(P,{variant:"ghost",onClick:b,disabled:r===p-1,rightIcon:e.jsx(re,{className:"w-4 h-4"}),children:"Next"})]})]})}),e.jsx("div",{children:e.jsxs(T,{className:"sticky top-24",children:[e.jsx(H,{title:"Context"}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Qa,{className:"w-4 h-4 text-slate-400"}),e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Historical Context"})]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:m.historicalContext})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ht,{className:"w-4 h-4 text-yellow-500"}),e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Expert Guidance"})]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:m.expertGuidance})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Legitimate Use Cases"}),e.jsx("ul",{className:"space-y-1",children:m.legitimateUseCases.map((N,d)=>e.jsxs("li",{className:"text-sm text-slate-600 dark:text-slate-400 flex items-center gap-2",children:[e.jsx(B,{className:"w-3 h-3 text-green-500"}),N]},d))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Suspicious Indicators"}),e.jsx("ul",{className:"space-y-1",children:m.suspiciousIndicators.map((N,d)=>e.jsxs("li",{className:"text-sm text-slate-600 dark:text-slate-400 flex items-center gap-2",children:[e.jsx(qe,{className:"w-3 h-3 text-red-500"}),N]},d))})]})]})]})})]})]})}const Sl=[{priority:"immediate",title:"Isolate affected systems",status:"pending",tooltip:"Network-isolate all compromised systems to prevent further lateral movement and data exfiltration.",example:'Disable network ports for WS-FIN-042, DC-MAIN-01 on the switch. Use firewall rules to block inter-VLAN traffic from Finance segment. In Palo Alto: set security policy deny from zone "Finance" to zone "any".',steps:["Identify all confirmed compromised hosts","Disable switch ports or apply ACLs","Block C2 IPs at perimeter firewall","Monitor for new outbound connections"],affectedAssets:[{name:"WS-FIN-042",type:"Workstation",os:"Windows 10",ip:"10.0.2.42",severity:"critical"},{name:"DC-MAIN-01",type:"Domain Controller",os:"Windows Server 2022",ip:"10.0.1.10",severity:"critical"},{name:"FS-FINANCE-01",type:"File Server",os:"Windows Server 2019",ip:"10.0.2.20",severity:"high"}]},{priority:"immediate",title:"Reset compromised credentials",status:"pending",tooltip:"Force password reset for all compromised accounts including service accounts. Revoke all active tokens and sessions.",example:'In Active Directory: Right-click user  Reset Password  Check "User must change password at next logon". For service accounts: Update password in AD and all services referencing it. Revoke Azure AD tokens: Revoke-AzureADUserAllRefreshToken -ObjectId <user-object-id>',steps:["Reset passwords for jsmith, admin.jsmith, svc-backup","Revoke all OAuth tokens and API keys","Invalidate Kerberos TGTs (krbtgt reset twice)","Update service account passwords in all dependent services"],affectedAssets:[{name:"jsmith@company.com",type:"User Account",os:"AD/Azure AD",ip:"-",severity:"critical"},{name:"admin.jsmith",type:"Admin Account",os:"Active Directory",ip:"-",severity:"critical"},{name:"svc-backup",type:"Service Account",os:"Active Directory",ip:"-",severity:"high"}]},{priority:"short_term",title:"Implement MFA for all admin accounts",status:"pending",tooltip:"Deploy multi-factor authentication for all privileged accounts to prevent credential-based attacks.",example:'Azure AD: Security  MFA  Conditional Access  New Policy  Target: "All Admin Roles"  Grant: "Require MFA". For on-prem: Deploy Duo or Azure MFA Server for RDP and VPN access. Use FIDO2 keys for domain admins.',steps:["Audit all accounts with admin privileges","Enable Azure AD Conditional Access with MFA requirement","Deploy hardware tokens (FIDO2) for domain admins","Configure MFA for VPN and RDP gateways"],affectedAssets:[{name:"All Admin Accounts",type:"Identity",os:"Azure AD / AD",ip:"-",severity:"high"},{name:"VPN Gateway",type:"Network Device",os:"Palo Alto GlobalProtect",ip:"10.0.0.1",severity:"high"}]},{priority:"short_term",title:"Deploy EDR solution",status:"pending",tooltip:"Install endpoint detection and response (EDR) on all endpoints for real-time threat detection and automated response.",example:'Deploy CrowdStrike Falcon or Microsoft Defender for Endpoint. Use Group Policy to push MSI: msiexec /i WindowsSensor.exe CID=<your-customer-id> /quiet. Set detection policy to "Extra Aggressive" during incident recovery.',steps:["Select EDR vendor (CrowdStrike, SentinelOne, MDE)","Deploy agent to all Windows and Linux endpoints via GPO/SCCM","Configure detection policies and automated response","Integrate with SIEM for centralized alerting"],affectedAssets:[{name:"All Endpoints",type:"Fleet",os:"Windows/Linux",ip:"Multiple",severity:"medium"},{name:"DC-MAIN-01",type:"Domain Controller",os:"Windows Server 2022",ip:"10.0.1.10",severity:"critical"}]},{priority:"long_term",title:"Security awareness training",status:"pending",tooltip:"Conduct organization-wide security awareness training with focus on phishing identification and reporting procedures.",example:'Use KnowBe4 or Proofpoint Security Awareness: Set up monthly phishing simulations. Track click rates by department. Finance dept gets additional targeted training due to this incident. Add "Report Phish" button to Outlook.',steps:["Select awareness training platform","Conduct baseline phishing simulation","Deploy monthly phishing tests with increasing difficulty","Require completion of anti-phishing training module","Implement phishing report button in email client"],affectedAssets:[{name:"Finance Department",type:"Department",os:"-",ip:"-",severity:"high"},{name:"All Employees",type:"Organization",os:"-",ip:"-",severity:"medium"}]}],Cl=[{category:"Detection",current:2,target:4,gap:"No behavioral analytics",remediation:"Deploy UEBA solution (e.g., Microsoft Sentinel UEBA, Exabeam) to detect anomalous user behavior patterns like unusual login times, impossible travel, and mass file access.",example:"In Microsoft Sentinel: Analytics  UEBA  Enable for all users. Configure detection rules for: Anomalous login locations, First-time VPN connections, Mass file downloads exceeding baseline by 3x."},{category:"Response",current:3,target:4,gap:"Manual playbooks only",remediation:"Implement SOAR platform (e.g., Palo Alto XSOAR, Splunk SOAR) to automate incident response playbooks for common scenarios like phishing, ransomware, and unauthorized access.",example:"Create automated playbook: Phishing detected  Extract IOCs  Block sender in email gateway  Search mailboxes for similar  Isolate affected endpoints  Notify SOC analyst  Create ticket."},{category:"Prevention",current:2,target:5,gap:"Limited email security",remediation:"Upgrade email security with advanced threat protection: sandboxing, URL rewriting, impersonation protection, and DMARC/DKIM/SPF enforcement.",example:"Deploy Proofpoint or Mimecast ATP. Configure: Attachment sandboxing (detonate in VM), URL rewriting with click-time analysis, Brand impersonation protection, DMARC policy p=reject."}];function Dl(){const t=ne(),{goToPreviousStep:s}=Z(),[a,r]=v.useState("pdf"),[n,i]=v.useState(!1),[o,l]=v.useState(!0),[c,m]=v.useState(null),[p,f]=v.useState(null),[g,S]=v.useState(!1),y=()=>{s(),t("/verification")},b=()=>{alert(`Exporting report as ${a.toUpperCase()}...`)},w=()=>{t("/")},D={incidentSummary:"Ransomware attack via phishing email targeting finance department",affectedSystems:12,totalFindings:23,criticalFindings:5,timeToDetection:"4 hours",dataAtRisk:"Customer PII, Financial Records",businessImpact:{operational:"high",financial:"medium",reputational:"low",regulatory:"high"}};return e.jsx(ge,{title:"Report Generation",subtitle:"Review and export the investigation report",footer:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(P,{variant:"ghost",onClick:y,children:"Back to Verification"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"secondary",onClick:w,children:"New Investigation"}),e.jsx(k,{content:`Export report as ${a.toUpperCase()}`,children:e.jsx(P,{onClick:b,leftIcon:e.jsx($e,{className:"w-4 h-4"}),children:"Export Report"})})]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsx(T,{className:"bg-gradient-to-br from-slate-50 to-white dark:from-slate-800 dark:to-slate-800/50",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-forensic-100 dark:bg-forensic-900/30 rounded-lg",children:e.jsx(pe,{className:"w-6 h-6 text-forensic-600 dark:text-forensic-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 mb-2",children:"Executive Summary"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-4",children:D.incidentSummary}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsx(ot,{icon:e.jsx(Cs,{className:"w-4 h-4"}),label:"Affected Systems",value:D.affectedSystems}),e.jsx(ot,{icon:e.jsx(qe,{className:"w-4 h-4"}),label:"Total Findings",value:D.totalFindings,subValue:`${D.criticalFindings} critical`}),e.jsx(ot,{icon:e.jsx(Ke,{className:"w-4 h-4"}),label:"Time to Detect",value:D.timeToDetection}),e.jsx(ot,{icon:e.jsx(Te,{className:"w-4 h-4"}),label:"Data at Risk",value:D.dataAtRisk,small:!0})]})]})]})}),e.jsxs(T,{children:[e.jsxs("button",{onClick:()=>S(!g),className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bt,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Attack Chain Visualization"})]}),g?e.jsx(he,{className:"w-5 h-5 text-slate-400"}):e.jsx(re,{className:"w-5 h-5 text-slate-400"})]}),g&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsx("div",{className:"flex items-center gap-1 overflow-x-auto pb-2",children:[{phase:"Initial Access",icon:e.jsx(Ye,{className:"w-3 h-3"}),color:"bg-red-500"},{phase:"Execution",icon:e.jsx(Te,{className:"w-3 h-3"}),color:"bg-red-600"},{phase:"Persistence",icon:e.jsx(Ps,{className:"w-3 h-3"}),color:"bg-orange-500"},{phase:"Priv. Escalation",icon:e.jsx(Is,{className:"w-3 h-3"}),color:"bg-orange-600"},{phase:"Lateral Movement",icon:e.jsx(Ne,{className:"w-3 h-3"}),color:"bg-yellow-500"},{phase:"Collection",icon:e.jsx(Pe,{className:"w-3 h-3"}),color:"bg-yellow-600"},{phase:"Exfiltration",icon:e.jsx(q,{className:"w-3 h-3"}),color:"bg-purple-500"},{phase:"Impact",icon:e.jsx(Ge,{className:"w-3 h-3"}),color:"bg-red-700"}].map((h,N,d)=>e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:u("flex items-center gap-1 px-2 py-1 rounded text-white text-[10px] font-medium whitespace-nowrap",h.color),children:[h.icon,h.phase]}),N<d.length-1&&e.jsx(Yt,{className:"w-3 h-3 text-slate-300 mx-0.5 flex-shrink-0"})]},N))}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/10 rounded-lg border border-red-200 dark:border-red-900/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Bt,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"text-xs font-medium text-red-700 dark:text-red-400",children:"Threat Actor"})]}),e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400",children:"External, IP: 185.220.101.42"}),e.jsx("p",{className:"text-xs text-red-500",children:"Tools: PsExec, Mimikatz"})]}),e.jsxs("div",{className:"p-3 bg-orange-50 dark:bg-orange-900/10 rounded-lg border border-orange-200 dark:border-orange-900/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ja,{className:"w-4 h-4 text-orange-500"}),e.jsx("span",{className:"text-xs font-medium text-orange-700 dark:text-orange-400",children:"Compromised Users"})]}),e.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400",children:"jsmith, admin.jsmith, svc-backup"}),e.jsx("p",{className:"text-xs text-orange-500",children:"3 accounts compromised"})]}),e.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900/10 rounded-lg border border-purple-200 dark:border-purple-900/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Y,{className:"w-4 h-4 text-purple-500"}),e.jsx("span",{className:"text-xs font-medium text-purple-700 dark:text-purple-400",children:"Affected Systems"})]}),e.jsx("p",{className:"text-xs text-purple-600 dark:text-purple-400",children:"12 systems across 4 segments"}),e.jsx("p",{className:"text-xs text-purple-500",children:"5 critical, 4 high, 3 medium"})]})]})]})]}),e.jsxs(T,{children:[e.jsx(H,{title:"Business Impact Assessment",description:"Impact across key business dimensions"}),e.jsx("div",{className:"mt-4 grid grid-cols-2 sm:grid-cols-4 gap-4",children:Object.entries(D.businessImpact).map(([h,N])=>e.jsx(Pl,{dimension:h,level:N},h))})]}),e.jsxs(T,{children:[e.jsx(H,{title:"Recommendations & Mitigations",description:"Prioritized actions with implementation guidance"}),e.jsx("div",{className:"mt-4 space-y-3",children:Sl.map((h,N)=>e.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>m(c===N?null:N),className:"w-full flex items-center gap-3 p-3 hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsx(Q,{variant:h.priority==="immediate"?"danger":h.priority==="short_term"?"warning":"info",size:"sm",children:h.priority.replace("_"," ")}),e.jsx("span",{className:"flex-1 text-sm text-slate-700 dark:text-slate-300 text-left",children:h.title}),e.jsx(k,{content:h.tooltip,children:e.jsx(Vt,{className:"w-4 h-4 text-slate-400 hover:text-forensic-500"})}),e.jsx(Q,{variant:"secondary",size:"sm",children:h.status}),c===N?e.jsx(he,{className:"w-4 h-4 text-slate-400"}):e.jsx(re,{className:"w-4 h-4 text-slate-400"})]}),c===N&&e.jsxs("div",{className:"px-4 pb-4 space-y-4 border-t border-slate-200 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-800/30",children:[e.jsxs("div",{className:"pt-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(as,{className:"w-4 h-4 text-forensic-500"}),e.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase",children:"Implementation Steps"})]}),e.jsx("ol",{className:"space-y-1.5 ml-4",children:h.steps.map((d,C)=>e.jsxs("li",{className:"text-xs text-slate-600 dark:text-slate-400 flex gap-2",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-forensic-100 dark:bg-forensic-900/30 text-forensic-600 dark:text-forensic-400 flex items-center justify-center text-[10px] font-bold flex-shrink-0",children:C+1}),d]},C))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ht,{className:"w-4 h-4 text-yellow-500"}),e.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase",children:"Practical Example"})]}),e.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/10 border border-yellow-200 dark:border-yellow-900/50 rounded-lg",children:e.jsx("p",{className:"text-xs text-yellow-800 dark:text-yellow-300 leading-relaxed",children:h.example})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ie,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{className:"text-xs font-medium text-slate-500 uppercase",children:["Affected Assets (",h.affectedAssets.length,")"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-slate-400 uppercase",children:[e.jsx("th",{className:"pb-1.5 pr-3",children:"Asset"}),e.jsx("th",{className:"pb-1.5 pr-3",children:"Type"}),e.jsx("th",{className:"pb-1.5 pr-3",children:"OS/Platform"}),e.jsx("th",{className:"pb-1.5 pr-3",children:"IP"}),e.jsx("th",{className:"pb-1.5",children:"Severity"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:h.affectedAssets.map((d,C)=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-1.5 pr-3 font-medium text-slate-700 dark:text-slate-300",children:d.name}),e.jsx("td",{className:"py-1.5 pr-3 text-slate-500",children:d.type}),e.jsx("td",{className:"py-1.5 pr-3 text-slate-500",children:d.os}),e.jsx("td",{className:"py-1.5 pr-3 font-mono text-slate-500",children:d.ip}),e.jsx("td",{className:"py-1.5",children:e.jsx("span",{className:u("px-1.5 py-0.5 rounded text-[10px] font-medium",d.severity==="critical"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":d.severity==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"),children:d.severity})})]},C))})]})})]})]})]},N))})]}),e.jsxs(T,{children:[e.jsx(H,{title:"Gap Analysis",description:"Security maturity assessment with remediation guidance"}),e.jsx("div",{className:"mt-4 space-y-4",children:Cl.map((h,N)=>e.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>f(p===N?null:N),className:"w-full p-3 hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:h.category}),e.jsx(k,{content:h.remediation,children:e.jsx(Vt,{className:"w-3.5 h-3.5 text-slate-400 hover:text-forensic-500"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-slate-500",children:[h.current,"/",h.target]}),p===N?e.jsx(he,{className:"w-4 h-4 text-slate-400"}):e.jsx(re,{className:"w-4 h-4 text-slate-400"})]})]}),e.jsx(ht,{value:h.current/h.target*100,variant:h.current<h.target*.5?"danger":"warning"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1 text-left",children:h.gap})]}),p===N&&e.jsxs("div",{className:"px-4 pb-4 space-y-3 border-t border-slate-200 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-800/30",children:[e.jsxs("div",{className:"pt-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(as,{className:"w-4 h-4 text-forensic-500"}),e.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase",children:"Remediation Plan"})]}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400 leading-relaxed",children:h.remediation})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ht,{className:"w-4 h-4 text-yellow-500"}),e.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase",children:"Example Configuration"})]}),e.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/10 border border-yellow-200 dark:border-yellow-900/50 rounded-lg",children:e.jsx("p",{className:"text-xs text-yellow-800 dark:text-yellow-300 leading-relaxed",children:h.example})})]})]})]},N))})]})]}),e.jsx("div",{children:e.jsxs(T,{className:"sticky top-24",children:[e.jsx(H,{title:"Export Options"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 block",children:"Format"}),e.jsx("div",{className:"space-y-2",children:[{id:"pdf",icon:e.jsx(bt,{className:"w-4 h-4"}),label:"PDF Document"},{id:"html",icon:e.jsx(rs,{className:"w-4 h-4"}),label:"Interactive HTML"},{id:"json",icon:e.jsx(rs,{className:"w-4 h-4"}),label:"JSON Data"}].map(h=>e.jsx(k,{content:`Export as ${h.label}`,children:e.jsxs("button",{onClick:()=>r(h.id),className:u("w-full flex items-center gap-2 p-2 rounded-lg border transition-colors",a===h.id?"border-forensic-500 bg-forensic-50 dark:bg-forensic-900/20":"border-slate-200 dark:border-slate-700 hover:border-slate-300"),children:[h.icon,e.jsx("span",{className:"text-sm",children:h.label}),a===h.id&&e.jsx(B,{className:"w-4 h-4 text-forensic-500 ml-auto"})]})},h.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 block",children:"Content Options"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{content:"Include raw log data in export",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:n,onChange:h=>i(h.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Include raw logs"})]})}),e.jsx(k,{content:"Automatically redact sensitive data",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:h=>l(h.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Redact sensitive data"})]})})]})]}),e.jsxs("div",{className:"pt-4 border-t border-slate-200 dark:border-slate-700 space-y-2",children:[e.jsx(k,{content:"Generate downloadable PDF report with current findings",children:e.jsx(P,{fullWidth:!0,onClick:b,leftIcon:e.jsx($e,{className:"w-4 h-4"}),children:"Export Report"})}),e.jsx(k,{content:"Open print preview",children:e.jsx(P,{variant:"outline",fullWidth:!0,leftIcon:e.jsx(Za,{className:"w-4 h-4"}),children:"Print Preview"})}),e.jsx(k,{content:"Generate shareable link",children:e.jsx(P,{variant:"ghost",fullWidth:!0,leftIcon:e.jsx(er,{className:"w-4 h-4"}),children:"Share Link"})})]})]})]})})]})})}function ot({icon:t,label:s,value:a,subValue:r,small:n}){return e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-1",children:[t,e.jsx("span",{className:"text-xs",children:s})]}),e.jsx("p",{className:u("font-bold text-slate-900 dark:text-slate-100",n?"text-sm":"text-lg"),children:a}),r&&e.jsx("p",{className:"text-xs text-red-500",children:r})]})}function Pl({dimension:t,level:s}){const a={low:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",high:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"};return e.jsxs("div",{className:"text-center p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase mb-1 capitalize",children:t}),e.jsx("span",{className:u("px-3 py-1 rounded-full text-sm font-medium capitalize",a[s]),children:s})]})}function Il(){return e.jsx(Er,{delayDuration:300,children:e.jsxs(ya,{children:[e.jsx(K,{path:"/",element:e.jsx(rl,{})}),e.jsx(K,{path:"/context",element:e.jsx(ol,{})}),e.jsx(K,{path:"/incident",element:e.jsx(dl,{})}),e.jsx(K,{path:"/connectors",element:e.jsx(xl,{})}),e.jsx(K,{path:"/validation",element:e.jsx(hl,{})}),e.jsx(K,{path:"/triage",element:e.jsx(gl,{})}),e.jsx(K,{path:"/timeline",element:e.jsx(yl,{})}),e.jsx(K,{path:"/verification",element:e.jsx(kl,{})}),e.jsx(K,{path:"/report",element:e.jsx(Dl,{})}),e.jsx(K,{path:"*",element:e.jsx(wa,{to:"/",replace:!0})})]})})}zs.getState().initializeTheme();const Al="/SSF/".replace(/\/$/,"")||"/";Ut.createRoot(document.getElementById("root")).render(e.jsx(Be.StrictMode,{children:e.jsx(Na,{basename:Al,children:e.jsx(Il,{})})}));
//# sourceMappingURL=index-4ShYMHOe.js.map
