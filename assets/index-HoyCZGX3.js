import{j as e,R as Es,T as Os,P as Rs,C as Fs,A as Ls,a as _s,b as zs,I as Ws,c as Vs,d as Bs,O as Us,e as Hs,f as Gs,D as $s,g as Ys}from"./radix-uGlnZHxF.js";import{a as qs,r as N,c as Oe,L as Xs,u as Z,d as Qs,e as $,N as Ks,B as Js}from"./vendor-DrAsnYEO.js";import{c as Zs,A as ea,m as At,a as tt,T as ta,L as wt,U as be,b as Nt,G as Le,B as sa,C as ke,d as aa,e as V,S as Y,N as _e,f as xe,g as gt,K as st,h as ra,F as at,E as kt,X as St,i as je,j as me,k as na,l as ia,n as ft,o as as,M as la,P as oa,p as Tt,q as rs,H as ve,r as ca,s as ot,t as ze,D as qe,u as da,v as ma,w as ye,x as ne,y as xa,z as ua,I as Xe,J as Qe,O as Ct,Q as rt,R as ha,V as pa,W as ns,Y as Et,Z as ga,_ as Ot,$ as is,a0 as we,a1 as fa,a2 as ba,a3 as Rt,a4 as Ke,a5 as ls,a6 as ja,a7 as os,a8 as cs,a9 as va,aa as ya,ab as wa,ac as Na,ad as ka,ae as Sa,af as bt,ag as Ca,ah as Ft,ai as Lt,aj as _t,ak as Da,al as Pa}from"./ui--1hEdNqh.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function a(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=a(n);fetch(n.href,i)}})();var jt={},zt=qs;jt.createRoot=zt.createRoot,jt.hydrateRoot=zt.hydrateRoot;const Dt="-",Ma=t=>{const s=Aa(t),{conflictingClassGroups:a,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:o=>{const l=o.split(Dt);return l[0]===""&&l.length!==1&&l.shift(),ds(l,s)||Ia(o)},getConflictingClassGroupIds:(o,l)=>{const c=a[o]||[];return l&&r[o]?[...c,...r[o]]:c}}},ds=(t,s)=>{var o;if(t.length===0)return s.classGroupId;const a=t[0],r=s.nextPart.get(a),n=r?ds(t.slice(1),r):void 0;if(n)return n;if(s.validators.length===0)return;const i=t.join(Dt);return(o=s.validators.find(({validator:l})=>l(i)))==null?void 0:o.classGroupId},Wt=/^\[(.+)\]$/,Ia=t=>{if(Wt.test(t)){const s=Wt.exec(t)[1],a=s==null?void 0:s.substring(0,s.indexOf(":"));if(a)return"arbitrary.."+a}},Aa=t=>{const{theme:s,prefix:a}=t,r={nextPart:new Map,validators:[]};return Ea(Object.entries(t.classGroups),a).forEach(([i,o])=>{vt(o,r,i,s)}),r},vt=(t,s,a,r)=>{t.forEach(n=>{if(typeof n=="string"){const i=n===""?s:Vt(s,n);i.classGroupId=a;return}if(typeof n=="function"){if(Ta(n)){vt(n(r),s,a,r);return}s.validators.push({validator:n,classGroupId:a});return}Object.entries(n).forEach(([i,o])=>{vt(o,Vt(s,i),a,r)})})},Vt=(t,s)=>{let a=t;return s.split(Dt).forEach(r=>{a.nextPart.has(r)||a.nextPart.set(r,{nextPart:new Map,validators:[]}),a=a.nextPart.get(r)}),a},Ta=t=>t.isThemeGetter,Ea=(t,s)=>s?t.map(([a,r])=>{const n=r.map(i=>typeof i=="string"?s+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,l])=>[s+o,l])):i);return[a,n]}):t,Oa=t=>{if(t<1)return{get:()=>{},set:()=>{}};let s=0,a=new Map,r=new Map;const n=(i,o)=>{a.set(i,o),s++,s>t&&(s=0,r=a,a=new Map)};return{get(i){let o=a.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return n(i,o),o},set(i,o){a.has(i)?a.set(i,o):n(i,o)}}},ms="!",Ra=t=>{const{separator:s,experimentalParseClassName:a}=t,r=s.length===1,n=s[0],i=s.length,o=l=>{const c=[];let d=0,h=0,p;for(let m=0;m<l.length;m++){let w=l[m];if(d===0){if(w===n&&(r||l.slice(m,m+i)===s)){c.push(l.slice(h,m)),h=m+i;continue}if(w==="/"){p=m;continue}}w==="["?d++:w==="]"&&d--}const g=c.length===0?l:l.substring(h),k=g.startsWith(ms),j=k?g.substring(1):g,f=p&&p>h?p-h:void 0;return{modifiers:c,hasImportantModifier:k,baseClassName:j,maybePostfixModifierPosition:f}};return a?l=>a({className:l,parseClassName:o}):o},Fa=t=>{if(t.length<=1)return t;const s=[];let a=[];return t.forEach(r=>{r[0]==="["?(s.push(...a.sort(),r),a=[]):a.push(r)}),s.push(...a.sort()),s},La=t=>({cache:Oa(t.cacheSize),parseClassName:Ra(t),...Ma(t)}),_a=/\s+/,za=(t,s)=>{const{parseClassName:a,getClassGroupId:r,getConflictingClassGroupIds:n}=s,i=[],o=t.trim().split(_a);let l="";for(let c=o.length-1;c>=0;c-=1){const d=o[c],{modifiers:h,hasImportantModifier:p,baseClassName:g,maybePostfixModifierPosition:k}=a(d);let j=!!k,f=r(j?g.substring(0,k):g);if(!f){if(!j){l=d+(l.length>0?" "+l:l);continue}if(f=r(g),!f){l=d+(l.length>0?" "+l:l);continue}j=!1}const m=Fa(h).join(":"),w=p?m+ms:m,x=w+f;if(i.includes(x))continue;i.push(x);const v=n(f,j);for(let y=0;y<v.length;++y){const T=v[y];i.push(w+T)}l=d+(l.length>0?" "+l:l)}return l};function Wa(){let t=0,s,a,r="";for(;t<arguments.length;)(s=arguments[t++])&&(a=xs(s))&&(r&&(r+=" "),r+=a);return r}const xs=t=>{if(typeof t=="string")return t;let s,a="";for(let r=0;r<t.length;r++)t[r]&&(s=xs(t[r]))&&(a&&(a+=" "),a+=s);return a};function Va(t,...s){let a,r,n,i=o;function o(c){const d=s.reduce((h,p)=>p(h),t());return a=La(d),r=a.cache.get,n=a.cache.set,i=l,l(c)}function l(c){const d=r(c);if(d)return d;const h=za(c,a);return n(c,h),h}return function(){return i(Wa.apply(null,arguments))}}const F=t=>{const s=a=>a[t]||[];return s.isThemeGetter=!0,s},us=/^\[(?:([a-z-]+):)?(.+)\]$/i,Ba=/^\d+\/\d+$/,Ua=new Set(["px","full","screen"]),Ha=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Ga=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,$a=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,Ya=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,qa=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,K=t=>Ne(t)||Ua.has(t)||Ba.test(t),se=t=>Se(t,"length",sr),Ne=t=>!!t&&!Number.isNaN(Number(t)),ct=t=>Se(t,"number",Ne),De=t=>!!t&&Number.isInteger(Number(t)),Xa=t=>t.endsWith("%")&&Ne(t.slice(0,-1)),D=t=>us.test(t),ae=t=>Ha.test(t),Qa=new Set(["length","size","percentage"]),Ka=t=>Se(t,Qa,hs),Ja=t=>Se(t,"position",hs),Za=new Set(["image","url"]),er=t=>Se(t,Za,rr),tr=t=>Se(t,"",ar),Pe=()=>!0,Se=(t,s,a)=>{const r=us.exec(t);return r?r[1]?typeof s=="string"?r[1]===s:s.has(r[1]):a(r[2]):!1},sr=t=>Ga.test(t)&&!$a.test(t),hs=()=>!1,ar=t=>Ya.test(t),rr=t=>qa.test(t),nr=()=>{const t=F("colors"),s=F("spacing"),a=F("blur"),r=F("brightness"),n=F("borderColor"),i=F("borderRadius"),o=F("borderSpacing"),l=F("borderWidth"),c=F("contrast"),d=F("grayscale"),h=F("hueRotate"),p=F("invert"),g=F("gap"),k=F("gradientColorStops"),j=F("gradientColorStopPositions"),f=F("inset"),m=F("margin"),w=F("opacity"),x=F("padding"),v=F("saturate"),y=F("scale"),T=F("sepia"),b=F("skew"),C=F("space"),_=F("translate"),U=()=>["auto","contain","none"],H=()=>["auto","hidden","clip","visible","scroll"],le=()=>["auto",D,s],R=()=>[D,s],he=()=>["",K,se],G=()=>["auto",Ne,D],I=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],W=()=>["solid","dashed","dotted","double","none"],pe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Ce=()=>["start","end","center","between","around","evenly","stretch"],ee=()=>["","0",D],A=()=>["auto","avoid","all","avoid-page","page","left","right","column"],E=()=>[Ne,D];return{cacheSize:500,separator:":",theme:{colors:[Pe],spacing:[K,se],blur:["none","",ae,D],brightness:E(),borderColor:[t],borderRadius:["none","","full",ae,D],borderSpacing:R(),borderWidth:he(),contrast:E(),grayscale:ee(),hueRotate:E(),invert:ee(),gap:R(),gradientColorStops:[t],gradientColorStopPositions:[Xa,se],inset:le(),margin:le(),opacity:E(),padding:R(),saturate:E(),scale:E(),sepia:ee(),skew:E(),space:R(),translate:R()},classGroups:{aspect:[{aspect:["auto","square","video",D]}],container:["container"],columns:[{columns:[ae]}],"break-after":[{"break-after":A()}],"break-before":[{"break-before":A()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...I(),D]}],overflow:[{overflow:H()}],"overflow-x":[{"overflow-x":H()}],"overflow-y":[{"overflow-y":H()}],overscroll:[{overscroll:U()}],"overscroll-x":[{"overscroll-x":U()}],"overscroll-y":[{"overscroll-y":U()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[f]}],"inset-x":[{"inset-x":[f]}],"inset-y":[{"inset-y":[f]}],start:[{start:[f]}],end:[{end:[f]}],top:[{top:[f]}],right:[{right:[f]}],bottom:[{bottom:[f]}],left:[{left:[f]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",De,D]}],basis:[{basis:le()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",D]}],grow:[{grow:ee()}],shrink:[{shrink:ee()}],order:[{order:["first","last","none",De,D]}],"grid-cols":[{"grid-cols":[Pe]}],"col-start-end":[{col:["auto",{span:["full",De,D]},D]}],"col-start":[{"col-start":G()}],"col-end":[{"col-end":G()}],"grid-rows":[{"grid-rows":[Pe]}],"row-start-end":[{row:["auto",{span:[De,D]},D]}],"row-start":[{"row-start":G()}],"row-end":[{"row-end":G()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",D]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",D]}],gap:[{gap:[g]}],"gap-x":[{"gap-x":[g]}],"gap-y":[{"gap-y":[g]}],"justify-content":[{justify:["normal",...Ce()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Ce(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Ce(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[x]}],px:[{px:[x]}],py:[{py:[x]}],ps:[{ps:[x]}],pe:[{pe:[x]}],pt:[{pt:[x]}],pr:[{pr:[x]}],pb:[{pb:[x]}],pl:[{pl:[x]}],m:[{m:[m]}],mx:[{mx:[m]}],my:[{my:[m]}],ms:[{ms:[m]}],me:[{me:[m]}],mt:[{mt:[m]}],mr:[{mr:[m]}],mb:[{mb:[m]}],ml:[{ml:[m]}],"space-x":[{"space-x":[C]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[C]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",D,s]}],"min-w":[{"min-w":[D,s,"min","max","fit"]}],"max-w":[{"max-w":[D,s,"none","full","min","max","fit","prose",{screen:[ae]},ae]}],h:[{h:[D,s,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[D,s,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[D,s,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[D,s,"auto","min","max","fit"]}],"font-size":[{text:["base",ae,se]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ct]}],"font-family":[{font:[Pe]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",D]}],"line-clamp":[{"line-clamp":["none",Ne,ct]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",K,D]}],"list-image":[{"list-image":["none",D]}],"list-style-type":[{list:["none","disc","decimal",D]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[w]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...W(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",K,se]}],"underline-offset":[{"underline-offset":["auto",K,D]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:R()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",D]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",D]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[w]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...I(),Ja]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Ka]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},er]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[j]}],"gradient-via-pos":[{via:[j]}],"gradient-to-pos":[{to:[j]}],"gradient-from":[{from:[k]}],"gradient-via":[{via:[k]}],"gradient-to":[{to:[k]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[w]}],"border-style":[{border:[...W(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[w]}],"divide-style":[{divide:W()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-s":[{"border-s":[n]}],"border-color-e":[{"border-e":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["",...W()]}],"outline-offset":[{"outline-offset":[K,D]}],"outline-w":[{outline:[K,se]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:he()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[w]}],"ring-offset-w":[{"ring-offset":[K,se]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",ae,tr]}],"shadow-color":[{shadow:[Pe]}],opacity:[{opacity:[w]}],"mix-blend":[{"mix-blend":[...pe(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":pe()}],filter:[{filter:["","none"]}],blur:[{blur:[a]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",ae,D]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[p]}],saturate:[{saturate:[v]}],sepia:[{sepia:[T]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[a]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[p]}],"backdrop-opacity":[{"backdrop-opacity":[w]}],"backdrop-saturate":[{"backdrop-saturate":[v]}],"backdrop-sepia":[{"backdrop-sepia":[T]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",D]}],duration:[{duration:E()}],ease:[{ease:["linear","in","out","in-out",D]}],delay:[{delay:E()}],animate:[{animate:["none","spin","ping","pulse","bounce",D]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[y]}],"scale-x":[{"scale-x":[y]}],"scale-y":[{"scale-y":[y]}],rotate:[{rotate:[De,D]}],"translate-x":[{"translate-x":[_]}],"translate-y":[{"translate-y":[_]}],"skew-x":[{"skew-x":[b]}],"skew-y":[{"skew-y":[b]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",D]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",D]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":R()}],"scroll-mx":[{"scroll-mx":R()}],"scroll-my":[{"scroll-my":R()}],"scroll-ms":[{"scroll-ms":R()}],"scroll-me":[{"scroll-me":R()}],"scroll-mt":[{"scroll-mt":R()}],"scroll-mr":[{"scroll-mr":R()}],"scroll-mb":[{"scroll-mb":R()}],"scroll-ml":[{"scroll-ml":R()}],"scroll-p":[{"scroll-p":R()}],"scroll-px":[{"scroll-px":R()}],"scroll-py":[{"scroll-py":R()}],"scroll-ps":[{"scroll-ps":R()}],"scroll-pe":[{"scroll-pe":R()}],"scroll-pt":[{"scroll-pt":R()}],"scroll-pr":[{"scroll-pr":R()}],"scroll-pb":[{"scroll-pb":R()}],"scroll-pl":[{"scroll-pl":R()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",D]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[K,se,ct]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},ir=Va(nr);function u(...t){return ir(Zs(t))}const lr=_s;function S({content:t,children:s,side:a="top",align:r="center",delayDuration:n=300,disabled:i=!1,className:o}){return i||!t?e.jsx(e.Fragment,{children:s}):e.jsxs(Es,{delayDuration:n,children:[e.jsx(Os,{asChild:!0,children:s}),e.jsx(Rs,{children:e.jsxs(Fs,{side:a,align:r,sideOffset:5,className:u("z-50 overflow-hidden rounded-md px-3 py-1.5 text-sm","bg-slate-900 text-slate-50 dark:bg-slate-50 dark:text-slate-900","shadow-md animate-fade-in","max-w-xs",o),children:[t,e.jsx(Ls,{className:"fill-slate-900 dark:fill-slate-50",width:10,height:5})]})})]})}function ps({content:t,icon:s,className:a}){return e.jsx(S,{content:t,children:e.jsx("span",{className:u("inline-flex items-center justify-center","text-slate-400 hover:text-slate-600 dark:text-slate-500 dark:hover:text-slate-300","cursor-help",a),children:s||e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),e.jsx("path",{d:"M12 17h.01"})]})})})}const or={primary:u("bg-forensic-500 hover:bg-forensic-600 active:bg-forensic-700","text-white","border border-transparent","shadow-sm"),secondary:u("bg-slate-100 hover:bg-slate-200 active:bg-slate-300","dark:bg-slate-700 dark:hover:bg-slate-600 dark:active:bg-slate-500","text-slate-900 dark:text-slate-100","border border-transparent"),ghost:u("bg-transparent hover:bg-slate-100 active:bg-slate-200","dark:hover:bg-slate-800 dark:active:bg-slate-700","text-slate-700 dark:text-slate-300","border border-transparent"),danger:u("bg-red-500 hover:bg-red-600 active:bg-red-700","text-white","border border-transparent","shadow-sm"),outline:u("bg-transparent hover:bg-slate-50 active:bg-slate-100","dark:hover:bg-slate-800 dark:active:bg-slate-700","text-slate-700 dark:text-slate-300","border border-slate-300 dark:border-slate-600")},cr={sm:"h-8 px-3 text-sm gap-1.5",md:"h-10 px-4 text-sm gap-2",lg:"h-12 px-6 text-base gap-2.5"},P=N.forwardRef(({className:t,variant:s="primary",size:a="md",leftIcon:r,rightIcon:n,isLoading:i,tooltip:o,fullWidth:l,disabled:c,children:d,...h},p)=>{const g=e.jsxs("button",{ref:p,disabled:c||i,className:u("inline-flex items-center justify-center","font-medium rounded-lg","transition-colors duration-200","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-forensic-500 focus-visible:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none",or[s],cr[a],l&&"w-full",t),...h,children:[i?e.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):r,d,!i&&n]});return o?e.jsx(S,{content:o,children:g}):g});P.displayName="Button";const dr=N.forwardRef(({className:t,size:s="md",icon:a,...r},n)=>{const i={sm:"h-8 w-8",md:"h-10 w-10",lg:"h-12 w-12"};return e.jsx(P,{ref:n,size:s,className:u("!p-0",i[s],t),...r,children:a})});dr.displayName="IconButton";const mr={none:"",sm:"p-3",md:"p-4",lg:"p-6"},M=N.forwardRef(({className:t,hoverable:s=!1,selected:a=!1,padding:r="md",children:n,...i},o)=>e.jsx("div",{ref:o,className:u("bg-white dark:bg-slate-800","rounded-lg","border border-slate-200 dark:border-slate-700","shadow-sm",mr[r],s&&["transition-all duration-200","hover:shadow-md hover:border-slate-300 dark:hover:border-slate-600","cursor-pointer"],a&&["ring-2 ring-forensic-500 ring-offset-2 dark:ring-offset-slate-900","border-forensic-500"],t),...i,children:n}));M.displayName="Card";function z({className:t,title:s,description:a,action:r,children:n,...i}){return e.jsxs("div",{className:u("flex items-start justify-between gap-4",t),...i,children:[e.jsxs("div",{className:"space-y-1",children:[s&&e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:s}),a&&e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:a}),n]}),r&&e.jsx("div",{className:"flex-shrink-0",children:r})]})}const xr={default:"bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300",primary:"bg-forensic-100 text-forensic-800 dark:bg-forensic-900/30 dark:text-forensic-400",secondary:"bg-slate-100 text-slate-600 dark:bg-slate-700 dark:text-slate-400",success:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",warning:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",danger:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",info:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",critical:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",high:"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",low:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400"},ur={sm:"px-1.5 py-0.5 text-xs",md:"px-2.5 py-0.5 text-xs",lg:"px-3 py-1 text-sm"},hr={default:"bg-slate-500",primary:"bg-forensic-500",secondary:"bg-slate-400",success:"bg-green-500",warning:"bg-yellow-500",danger:"bg-red-500",info:"bg-blue-500",critical:"bg-red-500",high:"bg-orange-500",medium:"bg-yellow-500",low:"bg-green-500"};function q({className:t,variant:s="default",size:a="md",icon:r,dot:n,dotColor:i,children:o,...l}){return e.jsxs("span",{className:u("inline-flex items-center gap-1.5 font-medium rounded-full",xr[s],ur[a],t),...l,children:[n&&e.jsx("span",{className:u("w-1.5 h-1.5 rounded-full",i||hr[s])}),r&&e.jsx("span",{className:"flex-shrink-0",children:r}),o]})}function Pt({severity:t,size:s="md",className:a}){const r={critical:"Critical",high:"High",medium:"Medium",low:"Low",info:"Info"},n={critical:"critical",high:"high",medium:"medium",low:"low",info:"info"};return e.jsx(q,{variant:n[t],size:s,className:a,children:r[t]})}const pr={sm:"h-1",md:"h-2",lg:"h-3"},gr={default:"bg-forensic-500",success:"bg-green-500",warning:"bg-yellow-500",danger:"bg-red-500"};function Je({value:t,max:s=100,size:a="md",variant:r="default",showLabel:n=!1,animated:i=!0,className:o}){const l=Math.min(Math.max(t/s*100,0),100);return e.jsxs("div",{className:u("w-full",o),children:[n&&e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Progress"}),e.jsxs("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:[Math.round(l),"%"]})]}),e.jsx(zs,{value:t,max:s,className:u("w-full overflow-hidden rounded-full bg-slate-200 dark:bg-slate-700",pr[a]),children:e.jsx(Ws,{className:u("h-full rounded-full",gr[r],i&&"transition-all duration-300 ease-out"),style:{width:`${l}%`}})})]})}const fr={default:"stroke-forensic-500",success:"stroke-green-500",warning:"stroke-yellow-500",danger:"stroke-red-500"};function br({value:t,size:s=120,strokeWidth:a=8,showLabel:r=!0,variant:n="default",label:i,className:o}){const l=Math.min(Math.max(t,0),100),c=(s-a)/2,d=c*2*Math.PI,h=d-l/100*d;return e.jsxs("div",{className:u("relative inline-flex",o),children:[e.jsxs("svg",{width:s,height:s,className:"transform -rotate-90",children:[e.jsx("circle",{cx:s/2,cy:s/2,r:c,fill:"none",strokeWidth:a,className:"stroke-slate-200 dark:stroke-slate-700"}),e.jsx("circle",{cx:s/2,cy:s/2,r:c,fill:"none",strokeWidth:a,strokeLinecap:"round",className:u(fr[n],"transition-all duration-500 ease-out"),style:{strokeDasharray:d,strokeDashoffset:h}})]}),r&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:i||e.jsxs("span",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:[Math.round(l),"%"]})})]})}const jr={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"};function vr({size:t="md",className:s}){return e.jsxs("svg",{className:u("animate-spin text-forensic-500",jr[t],s),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}const yr={sm:"h-8 text-sm px-2",md:"h-10 text-sm px-3",lg:"h-12 text-base px-4"},Fe=N.forwardRef(({className:t,label:s,helperText:a,error:r,tooltip:n,required:i,leftAddon:o,rightAddon:l,inputSize:c="md",disabled:d,id:h,...p},g)=>{const k=h||N.useId();return e.jsxs("div",{className:u("w-full",t),children:[s&&e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsxs("label",{htmlFor:k,className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:[s,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),n&&e.jsx(ps,{content:n})]}),e.jsxs("div",{className:"relative",children:[o&&e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none text-slate-400",children:o}),e.jsx("input",{ref:g,id:k,disabled:d,className:u("w-full rounded-lg","bg-white dark:bg-slate-800","border border-slate-300 dark:border-slate-600","text-slate-900 dark:text-slate-100","placeholder:text-slate-400 dark:placeholder:text-slate-500","focus:ring-2 focus:ring-forensic-500 focus:border-transparent","disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-slate-50 dark:disabled:bg-slate-900","transition-colors duration-200",yr[c],o&&"pl-10",l&&"pr-10",r&&"border-red-500 focus:ring-red-500"),"aria-invalid":!!r,"aria-describedby":r?`${k}-error`:void 0,...p}),l&&e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-slate-400",children:l})]}),(a||r)&&e.jsx("p",{id:r?`${k}-error`:void 0,className:u("mt-1 text-sm",r?"text-red-500":"text-slate-500 dark:text-slate-400"),children:r||a})]})});Fe.displayName="Input";const gs=N.forwardRef(({className:t,label:s,helperText:a,error:r,tooltip:n,required:i,minRows:o=3,disabled:l,id:c,...d},h)=>{const p=c||N.useId();return e.jsxs("div",{className:u("w-full",t),children:[s&&e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsxs("label",{htmlFor:p,className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:[s,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),n&&e.jsx(ps,{content:n})]}),e.jsx("textarea",{ref:h,id:p,disabled:l,rows:o,className:u("w-full rounded-lg px-3 py-2","bg-white dark:bg-slate-800","border border-slate-300 dark:border-slate-600","text-slate-900 dark:text-slate-100","placeholder:text-slate-400 dark:placeholder:text-slate-500","focus:ring-2 focus:ring-forensic-500 focus:border-transparent","disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-slate-50 dark:disabled:bg-slate-900","transition-colors duration-200","resize-y",r&&"border-red-500 focus:ring-red-500"),"aria-invalid":!!r,"aria-describedby":r?`${p}-error`:void 0,...d}),(a||r)&&e.jsx("p",{id:r?`${p}-error`:void 0,className:u("mt-1 text-sm",r?"text-red-500":"text-slate-500 dark:text-slate-400"),children:r||a})]})});gs.displayName="Textarea";function wr({onSearch:t,onKeyDown:s,...a}){const r=n=>{n.key==="Enter"&&t&&t(n.currentTarget.value),s==null||s(n)};return e.jsx(Fe,{type:"search",leftAddon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),onKeyDown:r,...a})}const Nr={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl",full:"max-w-4xl"};function dt({open:t,onOpenChange:s,title:a,description:r,children:n,size:i="md",closeOnOverlayClick:o=!0,showCloseButton:l=!0,footer:c}){return e.jsx(Vs,{open:t,onOpenChange:s,children:e.jsx(ea,{children:t&&e.jsxs(Bs,{forceMount:!0,children:[e.jsx(Us,{asChild:!0,children:e.jsx(At.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm",onClick:o?()=>s(!1):void 0})}),e.jsx(Hs,{asChild:!0,children:e.jsxs(At.div,{initial:{opacity:0,scale:.95,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:10},transition:{duration:.2,ease:"easeOut"},className:u("fixed z-50 w-full","left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2","bg-white dark:bg-slate-800","rounded-xl shadow-xl","border border-slate-200 dark:border-slate-700","focus:outline-none","max-h-[85vh] overflow-hidden flex flex-col",Nr[i]),onClick:d=>d.stopPropagation(),children:[(a||l)&&e.jsxs("div",{className:"flex items-start justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{children:[a&&e.jsx(Gs,{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:a}),r&&e.jsx($s,{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:r})]}),l&&e.jsx(Ys,{asChild:!0,children:e.jsx("button",{className:u("rounded-lg p-1.5","text-slate-400 hover:text-slate-600 dark:text-slate-500 dark:hover:text-slate-300","hover:bg-slate-100 dark:hover:bg-slate-700","transition-colors duration-200","focus:outline-none focus:ring-2 focus:ring-forensic-500"),"aria-label":"Close",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:n}),c&&e.jsx("div",{className:"flex items-center justify-end gap-2 p-4 border-t border-slate-200 dark:border-slate-700",children:c})]})})]})})})}const Bt=t=>{let s;const a=new Set,r=(d,h)=>{const p=typeof d=="function"?d(s):d;if(!Object.is(p,s)){const g=s;s=h??(typeof p!="object"||p===null)?p:Object.assign({},s,p),a.forEach(k=>k(s,g))}},n=()=>s,l={setState:r,getState:n,getInitialState:()=>c,subscribe:d=>(a.add(d),()=>a.delete(d))},c=s=t(r,n,l);return l},kr=t=>t?Bt(t):Bt,Sr=t=>t;function Cr(t,s=Sr){const a=Oe.useSyncExternalStore(t.subscribe,Oe.useCallback(()=>s(t.getState()),[t,s]),Oe.useCallback(()=>s(t.getInitialState()),[t,s]));return Oe.useDebugValue(a),a}const Ut=t=>{const s=kr(t),a=r=>Cr(s,r);return Object.assign(a,s),a},nt=t=>t?Ut(t):Ut;function Dr(t,s){let a;try{a=t()}catch{return}return{getItem:n=>{var i;const o=c=>c===null?null:JSON.parse(c,void 0),l=(i=a.getItem(n))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(n,i)=>a.setItem(n,JSON.stringify(i,void 0)),removeItem:n=>a.removeItem(n)}}const yt=t=>s=>{try{const a=t(s);return a instanceof Promise?a:{then(r){return yt(r)(a)},catch(r){return this}}}catch(a){return{then(r){return this},catch(r){return yt(r)(a)}}}},Pr=(t,s)=>(a,r,n)=>{let i={storage:Dr(()=>window.localStorage),partialize:m=>m,version:0,merge:(m,w)=>({...w,...m}),...s},o=!1,l=0;const c=new Set,d=new Set;let h=i.storage;if(!h)return t((...m)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),a(...m)},r,n);const p=()=>{const m=i.partialize({...r()});return h.setItem(i.name,{state:m,version:i.version})},g=n.setState;n.setState=(m,w)=>(g(m,w),p());const k=t((...m)=>(a(...m),p()),r,n);n.getInitialState=()=>k;let j;const f=()=>{var m,w;if(!h)return;const x=++l;o=!1,c.forEach(y=>{var T;return y((T=r())!=null?T:k)});const v=((w=i.onRehydrateStorage)==null?void 0:w.call(i,(m=r())!=null?m:k))||void 0;return yt(h.getItem.bind(h))(i.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==i.version){if(i.migrate){const T=i.migrate(y.state,y.version);return T instanceof Promise?T.then(b=>[!0,b]):[!0,T]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var T;if(x!==l)return;const[b,C]=y;if(j=i.merge(C,(T=r())!=null?T:k),a(j,!0),b)return p()}).then(()=>{x===l&&(v==null||v(j,void 0),j=r(),o=!0,d.forEach(y=>y(j)))}).catch(y=>{x===l&&(v==null||v(void 0,y))})};return n.persist={setOptions:m=>{i={...i,...m},m.storage&&(h=m.storage)},clearStorage:()=>{h==null||h.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>f(),hasHydrated:()=>o,onHydrate:m=>(c.add(m),()=>{c.delete(m)}),onFinishHydration:m=>(d.add(m),()=>{d.delete(m)})},i.skipHydration||f(),j||k},fs=Pr,bs={THEME:"forensic-theme",SESSION:"forensic-session"},Ht=[{id:"endpoints",name:"Endpoints",description:"Collect data from workstations and servers",connectors:["windows","linux","macos"]},{id:"cloud",name:"Cloud Services",description:"Connect to cloud platforms and SaaS applications",connectors:["aws","azure","gcp","o365","gsuite"]},{id:"peripherals",name:"Network & Peripherals",description:"Access network devices and security appliances",connectors:["firewall","storage","email_gateway","proxy_waf"]}],Gt={windows:{name:"Windows",icon:"Monitor",description:"Windows Event Logs, Registry, File System"},linux:{name:"Linux",icon:"Terminal",description:"Auth logs, Syslog, File System artifacts"},macos:{name:"macOS",icon:"Apple",description:"Unified Logs, FSEvents, Keychain"},aws:{name:"AWS",icon:"Cloud",description:"CloudTrail, CloudWatch, VPC Flow Logs"},azure:{name:"Azure",icon:"Cloud",description:"Activity Logs, Azure AD, Sentinel"},gcp:{name:"Google Cloud",icon:"Cloud",description:"Cloud Audit Logs, VPC Flow Logs"},o365:{name:"Microsoft 365",icon:"Mail",description:"Unified Audit Logs, Exchange, SharePoint"},gsuite:{name:"Google Workspace",icon:"Mail",description:"Admin Reports, Gmail, Drive Activity"},firewall:{name:"Firewall",icon:"Shield",description:"Traffic logs, Rule changes, Threat events"},storage:{name:"Storage/NAS",icon:"HardDrive",description:"Access logs, File activity, Quota changes"},email_gateway:{name:"Email Gateway",icon:"MailWarning",description:"Message tracking, Threat filtering"},proxy_waf:{name:"Proxy/WAF",icon:"Globe",description:"Web traffic, Blocked requests, Attacks"}},Mr={ping:{name:"Ping/ICMP",description:"Send ICMP echo request to verify host is reachable"},dns:{name:"DNS Resolution",description:"Verify hostname resolves to documented IP address"},spn:{name:"SPN Check",description:"Validate Service Principal Name in Active Directory"},ad_lookup:{name:"AD Lookup",description:"Verify computer object exists in Active Directory"},port_scan:{name:"Port Scan",description:"Check if expected services are listening"},cert_check:{name:"Certificate Check",description:"Validate SSL/TLS certificate is valid"}},Ir={pdf:{name:"PDF",icon:"FileText",color:"text-red-500"},docx:{name:"Word",icon:"FileText",color:"text-blue-500"},xlsx:{name:"Excel",icon:"FileSpreadsheet",color:"text-green-500"},json:{name:"JSON",icon:"FileJson",color:"text-yellow-500"},yaml:{name:"YAML",icon:"FileCode",color:"text-purple-500"},visio:{name:"Visio",icon:"Network",color:"text-blue-600"}},Ar={github:{name:"GitHub",icon:"Github"},gitlab:{name:"GitLab",icon:"GitBranch"},sharepoint:{name:"SharePoint",icon:"FileStack"},bitbucket:{name:"Bitbucket",icon:"GitBranch"}},ge=[{id:"data_collection",name:"Data Collection",description:"Gathering logs and artifacts from configured sources",estimatedDuration:3e3,steps:5},{id:"log_analysis",name:"Log Analysis",description:"Parsing and analyzing collected log data",estimatedDuration:4e3,steps:8},{id:"artifact_extraction",name:"Artifact Extraction",description:"Extracting forensic artifacts from systems",estimatedDuration:2500,steps:4},{id:"correlation",name:"Correlation Engine",description:"Correlating events and building timeline",estimatedDuration:3500,steps:6},{id:"anomaly_detection",name:"Anomaly Detection",description:"Identifying suspicious patterns and behaviors",estimatedDuration:2e3,steps:3}];function Tr(){return typeof window>"u"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function mt(t){if(typeof document>"u")return;const s=document.documentElement;t==="dark"?s.classList.add("dark"):s.classList.remove("dark")}function $t(t){return t==="auto"?Tr():t}const js=nt()(fs((t,s)=>({mode:"auto",effectiveTheme:"light",setMode:a=>{const r=$t(a);mt(r),t({mode:a,effectiveTheme:r})},initializeTheme:()=>{const{mode:a}=s(),r=$t(a);mt(r),t({effectiveTheme:r}),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",i=>{const{mode:o}=s();if(o==="auto"){const l=i.matches?"dark":"light";mt(l),t({effectiveTheme:l})}})}}),{name:bs.THEME,partialize:t=>({mode:t.mode})})),oe=["dashboard","organization_context","incident_description","connector_config","infrastructure_validation","triage","timeline","verification","report"];function Er(){return`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function Or(t){const s=new Date;return{id:Er(),createdAt:s,lastModified:s,scenarioType:t||"custom",currentStep:1,isComplete:!1,connectors:[],timelineEvents:[],findings:[],verificationDecisions:[]}}const Q=nt()(fs((t,s)=>({currentSession:null,recentSessions:[],currentStep:"dashboard",createSession:a=>{const r=Or(a);t(n=>({currentSession:r,currentStep:"organization_context",recentSessions:[r,...n.recentSessions.slice(0,9)]}))},loadSession:a=>{const{recentSessions:r}=s(),n=r.find(i=>i.id===a);if(n){const i=n.currentStep,o=oe[i]||"dashboard";t({currentSession:{...n,lastModified:new Date},currentStep:o})}},updateSession:a=>{t(r=>{if(!r.currentSession)return r;const n={...r.currentSession,...a,lastModified:new Date};return{currentSession:n,recentSessions:r.recentSessions.map(i=>i.id===n.id?n:i)}})},deleteSession:a=>{t(r=>{var n;return{currentSession:((n=r.currentSession)==null?void 0:n.id)===a?null:r.currentSession,recentSessions:r.recentSessions.filter(i=>i.id!==a)}})},clearRecentSessions:()=>{t({recentSessions:[],currentSession:null})},setCurrentStep:a=>{const r=oe.indexOf(a);t(n=>({currentStep:a,currentSession:n.currentSession?{...n.currentSession,currentStep:r,lastModified:new Date}:null}))},goToNextStep:()=>{const{currentStep:a}=s(),r=oe.indexOf(a);if(r<oe.length-1){const n=oe[r+1];t(i=>({currentStep:n,currentSession:i.currentSession?{...i.currentSession,currentStep:r+1,lastModified:new Date}:null}))}},goToPreviousStep:()=>{const{currentStep:a}=s(),r=oe.indexOf(a);if(r>0){const n=oe[r-1];t(i=>({currentStep:n,currentSession:i.currentSession?{...i.currentSession,currentStep:r-1,lastModified:new Date}:null}))}},updateIncidentDescription:a=>{t(r=>{if(!r.currentSession)return r;const n=r.currentSession.incidentDescription||{naturalLanguage:"",startDate:new Date,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,patientZero:{hostname:"",type:"workstation"},iocs:[],criticalSystems:[],compromisedCredentials:[]};return{currentSession:{...r.currentSession,incidentDescription:{...n,...a},lastModified:new Date}}})},updateConnectors:a=>{t(r=>r.currentSession?{currentSession:{...r.currentSession,connectors:a,lastModified:new Date}}:r)},updateTriageState:a=>{t(r=>{if(!r.currentSession)return r;const n=r.currentSession.triageState||{status:"idle",overallProgress:0,phases:[],activityLog:[],findings:[],errors:[]};return{currentSession:{...r.currentSession,triageState:{...n,...a},lastModified:new Date}}})},addTimelineEvent:a=>{t(r=>r.currentSession?{currentSession:{...r.currentSession,timelineEvents:[...r.currentSession.timelineEvents,a],lastModified:new Date}}:r)},addFinding:a=>{t(r=>r.currentSession?{currentSession:{...r.currentSession,findings:[...r.currentSession.findings,a],lastModified:new Date}}:r)},addVerificationDecision:a=>{t(r=>r.currentSession?{currentSession:{...r.currentSession,verificationDecisions:[...r.currentSession.verificationDecisions,a],lastModified:new Date}}:r)}}),{name:bs.SESSION,partialize:t=>({currentSession:t.currentSession,recentSessions:t.recentSessions})})),Yt={systems:[],networks:[],processes:[],compliance:[],recoveryObjectives:[]};function J(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function Rr(t){await new Promise(i=>setTimeout(i,2e3+Math.random()*2e3));const s=[{id:J(),hostname:"DC-MAIN-01",ip:"10.0.1.10",role:"Domain Controller",criticality:"critical",sourceDocument:t.filename,os:"Windows Server 2022"},{id:J(),hostname:"FS-FINANCE-01",ip:"10.0.2.20",role:"File Server",criticality:"high",sourceDocument:t.filename,os:"Windows Server 2019"},{id:J(),hostname:"WEB-APP-01",ip:"10.0.3.30",role:"Web Application Server",criticality:"high",sourceDocument:t.filename,os:"Ubuntu 22.04"}],a=[{id:J(),name:"Corporate LAN",cidr:"10.0.0.0/16",vlan:10,description:"Main corporate network",sourceDocument:t.filename},{id:J(),name:"DMZ",cidr:"192.168.1.0/24",vlan:50,description:"Demilitarized zone for public services",sourceDocument:t.filename}],r=[{id:J(),name:"Financial Reporting",description:"Monthly financial reporting and compliance",criticality:"critical",rto:4,rpo:1,dependentSystems:["FS-FINANCE-01","DC-MAIN-01"],sourceDocument:t.filename}],n=[{id:J(),framework:"SOC2",requirement:"CC6.1",description:"Logical and physical access controls",applicableSystems:["DC-MAIN-01"],sourceDocument:t.filename}];return{systems:s,networks:a,processes:r,compliance:n,recoveryObjectives:r.map(i=>({processId:i.id,processName:i.name,rto:i.rto,rpo:i.rpo,tier:i.criticality==="critical"?1:i.criticality==="high"?2:3}))}}const vs=nt((t,s)=>({documents:[],repositories:[],extractedEntities:Yt,isParsingDocument:!1,isSyncingRepo:!1,addDocument:async a=>{var o;const r=J(),n=(o=a.name.split(".").pop())==null?void 0:o.toLowerCase(),i={id:r,filename:a.name,type:n||"pdf",size:a.size,uploadedAt:new Date,status:"uploading"};t(l=>({documents:[...l.documents,i]})),await new Promise(l=>setTimeout(l,500)),t(l=>({documents:l.documents.map(c=>c.id===r?{...c,status:"parsing"}:c),isParsingDocument:!0}));try{const l=await Rr(i);t(c=>({documents:c.documents.map(d=>d.id===r?{...d,status:"parsed",extractedData:l}:d),extractedEntities:{systems:[...c.extractedEntities.systems,...l.systems],networks:[...c.extractedEntities.networks,...l.networks],processes:[...c.extractedEntities.processes,...l.processes],compliance:[...c.extractedEntities.compliance,...l.compliance],recoveryObjectives:[...c.extractedEntities.recoveryObjectives,...l.recoveryObjectives]},isParsingDocument:!1}))}catch{t(l=>({documents:l.documents.map(c=>c.id===r?{...c,status:"error",errorMessage:"Failed to parse document"}:c),isParsingDocument:!1}))}},removeDocument:a=>{const r=s().documents.find(n=>n.id===a);r&&t(n=>({documents:n.documents.filter(i=>i.id!==a),extractedEntities:{systems:n.extractedEntities.systems.filter(i=>i.sourceDocument!==r.filename),networks:n.extractedEntities.networks.filter(i=>i.sourceDocument!==r.filename),processes:n.extractedEntities.processes.filter(i=>i.sourceDocument!==r.filename),compliance:n.extractedEntities.compliance.filter(i=>i.sourceDocument!==r.filename),recoveryObjectives:n.extractedEntities.recoveryObjectives.filter(i=>{const o=n.extractedEntities.processes.find(l=>l.id===i.processId);return(o==null?void 0:o.sourceDocument)!==r.filename})}}))},updateDocumentStatus:(a,r,n)=>{t(i=>({documents:i.documents.map(o=>o.id===a?{...o,status:r,errorMessage:n}:o)}))},connectRepository:async(a,r,n)=>{const i=J(),o={id:i,type:a,name:n,url:r,status:"syncing"};t(l=>({repositories:[...l.repositories,o],isSyncingRepo:!0})),await new Promise(l=>setTimeout(l,2e3)),t(l=>({repositories:l.repositories.map(c=>c.id===i?{...c,status:"connected",lastSync:new Date,filesCount:Math.floor(Math.random()*50)+10}:c),isSyncingRepo:!1}))},disconnectRepository:a=>{t(r=>({repositories:r.repositories.filter(n=>n.id!==a)}))},syncRepository:async a=>{t(r=>({repositories:r.repositories.map(n=>n.id===a?{...n,status:"syncing"}:n),isSyncingRepo:!0})),await new Promise(r=>setTimeout(r,1500)),t(r=>({repositories:r.repositories.map(n=>n.id===a?{...n,status:"connected",lastSync:new Date}:n),isSyncingRepo:!1}))},addExtractedSystem:a=>{t(r=>({extractedEntities:{...r.extractedEntities,systems:[...r.extractedEntities.systems,a]}}))},addExtractedNetwork:a=>{t(r=>({extractedEntities:{...r.extractedEntities,networks:[...r.extractedEntities.networks,a]}}))},addBusinessProcess:a=>{t(r=>({extractedEntities:{...r.extractedEntities,processes:[...r.extractedEntities.processes,a]}}))},addComplianceRequirement:a=>{t(r=>({extractedEntities:{...r.extractedEntities,compliance:[...r.extractedEntities.compliance,a]}}))},loadScenarioContext:a=>{t({documents:a.documents,repositories:a.repositories,extractedEntities:a.extractedEntities})},resetContext:()=>{t({documents:[],repositories:[],extractedEntities:Yt,isParsingDocument:!1,isSyncingRepo:!1})}}));function Fr(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function Lr(t,s){await new Promise(i=>setTimeout(i,500+Math.random()*1e3));const a=Math.random()>.2,r={method:s,status:a?"success":"failed",timestamp:new Date,message:a?_r(s,t):zr(s,t),details:a?Wr(s,t):Vr(s,t)};let n;return a||(n={id:Fr(),systemId:t.systemId,hostname:t.hostname,type:Br(s),severity:s==="ad_lookup"||s==="cert_check"?"critical":"warning",description:r.message||"Validation failed",documented:t.documentedIP,actual:Ur(s)}),{result:r,discrepancy:n}}function _r(t,s){return{ping:`Host ${s.hostname} (${s.documentedIP}) is reachable`,dns:`Hostname ${s.hostname} resolves to ${s.documentedIP}`,spn:`SPN registered for ${s.hostname} in Active Directory`,ad_lookup:`Computer object ${s.hostname} found in Active Directory`,port_scan:`Expected services responding on ${s.hostname}`,cert_check:`SSL/TLS certificate valid for ${s.hostname}`}[t]}function zr(t,s){return{ping:`Host ${s.hostname} (${s.documentedIP}) is not responding`,dns:`Hostname ${s.hostname} does not resolve to documented IP`,spn:`No SPN found for ${s.hostname} in Active Directory`,ad_lookup:`Computer object ${s.hostname} not found in Active Directory`,port_scan:`Expected services not responding on ${s.hostname}`,cert_check:`SSL/TLS certificate expired or invalid for ${s.hostname}`}[t]}function Wr(t,s){return{ping:{latency:`${Math.floor(Math.random()*50)+1}ms`,packetLoss:"0%"},dns:{resolvedIP:s.documentedIP,ttl:3600},spn:{spn:`HOST/${s.hostname}`,realm:"CORP.LOCAL"},ad_lookup:{ou:"OU=Servers,DC=corp,DC=local",enabled:!0},port_scan:{openPorts:[22,80,443],closedPorts:[]},cert_check:{issuer:"Corp Internal CA",expiresIn:"180 days"}}[t]}function Vr(t,s){return{ping:{packetLoss:"100%",timeout:"3000ms"},dns:{resolvedIP:`10.0.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`,expected:s.documentedIP},spn:{searched:`HOST/${s.hostname}`,found:null},ad_lookup:{searched:s.hostname,found:!1},port_scan:{openPorts:[],expectedPorts:[22,80,443]},cert_check:{error:"Certificate expired",expiredDays:Math.floor(Math.random()*30)+1}}[t]}function Br(t){return{ping:"ip_mismatch",dns:"dns_mismatch",spn:"missing_spn",ad_lookup:"not_in_ad",port_scan:"missing_service",cert_check:"cert_expired"}[t]}function Ur(t,s){return{ping:"No response",dns:`10.0.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`,spn:"Not found",ad_lookup:"Not found",port_scan:"No services responding",cert_check:"Expired"}[t]}function Hr(t){return t==="critical"?["ping","dns","ad_lookup","spn","port_scan","cert_check"]:t==="high"?["ping","dns","ad_lookup","port_scan"]:["ping","dns"]}function Gr(t){return t.length===0||t.some(s=>s.status==="pending")?"pending":t.every(s=>s.status==="success")?"verified":t.some(s=>s.status==="failed")?"failed":"unknown"}const $r=nt((t,s)=>({systems:[],autoValidateEnabled:!1,discrepancies:[],isValidating:!1,initializeFromSystems:a=>{const r=a.map(n=>({systemId:n.id,hostname:n.hostname,documentedIP:n.ip||"N/A",role:n.role,criticality:n.criticality,validationMethods:Hr(n.criticality),results:[],overallStatus:"pending"}));t({systems:r,discrepancies:[]})},setAutoValidate:a=>{t({autoValidateEnabled:a}),a&&s().validateAllSystems()},validateSystem:async(a,r)=>{const n=s().systems.find(o=>o.systemId===a);if(!n)return;const i=r||n.validationMethods;t({isValidating:!0}),t(o=>({systems:o.systems.map(l=>l.systemId===a?{...l,results:l.results.filter(c=>!i.includes(c.method)),overallStatus:"pending"}:l),discrepancies:o.discrepancies.filter(l=>l.systemId!==a)}));for(const o of i){const{result:l,discrepancy:c}=await Lr(n,o);t(d=>{const h=d.systems.map(g=>{if(g.systemId!==a)return g;const k=[...g.results,l];return{...g,results:k,overallStatus:Gr(k),lastChecked:new Date}}),p=c?[...d.discrepancies,c]:d.discrepancies;return{systems:h,discrepancies:p}})}t({isValidating:!1,lastFullValidation:new Date})},validateAllSystems:async()=>{const{systems:a}=s();t({isValidating:!0});for(const r of a)await s().validateSystem(r.systemId);t({isValidating:!1,lastFullValidation:new Date})},revalidateFailed:async()=>{const{systems:a}=s(),r=a.filter(n=>n.overallStatus==="failed");t({isValidating:!0});for(const n of r){const i=n.results.filter(o=>o.status==="failed").map(o=>o.method);await s().validateSystem(n.systemId,i)}t({isValidating:!1})},clearValidation:a=>{t(r=>({systems:r.systems.map(n=>n.systemId===a?{...n,results:[],overallStatus:"pending",lastChecked:void 0}:n),discrepancies:r.discrepancies.filter(n=>n.systemId!==a)}))},resetValidation:()=>{t({systems:[],autoValidateEnabled:!1,discrepancies:[],isValidating:!1,lastFullValidation:void 0})}})),Yr={sm:"h-8 w-8",md:"h-10 w-10",lg:"h-12 w-12"},xt={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"};function qr({size:t="md",className:s}){const{mode:a,setMode:r}=js(),n=()=>{const l=["light","dark","auto"],d=(l.indexOf(a)+1)%l.length;r(l[d])},i={light:"Switch to dark mode",dark:"Switch to auto mode",auto:"Switch to light mode"},o={light:e.jsx("svg",{className:xt[t],fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),dark:e.jsx("svg",{className:xt[t],fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),auto:e.jsx("svg",{className:xt[t],fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})};return e.jsx(S,{content:i[a],children:e.jsx("button",{onClick:n,className:u("inline-flex items-center justify-center","rounded-lg","text-slate-600 dark:text-slate-400","hover:bg-slate-100 dark:hover:bg-slate-800","hover:text-slate-900 dark:hover:text-slate-100","transition-colors duration-200","focus:outline-none focus:ring-2 focus:ring-forensic-500 focus:ring-offset-2 dark:focus:ring-offset-slate-900",Yr[t],s),"aria-label":`Current theme: ${a}. Click to change.`,children:o[a]})})}const Re=[{step:"organization_context",label:"Context",number:1},{step:"incident_description",label:"Incident",number:2},{step:"connector_config",label:"Connectors",number:3},{step:"infrastructure_validation",label:"Validation",number:4},{step:"triage",label:"Triage",number:5},{step:"timeline",label:"Timeline",number:6},{step:"verification",label:"Verify",number:7},{step:"report",label:"Report",number:8}];function ys({showProgress:t=!0,className:s}){var o;const{currentSession:a,currentStep:r}=Q(),n=Re.findIndex(l=>l.step===r),i=n>=0;return e.jsxs("header",{className:u("sticky top-0 z-40","bg-white/80 dark:bg-slate-900/80 backdrop-blur-md","border-b border-slate-200 dark:border-slate-700",s),children:[e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs(Xs,{to:"/",className:"flex items-center gap-2 text-slate-900 dark:text-slate-100 hover:opacity-80 transition-opacity",children:[e.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-forensic-500",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"m21 21-4.3-4.3"}),e.jsx("path",{d:"M11 8v6",className:"text-red-500",stroke:"currentColor"}),e.jsx("path",{d:"M8 11h6",className:"text-red-500",stroke:"currentColor"})]})}),e.jsx("span",{className:"font-semibold text-lg hidden sm:inline",children:"Forensic Triage"})]}),t&&i&&a&&e.jsx("div",{className:"hidden md:flex items-center",children:e.jsx(Xr,{currentStepIndex:n,totalSteps:Re.length})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{content:"Get help and documentation",children:e.jsx(P,{variant:"ghost",size:"sm","aria-label":"Help",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),e.jsx(qr,{size:"sm"})]})]})}),t&&i&&a&&e.jsx("div",{className:"md:hidden px-4 pb-3",children:e.jsx(Qr,{currentStepIndex:n,currentStepLabel:((o=Re[n])==null?void 0:o.label)||"",totalSteps:Re.length})})]})}function Xr({currentStepIndex:t,totalSteps:s}){return e.jsx("div",{className:"flex items-center gap-1",children:Re.map((a,r)=>e.jsxs(N.Fragment,{children:[e.jsx(S,{content:a.label,children:e.jsx("div",{className:u("w-3 h-3 rounded-full transition-colors duration-200",r<t?"bg-forensic-500":r===t?"bg-forensic-500 ring-2 ring-forensic-200 dark:ring-forensic-800":"bg-slate-200 dark:bg-slate-700")})}),r<s-1&&e.jsx("div",{className:u("w-4 h-0.5",r<t?"bg-forensic-500":"bg-slate-200 dark:bg-slate-700")})]},a.step))})}function Qr({currentStepIndex:t,currentStepLabel:s,totalSteps:a}){return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-1 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-forensic-500 transition-all duration-300",style:{width:`${(t+1)/a*100}%`}})}),e.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400 whitespace-nowrap",children:["Step ",t+1,"/",a,": ",s]})]})}const qt={sm:"max-w-2xl",md:"max-w-4xl",lg:"max-w-5xl",xl:"max-w-6xl","2xl":"max-w-7xl",full:"max-w-full"};function ie({title:t,subtitle:s,showProgress:a=!0,actions:r,footer:n,children:i,maxWidth:o="2xl",className:l}){return e.jsxs("div",{className:"min-h-screen flex flex-col bg-slate-50 dark:bg-slate-900",children:[e.jsx(ys,{showProgress:a}),e.jsxs("main",{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:u("flex-1 w-full mx-auto px-4 sm:px-6 lg:px-8 py-6",qt[o],l),children:[(t||r)&&e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[t&&e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:t}),s&&e.jsx("p",{className:"mt-1 text-slate-500 dark:text-slate-400",children:s})]}),r&&e.jsx("div",{className:"flex items-center gap-2 flex-shrink-0",children:r})]})}),e.jsx("div",{className:"flex-1",children:i})]}),n&&e.jsx("div",{className:"sticky bottom-0 bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-slate-700",children:e.jsx("div",{className:u("w-full mx-auto px-4 sm:px-6 lg:px-8 py-4",qt[o]),children:n})})]})]})}function ue({onBack:t,backLabel:s="Back",onContinue:a,continueLabel:r="Continue",continueDisabled:n,continueLoading:i,middleContent:o}){return e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{children:t&&e.jsxs("button",{onClick:t,className:u("inline-flex items-center gap-2","px-4 py-2 text-sm font-medium","text-slate-600 dark:text-slate-400","hover:text-slate-900 dark:hover:text-slate-100","transition-colors duration-200"),children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),s]})}),o&&e.jsx("div",{className:"flex-1 flex justify-center",children:o}),e.jsx("div",{children:a&&e.jsxs("button",{onClick:a,disabled:n||i,className:u("inline-flex items-center gap-2","px-6 py-2 text-sm font-medium","bg-forensic-500 hover:bg-forensic-600 text-white","rounded-lg","transition-colors duration-200","disabled:opacity-50 disabled:cursor-not-allowed"),children:[i?e.jsxs("svg",{className:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):null,r,e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]})})]})}function Kr({icon:t,title:s,description:a,action:r,className:n}){return e.jsxs("div",{className:u("flex flex-col items-center justify-center text-center py-12",n),children:[t&&e.jsx("div",{className:"w-16 h-16 flex items-center justify-center text-slate-400 dark:text-slate-500 mb-4",children:t}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-1",children:s}),a&&e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 max-w-sm mb-4",children:a}),r]})}const ws=6048e5,Jr=864e5,Ns=6e4,ks=36e5,Be=43200,Xt=1440,Qt=Symbol.for("constructDateFrom");function X(t,s){return typeof t=="function"?t(s):t&&typeof t=="object"&&Qt in t?t[Qt](s):t instanceof Date?new t.constructor(s):new Date(s)}function L(t,s){return X(s||t,t)}let Zr={};function Ve(){return Zr}function We(t,s){var l,c,d,h;const a=Ve(),r=(s==null?void 0:s.weekStartsOn)??((c=(l=s==null?void 0:s.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??a.weekStartsOn??((h=(d=a.locale)==null?void 0:d.options)==null?void 0:h.weekStartsOn)??0,n=L(t,s==null?void 0:s.in),i=n.getDay(),o=(i<r?7:0)+i-r;return n.setDate(n.getDate()-o),n.setHours(0,0,0,0),n}function Ze(t,s){return We(t,{...s,weekStartsOn:1})}function Ss(t,s){const a=L(t,s==null?void 0:s.in),r=a.getFullYear(),n=X(a,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const i=Ze(n),o=X(a,0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);const l=Ze(o);return a.getTime()>=i.getTime()?r+1:a.getTime()>=l.getTime()?r:r-1}function et(t){const s=L(t),a=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return a.setUTCFullYear(s.getFullYear()),+t-+a}function it(t,...s){const a=X.bind(null,t||s.find(r=>typeof r=="object"));return s.map(a)}function Kt(t,s){const a=L(t,s==null?void 0:s.in);return a.setHours(0,0,0,0),a}function en(t,s,a){const[r,n]=it(a==null?void 0:a.in,t,s),i=Kt(r),o=Kt(n),l=+i-et(i),c=+o-et(o);return Math.round((l-c)/Jr)}function tn(t,s){const a=Ss(t,s),r=X(t,0);return r.setFullYear(a,0,4),r.setHours(0,0,0,0),Ze(r)}function Ye(t,s){const a=+L(t)-+L(s);return a<0?-1:a>0?1:a}function sn(t){return X(t,Date.now())}function an(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function rn(t){return!(!an(t)&&typeof t!="number"||isNaN(+L(t)))}function nn(t,s,a){const[r,n]=it(a==null?void 0:a.in,t,s),i=r.getFullYear()-n.getFullYear(),o=r.getMonth()-n.getMonth();return i*12+o}function ln(t){return s=>{const r=(t?Math[t]:Math.trunc)(s);return r===0?0:r}}function on(t,s){return+L(t)-+L(s)}function cn(t,s){const a=L(t,s==null?void 0:s.in);return a.setHours(23,59,59,999),a}function dn(t,s){const a=L(t,s==null?void 0:s.in),r=a.getMonth();return a.setFullYear(a.getFullYear(),r+1,0),a.setHours(23,59,59,999),a}function mn(t,s){const a=L(t,s==null?void 0:s.in);return+cn(a,s)==+dn(a,s)}function xn(t,s,a){const[r,n,i]=it(a==null?void 0:a.in,t,t,s),o=Ye(n,i),l=Math.abs(nn(n,i));if(l<1)return 0;n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-o*l);let c=Ye(n,i)===-o;mn(r)&&l===1&&Ye(r,i)===1&&(c=!1);const d=o*(l-+c);return d===0?0:d}function un(t,s,a){const r=on(t,s)/1e3;return ln(a==null?void 0:a.roundingMethod)(r)}function hn(t,s){const a=L(t,s==null?void 0:s.in);return a.setFullYear(a.getFullYear(),0,1),a.setHours(0,0,0,0),a}const pn={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},gn=(t,s,a)=>{let r;const n=pn[t];return typeof n=="string"?r=n:s===1?r=n.one:r=n.other.replace("{{count}}",s.toString()),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"in "+r:r+" ago":r};function ut(t){return(s={})=>{const a=s.width?String(s.width):t.defaultWidth;return t.formats[a]||t.formats[t.defaultWidth]}}const fn={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},bn={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},jn={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},vn={date:ut({formats:fn,defaultWidth:"full"}),time:ut({formats:bn,defaultWidth:"full"}),dateTime:ut({formats:jn,defaultWidth:"full"})},yn={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},wn=(t,s,a,r)=>yn[t];function Me(t){return(s,a)=>{const r=a!=null&&a.context?String(a.context):"standalone";let n;if(r==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=a!=null&&a.width?String(a.width):o;n=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=a!=null&&a.width?String(a.width):t.defaultWidth;n=t.values[l]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(s):s;return n[i]}}const Nn={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},kn={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Sn={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Cn={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Dn={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Pn={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Mn=(t,s)=>{const a=Number(t),r=a%100;if(r>20||r<10)switch(r%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},In={ordinalNumber:Mn,era:Me({values:Nn,defaultWidth:"wide"}),quarter:Me({values:kn,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Me({values:Sn,defaultWidth:"wide"}),day:Me({values:Cn,defaultWidth:"wide"}),dayPeriod:Me({values:Dn,defaultWidth:"wide",formattingValues:Pn,defaultFormattingWidth:"wide"})};function Ie(t){return(s,a={})=>{const r=a.width,n=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],i=s.match(n);if(!i)return null;const o=i[0],l=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?Tn(l,p=>p.test(o)):An(l,p=>p.test(o));let d;d=t.valueCallback?t.valueCallback(c):c,d=a.valueCallback?a.valueCallback(d):d;const h=s.slice(o.length);return{value:d,rest:h}}}function An(t,s){for(const a in t)if(Object.prototype.hasOwnProperty.call(t,a)&&s(t[a]))return a}function Tn(t,s){for(let a=0;a<t.length;a++)if(s(t[a]))return a}function En(t){return(s,a={})=>{const r=s.match(t.matchPattern);if(!r)return null;const n=r[0],i=s.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=a.valueCallback?a.valueCallback(o):o;const l=s.slice(n.length);return{value:o,rest:l}}}const On=/^(\d+)(th|st|nd|rd)?/i,Rn=/\d+/i,Fn={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Ln={any:[/^b/i,/^(a|c)/i]},_n={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},zn={any:[/1/i,/2/i,/3/i,/4/i]},Wn={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Vn={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Bn={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Un={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Hn={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Gn={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},$n={ordinalNumber:En({matchPattern:On,parsePattern:Rn,valueCallback:t=>parseInt(t,10)}),era:Ie({matchPatterns:Fn,defaultMatchWidth:"wide",parsePatterns:Ln,defaultParseWidth:"any"}),quarter:Ie({matchPatterns:_n,defaultMatchWidth:"wide",parsePatterns:zn,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ie({matchPatterns:Wn,defaultMatchWidth:"wide",parsePatterns:Vn,defaultParseWidth:"any"}),day:Ie({matchPatterns:Bn,defaultMatchWidth:"wide",parsePatterns:Un,defaultParseWidth:"any"}),dayPeriod:Ie({matchPatterns:Hn,defaultMatchWidth:"any",parsePatterns:Gn,defaultParseWidth:"any"})},Cs={code:"en-US",formatDistance:gn,formatLong:vn,formatRelative:wn,localize:In,match:$n,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Yn(t,s){const a=L(t,s==null?void 0:s.in);return en(a,hn(a))+1}function qn(t,s){const a=L(t,s==null?void 0:s.in),r=+Ze(a)-+tn(a);return Math.round(r/ws)+1}function Ds(t,s){var h,p,g,k;const a=L(t,s==null?void 0:s.in),r=a.getFullYear(),n=Ve(),i=(s==null?void 0:s.firstWeekContainsDate)??((p=(h=s==null?void 0:s.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)??n.firstWeekContainsDate??((k=(g=n.locale)==null?void 0:g.options)==null?void 0:k.firstWeekContainsDate)??1,o=X((s==null?void 0:s.in)||t,0);o.setFullYear(r+1,0,i),o.setHours(0,0,0,0);const l=We(o,s),c=X((s==null?void 0:s.in)||t,0);c.setFullYear(r,0,i),c.setHours(0,0,0,0);const d=We(c,s);return+a>=+l?r+1:+a>=+d?r:r-1}function Xn(t,s){var l,c,d,h;const a=Ve(),r=(s==null?void 0:s.firstWeekContainsDate)??((c=(l=s==null?void 0:s.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??a.firstWeekContainsDate??((h=(d=a.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??1,n=Ds(t,s),i=X((s==null?void 0:s.in)||t,0);return i.setFullYear(n,0,r),i.setHours(0,0,0,0),We(i,s)}function Qn(t,s){const a=L(t,s==null?void 0:s.in),r=+We(a,s)-+Xn(a,s);return Math.round(r/ws)+1}function O(t,s){const a=t<0?"-":"",r=Math.abs(t).toString().padStart(s,"0");return a+r}const re={y(t,s){const a=t.getFullYear(),r=a>0?a:1-a;return O(s==="yy"?r%100:r,s.length)},M(t,s){const a=t.getMonth();return s==="M"?String(a+1):O(a+1,2)},d(t,s){return O(t.getDate(),s.length)},a(t,s){const a=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];case"aaaa":default:return a==="am"?"a.m.":"p.m."}},h(t,s){return O(t.getHours()%12||12,s.length)},H(t,s){return O(t.getHours(),s.length)},m(t,s){return O(t.getMinutes(),s.length)},s(t,s){return O(t.getSeconds(),s.length)},S(t,s){const a=s.length,r=t.getMilliseconds(),n=Math.trunc(r*Math.pow(10,a-3));return O(n,s.length)}},fe={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Jt={G:function(t,s,a){const r=t.getFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"});case"GGGGG":return a.era(r,{width:"narrow"});case"GGGG":default:return a.era(r,{width:"wide"})}},y:function(t,s,a){if(s==="yo"){const r=t.getFullYear(),n=r>0?r:1-r;return a.ordinalNumber(n,{unit:"year"})}return re.y(t,s)},Y:function(t,s,a,r){const n=Ds(t,r),i=n>0?n:1-n;if(s==="YY"){const o=i%100;return O(o,2)}return s==="Yo"?a.ordinalNumber(i,{unit:"year"}):O(i,s.length)},R:function(t,s){const a=Ss(t);return O(a,s.length)},u:function(t,s){const a=t.getFullYear();return O(a,s.length)},Q:function(t,s,a){const r=Math.ceil((t.getMonth()+1)/3);switch(s){case"Q":return String(r);case"QQ":return O(r,2);case"Qo":return a.ordinalNumber(r,{unit:"quarter"});case"QQQ":return a.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,s,a){const r=Math.ceil((t.getMonth()+1)/3);switch(s){case"q":return String(r);case"qq":return O(r,2);case"qo":return a.ordinalNumber(r,{unit:"quarter"});case"qqq":return a.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,s,a){const r=t.getMonth();switch(s){case"M":case"MM":return re.M(t,s);case"Mo":return a.ordinalNumber(r+1,{unit:"month"});case"MMM":return a.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(r,{width:"wide",context:"formatting"})}},L:function(t,s,a){const r=t.getMonth();switch(s){case"L":return String(r+1);case"LL":return O(r+1,2);case"Lo":return a.ordinalNumber(r+1,{unit:"month"});case"LLL":return a.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(r,{width:"wide",context:"standalone"})}},w:function(t,s,a,r){const n=Qn(t,r);return s==="wo"?a.ordinalNumber(n,{unit:"week"}):O(n,s.length)},I:function(t,s,a){const r=qn(t);return s==="Io"?a.ordinalNumber(r,{unit:"week"}):O(r,s.length)},d:function(t,s,a){return s==="do"?a.ordinalNumber(t.getDate(),{unit:"date"}):re.d(t,s)},D:function(t,s,a){const r=Yn(t);return s==="Do"?a.ordinalNumber(r,{unit:"dayOfYear"}):O(r,s.length)},E:function(t,s,a){const r=t.getDay();switch(s){case"E":case"EE":case"EEE":return a.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(r,{width:"short",context:"formatting"});case"EEEE":default:return a.day(r,{width:"wide",context:"formatting"})}},e:function(t,s,a,r){const n=t.getDay(),i=(n-r.weekStartsOn+8)%7||7;switch(s){case"e":return String(i);case"ee":return O(i,2);case"eo":return a.ordinalNumber(i,{unit:"day"});case"eee":return a.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(n,{width:"short",context:"formatting"});case"eeee":default:return a.day(n,{width:"wide",context:"formatting"})}},c:function(t,s,a,r){const n=t.getDay(),i=(n-r.weekStartsOn+8)%7||7;switch(s){case"c":return String(i);case"cc":return O(i,s.length);case"co":return a.ordinalNumber(i,{unit:"day"});case"ccc":return a.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(n,{width:"narrow",context:"standalone"});case"cccccc":return a.day(n,{width:"short",context:"standalone"});case"cccc":default:return a.day(n,{width:"wide",context:"standalone"})}},i:function(t,s,a){const r=t.getDay(),n=r===0?7:r;switch(s){case"i":return String(n);case"ii":return O(n,s.length);case"io":return a.ordinalNumber(n,{unit:"day"});case"iii":return a.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(r,{width:"short",context:"formatting"});case"iiii":default:return a.day(r,{width:"wide",context:"formatting"})}},a:function(t,s,a){const n=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(t,s,a){const r=t.getHours();let n;switch(r===12?n=fe.noon:r===0?n=fe.midnight:n=r/12>=1?"pm":"am",s){case"b":case"bb":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(t,s,a){const r=t.getHours();let n;switch(r>=17?n=fe.evening:r>=12?n=fe.afternoon:r>=4?n=fe.morning:n=fe.night,s){case"B":case"BB":case"BBB":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(t,s,a){if(s==="ho"){let r=t.getHours()%12;return r===0&&(r=12),a.ordinalNumber(r,{unit:"hour"})}return re.h(t,s)},H:function(t,s,a){return s==="Ho"?a.ordinalNumber(t.getHours(),{unit:"hour"}):re.H(t,s)},K:function(t,s,a){const r=t.getHours()%12;return s==="Ko"?a.ordinalNumber(r,{unit:"hour"}):O(r,s.length)},k:function(t,s,a){let r=t.getHours();return r===0&&(r=24),s==="ko"?a.ordinalNumber(r,{unit:"hour"}):O(r,s.length)},m:function(t,s,a){return s==="mo"?a.ordinalNumber(t.getMinutes(),{unit:"minute"}):re.m(t,s)},s:function(t,s,a){return s==="so"?a.ordinalNumber(t.getSeconds(),{unit:"second"}):re.s(t,s)},S:function(t,s){return re.S(t,s)},X:function(t,s,a){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(s){case"X":return es(r);case"XXXX":case"XX":return de(r);case"XXXXX":case"XXX":default:return de(r,":")}},x:function(t,s,a){const r=t.getTimezoneOffset();switch(s){case"x":return es(r);case"xxxx":case"xx":return de(r);case"xxxxx":case"xxx":default:return de(r,":")}},O:function(t,s,a){const r=t.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+Zt(r,":");case"OOOO":default:return"GMT"+de(r,":")}},z:function(t,s,a){const r=t.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+Zt(r,":");case"zzzz":default:return"GMT"+de(r,":")}},t:function(t,s,a){const r=Math.trunc(+t/1e3);return O(r,s.length)},T:function(t,s,a){return O(+t,s.length)}};function Zt(t,s=""){const a=t>0?"-":"+",r=Math.abs(t),n=Math.trunc(r/60),i=r%60;return i===0?a+String(n):a+String(n)+s+O(i,2)}function es(t,s){return t%60===0?(t>0?"-":"+")+O(Math.abs(t)/60,2):de(t,s)}function de(t,s=""){const a=t>0?"-":"+",r=Math.abs(t),n=O(Math.trunc(r/60),2),i=O(r%60,2);return a+n+s+i}const ts=(t,s)=>{switch(t){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},Ps=(t,s)=>{switch(t){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},Kn=(t,s)=>{const a=t.match(/(P+)(p+)?/)||[],r=a[1],n=a[2];if(!n)return ts(t,s);let i;switch(r){case"P":i=s.dateTime({width:"short"});break;case"PP":i=s.dateTime({width:"medium"});break;case"PPP":i=s.dateTime({width:"long"});break;case"PPPP":default:i=s.dateTime({width:"full"});break}return i.replace("{{date}}",ts(r,s)).replace("{{time}}",Ps(n,s))},Jn={p:Ps,P:Kn},Zn=/^D+$/,ei=/^Y+$/,ti=["D","DD","YY","YYYY"];function si(t){return Zn.test(t)}function ai(t){return ei.test(t)}function ri(t,s,a){const r=ni(t,s,a);if(console.warn(r),ti.includes(t))throw new RangeError(r)}function ni(t,s,a){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${s}\`) for formatting ${r} to the input \`${a}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const ii=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,li=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,oi=/^'([^]*?)'?$/,ci=/''/g,di=/[a-zA-Z]/;function Ms(t,s,a){var h,p,g,k;const r=Ve(),n=r.locale??Cs,i=r.firstWeekContainsDate??((p=(h=r.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)??1,o=r.weekStartsOn??((k=(g=r.locale)==null?void 0:g.options)==null?void 0:k.weekStartsOn)??0,l=L(t,a==null?void 0:a.in);if(!rn(l))throw new RangeError("Invalid time value");let c=s.match(li).map(j=>{const f=j[0];if(f==="p"||f==="P"){const m=Jn[f];return m(j,n.formatLong)}return j}).join("").match(ii).map(j=>{if(j==="''")return{isToken:!1,value:"'"};const f=j[0];if(f==="'")return{isToken:!1,value:mi(j)};if(Jt[f])return{isToken:!0,value:j};if(f.match(di))throw new RangeError("Format string contains an unescaped latin alphabet character `"+f+"`");return{isToken:!1,value:j}});n.localize.preprocessor&&(c=n.localize.preprocessor(l,c));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:n};return c.map(j=>{if(!j.isToken)return j.value;const f=j.value;(ai(f)||si(f))&&ri(f,s,String(t));const m=Jt[f[0]];return m(l,f,n.localize,d)}).join("")}function mi(t){const s=t.match(oi);return s?s[1].replace(ci,"'"):t}function xi(t,s,a){const r=Ve(),n=(a==null?void 0:a.locale)??r.locale??Cs,i=2520,o=Ye(t,s);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},a,{addSuffix:a==null?void 0:a.addSuffix,comparison:o}),[c,d]=it(a==null?void 0:a.in,...o>0?[s,t]:[t,s]),h=un(d,c),p=(et(d)-et(c))/1e3,g=Math.round((h-p)/60);let k;if(g<2)return a!=null&&a.includeSeconds?h<5?n.formatDistance("lessThanXSeconds",5,l):h<10?n.formatDistance("lessThanXSeconds",10,l):h<20?n.formatDistance("lessThanXSeconds",20,l):h<40?n.formatDistance("halfAMinute",0,l):h<60?n.formatDistance("lessThanXMinutes",1,l):n.formatDistance("xMinutes",1,l):g===0?n.formatDistance("lessThanXMinutes",1,l):n.formatDistance("xMinutes",g,l);if(g<45)return n.formatDistance("xMinutes",g,l);if(g<90)return n.formatDistance("aboutXHours",1,l);if(g<Xt){const j=Math.round(g/60);return n.formatDistance("aboutXHours",j,l)}else{if(g<i)return n.formatDistance("xDays",1,l);if(g<Be){const j=Math.round(g/Xt);return n.formatDistance("xDays",j,l)}else if(g<Be*2)return k=Math.round(g/Be),n.formatDistance("aboutXMonths",k,l)}if(k=xn(d,c),k<12){const j=Math.round(g/Be);return n.formatDistance("xMonths",j,l)}else{const j=k%12,f=Math.trunc(k/12);return j<3?n.formatDistance("aboutXYears",f,l):j<9?n.formatDistance("overXYears",f,l):n.formatDistance("almostXYears",f+1,l)}}function ui(t,s){return xi(t,sn(t),s)}function Mt(t,s){const a=()=>X(s==null?void 0:s.in,NaN),n=fi(t);let i;if(n.date){const d=bi(n.date,2);i=ji(d.restDateString,d.year)}if(!i||isNaN(+i))return a();const o=+i;let l=0,c;if(n.time&&(l=vi(n.time),isNaN(l)))return a();if(n.timezone){if(c=yi(n.timezone),isNaN(c))return a()}else{const d=new Date(o+l),h=L(0,s==null?void 0:s.in);return h.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),h.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),h}return L(o+l+c,s==null?void 0:s.in)}const Ue={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},hi=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,pi=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,gi=/^([+-])(\d{2})(?::?(\d{2}))?$/;function fi(t){const s={},a=t.split(Ue.dateTimeDelimiter);let r;if(a.length>2)return s;if(/:/.test(a[0])?r=a[0]:(s.date=a[0],r=a[1],Ue.timeZoneDelimiter.test(s.date)&&(s.date=t.split(Ue.timeZoneDelimiter)[0],r=t.substr(s.date.length,t.length))),r){const n=Ue.timezone.exec(r);n?(s.time=r.replace(n[1],""),s.timezone=n[1]):s.time=r}return s}function bi(t,s){const a=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+s)+"})|(\\d{2}|[+-]\\d{"+(2+s)+"})$)"),r=t.match(a);if(!r)return{year:NaN,restDateString:""};const n=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:i===null?n:i*100,restDateString:t.slice((r[1]||r[2]).length)}}function ji(t,s){if(s===null)return new Date(NaN);const a=t.match(hi);if(!a)return new Date(NaN);const r=!!a[4],n=Ae(a[1]),i=Ae(a[2])-1,o=Ae(a[3]),l=Ae(a[4]),c=Ae(a[5])-1;if(r)return Ci(s,l,c)?wi(s,l,c):new Date(NaN);{const d=new Date(0);return!ki(s,i,o)||!Si(s,n)?new Date(NaN):(d.setUTCFullYear(s,i,Math.max(n,o)),d)}}function Ae(t){return t?parseInt(t):1}function vi(t){const s=t.match(pi);if(!s)return NaN;const a=ht(s[1]),r=ht(s[2]),n=ht(s[3]);return Di(a,r,n)?a*ks+r*Ns+n*1e3:NaN}function ht(t){return t&&parseFloat(t.replace(",","."))||0}function yi(t){if(t==="Z")return 0;const s=t.match(gi);if(!s)return 0;const a=s[1]==="+"?-1:1,r=parseInt(s[2]),n=s[3]&&parseInt(s[3])||0;return Pi(r,n)?a*(r*ks+n*Ns):NaN}function wi(t,s,a){const r=new Date(0);r.setUTCFullYear(t,0,4);const n=r.getUTCDay()||7,i=(s-1)*7+a+1-n;return r.setUTCDate(r.getUTCDate()+i),r}const Ni=[31,null,31,30,31,30,31,31,30,31,30,31];function Is(t){return t%400===0||t%4===0&&t%100!==0}function ki(t,s,a){return s>=0&&s<=11&&a>=1&&a<=(Ni[s]||(Is(t)?29:28))}function Si(t,s){return s>=1&&s<=(Is(t)?366:365)}function Ci(t,s,a){return s>=1&&s<=53&&a>=0&&a<=6}function Di(t,s,a){return t===24?s===0&&a===0:a>=0&&a<60&&s>=0&&s<60&&t>=0&&t<25}function Pi(t,s){return s>=0&&s<=59}function Mi(t){const s=typeof t=="string"?Mt(t):t;return Ms(s,"PPP p")}function As(t){const s=typeof t=="string"?Mt(t):t;return Ms(s,"HH:mm:ss")}function Ii(t){const s=typeof t=="string"?Mt(t):t;return ui(s,{addSuffix:!0})}function Ai(t){if(t===0)return"0 Bytes";const s=1024,a=["Bytes","KB","MB","GB","TB"],r=Math.floor(Math.log(t)/Math.log(s));return`${parseFloat((t/Math.pow(s,r)).toFixed(2))} ${a[r]}`}function Ti(){const t=Z(),{createSession:s,recentSessions:a,loadSession:r,clearRecentSessions:n}=Q(),i=()=>{s(),t("/context")},o=c=>{s(c),t("/context")},l=c=>{r(c),t("/context")};return e.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900",children:[e.jsx(ys,{showProgress:!1}),e.jsxs("main",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-slate-900 dark:text-slate-100 mb-4",children:"Self-Service Forensic Triage"}),e.jsx("p",{className:"text-lg text-slate-600 dark:text-slate-400 max-w-2xl mx-auto mb-8",children:"Quick diagnostic before professional incident response. Upload organizational context, configure data sources, and get actionable insights."}),e.jsx(S,{content:"Begin a new forensic investigation from scratch",children:e.jsx(P,{size:"lg",onClick:i,rightIcon:e.jsx(tt,{className:"w-5 h-5"}),children:"Start New Investigation"})})]}),e.jsxs("section",{className:"mb-12",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-4",children:"Select a Scenario"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-6",children:"Choose a pre-populated scenario to see the full workflow with realistic demo data."}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:Ei.map(c=>e.jsx(Oi,{scenario:c,onSelect:()=>o(c.id)},c.id))})]}),a.length>0&&e.jsxs("section",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Recent Sessions"}),e.jsx(S,{content:"Remove all saved session history",children:e.jsx(P,{variant:"ghost",size:"sm",onClick:n,leftIcon:e.jsx(ta,{className:"w-4 h-4"}),children:"Clear"})})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:a.slice(0,6).map(c=>e.jsx(Ri,{session:c,onResume:()=>l(c.id)},c.id))})]})]})]})}const Ei=[{id:"ransomware",title:"Ransomware Attack",description:"Enterprise ransomware infection with lateral movement and file encryption",icon:e.jsx(wt,{className:"w-8 h-8"}),difficulty:"intermediate"},{id:"data_exfiltration",title:"Data Exfiltration",description:"Sensitive data theft via compromised cloud storage and sync tools",icon:e.jsx(be,{className:"w-8 h-8"}),difficulty:"advanced"},{id:"insider_threat",title:"Insider Threat",description:"Malicious activity by authorized user with privileged access",icon:e.jsx(Nt,{className:"w-8 h-8"}),difficulty:"advanced"},{id:"web_dos",title:"Web Resource DOS",description:"Application-layer denial of service attack on public web services",icon:e.jsx(Le,{className:"w-8 h-8"}),difficulty:"beginner"},{id:"ai_breach",title:"AI-Related Breach",description:"Security incident involving AI/ML systems and data poisoning",icon:e.jsx(sa,{className:"w-8 h-8"}),difficulty:"advanced"}];function Oi({scenario:t,onSelect:s}){const a={beginner:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",intermediate:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",advanced:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"};return e.jsx(S,{content:`Load ${t.title} scenario with pre-populated data`,children:e.jsx(M,{hoverable:!0,onClick:s,className:"cursor-pointer text-center h-full",children:e.jsxs("div",{className:"flex flex-col items-center gap-3 p-2",children:[e.jsx("div",{className:"text-forensic-500 dark:text-forensic-400",children:t.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-slate-100",children:t.title}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1 line-clamp-2",children:t.description})]}),e.jsx("span",{className:u("px-2 py-0.5 rounded-full text-xs font-medium capitalize",a[t.difficulty]),children:t.difficulty})]})})})}function Ri({session:t,onResume:s}){const a={ransomware:"Ransomware Attack",data_exfiltration:"Data Exfiltration",insider_threat:"Insider Threat",web_dos:"Web Resource DOS",ai_breach:"AI-Related Breach",custom:"Custom Investigation"};return e.jsx(S,{content:"Continue this investigation session",children:e.jsx(M,{hoverable:!0,onClick:s,className:"cursor-pointer",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-slate-900 dark:text-slate-100 truncate",children:a[t.scenarioType]||"Investigation"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-sm text-slate-500 dark:text-slate-400",children:[e.jsx(ke,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:Ii(t.lastModified)})]})]}),e.jsx("div",{className:"flex flex-col items-end gap-1",children:e.jsx("span",{className:u("px-2 py-0.5 rounded text-xs font-medium",t.isComplete?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"),children:t.isComplete?"Complete":`Step ${t.currentStep+1}`})})]})})})}function Fi(){const t=Z(),{goToNextStep:s,goToPreviousStep:a}=Q(),{documents:r,repositories:n,extractedEntities:i,addDocument:o,removeDocument:l}=vs(),c=N.useRef(null),d=()=>{a(),t("/")},h=()=>{s(),t("/incident")},p=N.useCallback(async x=>{const v=x.target.files;if(v){for(const y of Array.from(v))await o(y);c.current&&(c.current.value="")}},[o]),g=N.useCallback(async x=>{x.preventDefault();const v=x.dataTransfer.files;for(const y of Array.from(v))await o(y)},[o]),k=x=>{x.preventDefault()},j=i.systems.length,f=i.networks.length,m=i.processes.length,w=i.compliance.length;return e.jsxs(ie,{title:"Organization Context",subtitle:"Upload documents to help AI understand your environment",footer:e.jsx(ue,{onBack:d,backLabel:"Dashboard",onContinue:h,continueLabel:"Continue"}),children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs(M,{children:[e.jsx(z,{title:"Upload Documents",description:"Drag and drop or browse files"}),e.jsxs("div",{className:"mt-4",children:[e.jsx(S,{content:"Drag and drop files or click to browse. Supports PDF, DOCX, XLSX, JSON, YAML, Visio",children:e.jsxs("div",{onDrop:g,onDragOver:k,onClick:()=>{var x;return(x=c.current)==null?void 0:x.click()},className:u("border-2 border-dashed rounded-lg p-8 text-center cursor-pointer","border-slate-300 dark:border-slate-600","hover:border-forensic-400 dark:hover:border-forensic-500","transition-colors duration-200"),children:[e.jsx(be,{className:"w-10 h-10 mx-auto text-slate-400 mb-3"}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Drag & Drop or"," ",e.jsx("span",{className:"text-forensic-500 font-medium",children:"Browse"})]}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"PDF, DOCX, XLSX, JSON, YAML, Visio"})]})}),e.jsx("input",{ref:c,type:"file",multiple:!0,accept:".pdf,.docx,.xlsx,.json,.yaml,.yml,.vsdx",onChange:p,className:"hidden"})]})]}),e.jsxs(M,{children:[e.jsx(z,{title:"Connect Repository",description:"Access documentation from code repos"}),e.jsx("div",{className:"mt-4 grid grid-cols-2 gap-3",children:["github","gitlab","sharepoint","bitbucket"].map(x=>{const v=Ar[x],y=n.some(T=>T.type===x&&T.status==="connected");return e.jsx(S,{content:`Connect to ${v.name} for infrastructure documentation`,children:e.jsxs("button",{className:u("flex items-center gap-2 p-3 rounded-lg border","transition-colors duration-200",y?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-slate-200 dark:border-slate-700 hover:border-forensic-400"),children:[e.jsx(aa,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:v.name}),y&&e.jsx(V,{className:"w-4 h-4 text-green-500 ml-auto"})]})},x)})})]})]}),r.length>0&&e.jsxs("section",{className:"mb-8",children:[e.jsxs("h3",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:["Uploaded Documents (",r.length,")"]}),e.jsx("div",{className:"space-y-2",children:r.map(x=>e.jsx(Li,{document:x,onRemove:()=>l(x.id)},x.id))})]}),(j>0||f>0||m>0||w>0)&&e.jsxs("section",{children:[e.jsx("h3",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Extracted Context"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsx(He,{icon:e.jsx(Y,{className:"w-5 h-5"}),label:"Systems",count:j,tooltip:"Systems, servers, and workstations identified"}),e.jsx(He,{icon:e.jsx(_e,{className:"w-5 h-5"}),label:"Networks",count:f,tooltip:"Network segments and VLANs identified"}),e.jsx(He,{icon:e.jsx(ke,{className:"w-5 h-5"}),label:"Processes",count:m,tooltip:"Critical business processes identified"}),e.jsx(He,{icon:e.jsx(xe,{className:"w-5 h-5"}),label:"Compliance",count:w,tooltip:"Compliance requirements identified"})]})]}),(j>0||r.length>0)&&e.jsxs("section",{className:"mt-8 mb-8",children:[e.jsx("h3",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Identity & Access Management"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(pt,{icon:e.jsx(gt,{className:"w-6 h-6"}),title:"Active Directory",subtitle:"On-Premises AD",status:"detected",details:[{label:"Domain Controllers",value:"2 detected"},{label:"Forest",value:"corp.local"},{label:"Functional Level",value:"2016"},{label:"User Accounts",value:"~1,250"},{label:"Service Accounts",value:"~45"},{label:"Group Policies",value:"38 linked"}]}),e.jsx(pt,{icon:e.jsx(st,{className:"w-6 h-6"}),title:"Azure AD / Entra ID",subtitle:"Cloud Identity",status:"detected",details:[{label:"Tenant",value:"company.onmicrosoft.com"},{label:"Synced Users",value:"~1,180"},{label:"Cloud-Only Users",value:"~70"},{label:"MFA Enforced",value:"62%"},{label:"Conditional Access",value:"8 policies"},{label:"App Registrations",value:"24"}]}),e.jsx(pt,{icon:e.jsx(ra,{className:"w-6 h-6"}),title:"Hybrid Identity",subtitle:"AD Connect Sync",status:"synced",details:[{label:"Sync Status",value:"Healthy"},{label:"Last Sync",value:"12 min ago"},{label:"Sync Method",value:"Password Hash"},{label:"Privileged Roles",value:"15 Global Admins"},{label:"Guest Accounts",value:"34"},{label:"Stale Accounts (90d)",value:"127"}]})]})]}),r.length===0&&n.length===0&&e.jsx(Kr,{icon:e.jsx(at,{className:"w-12 h-12"}),title:"No context uploaded yet",description:"Upload documents or connect repositories to provide organizational context for better analysis."})]})}function Li({document:t,onRemove:s}){const a=Ir[t.type]||{name:"File",color:"text-slate-500"},r={uploading:e.jsx(ft,{className:"w-4 h-4 animate-spin text-blue-500"}),parsing:e.jsx(ft,{className:"w-4 h-4 animate-spin text-yellow-500"}),parsed:e.jsx(V,{className:"w-4 h-4 text-green-500"}),error:e.jsx(ia,{className:"w-4 h-4 text-red-500"})},n={uploading:"Uploading...",parsing:"Parsing...",parsed:"Parsed",error:"Error"};return e.jsxs("div",{className:u("flex items-center gap-3 p-3 rounded-lg","bg-slate-50 dark:bg-slate-800/50","border border-slate-200 dark:border-slate-700"),children:[e.jsx(at,{className:u("w-5 h-5",a.color)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100 truncate",children:t.filename}),e.jsxs("p",{className:"text-xs text-slate-500",children:[Ai(t.size)," "," ",e.jsx("span",{className:"capitalize",children:a.name})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{content:"Document is being analyzed to extract context",children:e.jsxs("div",{className:"flex items-center gap-1",children:[r[t.status],e.jsx("span",{className:"text-xs text-slate-500",children:n[t.status]})]})}),t.status==="parsed"&&e.jsx(S,{content:"Preview extracted data",children:e.jsx("button",{className:"p-1 hover:bg-slate-200 dark:hover:bg-slate-700 rounded",children:e.jsx(kt,{className:"w-4 h-4 text-slate-500"})})}),e.jsx(S,{content:"Remove document",children:e.jsx("button",{onClick:s,className:"p-1 hover:bg-red-100 dark:hover:bg-red-900/30 rounded text-slate-400 hover:text-red-500",children:e.jsx(St,{className:"w-4 h-4"})})})]})]})}function He({icon:t,label:s,count:a,tooltip:r}){return e.jsx(S,{content:r,children:e.jsx(M,{className:"text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"text-forensic-500",children:t}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:a}),e.jsx("p",{className:"text-xs text-slate-500",children:s})]})]})})})}function pt({icon:t,title:s,subtitle:a,status:r,details:n}){var h,p;const[i,o]=N.useState(!1),l={detected:"border-green-400 dark:border-green-600",synced:"border-blue-400 dark:border-blue-600",error:"border-red-400 dark:border-red-600",not_found:"border-slate-300 dark:border-slate-600"},c={detected:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",synced:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",error:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",not_found:"bg-slate-100 text-slate-600 dark:bg-slate-800 dark:text-slate-400"},d={detected:"Detected",synced:"Synced",error:"Error",not_found:"Not Found"};return e.jsx(M,{className:u("relative border-2 transition-all duration-300 cursor-pointer","hover:shadow-lg hover:-translate-y-0.5","bg-gradient-to-br from-white to-slate-50 dark:from-slate-800 dark:to-slate-800/50",l[r]),children:e.jsxs("div",{onClick:()=>o(!i),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:u("p-2 rounded-lg",r==="detected"?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":r==="synced"?"bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":"bg-slate-100 text-slate-500 dark:bg-slate-700 dark:text-slate-400"),children:t}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100 text-sm",children:s}),e.jsx("p",{className:"text-xs text-slate-500",children:a})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:u("px-2 py-0.5 rounded-full text-xs font-medium",c[r]),children:d[r]}),i?e.jsx(je,{className:"w-4 h-4 text-slate-400"}):e.jsx(me,{className:"w-4 h-4 text-slate-400"})]})]}),!i&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[e.jsx(na,{className:"w-3 h-3"}),e.jsx("span",{children:(h=n[0])==null?void 0:h.value}),e.jsx("span",{className:"text-slate-300 dark:text-slate-600",children:"|"}),e.jsx("span",{children:(p=n[1])==null?void 0:p.value})]}),i&&e.jsx("div",{className:"mt-3 pt-3 border-t border-slate-200 dark:border-slate-700 space-y-2",children:n.map((g,k)=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-slate-500",children:g.label}),e.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:g.value})]},k))})]})})}function _i(){var b;const t=Z(),{goToNextStep:s,goToPreviousStep:a,updateIncidentDescription:r,currentSession:n}=Q(),[i,o]=N.useState(((b=n==null?void 0:n.incidentDescription)==null?void 0:b.naturalLanguage)||""),[l,c]=N.useState(""),[d,h]=N.useState(""),[p,g]=N.useState([]),[k,j]=N.useState("hash"),[f,m]=N.useState(""),w=()=>{a(),t("/context")},x=()=>{r({naturalLanguage:i,startDate:l?new Date(l):new Date,patientZero:{hostname:d,type:"workstation"},iocs:p.map((C,_)=>({id:`ioc-${_}`,type:C.type,value:C.value,confidence:"medium"}))}),s(),t("/connectors")},v=()=>{f.trim()&&(g([...p,{type:k,value:f}]),m(""))},y=C=>{g(p.filter((_,U)=>U!==C))},T=["Ransomware detected","Unauthorized access","Data exfiltration suspected","Malicious email received","System compromise"];return e.jsx(ie,{title:"Incident Description",subtitle:"Describe the security incident in detail",footer:e.jsx(ue,{onBack:w,backLabel:"Context",onContinue:x,continueLabel:"Continue"}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(M,{children:[e.jsx(z,{title:"Describe the Incident",description:"Provide a detailed description of what happened"}),e.jsxs("div",{className:"mt-4",children:[e.jsx(gs,{value:i,onChange:C=>o(C.target.value),placeholder:"Our finance department reported that multiple file servers became inaccessible around 2:30 AM on Tuesday. Users discovered ransom notes demanding Bitcoin payment...",minRows:5,tooltip:"Describe the incident in your own words. Include what happened, when it was discovered, and any initial observations."}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:T.map(C=>e.jsx(S,{content:"Click to add this common phrase",children:e.jsx("button",{onClick:()=>o(_=>_?`${_} ${C}.`:C),className:u("px-3 py-1 text-sm rounded-full","bg-slate-100 dark:bg-slate-700","text-slate-600 dark:text-slate-300","hover:bg-forensic-100 dark:hover:bg-forensic-900/30","hover:text-forensic-700 dark:hover:text-forensic-300","transition-colors duration-200"),children:C})},C))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(M,{children:[e.jsx(z,{title:"Incident Start Date",description:"When was the incident first discovered?"}),e.jsx("div",{className:"mt-4",children:e.jsx(Fe,{type:"datetime-local",value:l,onChange:C=>c(C.target.value),leftAddon:e.jsx(as,{className:"w-4 h-4"}),tooltip:"When did the first indicator of the incident appear?"})})]}),e.jsxs(M,{children:[e.jsx(z,{title:"Patient Zero",description:"First affected system identified"}),e.jsx("div",{className:"mt-4",children:e.jsx(Fe,{value:d,onChange:C=>h(C.target.value),placeholder:"e.g., ACCT-WS-042 or 10.20.30.42",leftAddon:e.jsx(la,{className:"w-4 h-4"}),tooltip:"Enter the hostname or IP of the first affected system"})})]})]}),e.jsxs(M,{children:[e.jsx(z,{title:"Indicators of Compromise (IOCs)",description:"Add known IOCs associated with this incident"}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{content:"Type of Indicator of Compromise",children:e.jsxs("select",{value:k,onChange:C=>j(C.target.value),className:"input w-32",children:[e.jsx("option",{value:"hash",children:"Hash"}),e.jsx("option",{value:"ip",children:"IP Address"}),e.jsx("option",{value:"domain",children:"Domain"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"url",children:"URL"}),e.jsx("option",{value:"file_path",children:"File Path"})]})}),e.jsx(Fe,{value:f,onChange:C=>m(C.target.value),placeholder:"Enter IOC value...",className:"flex-1",tooltip:"Enter the IOC value"}),e.jsx(S,{content:"Add another Indicator of Compromise to the list",children:e.jsx(P,{onClick:v,leftIcon:e.jsx(oa,{className:"w-4 h-4"}),children:"Add"})})]}),p.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:p.map((C,_)=>e.jsxs(q,{variant:"secondary",children:[e.jsxs("span",{className:"font-medium capitalize",children:[C.type,":"]})," ",e.jsx("span",{className:"font-mono text-xs",children:C.value}),e.jsx("button",{onClick:()=>y(_),className:"ml-1 hover:text-red-500",children:e.jsx(St,{className:"w-3 h-3"})})]},_))})]})]})]})})}function zi(){const t=Z(),{goToNextStep:s,goToPreviousStep:a}=Q(),[r,n]=N.useState("endpoints"),[i,o]=N.useState(new Set),[l,c]=N.useState(!1),[d,h]=N.useState(null),[p,g]=N.useState("credentials"),[k,j]=N.useState(!1),[f,m]=N.useState("windows"),[w,x]=N.useState(!1),[v,y]=N.useState([]),[T,b]=N.useState(!1),[C,_]=N.useState(!1),U=()=>{a(),t("/incident")},H=()=>{s(),t("/validation")},le=I=>{h(I),c(!0)},R=()=>{d&&o(new Set([...i,d])),c(!1),h(null)},he=I=>({windows:e.jsx(ze,{className:"w-6 h-6"}),linux:e.jsx(ot,{className:"w-6 h-6"}),macos:e.jsx(xa,{className:"w-6 h-6"}),aws:e.jsx(ne,{className:"w-6 h-6"}),azure:e.jsx(ne,{className:"w-6 h-6"}),gcp:e.jsx(ne,{className:"w-6 h-6"}),o365:e.jsx(ye,{className:"w-6 h-6"}),gsuite:e.jsx(ye,{className:"w-6 h-6"}),firewall:e.jsx(xe,{className:"w-6 h-6"}),storage:e.jsx(ve,{className:"w-6 h-6"}),email_gateway:e.jsx(ma,{className:"w-6 h-6"}),proxy_waf:e.jsx(Le,{className:"w-6 h-6"})})[I],G=Ht.find(I=>I.id===r);return e.jsxs(ie,{title:"Connector Configuration",subtitle:"Configure data sources for forensic analysis",footer:e.jsx(ue,{onBack:U,backLabel:"Incident",onContinue:H,continueLabel:"Continue",middleContent:e.jsxs("span",{className:"text-sm text-slate-500",children:[i.size," connector",i.size!==1?"s":""," configured"]})}),children:[e.jsxs("div",{className:"flex gap-2 mb-6 border-b border-slate-200 dark:border-slate-700",children:[Ht.map(I=>e.jsx(S,{content:I.description,children:e.jsx("button",{onClick:()=>n(I.id),className:u("px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors",r===I.id?"border-forensic-500 text-forensic-600 dark:text-forensic-400":"border-transparent text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"),children:I.name})},I.id)),e.jsx(S,{content:"Agentless collection via portable tools or disk images",children:e.jsx("button",{onClick:()=>n("collector"),className:u("px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors",r==="collector"?"border-forensic-500 text-forensic-600 dark:text-forensic-400":"border-transparent text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"),children:"Agentless / Offline"})})]}),r!=="collector"&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:G==null?void 0:G.connectors.map(I=>{const W=Gt[I],pe=i.has(I);return e.jsx(Wi,{type:I,name:W.name,description:W.description,icon:he(I),isConfigured:pe,onConfigure:()=>le(I)},I)})}),r==="collector"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(M,{className:"border-2 border-dashed border-slate-300 dark:border-slate-600 hover:border-forensic-400 dark:hover:border-forensic-500 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-forensic-100 dark:bg-forensic-900/30 rounded-lg",children:e.jsx(Tt,{className:"w-8 h-8 text-forensic-600 dark:text-forensic-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Craft Portable Collector"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1 mb-3",children:"Build a lightweight executable that collects forensic artifacts without installing an agent. Run on any Windows or Linux system via USB or network share."}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsx("span",{className:"px-2 py-0.5 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 text-xs rounded-full",children:"No Installation"}),e.jsx("span",{className:"px-2 py-0.5 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 text-xs rounded-full",children:"USB Portable"}),e.jsx("span",{className:"px-2 py-0.5 bg-purple-50 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400 text-xs rounded-full",children:"Customizable"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(S,{content:"Configure and build a portable forensic collector",children:e.jsx(P,{size:"sm",onClick:()=>j(!0),leftIcon:e.jsx(rs,{className:"w-4 h-4"}),children:"Configure & Build"})})})]})]})}),e.jsx(M,{className:"border-2 border-dashed border-slate-300 dark:border-slate-600 hover:border-forensic-400 dark:hover:border-forensic-500 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-900/30 rounded-lg",children:e.jsx(Y,{className:"w-8 h-8 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Upload Disk Image"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1 mb-3",children:"Upload VM disk images or forensic images for triage without connecting to live systems. Supports VMDK, VHD, VHDX, E01, RAW, and more."}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsx("span",{className:"px-2 py-0.5 bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 text-xs rounded-full",children:"VMDK"}),e.jsx("span",{className:"px-2 py-0.5 bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 text-xs rounded-full",children:"VHD/VHDX"}),e.jsx("span",{className:"px-2 py-0.5 bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 text-xs rounded-full",children:"E01"}),e.jsx("span",{className:"px-2 py-0.5 bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 text-xs rounded-full",children:"RAW/DD"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(S,{content:"Upload a forensic disk image for offline analysis",children:e.jsx(P,{size:"sm",onClick:()=>x(!0),leftIcon:e.jsx(be,{className:"w-4 h-4"}),children:"Upload Image"})})})]})]})})]}),v.length>0&&e.jsxs(M,{children:[e.jsxs("h4",{className:"font-medium text-slate-900 dark:text-slate-100 mb-3",children:["Uploaded Images (",v.length,")"]}),e.jsx("div",{className:"space-y-2",children:v.map((I,W)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsx(ve,{className:"w-5 h-5 text-slate-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:I}),e.jsx("p",{className:"text-xs text-slate-500",children:"VMDK  42.5 GB  Uploaded just now"})]}),e.jsx(V,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-xs text-green-600 dark:text-green-400",children:"Ready for triage"})]},W))})]})]}),e.jsx(dt,{open:l,onOpenChange:c,title:`Configure ${d?Gt[d].name:""}`,description:"Enter connection details for this data source",size:"md",footer:e.jsxs(e.Fragment,{children:[e.jsx(P,{variant:"secondary",onClick:()=>c(!1),children:"Cancel"}),e.jsx(S,{content:"Verify connectivity to this system (simulated)",children:e.jsx(P,{variant:"outline",children:"Test Connection"})}),e.jsx(P,{onClick:R,children:"Save"})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Hostname / IP"}),e.jsx("input",{type:"text",className:"input",placeholder:"e.g., 10.0.1.10 or server.domain.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label mb-2 block",children:"Authentication Method"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("button",{onClick:()=>g("credentials"),className:u("flex flex-col items-center gap-1.5 p-3 rounded-lg border text-xs font-medium transition-colors",p==="credentials"?"border-forensic-500 bg-forensic-50 text-forensic-700 dark:bg-forensic-900/20 dark:text-forensic-300":"border-slate-200 dark:border-slate-700 text-slate-500 hover:border-slate-300"),children:[e.jsx(st,{className:"w-4 h-4"}),"Credentials"]}),e.jsxs("button",{onClick:()=>g("certificate"),className:u("flex flex-col items-center gap-1.5 p-3 rounded-lg border text-xs font-medium transition-colors",p==="certificate"?"border-forensic-500 bg-forensic-50 text-forensic-700 dark:bg-forensic-900/20 dark:text-forensic-300":"border-slate-200 dark:border-slate-700 text-slate-500 hover:border-slate-300"),children:[e.jsx(ca,{className:"w-4 h-4"}),"Certificate"]}),e.jsxs("button",{onClick:()=>g("ssh_key"),className:u("flex flex-col items-center gap-1.5 p-3 rounded-lg border text-xs font-medium transition-colors",p==="ssh_key"?"border-forensic-500 bg-forensic-50 text-forensic-700 dark:bg-forensic-900/20 dark:text-forensic-300":"border-slate-200 dark:border-slate-700 text-slate-500 hover:border-slate-300"),children:[e.jsx(ot,{className:"w-4 h-4"}),"SSH Key"]})]})]}),p==="credentials"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Username"}),e.jsx("input",{type:"text",className:"input",placeholder:"Service account username"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Password"}),e.jsx("input",{type:"password",className:"input",placeholder:"Service account password"})]})]}),p==="certificate"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Certificate File (.pem, .pfx, .p12)"}),e.jsxs("div",{className:u("border-2 border-dashed rounded-lg p-4 text-center cursor-pointer","border-slate-300 dark:border-slate-600","hover:border-forensic-400 dark:hover:border-forensic-500","transition-colors duration-200"),children:[e.jsx(be,{className:"w-6 h-6 mx-auto text-slate-400 mb-2"}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Drag & drop or ",e.jsx("span",{className:"text-forensic-500 font-medium",children:"browse"})," certificate file"]}),e.jsx("input",{type:"file",accept:".pem,.pfx,.p12,.cer,.crt",className:"hidden"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Certificate Password (if applicable)"}),e.jsx("input",{type:"password",className:"input",placeholder:"Private key passphrase"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"CA Bundle (optional)"}),e.jsx("input",{type:"text",className:"input",placeholder:"Path to CA bundle or paste CA cert"})]})]}),p==="ssh_key"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Username"}),e.jsx("input",{type:"text",className:"input",placeholder:"SSH username (e.g., root, forensic-svc)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"SSH Private Key"}),e.jsxs("div",{className:u("border-2 border-dashed rounded-lg p-4 text-center cursor-pointer","border-slate-300 dark:border-slate-600","hover:border-forensic-400 dark:hover:border-forensic-500","transition-colors duration-200"),children:[e.jsx(be,{className:"w-6 h-6 mx-auto text-slate-400 mb-2"}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Upload ",e.jsx("span",{className:"text-forensic-500 font-medium",children:"id_rsa"}),", ",e.jsx("span",{className:"text-forensic-500 font-medium",children:"id_ed25519"}),", or other key file"]}),e.jsx("input",{type:"file",accept:".pem,.key,.pub",className:"hidden"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Key Passphrase (if applicable)"}),e.jsx("input",{type:"password",className:"input",placeholder:"SSH key passphrase"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"SSH Port"}),e.jsx("input",{type:"number",className:"input",placeholder:"22",defaultValue:22})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"mockMode",className:"rounded",defaultChecked:!0}),e.jsx("label",{htmlFor:"mockMode",className:"text-sm text-slate-600 dark:text-slate-400",children:"Use simulated data for demo"})]})]})}),e.jsx(dt,{open:k,onOpenChange:j,title:"Craft Portable Collector",description:"Build a lightweight forensic collector for offline triage",size:"md",footer:e.jsxs(e.Fragment,{children:[e.jsx(P,{variant:"secondary",onClick:()=>j(!1),children:"Cancel"}),e.jsx(S,{content:"Generate a portable collector package",children:e.jsx(P,{onClick:()=>{_(!0),setTimeout(()=>{_(!1),b(!0)},2e3)},isLoading:C,leftIcon:e.jsx(Tt,{className:"w-4 h-4"}),children:"Build Collector"})})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label mb-2 block",children:"Target Platform"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>m("windows"),className:u("flex items-center gap-3 p-4 rounded-lg border transition-colors",f==="windows"?"border-forensic-500 bg-forensic-50 dark:bg-forensic-900/20":"border-slate-200 dark:border-slate-700 hover:border-slate-300"),children:[e.jsx(ze,{className:"w-6 h-6"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-sm font-medium",children:"Windows"}),e.jsx("p",{className:"text-xs text-slate-500",children:".exe portable"})]})]}),e.jsxs("button",{onClick:()=>m("linux"),className:u("flex items-center gap-3 p-4 rounded-lg border transition-colors",f==="linux"?"border-forensic-500 bg-forensic-50 dark:bg-forensic-900/20":"border-slate-200 dark:border-slate-700 hover:border-slate-300"),children:[e.jsx(ot,{className:"w-6 h-6"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-sm font-medium",children:"Linux"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Shell script / binary"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label mb-2 block",children:"Collection Scope"}),e.jsx("div",{className:"space-y-2",children:[{id:"evtlogs",label:"Event Logs / Syslog",checked:!0},{id:"registry",label:f==="windows"?"Registry Hives":"Config Files (/etc)",checked:!0},{id:"filesystem",label:"File System Metadata (MFT / Inodes)",checked:!0},{id:"memory",label:"Memory Dump (RAM)",checked:!1},{id:"network",label:"Network Connections & ARP Table",checked:!0},{id:"processes",label:"Running Processes & Services",checked:!0},{id:"persistence",label:"Persistence Mechanisms (Startup, Cron, Tasks)",checked:!0},{id:"browser",label:"Browser Artifacts",checked:!1}].map(I=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",defaultChecked:I.checked,className:"rounded"}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:I.label})]},I.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Output Format"}),e.jsxs("select",{className:"input",defaultValue:"zip",children:[e.jsx("option",{value:"zip",children:"ZIP Archive (compressed)"}),e.jsx("option",{value:"tar",children:"TAR.GZ Archive"}),e.jsx("option",{value:"raw",children:"Raw directory structure"})]})]}),T&&e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(V,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Collector Ready"})]}),e.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 mb-2",children:[f==="windows"?"forensic-collector-win-x64.exe":"forensic-collector-linux-x64.sh"," (2.4 MB)"]}),e.jsx(P,{size:"sm",variant:"outline",leftIcon:e.jsx(qe,{className:"w-3 h-3"}),children:"Download Collector"})]})]})}),e.jsx(dt,{open:w,onOpenChange:x,title:"Upload Disk Image",description:"Upload a forensic disk image for offline triage analysis",size:"md",footer:e.jsxs(e.Fragment,{children:[e.jsx(P,{variant:"secondary",onClick:()=>x(!1),children:"Cancel"}),e.jsx(P,{onClick:()=>{y([...v,"server-backup-2024.vmdk"]),x(!1)},leftIcon:e.jsx(be,{className:"w-4 h-4"}),children:"Upload & Analyze"})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label mb-2 block",children:"Supported Formats"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{format:"VMDK",desc:"VMware disk"},{format:"VHD",desc:"Hyper-V (Gen1)"},{format:"VHDX",desc:"Hyper-V (Gen2)"},{format:"E01",desc:"EnCase image"},{format:"RAW/DD",desc:"Raw disk image"},{format:"QCOW2",desc:"QEMU disk"},{format:"OVA",desc:"Open Virtual"},{format:"ISO",desc:"Disk image"}].map(I=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-slate-50 dark:bg-slate-800/50 rounded text-xs",children:[e.jsx(ve,{className:"w-3 h-3 text-slate-400"}),e.jsx("span",{className:"font-medium",children:I.format}),e.jsxs("span",{className:"text-slate-400",children:["- ",I.desc]})]},I.format))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Disk Image File"}),e.jsxs("div",{className:u("border-2 border-dashed rounded-lg p-8 text-center cursor-pointer","border-slate-300 dark:border-slate-600","hover:border-forensic-400 dark:hover:border-forensic-500","transition-colors duration-200"),children:[e.jsx(da,{className:"w-10 h-10 mx-auto text-slate-400 mb-3"}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Drag & Drop or ",e.jsx("span",{className:"text-forensic-500 font-medium",children:"browse"})]}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"VMDK, VHD, VHDX, E01, RAW, QCOW2, OVA, ISO"}),e.jsx("input",{type:"file",accept:".vmdk,.vhd,.vhdx,.e01,.dd,.raw,.qcow2,.ova,.iso",className:"hidden"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Image Description"}),e.jsx("input",{type:"text",className:"input",placeholder:"e.g., Finance Server backup from Jan 15"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Source System Hostname (optional)"}),e.jsx("input",{type:"text",className:"input",placeholder:"e.g., FS-FINANCE-01"})]}),v.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"label",children:"Uploaded Images"}),v.map((I,W)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 dark:bg-green-900/20 rounded text-sm",children:[e.jsx(V,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-green-700 dark:text-green-300",children:I})]},W))]})]})})]})}function Wi({name:t,description:s,icon:a,isConfigured:r,onConfigure:n}){return e.jsxs(M,{className:u(r&&"ring-2 ring-green-500 ring-offset-2 dark:ring-offset-slate-900"),children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:u("text-slate-400",r&&"text-green-500"),children:a}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100",children:t}),r&&e.jsx(V,{className:"w-4 h-4 text-green-500"})]}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:s})]})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[e.jsx(S,{content:"Open configuration form for this data source",children:e.jsx(P,{size:"sm",variant:r?"secondary":"primary",onClick:n,leftIcon:e.jsx(rs,{className:"w-4 h-4"}),children:r?"Reconfigure":"Configure"})}),e.jsx(S,{content:"Use simulated data instead of real connection",children:e.jsxs("label",{className:"flex items-center gap-1 text-xs text-slate-500 cursor-pointer",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded w-3 h-3"}),"Mock"]})})]})]})}function Vi(){const t=Z(),{goToNextStep:s,goToPreviousStep:a}=Q(),{extractedEntities:r}=vs(),{systems:n,autoValidateEnabled:i,discrepancies:o,isValidating:l,initializeFromSystems:c,setAutoValidate:d,validateSystem:h,validateAllSystems:p}=$r(),[g,k]=N.useState(!1),[j,f]=N.useState(null);N.useEffect(()=>{r.systems.length>0&&n.length===0&&c(r.systems)},[r.systems,n.length,c]);const m=()=>{if(g){k(!1);return}a(),t("/connectors")},w=()=>{if(!g&&x>0){k(!0);return}s(),t("/triage")},x=n.filter(b=>b.overallStatus==="verified").length,v=n.filter(b=>b.overallStatus==="failed").length,y=n.filter(b=>b.overallStatus==="pending").length,T=n.filter(b=>b.overallStatus==="unknown").length;return e.jsxs(ie,{title:"Infrastructure Validation",subtitle:"Verify documented systems exist and match reality",actions:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{content:"Automatically validate all documented systems when page loads",children:e.jsxs("button",{onClick:()=>d(!i),className:u("flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors",i?"bg-forensic-100 text-forensic-700 dark:bg-forensic-900/30 dark:text-forensic-300":"bg-slate-100 text-slate-600 dark:bg-slate-800 dark:text-slate-400"),children:[i?e.jsx(ha,{className:"w-5 h-5"}):e.jsx(pa,{className:"w-5 h-5"}),"Auto-Validate"]})}),e.jsx(S,{content:"Run validation checks on all documented systems",children:e.jsx(P,{variant:"primary",size:"sm",onClick:p,isLoading:l,leftIcon:e.jsx(ns,{className:"w-4 h-4"}),children:"Validate All"})}),e.jsx(S,{content:"Export validation results as CSV",children:e.jsx(P,{variant:"secondary",size:"sm",leftIcon:e.jsx(qe,{className:"w-4 h-4"}),children:"Export"})})]}),footer:e.jsx(ue,{onBack:m,backLabel:g?"Back to Validation":"Connectors",onContinue:w,continueLabel:g?"Proceed to Triage":(o.length>0,"View Summary")}),children:[g&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(M,{className:"bg-gradient-to-br from-forensic-50 to-white dark:from-forensic-900/20 dark:to-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-forensic-100 dark:bg-forensic-900/30 rounded-lg",children:e.jsx(ua,{className:"w-6 h-6 text-forensic-600 dark:text-forensic-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:"Infrastructure Summary"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Complete overview of discovered resources before triage begins"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-6 gap-3",children:[e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(Y,{className:"w-5 h-5 mx-auto text-blue-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:r.systems.length}),e.jsx("p",{className:"text-xs text-slate-500",children:"Systems"})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(_e,{className:"w-5 h-5 mx-auto text-green-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:r.networks.length}),e.jsx("p",{className:"text-xs text-slate-500",children:"Networks"})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(gt,{className:"w-5 h-5 mx-auto text-purple-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"~1,250"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Employees"})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(ne,{className:"w-5 h-5 mx-auto text-cyan-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"3"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Cloud Services"})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(Xe,{className:"w-5 h-5 mx-auto text-orange-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:r.processes.length}),e.jsx("p",{className:"text-xs text-slate-500",children:"Processes"})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(xe,{className:"w-5 h-5 mx-auto text-red-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:r.compliance.length}),e.jsx("p",{className:"text-xs text-slate-500",children:"Compliance"})]})]})]}),e.jsx(Te,{title:"Systems & Servers",icon:e.jsx(Y,{className:"w-5 h-5 text-blue-500"}),count:r.systems.length,isExpanded:j==="systems",onToggle:()=>f(j==="systems"?null:"systems"),children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-slate-500 uppercase",children:[e.jsx("th",{className:"pb-2",children:"Hostname"}),e.jsx("th",{className:"pb-2",children:"IP"}),e.jsx("th",{className:"pb-2",children:"Role"}),e.jsx("th",{className:"pb-2",children:"OS"}),e.jsx("th",{className:"pb-2",children:"Criticality"}),e.jsx("th",{className:"pb-2",children:"Validation"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:r.systems.map(b=>{const C=n.find(_=>_.hostname===b.hostname);return e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30",children:[e.jsx("td",{className:"py-2 font-medium",children:b.hostname}),e.jsx("td",{className:"py-2 font-mono text-xs text-slate-500",children:b.ip||"N/A"}),e.jsx("td",{className:"py-2 text-slate-600 dark:text-slate-400",children:b.role}),e.jsx("td",{className:"py-2 text-slate-500 text-xs",children:b.os||"-"}),e.jsx("td",{className:"py-2",children:e.jsx("span",{className:u("px-2 py-0.5 rounded-full text-xs font-medium",b.criticality==="critical"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":b.criticality==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"),children:b.criticality})}),e.jsx("td",{className:"py-2",children:C?e.jsxs("span",{className:u("flex items-center gap-1 text-xs",C.overallStatus==="verified"?"text-green-600":C.overallStatus==="failed"?"text-red-600":"text-yellow-600"),children:[C.overallStatus==="verified"&&e.jsx(V,{className:"w-3 h-3"}),C.overallStatus==="failed"&&e.jsx(Qe,{className:"w-3 h-3"}),C.overallStatus==="pending"&&e.jsx(ke,{className:"w-3 h-3"}),C.overallStatus]}):e.jsx("span",{className:"text-xs text-slate-400",children:"-"})})]},b.id)})})]})})}),e.jsx(Te,{title:"Network Segments",icon:e.jsx(_e,{className:"w-5 h-5 text-green-500"}),count:r.networks.length,isExpanded:j==="networks",onToggle:()=>f(j==="networks"?null:"networks"),children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:r.networks.map(b=>e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Le,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"font-medium text-sm",children:b.name}),b.vlan&&e.jsxs("span",{className:"text-xs bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 px-1.5 rounded",children:["VLAN ",b.vlan]})]}),e.jsx("p",{className:"text-xs font-mono text-slate-500",children:b.cidr}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:b.description})]},b.id))})}),e.jsx(Te,{title:"Business Processes",icon:e.jsx(Xe,{className:"w-5 h-5 text-orange-500"}),count:r.processes.length,isExpanded:j==="processes",onToggle:()=>f(j==="processes"?null:"processes"),children:r.processes.map(b=>e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg mb-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-medium text-sm",children:b.name}),e.jsx("span",{className:u("px-2 py-0.5 rounded-full text-xs font-medium",b.criticality==="critical"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-orange-100 text-orange-700"),children:b.criticality})]}),e.jsx("p",{className:"text-xs text-slate-500",children:b.description}),e.jsxs("div",{className:"flex gap-4 mt-2 text-xs text-slate-400",children:[e.jsxs("span",{children:["RTO: ",b.rto,"h"]}),e.jsxs("span",{children:["RPO: ",b.rpo,"h"]}),e.jsxs("span",{children:["Depends: ",b.dependentSystems.join(", ")]})]})]},b.id))}),e.jsx(Te,{title:"Key Personnel & Employees",icon:e.jsx(gt,{className:"w-5 h-5 text-purple-500"}),count:8,isExpanded:j==="employees",onToggle:()=>f(j==="employees"?null:"employees"),children:e.jsx("div",{className:"space-y-2",children:[{name:"John Smith",role:"IT Director",dept:"IT",access:"Domain Admin",risk:"high"},{name:"Sarah Johnson",role:"CISO",dept:"Security",access:"Security Admin",risk:"high"},{name:"Mike Chen",role:"Sr. Network Engineer",dept:"IT",access:"Network Admin",risk:"medium"},{name:"Lisa Williams",role:"Finance Manager",dept:"Finance",access:"Finance Share",risk:"medium"},{name:"svc-backup",role:"Service Account",dept:"System",access:"Backup Operator",risk:"high"},{name:"svc-sql",role:"Service Account",dept:"System",access:"SQL Server Agent",risk:"high"},{name:"admin.jsmith",role:"Privileged Account",dept:"IT",access:"Domain Admin",risk:"critical"},{name:"helpdesk-svc",role:"Service Account",dept:"IT",access:"Password Reset",risk:"medium"}].map((b,C)=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-slate-50 dark:bg-slate-800/50 rounded-lg text-sm",children:[e.jsx("div",{className:u("w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium",b.role.includes("Service")||b.role.includes("Privileged")?"bg-orange-100 text-orange-600 dark:bg-orange-900/30":"bg-blue-100 text-blue-600 dark:bg-blue-900/30"),children:b.name.slice(0,2).toUpperCase()}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-medium",children:b.name}),e.jsx("span",{className:"text-slate-400 ml-2 text-xs",children:b.role})]}),e.jsx("span",{className:"text-xs text-slate-500",children:b.dept}),e.jsx("span",{className:"text-xs text-slate-400",children:b.access}),e.jsx("span",{className:u("px-1.5 py-0.5 rounded text-xs font-medium",b.risk==="critical"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":b.risk==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"),children:b.risk})]},C))})}),e.jsx(Te,{title:"Compliance & Data Classification",icon:e.jsx(xe,{className:"w-5 h-5 text-red-500"}),count:r.compliance.length,isExpanded:j==="compliance",onToggle:()=>f(j==="compliance"?null:"compliance"),children:r.compliance.map(b=>e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"px-2 py-0.5 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 text-xs font-medium rounded",children:b.framework}),e.jsx("span",{className:"font-medium text-sm",children:b.requirement})]}),e.jsx("p",{className:"text-xs text-slate-500",children:b.description}),e.jsxs("p",{className:"text-xs text-slate-400 mt-1",children:["Applies to: ",b.applicableSystems.join(", ")]})]},b.id))}),e.jsx(M,{className:"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border-green-200 dark:border-green-800",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(V,{className:"w-8 h-8 text-green-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-green-800 dark:text-green-200",children:"Ready for Triage"}),e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400",children:[x," of ",n.length,' systems verified. All key resources have been documented and validated. Click "Proceed to Triage" to begin forensic analysis.']})]}),e.jsx(tt,{className:"w-5 h-5 text-green-500"})]})})]}),!g&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6",children:[e.jsx(Ge,{icon:e.jsx(V,{className:"w-5 h-5"}),count:x,label:"Verified",color:"green"}),e.jsx(Ge,{icon:e.jsx(Qe,{className:"w-5 h-5"}),count:v,label:"Failed",color:"red"}),e.jsx(Ge,{icon:e.jsx(ke,{className:"w-5 h-5"}),count:y,label:"Pending",color:"yellow"}),e.jsx(Ge,{icon:e.jsx(Ct,{className:"w-5 h-5"}),count:T,label:"Unknown",color:"slate"})]}),o.length>0&&e.jsx(M,{className:"mb-6 border-yellow-300 dark:border-yellow-700 bg-yellow-50 dark:bg-yellow-900/20",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(rt,{className:"w-5 h-5 text-yellow-500 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:["Discrepancy Alerts (",o.length,")"]}),e.jsxs("ul",{className:"mt-2 space-y-1 text-sm text-yellow-700 dark:text-yellow-300",children:[o.slice(0,3).map(b=>e.jsxs("li",{children:[e.jsxs("span",{className:"font-medium",children:[b.hostname,":"]})," ",b.description]},b.id)),o.length>3&&e.jsxs("li",{className:"text-yellow-600 dark:text-yellow-400",children:["+",o.length-3," more discrepancies"]})]})]})]})}),e.jsx(M,{padding:"none",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 dark:bg-slate-800/50 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"System"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"IP"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Methods"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:n.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-4 py-12 text-center",children:[e.jsx(Y,{className:"w-10 h-10 mx-auto text-slate-300 mb-3"}),e.jsx("p",{className:"text-slate-500",children:"No systems to validate"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Upload documents with system information first"})]})}):n.map(b=>e.jsx(Bi,{system:b,onValidate:()=>h(b.systemId),isValidating:l},b.systemId))})]})})})]})]})}function Te({title:t,icon:s,count:a,isExpanded:r,onToggle:n,children:i}){return e.jsxs(M,{children:[e.jsxs("button",{onClick:n,className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s,e.jsx("span",{className:"font-semibold text-slate-900 dark:text-slate-100",children:t}),e.jsx("span",{className:"text-xs bg-slate-100 dark:bg-slate-700 px-2 py-0.5 rounded-full text-slate-500",children:a})]}),r?e.jsx(je,{className:"w-5 h-5 text-slate-400"}):e.jsx(me,{className:"w-5 h-5 text-slate-400"})]}),r&&e.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200 dark:border-slate-700",children:i})]})}function Ge({icon:t,count:s,label:a,color:r}){const n={green:"text-green-500 bg-green-50 dark:bg-green-900/20",red:"text-red-500 bg-red-50 dark:bg-red-900/20",yellow:"text-yellow-500 bg-yellow-50 dark:bg-yellow-900/20",slate:"text-slate-400 bg-slate-50 dark:bg-slate-800/50"};return e.jsx(M,{className:u("text-center",n[r]),children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[t,e.jsx("span",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:s}),e.jsx("span",{className:"text-xs text-slate-500",children:a})]})})}function Bi({system:t,onValidate:s,isValidating:a}){const r={verified:e.jsx(V,{className:"w-4 h-4 text-green-500"}),failed:e.jsx(Qe,{className:"w-4 h-4 text-red-500"}),pending:e.jsx(ke,{className:"w-4 h-4 text-yellow-500"}),unknown:e.jsx(Ct,{className:"w-4 h-4 text-slate-400"})};return e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"font-medium text-slate-900 dark:text-slate-100",children:t.hostname})}),e.jsx("td",{className:"px-4 py-3 font-mono text-sm text-slate-600 dark:text-slate-400",children:t.documentedIP}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-400",children:t.role}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-1",children:[t.validationMethods.slice(0,3).map(n=>e.jsx(S,{content:Mr[n].description,children:e.jsx(q,{variant:"secondary",size:"sm",children:n.toUpperCase().slice(0,3)})},n)),t.validationMethods.length>3&&e.jsxs(q,{variant:"secondary",size:"sm",children:["+",t.validationMethods.length-3]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[r[t.overallStatus],e.jsx("span",{className:u("text-sm capitalize",t.overallStatus==="verified"&&"text-green-600",t.overallStatus==="failed"&&"text-red-600",t.overallStatus==="pending"&&"text-yellow-600",t.overallStatus==="unknown"&&"text-slate-500"),children:t.overallStatus})]})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx(S,{content:"Run validation checks on this system",children:e.jsx(P,{variant:"ghost",size:"sm",onClick:s,disabled:a,leftIcon:a&&t.overallStatus==="pending"?e.jsx(vr,{size:"sm"}):e.jsx(ns,{className:"w-3 h-3"}),children:"Validate"})})})]})}const ss=[{id:"cti-1",type:"leaked_credentials",source:"BreachDB (OSINT)",severity:"critical",title:"Compromised credentials found in 2024 data breach",description:"12 corporate email addresses with password hashes found in recent breach dump. Includes admin accounts.",date:"2024-01-10",indicators:["admin.jsmith@company.com","svc-backup@company.com","sarah.j@company.com"]},{id:"cti-2",type:"darknet_mention",source:"Darknet Forum Monitoring",severity:"high",title:"Company network access for sale on darknet forum",description:"Initial access broker offering VPN credentials and internal network maps. Listed 3 days before the incident.",date:"2024-01-12",indicators:["vpn.company.com","RDP access - Finance segment","$5,000 asking price"]},{id:"cti-3",type:"pii_exposure",source:"Public Paste Sites",severity:"high",title:"Employee PII leaked on paste site",description:"Partial employee directory with names, email addresses, phone numbers, and department info found on public paste site.",date:"2024-01-08",indicators:["~250 employee records","Names, emails, phone numbers","Department structure"]},{id:"cti-4",type:"breach_database",source:"Have I Been Pwned (OSINT)",severity:"medium",title:"Domain appears in 3 known breach databases",description:"company.com domain found across multiple breach databases with varying dates and data types exposed.",date:"2023-11-15",indicators:["LinkedIn breach (2023)","Third-party SaaS breach (2024)","Marketing platform leak (2023)"]},{id:"cti-5",type:"paste_site",source:"GitHub/Gist OSINT",severity:"medium",title:"Internal API keys found in public GitHub repos",description:"AWS access keys and internal API tokens committed to public repositories by developers.",date:"2024-01-05",indicators:["AWS Access Key: AKIA****","Slack webhook URL","Internal API bearer token"]}];function Ui(){var ee;const t=Z(),{goToNextStep:s,goToPreviousStep:a}=Q(),[r,n]=N.useState(!1),[i,o]=N.useState(!1),[l,c]=N.useState(0),[d,h]=N.useState(0),[p,g]=N.useState(ge.map(()=>0)),[k,j]=N.useState([]),[f,m]=N.useState({critical:0,high:0,medium:0,low:0,ambiguous:0}),[w,x]=N.useState(""),[v,y]=N.useState(!1),[T,b]=N.useState([]),[C,_]=N.useState("all"),U=N.useRef(null),H=N.useRef(null);N.useEffect(()=>{U.current&&(U.current.scrollTop=U.current.scrollHeight)},[k]),N.useEffect(()=>{if(!r||i){H.current&&clearInterval(H.current);return}return H.current=setInterval(()=>{if(c(A=>{const E=A+1;return E>=100?(n(!1),100):E}),g(A=>{const E=[...A],te=100/ge.length;for(let B=0;B<ge.length;B++){const It=B*te,Ts=(B+1)*te,lt=l+1;lt>=Ts?E[B]=100:lt>It&&(E[B]=(lt-It)/te*100,h(B))}return E}),Math.random()>.5){const A=[{message:"Collecting Windows Security Event Logs...",severity:"info"},{message:"Analyzing authentication patterns...",severity:"info"},{message:"Found suspicious process execution",severity:"warning"},{message:"Extracting registry artifacts...",severity:"info"},{message:"Correlating network connections...",severity:"info"},{message:"Detected potential lateral movement",severity:"warning"},{message:"Identified scheduled task persistence",severity:"warning"},{message:"Phase completed successfully",severity:"success"}],E=A[Math.floor(Math.random()*A.length)];j(te=>{var B;return[...te.slice(-49),{id:`${Date.now()}-${Math.random()}`,timestamp:new Date,phase:((B=ge[d])==null?void 0:B.name)||"Analysis",...E}]}),Math.random()>.85&&m(te=>{const B=["critical","high","medium","low","ambiguous"][Math.floor(Math.random()*5)];return{...te,[B]:te[B]+1}})}},200),()=>{H.current&&clearInterval(H.current)}},[r,i,l,d]);const le=()=>{a(),t("/validation")},R=()=>{s(),t("/timeline")},he=()=>{n(!0),o(!1)},G=()=>{o(!i)},I=A=>{const E=[e.jsx(Xe,{className:"w-5 h-5"},"db"),e.jsx(is,{className:"w-5 h-5"},"search"),e.jsx(we,{className:"w-5 h-5"},"activity"),e.jsx(fa,{className:"w-5 h-5"},"git"),e.jsx(ba,{className:"w-5 h-5"},"radar")];return E[A]||E[0]},W=A=>p[A]>=100?"complete":p[A]>0?"running":"pending",pe=N.useCallback(()=>{y(!0),b([]),setTimeout(()=>{const A=C==="all"?ss:ss.filter(E=>C==="credentials"?E.type==="leaked_credentials"||E.type==="breach_database":C==="pii"?E.type==="pii_exposure"||E.type==="paste_site":C==="darknet"?E.type==="darknet_mention":!0);b(A),y(!1)},2500)},[C]),Ce=f.critical+f.high+f.medium+f.low;return e.jsxs(ie,{title:"Triage Process",subtitle:"Automated forensic analysis in progress",footer:e.jsx(ue,{onBack:le,backLabel:"Validation",onContinue:R,continueLabel:"View Timeline",continueDisabled:l<100}),children:[e.jsx(M,{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-6",children:[e.jsx(br,{value:l,size:140,variant:l>=100?"success":"default"}),e.jsxs("div",{className:"flex-1 text-center sm:text-left",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:l>=100?"Analysis Complete":i?"Paused":r?((ee=ge[d])==null?void 0:ee.name)||"Analyzing...":"Ready to Start"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:l>=100?`Found ${Ce} findings (${f.ambiguous} require verification)`:r?"Processing forensic data...":"Click Start to begin the automated triage process"}),e.jsxs("div",{className:"mt-4 flex gap-2 justify-center sm:justify-start",children:[!r&&l<100&&e.jsx(S,{content:"Begin automated forensic triage",children:e.jsx(P,{onClick:he,leftIcon:e.jsx(Et,{className:"w-4 h-4"}),children:"Start Triage"})}),r&&e.jsx(S,{content:i?"Resume the triage process":"Pause the triage process",children:e.jsx(P,{variant:"secondary",onClick:G,leftIcon:i?e.jsx(Et,{className:"w-4 h-4"}):e.jsx(ga,{className:"w-4 h-4"}),children:i?"Resume":"Pause"})})]})]})]})}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:ge.map((A,E)=>e.jsx(Gi,{name:A.name,icon:I(E),progress:p[E],status:W(E)},A.id))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(M,{className:"h-[400px] flex flex-col",children:[e.jsx(z,{title:"Activity Feed",description:"Real-time log of triage operations"}),e.jsx("div",{ref:U,className:"flex-1 overflow-y-auto mt-4 space-y-2",children:k.length===0?e.jsx("p",{className:"text-sm text-slate-400 text-center py-8",children:"Activity will appear here when triage starts..."}):k.map(A=>e.jsx($i,{log:A},A.id))})]})}),e.jsx("div",{children:e.jsxs(M,{className:"h-[400px]",children:[e.jsx(z,{title:"Findings",description:"Detected issues and anomalies"}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx(Ee,{label:"Critical",count:f.critical,color:"red"}),e.jsx(Ee,{label:"High",count:f.high,color:"orange"}),e.jsx(Ee,{label:"Medium",count:f.medium,color:"yellow"}),e.jsx(Ee,{label:"Low",count:f.low,color:"green"}),e.jsx("hr",{className:"border-slate-200 dark:border-slate-700"}),e.jsx(Ee,{label:"Ambiguous",count:f.ambiguous,color:"purple",tooltip:"Findings requiring manual review"})]})]})})]}),e.jsx("div",{className:"mt-6",children:e.jsxs(M,{children:[e.jsx(z,{title:"Cyber Threat Intelligence (CTI)",description:"OSINT search for PII, leaked credentials, and darknet mentions"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-[200px] relative",children:[e.jsx(Ot,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",value:w,onChange:A=>x(A.target.value),placeholder:"Search domain, email, IP, or keyword...",className:"input pl-10"})]}),e.jsx("div",{className:"flex gap-1",children:[{id:"all",label:"All Sources",icon:e.jsx(Le,{className:"w-3 h-3"})},{id:"pii",label:"PII / Leaks",icon:e.jsx(Nt,{className:"w-3 h-3"})},{id:"credentials",label:"Credentials",icon:e.jsx(st,{className:"w-3 h-3"})},{id:"darknet",label:"Darknet",icon:e.jsx(kt,{className:"w-3 h-3"})}].map(A=>e.jsx(S,{content:`Search ${A.label}`,children:e.jsxs("button",{onClick:()=>_(A.id),className:u("flex items-center gap-1.5 px-3 py-2 rounded-lg text-xs font-medium transition-colors",C===A.id?"bg-forensic-100 text-forensic-700 dark:bg-forensic-900/30 dark:text-forensic-300":"bg-slate-100 dark:bg-slate-800 text-slate-500 hover:text-slate-700"),children:[A.icon,A.label]})},A.id))}),e.jsx(S,{content:"Search public OSINT sources and darknet databases",children:e.jsx(P,{onClick:pe,isLoading:v,leftIcon:e.jsx(Ot,{className:"w-4 h-4"}),size:"sm",children:"Search CTI"})})]}),v&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsx(ft,{className:"w-5 h-5 animate-spin text-forensic-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Searching threat intelligence sources..."}),e.jsx("p",{className:"text-xs text-slate-500",children:"Querying OSINT databases, breach databases, paste sites, darknet forums"})]})]}),T.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[e.jsx(rt,{className:"w-4 h-4 text-yellow-500"}),e.jsxs("span",{children:[T.length," results found across open and dark sources"]})]}),T.map(A=>e.jsx(Hi,{result:A},A.id))]}),!v&&T.length===0&&e.jsxs("div",{className:"text-center py-6 text-slate-400",children:[e.jsx(Le,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Run a CTI search to discover exposed data, leaked credentials, and darknet mentions"}),e.jsx("p",{className:"text-xs mt-1",children:"Sources: OSINT databases, breach databases, paste sites, darknet forums, public repos"})]})]})]})})]})}function Hi({result:t}){const[s,a]=N.useState(!1),r={pii_exposure:e.jsx(Nt,{className:"w-4 h-4"}),leaked_credentials:e.jsx(st,{className:"w-4 h-4"}),darknet_mention:e.jsx(kt,{className:"w-4 h-4"}),paste_site:e.jsx(is,{className:"w-4 h-4"}),breach_database:e.jsx(Xe,{className:"w-4 h-4"})},n={pii_exposure:"PII Exposure",leaked_credentials:"Leaked Credentials",darknet_mention:"Darknet Mention",paste_site:"Paste Site",breach_database:"Breach Database"},i={critical:"border-l-red-500 bg-red-50/50 dark:bg-red-900/10",high:"border-l-orange-500 bg-orange-50/50 dark:bg-orange-900/10",medium:"border-l-yellow-500 bg-yellow-50/50 dark:bg-yellow-900/10",low:"border-l-green-500 bg-green-50/50 dark:bg-green-900/10"};return e.jsx("div",{className:u("border-l-4 rounded-lg p-4 cursor-pointer transition-colors",i[t.severity]),onClick:()=>a(!s),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-slate-400 mt-0.5",children:r[t.type]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:u("px-2 py-0.5 rounded text-xs font-medium",t.severity==="critical"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":t.severity==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"),children:t.severity}),e.jsx("span",{className:"text-xs text-slate-400 bg-slate-100 dark:bg-slate-700 px-2 py-0.5 rounded",children:n[t.type]}),e.jsx("span",{className:"text-xs text-slate-400 ml-auto",children:t.date})]}),e.jsx("h4",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:t.title}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:t.description}),e.jsxs("p",{className:"text-xs text-slate-400 mt-1",children:["Source: ",t.source]}),s&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase mb-2",children:"Indicators Found"}),e.jsx("div",{className:"space-y-1",children:t.indicators.map((o,l)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-red-400"}),e.jsx("span",{className:"font-mono text-slate-600 dark:text-slate-400",children:o})]},l))})]})]})]})})}function Gi({name:t,icon:s,progress:a,status:r}){return e.jsx(M,{className:u("text-center",r==="complete"&&"ring-2 ring-green-500 ring-offset-2 dark:ring-offset-slate-900"),children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:u(r==="complete"&&"text-green-500",r==="running"&&"text-forensic-500 animate-pulse",r==="pending"&&"text-slate-300 dark:text-slate-600"),children:r==="complete"?e.jsx(V,{className:"w-5 h-5"}):s}),e.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:t}),e.jsx(Je,{value:a,size:"sm",variant:r==="complete"?"success":"default"})]})})}function $i({log:t}){const s={info:"text-slate-400",warning:"text-yellow-500",success:"text-green-500",error:"text-red-500"};return e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx("span",{className:"text-xs font-mono text-slate-400 whitespace-nowrap",children:As(t.timestamp)}),e.jsx("span",{className:u("flex-1",s[t.severity]),children:t.message})]})}function Ee({label:t,count:s,color:a,tooltip:r}){const n={red:"bg-red-500",orange:"bg-orange-500",yellow:"bg-yellow-500",green:"bg-green-500",purple:"bg-purple-500"},i=e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:u("w-2 h-2 rounded-full",n[a])}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:t})]}),e.jsx("span",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:s})]});return r?e.jsx(S,{content:r,children:i}):i}const Yi=[{id:"1",timestamp:new Date("2024-01-15T02:30:15"),source:"windows_security",severity:"critical",title:"Suspicious Process Execution",summary:"PsExec.exe executed with SYSTEM privileges",category:"process_execution",rawLog:`EventID: 4688
Process Name: C:\\Windows\\System32\\PsExec.exe
User: NT AUTHORITY\\SYSTEM`,relatedCount:3},{id:"2",timestamp:new Date("2024-01-15T02:31:00"),source:"firewall",severity:"high",title:"Outbound Connection to Known C2",summary:"Connection to 185.220.101.42:443 blocked",category:"network_connection",rawLog:`Action: Block
Direction: Outbound
Dest IP: 185.220.101.42
Dest Port: 443`,relatedCount:5},{id:"3",timestamp:new Date("2024-01-15T02:32:30"),source:"windows_security",severity:"medium",title:"Scheduled Task Created",summary:'New scheduled task "WindowsUpdate" created',category:"persistence",rawLog:`Task Name: WindowsUpdate
Action: C:\\Users\\Public\\update.exe
Trigger: At startup`,relatedCount:1},{id:"4",timestamp:new Date("2024-01-15T02:35:00"),source:"azure_activity",severity:"high",title:"Bulk File Download",summary:"1,247 files downloaded from SharePoint",category:"data_exfiltration",rawLog:`Operation: FileDownloaded
Count: 1247
User: jsmith@company.com`,relatedCount:2},{id:"5",timestamp:new Date("2024-01-15T02:40:00"),source:"windows_security",severity:"critical",title:"Lateral Movement Detected",summary:"Remote WMI execution on DC-MAIN-01",category:"lateral_movement",rawLog:`EventID: 4624
Logon Type: 3
Target: DC-MAIN-01
Source: ACCT-WS-042`,relatedCount:8}];function qi(){const t=Z(),{goToNextStep:s,goToPreviousStep:a}=Q(),[r,n]=N.useState(null),[i,o]=N.useState(""),[l,c]=N.useState(1),[d,h]=N.useState(!0),p=()=>{a(),t("/triage")},g=()=>{s(),t("/verification")},k=Yi.filter(m=>m.title.toLowerCase().includes(i.toLowerCase())||m.summary.toLowerCase().includes(i.toLowerCase())),j=m=>m.includes("windows")?e.jsx(ze,{className:"w-4 h-4"}):m.includes("azure")||m.includes("cloud")?e.jsx(ne,{className:"w-4 h-4"}):m.includes("firewall")?e.jsx(xe,{className:"w-4 h-4"}):e.jsx(we,{className:"w-4 h-4"}),f=m=>{const w={critical:"bg-red-500",high:"bg-orange-500",medium:"bg-yellow-500",low:"bg-green-500",info:"bg-blue-500"};return w[m]||w.info};return e.jsxs(ie,{title:"Timeline View",subtitle:"Interactive timeline of security events",actions:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{content:"Zoom out on timeline",children:e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>c(Math.max(.5,l-.25)),children:e.jsx(va,{className:"w-4 h-4"})})}),e.jsxs("span",{className:"text-sm text-slate-500",children:[Math.round(l*100),"%"]}),e.jsx(S,{content:"Zoom in on timeline",children:e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>c(Math.min(2,l+.25)),children:e.jsx(ya,{className:"w-4 h-4"})})})]}),footer:e.jsx(ue,{onBack:p,backLabel:"Triage",onContinue:g,continueLabel:"Proceed to Review"}),children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[e.jsx("div",{className:"flex-1 min-w-[200px] max-w-md",children:e.jsx(wr,{value:i,onChange:m=>o(m.target.value),placeholder:"Search events...",tooltip:"Search events by keyword"})}),e.jsx(S,{content:"Filter by data source",children:e.jsx(P,{variant:"outline",size:"sm",leftIcon:e.jsx(Rt,{className:"w-4 h-4"}),children:"Source"})}),e.jsx(S,{content:"Filter by severity level",children:e.jsx(P,{variant:"outline",size:"sm",leftIcon:e.jsx(Rt,{className:"w-4 h-4"}),children:"Severity"})}),e.jsx(S,{content:"Filter events by date range",children:e.jsx(P,{variant:"outline",size:"sm",leftIcon:e.jsx(as,{className:"w-4 h-4"}),children:"Date Range"})})]}),e.jsxs(M,{className:"mb-6",children:[e.jsxs("button",{onClick:()=>h(!d),className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Attack Flow Visualization"}),e.jsx("span",{className:"text-xs bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 px-2 py-0.5 rounded-full",children:"Live"})]}),d?e.jsx(je,{className:"w-5 h-5 text-slate-400"}):e.jsx(me,{className:"w-5 h-5 text-slate-400"})]}),d&&e.jsxs("div",{className:"mt-4 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/10 border border-red-200 dark:border-red-900/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-red-500 flex items-center justify-center",children:e.jsx(Ke,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-red-800 dark:text-red-300 text-sm",children:"Threat Actor"}),e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400",children:"External / Unknown Attribution"})]})]}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400",children:"Origin IP:"}),e.jsx("span",{className:"font-mono text-red-800 dark:text-red-300",children:"185.220.101.42"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400",children:"C2 Server:"}),e.jsx("span",{className:"font-mono text-red-800 dark:text-red-300",children:"update-service.xyz:443"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400",children:"Initial Vector:"}),e.jsx("span",{className:"text-red-800 dark:text-red-300",children:"Phishing Email"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-600 dark:text-red-400",children:"Tools Used:"}),e.jsx("span",{className:"text-red-800 dark:text-red-300",children:"PsExec, Mimikatz, Cobalt Strike"})]})]})]}),e.jsxs("div",{className:"p-4 bg-orange-50 dark:bg-orange-900/10 border border-orange-200 dark:border-orange-900/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-500 flex items-center justify-center",children:e.jsx(ls,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-orange-800 dark:text-orange-300 text-sm",children:"Compromised Users"}),e.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400",children:"3 accounts confirmed compromised"})]})]}),e.jsx("div",{className:"space-y-2",children:[{user:"jsmith@company.com",type:"Phished",access:"Domain User + VPN",icon:e.jsx(ye,{className:"w-3 h-3"})},{user:"admin.jsmith",type:"Credential Theft",access:"Domain Admin",icon:e.jsx(ja,{className:"w-3 h-3"})},{user:"svc-backup",type:"Token Impersonation",access:"Backup Operator",icon:e.jsx(Y,{className:"w-3 h-3"})}].map((m,w)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs p-2 bg-white dark:bg-slate-800 rounded",children:[e.jsx("span",{className:"text-orange-500",children:m.icon}),e.jsx("span",{className:"font-mono font-medium text-slate-700 dark:text-slate-300 flex-1",children:m.user}),e.jsx("span",{className:"px-1.5 py-0.5 bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400 rounded text-[10px]",children:m.type}),e.jsx("span",{className:"text-slate-400",children:m.access})]},w))})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 uppercase mb-3",children:"Attack Chain / Kill Chain"}),e.jsx("div",{className:"flex items-center gap-1 overflow-x-auto pb-2",children:[{phase:"Initial Access",icon:e.jsx(ye,{className:"w-4 h-4"}),detail:"Phishing Email",color:"bg-red-500",time:"02:15"},{phase:"Execution",icon:e.jsx(we,{className:"w-4 h-4"}),detail:"Macro  PowerShell",color:"bg-red-600",time:"02:18"},{phase:"Persistence",icon:e.jsx(os,{className:"w-4 h-4"}),detail:"Scheduled Task",color:"bg-orange-500",time:"02:25"},{phase:"Priv. Escalation",icon:e.jsx(cs,{className:"w-4 h-4"}),detail:"Mimikatz DCSync",color:"bg-orange-600",time:"02:28"},{phase:"Lateral Movement",icon:e.jsx(_e,{className:"w-4 h-4"}),detail:"PsExec  DC, FS",color:"bg-yellow-500",time:"02:30"},{phase:"Collection",icon:e.jsx(ve,{className:"w-4 h-4"}),detail:"Finance Share",color:"bg-yellow-600",time:"02:35"},{phase:"Exfiltration",icon:e.jsx(ne,{className:"w-4 h-4"}),detail:"1,247 files  C2",color:"bg-purple-500",time:"02:35"},{phase:"Impact",icon:e.jsx(wt,{className:"w-4 h-4"}),detail:"Encryption Started",color:"bg-red-700",time:"02:40"}].map((m,w,x)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(S,{content:`${m.phase}: ${m.detail} (${m.time})`,children:e.jsxs("div",{className:u("flex flex-col items-center gap-1 p-2 rounded-lg min-w-[90px] transition-transform hover:scale-105","bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700"),children:[e.jsx("div",{className:u("w-8 h-8 rounded-full flex items-center justify-center text-white",m.color),children:m.icon}),e.jsx("span",{className:"text-[10px] font-medium text-slate-700 dark:text-slate-300 text-center leading-tight",children:m.phase}),e.jsx("span",{className:"text-[9px] text-slate-400 text-center",children:m.detail}),e.jsx("span",{className:"text-[9px] font-mono text-slate-400",children:m.time})]})}),w<x.length-1&&e.jsx(tt,{className:"w-4 h-4 text-slate-300 dark:text-slate-600 mx-0.5 flex-shrink-0"})]},w))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 uppercase mb-3",children:"Affected Resources"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:[{name:"WS-FIN-042",role:"Patient Zero",severity:"critical",icon:e.jsx(ze,{className:"w-4 h-4"})},{name:"DC-MAIN-01",role:"Domain Controller",severity:"critical",icon:e.jsx(Y,{className:"w-4 h-4"})},{name:"FS-FINANCE-01",role:"File Server",severity:"high",icon:e.jsx(ve,{className:"w-4 h-4"})},{name:"BKP-SERVER-01",role:"Backup Server",severity:"high",icon:e.jsx(Y,{className:"w-4 h-4"})},{name:"WEB-APP-01",role:"Web Server",severity:"medium",icon:e.jsx(ne,{className:"w-4 h-4"})},{name:"EXCH-01",role:"Exchange Server",severity:"medium",icon:e.jsx(ye,{className:"w-4 h-4"})},{name:"PRINT-SRV-01",role:"Print Server",severity:"low",icon:e.jsx(Y,{className:"w-4 h-4"})},{name:"VPN Gateway",role:"Network Device",severity:"high",icon:e.jsx(xe,{className:"w-4 h-4"})}].map((m,w)=>e.jsxs("div",{className:u("p-2 rounded-lg border text-xs",m.severity==="critical"?"border-red-300 bg-red-50 dark:bg-red-900/10 dark:border-red-900/50":m.severity==="high"?"border-orange-300 bg-orange-50 dark:bg-orange-900/10 dark:border-orange-900/50":m.severity==="medium"?"border-yellow-300 bg-yellow-50 dark:bg-yellow-900/10 dark:border-yellow-900/50":"border-slate-200 bg-slate-50 dark:bg-slate-800/50 dark:border-slate-700"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-slate-400",children:m.icon}),e.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:m.name})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-slate-500",children:m.role}),e.jsx("span",{className:u("px-1 py-0.5 rounded text-[10px] font-medium",m.severity==="critical"?"bg-red-200 text-red-700 dark:bg-red-900/40 dark:text-red-400":m.severity==="high"?"bg-orange-200 text-orange-700 dark:bg-orange-900/40 dark:text-orange-400":"bg-yellow-200 text-yellow-700 dark:bg-yellow-900/40 dark:text-yellow-400"),children:m.severity})]})]},w))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(M,{className:"min-h-[500px]",children:[e.jsx(z,{title:"Event Timeline",description:`${k.length} events  Jan 15, 2024`}),e.jsxs("div",{className:"mt-6 relative",children:[e.jsxs("div",{className:"flex justify-between text-xs text-slate-400 mb-4",children:[e.jsx("span",{children:"02:30"}),e.jsx("span",{children:"02:35"}),e.jsx("span",{children:"02:40"}),e.jsx("span",{children:"02:45"})]}),e.jsx("div",{className:"space-y-4",children:["Windows","Cloud","Network"].map(m=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-16 text-xs text-slate-500 text-right",children:m}),e.jsx("div",{className:"flex-1 h-10 bg-slate-100 dark:bg-slate-800 rounded relative",children:k.filter(w=>m==="Windows"?w.source.includes("windows"):m==="Cloud"?w.source.includes("azure"):w.source.includes("firewall")).map(w=>e.jsx(S,{content:w.title,children:e.jsx("button",{onClick:()=>n(w),className:u("absolute top-1/2 -translate-y-1/2 w-4 h-4 rounded-full","transition-transform hover:scale-150","ring-2 ring-white dark:ring-slate-900",f(w.severity),(r==null?void 0:r.id)===w.id&&"ring-4 ring-forensic-400"),style:{left:`${(w.timestamp.getMinutes()-30)/15*100}%`}})},w.id))})]},m))}),e.jsx("svg",{className:"absolute inset-0 pointer-events-none opacity-30",children:e.jsx("line",{x1:"20%",y1:"30%",x2:"40%",y2:"70%",stroke:"currentColor",strokeDasharray:"4",className:"text-forensic-500"})})]}),e.jsx("div",{className:"mt-8 space-y-2",children:k.map(m=>e.jsx(Xi,{event:m,isSelected:(r==null?void 0:r.id)===m.id,onClick:()=>n(m),sourceIcon:j(m.source)},m.id))})]})}),e.jsx("div",{children:e.jsx(M,{className:"sticky top-24 min-h-[500px]",children:r?e.jsx(Qi,{event:r,onClose:()=>n(null)}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center py-12",children:[e.jsx(we,{className:"w-12 h-12 text-slate-300 mb-3"}),e.jsx("p",{className:"text-slate-500",children:"Select an event to view details"})]})})})]})]})}function Xi({event:t,isSelected:s,onClick:a,sourceIcon:r}){return e.jsxs("button",{onClick:a,className:u("w-full flex items-center gap-3 p-3 rounded-lg text-left transition-colors",s?"bg-forensic-50 dark:bg-forensic-900/20 ring-1 ring-forensic-500":"hover:bg-slate-50 dark:hover:bg-slate-800/50"),children:[e.jsx("span",{className:"text-slate-400",children:r}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100 truncate",children:t.title}),e.jsx("p",{className:"text-xs text-slate-500 truncate",children:t.summary})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pt,{severity:t.severity,size:"sm"}),e.jsx("span",{className:"text-xs text-slate-400",children:As(t.timestamp)})]})]})}function Qi({event:t,onClose:s}){const[a,r]=N.useState(!1);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-slate-100",children:t.title}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:Mi(t.timestamp)})]}),e.jsx("button",{onClick:s,className:"p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded",children:e.jsx(St,{className:"w-4 h-4 text-slate-400"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsx(Pt,{severity:t.severity})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 uppercase mb-1",children:"Summary"}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:t.summary})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 uppercase mb-1",children:"Source"}),e.jsx(q,{variant:"secondary",children:t.source.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 uppercase mb-1",children:"Category"}),e.jsx(q,{variant:"info",children:t.category.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 uppercase mb-1",children:"Related Events"}),e.jsxs("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:[t.relatedCount," correlated event",t.relatedCount!==1?"s":""]})]}),e.jsxs("div",{children:[e.jsx(S,{content:"View full raw log data",children:e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>r(!a),fullWidth:!0,children:[a?"Hide":"View"," Raw Log"]})}),a&&e.jsxs("div",{className:"mt-3 relative",children:[e.jsx("pre",{className:"text-xs bg-slate-900 text-slate-100 p-3 rounded-lg overflow-x-auto",children:t.rawLog}),e.jsx(S,{content:"Copy raw log to clipboard",children:e.jsx("button",{onClick:()=>navigator.clipboard.writeText(t.rawLog),className:"absolute top-2 right-2 p-1 hover:bg-slate-700 rounded",children:e.jsx(wa,{className:"w-3 h-3 text-slate-400"})})})]})]})]})]})}const ce=[{id:"1",title:"PsExec Remote Execution",category:"dual_use_tool",severity:"medium",confidence:65,description:"PsExec was used to execute commands on remote systems. This tool has legitimate administrative uses but is commonly abused by attackers.",evidence:[{type:"Event Log",content:"EventID 4688: Process PsExec.exe created"},{type:"Process",content:"Parent: cmd.exe, User: CORP\\admin_jsmith"}],historicalContext:"This user has used PsExec 3 times in the past month for legitimate patching.",expertGuidance:"Review the target systems and timing. PsExec usage outside maintenance windows is suspicious.",legitimateUseCases:["System patching","Remote administration","Incident response"],suspiciousIndicators:["Unusual timing (2:30 AM)","Multiple targets in sequence","SYSTEM privilege usage"]},{id:"2",title:"Bulk File Access",category:"data_theft",severity:"high",confidence:72,description:"Large number of files accessed from finance share in short timeframe.",evidence:[{type:"File Access",content:"1,247 files accessed in 15 minutes"},{type:"User Activity",content:"User: jsmith, Time: 02:35-02:50 AM"}],historicalContext:"User typically accesses 20-30 files per day during business hours.",expertGuidance:"This is a significant deviation from baseline. Check if there was authorized backup or migration.",legitimateUseCases:["Quarter-end reporting","Authorized backup","Department migration"],suspiciousIndicators:["Off-hours activity","6000% above baseline","Sensitive file types"]},{id:"3",title:"Scheduled Task Persistence",category:"persistence_mechanism",severity:"high",confidence:85,description:"New scheduled task created pointing to executable in Public folder.",evidence:[{type:"Task Details",content:"Task: WindowsUpdate, Action: C:\\Users\\Public\\update.exe"},{type:"Timing",content:"Created 3 minutes after initial compromise indicator"}],historicalContext:"No legitimate tasks have been created in Public folder in past year.",expertGuidance:"Tasks in Public folder are highly suspicious. Likely malicious persistence mechanism.",legitimateUseCases:["IT deployment scripts","Third-party installers"],suspiciousIndicators:["Public folder location","Generic task name","Timing correlation"]}];function Ki(){const t=Z(),{goToNextStep:s,goToPreviousStep:a}=Q(),[r,n]=N.useState(0),[i,o]=N.useState({}),[l,c]=N.useState(""),d=ce[r],h=ce.length,p=Object.keys(i).length,g=()=>{a(),t("/timeline")},k=()=>{s(),t("/report")},j=()=>{r>0&&(n(r-1),c(""))},f=()=>{r<h-1&&(n(r+1),c(""))},m=v=>{o({...i,[d.id]:v})},w=()=>{const v={...i};ce.forEach(y=>{v[y.id]||(v[y.id]="needs_investigation")}),o(v)},x=i[d.id];return e.jsxs(ie,{title:"Verification Wizard",subtitle:"Review and classify ambiguous findings",footer:e.jsx(ue,{onBack:g,backLabel:"Timeline",onContinue:k,continueLabel:"Generate Report",continueDisabled:p<h}),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:["Finding ",r+1," of ",h]}),e.jsx(Je,{value:p/h*100,className:"w-32"}),e.jsxs("span",{className:"text-sm text-slate-500",children:[p," reviewed"]})]}),e.jsx(S,{content:"Accept defaults for remaining items",children:e.jsx(P,{variant:"ghost",size:"sm",onClick:w,leftIcon:e.jsx(Na,{className:"w-4 h-4"}),children:"Skip All"})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(M,{className:"min-h-[500px]",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs(q,{variant:"secondary",children:["#",r+1]}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:d.title})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pt,{severity:d.severity}),e.jsx(q,{variant:"info",children:d.category.replace("_"," ")})]})]}),e.jsx("div",{className:"text-right",children:e.jsx(S,{content:"Automated confidence level",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-slate-500",children:"Confidence"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Je,{value:d.confidence,size:"sm",className:"w-16",variant:d.confidence>75?"danger":d.confidence>50?"warning":"default"}),e.jsxs("span",{className:"text-sm font-medium",children:[d.confidence,"%"]})]})]})})})]}),e.jsx("div",{className:"mb-6",children:e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:d.description})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Evidence"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:d.evidence.map((v,y)=>e.jsx(S,{content:"View complete evidence",children:e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(at,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:v.type})]}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300 line-clamp-2",children:v.content})]})},y))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Classification"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(S,{content:"Confirm this activity as malicious based on evidence",children:e.jsxs("button",{onClick:()=>m("malicious"),className:u("flex-1 flex items-center justify-center gap-2 p-3 rounded-lg border-2 transition-colors",x==="malicious"?"border-red-500 bg-red-50 dark:bg-red-900/20":"border-slate-200 dark:border-slate-700 hover:border-red-300"),children:[e.jsx(Qe,{className:u("w-5 h-5",x==="malicious"?"text-red-500":"text-slate-400")}),e.jsx("span",{className:u("font-medium",x==="malicious"?"text-red-700 dark:text-red-300":"text-slate-600 dark:text-slate-400"),children:"Malicious"})]})}),e.jsx(S,{content:"Mark as legitimate activity",children:e.jsxs("button",{onClick:()=>m("benign"),className:u("flex-1 flex items-center justify-center gap-2 p-3 rounded-lg border-2 transition-colors",x==="benign"?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-slate-200 dark:border-slate-700 hover:border-green-300"),children:[e.jsx(V,{className:u("w-5 h-5",x==="benign"?"text-green-500":"text-slate-400")}),e.jsx("span",{className:u("font-medium",x==="benign"?"text-green-700 dark:text-green-300":"text-slate-600 dark:text-slate-400"),children:"Benign"})]})}),e.jsx(S,{content:"Flag for deeper analysis",children:e.jsxs("button",{onClick:()=>m("needs_investigation"),className:u("flex-1 flex items-center justify-center gap-2 p-3 rounded-lg border-2 transition-colors",x==="needs_investigation"?"border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20":"border-slate-200 dark:border-slate-700 hover:border-yellow-300"),children:[e.jsx(Ct,{className:u("w-5 h-5",x==="needs_investigation"?"text-yellow-500":"text-slate-400")}),e.jsx("span",{className:u("font-medium",x==="needs_investigation"?"text-yellow-700 dark:text-yellow-300":"text-slate-600 dark:text-slate-400"),children:"Investigate"})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 block",children:"Justification (optional)"}),e.jsx("textarea",{value:l,onChange:v=>c(v.target.value),placeholder:"Add notes for your decision...",className:"input min-h-[80px]"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(P,{variant:"ghost",onClick:j,disabled:r===0,leftIcon:e.jsx(ka,{className:"w-4 h-4"}),children:"Previous"}),e.jsx("div",{className:"flex gap-1",children:ce.map((v,y)=>e.jsx("button",{onClick:()=>n(y),className:u("w-3 h-3 rounded-full transition-colors",y===r?"bg-forensic-500":i[ce[y].id]?i[ce[y].id]==="malicious"?"bg-red-500":i[ce[y].id]==="benign"?"bg-green-500":"bg-yellow-500":"bg-slate-300 dark:bg-slate-600")},y))}),e.jsx(P,{variant:"ghost",onClick:f,disabled:r===h-1,rightIcon:e.jsx(me,{className:"w-4 h-4"}),children:"Next"})]})]})}),e.jsx("div",{children:e.jsxs(M,{className:"sticky top-24",children:[e.jsx(z,{title:"Context"}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Sa,{className:"w-4 h-4 text-slate-400"}),e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Historical Context"})]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:d.historicalContext})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(bt,{className:"w-4 h-4 text-yellow-500"}),e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Expert Guidance"})]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:d.expertGuidance})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Legitimate Use Cases"}),e.jsx("ul",{className:"space-y-1",children:d.legitimateUseCases.map((v,y)=>e.jsxs("li",{className:"text-sm text-slate-600 dark:text-slate-400 flex items-center gap-2",children:[e.jsx(V,{className:"w-3 h-3 text-green-500"}),v]},y))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Suspicious Indicators"}),e.jsx("ul",{className:"space-y-1",children:d.suspiciousIndicators.map((v,y)=>e.jsxs("li",{className:"text-sm text-slate-600 dark:text-slate-400 flex items-center gap-2",children:[e.jsx(rt,{className:"w-3 h-3 text-red-500"}),v]},y))})]})]})]})})]})]})}const Ji=[{priority:"immediate",title:"Isolate affected systems",status:"pending",tooltip:"Network-isolate all compromised systems to prevent further lateral movement and data exfiltration.",example:'Disable network ports for WS-FIN-042, DC-MAIN-01 on the switch. Use firewall rules to block inter-VLAN traffic from Finance segment. In Palo Alto: set security policy deny from zone "Finance" to zone "any".',steps:["Identify all confirmed compromised hosts","Disable switch ports or apply ACLs","Block C2 IPs at perimeter firewall","Monitor for new outbound connections"],affectedAssets:[{name:"WS-FIN-042",type:"Workstation",os:"Windows 10",ip:"10.0.2.42",severity:"critical"},{name:"DC-MAIN-01",type:"Domain Controller",os:"Windows Server 2022",ip:"10.0.1.10",severity:"critical"},{name:"FS-FINANCE-01",type:"File Server",os:"Windows Server 2019",ip:"10.0.2.20",severity:"high"}]},{priority:"immediate",title:"Reset compromised credentials",status:"pending",tooltip:"Force password reset for all compromised accounts including service accounts. Revoke all active tokens and sessions.",example:'In Active Directory: Right-click user  Reset Password  Check "User must change password at next logon". For service accounts: Update password in AD and all services referencing it. Revoke Azure AD tokens: Revoke-AzureADUserAllRefreshToken -ObjectId <user-object-id>',steps:["Reset passwords for jsmith, admin.jsmith, svc-backup","Revoke all OAuth tokens and API keys","Invalidate Kerberos TGTs (krbtgt reset twice)","Update service account passwords in all dependent services"],affectedAssets:[{name:"jsmith@company.com",type:"User Account",os:"AD/Azure AD",ip:"-",severity:"critical"},{name:"admin.jsmith",type:"Admin Account",os:"Active Directory",ip:"-",severity:"critical"},{name:"svc-backup",type:"Service Account",os:"Active Directory",ip:"-",severity:"high"}]},{priority:"short_term",title:"Implement MFA for all admin accounts",status:"pending",tooltip:"Deploy multi-factor authentication for all privileged accounts to prevent credential-based attacks.",example:'Azure AD: Security  MFA  Conditional Access  New Policy  Target: "All Admin Roles"  Grant: "Require MFA". For on-prem: Deploy Duo or Azure MFA Server for RDP and VPN access. Use FIDO2 keys for domain admins.',steps:["Audit all accounts with admin privileges","Enable Azure AD Conditional Access with MFA requirement","Deploy hardware tokens (FIDO2) for domain admins","Configure MFA for VPN and RDP gateways"],affectedAssets:[{name:"All Admin Accounts",type:"Identity",os:"Azure AD / AD",ip:"-",severity:"high"},{name:"VPN Gateway",type:"Network Device",os:"Palo Alto GlobalProtect",ip:"10.0.0.1",severity:"high"}]},{priority:"short_term",title:"Deploy EDR solution",status:"pending",tooltip:"Install endpoint detection and response (EDR) on all endpoints for real-time threat detection and automated response.",example:'Deploy CrowdStrike Falcon or Microsoft Defender for Endpoint. Use Group Policy to push MSI: msiexec /i WindowsSensor.exe CID=<your-customer-id> /quiet. Set detection policy to "Extra Aggressive" during incident recovery.',steps:["Select EDR vendor (CrowdStrike, SentinelOne, MDE)","Deploy agent to all Windows and Linux endpoints via GPO/SCCM","Configure detection policies and automated response","Integrate with SIEM for centralized alerting"],affectedAssets:[{name:"All Endpoints",type:"Fleet",os:"Windows/Linux",ip:"Multiple",severity:"medium"},{name:"DC-MAIN-01",type:"Domain Controller",os:"Windows Server 2022",ip:"10.0.1.10",severity:"critical"}]},{priority:"long_term",title:"Security awareness training",status:"pending",tooltip:"Conduct organization-wide security awareness training with focus on phishing identification and reporting procedures.",example:'Use KnowBe4 or Proofpoint Security Awareness: Set up monthly phishing simulations. Track click rates by department. Finance dept gets additional targeted training due to this incident. Add "Report Phish" button to Outlook.',steps:["Select awareness training platform","Conduct baseline phishing simulation","Deploy monthly phishing tests with increasing difficulty","Require completion of anti-phishing training module","Implement phishing report button in email client"],affectedAssets:[{name:"Finance Department",type:"Department",os:"-",ip:"-",severity:"high"},{name:"All Employees",type:"Organization",os:"-",ip:"-",severity:"medium"}]}],Zi=[{category:"Detection",current:2,target:4,gap:"No behavioral analytics",remediation:"Deploy UEBA solution (e.g., Microsoft Sentinel UEBA, Exabeam) to detect anomalous user behavior patterns like unusual login times, impossible travel, and mass file access.",example:"In Microsoft Sentinel: Analytics  UEBA  Enable for all users. Configure detection rules for: Anomalous login locations, First-time VPN connections, Mass file downloads exceeding baseline by 3x."},{category:"Response",current:3,target:4,gap:"Manual playbooks only",remediation:"Implement SOAR platform (e.g., Palo Alto XSOAR, Splunk SOAR) to automate incident response playbooks for common scenarios like phishing, ransomware, and unauthorized access.",example:"Create automated playbook: Phishing detected  Extract IOCs  Block sender in email gateway  Search mailboxes for similar  Isolate affected endpoints  Notify SOC analyst  Create ticket."},{category:"Prevention",current:2,target:5,gap:"Limited email security",remediation:"Upgrade email security with advanced threat protection: sandboxing, URL rewriting, impersonation protection, and DMARC/DKIM/SPF enforcement.",example:"Deploy Proofpoint or Mimecast ATP. Configure: Attachment sandboxing (detonate in VM), URL rewriting with click-time analysis, Brand impersonation protection, DMARC policy p=reject."}];function el(){const t=Z(),{goToPreviousStep:s}=Q(),[a,r]=N.useState("pdf"),[n,i]=N.useState(!1),[o,l]=N.useState(!0),[c,d]=N.useState(null),[h,p]=N.useState(null),[g,k]=N.useState(!1),j=()=>{s(),t("/verification")},f=()=>{alert(`Exporting report as ${a.toUpperCase()}...`)},m=()=>{t("/")},w={incidentSummary:"Ransomware attack via phishing email targeting finance department",affectedSystems:12,totalFindings:23,criticalFindings:5,timeToDetection:"4 hours",dataAtRisk:"Customer PII, Financial Records",businessImpact:{operational:"high",financial:"medium",reputational:"low",regulatory:"high"}};return e.jsx(ie,{title:"Report Generation",subtitle:"Review and export the investigation report",footer:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(P,{variant:"ghost",onClick:j,children:"Back to Verification"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"secondary",onClick:m,children:"New Investigation"}),e.jsx(S,{content:`Export report as ${a.toUpperCase()}`,children:e.jsx(P,{onClick:f,leftIcon:e.jsx(qe,{className:"w-4 h-4"}),children:"Export Report"})})]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsx(M,{className:"bg-gradient-to-br from-slate-50 to-white dark:from-slate-800 dark:to-slate-800/50",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-forensic-100 dark:bg-forensic-900/30 rounded-lg",children:e.jsx(xe,{className:"w-6 h-6 text-forensic-600 dark:text-forensic-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 mb-2",children:"Executive Summary"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-4",children:w.incidentSummary}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsx($e,{icon:e.jsx(Ca,{className:"w-4 h-4"}),label:"Affected Systems",value:w.affectedSystems}),e.jsx($e,{icon:e.jsx(rt,{className:"w-4 h-4"}),label:"Total Findings",value:w.totalFindings,subValue:`${w.criticalFindings} critical`}),e.jsx($e,{icon:e.jsx(ke,{className:"w-4 h-4"}),label:"Time to Detect",value:w.timeToDetection}),e.jsx($e,{icon:e.jsx(we,{className:"w-4 h-4"}),label:"Data at Risk",value:w.dataAtRisk,small:!0})]})]})]})}),e.jsxs(M,{children:[e.jsxs("button",{onClick:()=>k(!g),className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Attack Chain Visualization"})]}),g?e.jsx(je,{className:"w-5 h-5 text-slate-400"}):e.jsx(me,{className:"w-5 h-5 text-slate-400"})]}),g&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsx("div",{className:"flex items-center gap-1 overflow-x-auto pb-2",children:[{phase:"Initial Access",icon:e.jsx(ye,{className:"w-3 h-3"}),color:"bg-red-500"},{phase:"Execution",icon:e.jsx(we,{className:"w-3 h-3"}),color:"bg-red-600"},{phase:"Persistence",icon:e.jsx(os,{className:"w-3 h-3"}),color:"bg-orange-500"},{phase:"Priv. Escalation",icon:e.jsx(cs,{className:"w-3 h-3"}),color:"bg-orange-600"},{phase:"Lateral Movement",icon:e.jsx(_e,{className:"w-3 h-3"}),color:"bg-yellow-500"},{phase:"Collection",icon:e.jsx(ve,{className:"w-3 h-3"}),color:"bg-yellow-600"},{phase:"Exfiltration",icon:e.jsx(ne,{className:"w-3 h-3"}),color:"bg-purple-500"},{phase:"Impact",icon:e.jsx(wt,{className:"w-3 h-3"}),color:"bg-red-700"}].map((x,v,y)=>e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:u("flex items-center gap-1 px-2 py-1 rounded text-white text-[10px] font-medium whitespace-nowrap",x.color),children:[x.icon,x.phase]}),v<y.length-1&&e.jsx(tt,{className:"w-3 h-3 text-slate-300 mx-0.5 flex-shrink-0"})]},v))}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/10 rounded-lg border border-red-200 dark:border-red-900/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ke,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"text-xs font-medium text-red-700 dark:text-red-400",children:"Threat Actor"})]}),e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400",children:"External, IP: 185.220.101.42"}),e.jsx("p",{className:"text-xs text-red-500",children:"Tools: PsExec, Mimikatz"})]}),e.jsxs("div",{className:"p-3 bg-orange-50 dark:bg-orange-900/10 rounded-lg border border-orange-200 dark:border-orange-900/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ls,{className:"w-4 h-4 text-orange-500"}),e.jsx("span",{className:"text-xs font-medium text-orange-700 dark:text-orange-400",children:"Compromised Users"})]}),e.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400",children:"jsmith, admin.jsmith, svc-backup"}),e.jsx("p",{className:"text-xs text-orange-500",children:"3 accounts compromised"})]}),e.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900/10 rounded-lg border border-purple-200 dark:border-purple-900/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Y,{className:"w-4 h-4 text-purple-500"}),e.jsx("span",{className:"text-xs font-medium text-purple-700 dark:text-purple-400",children:"Affected Systems"})]}),e.jsx("p",{className:"text-xs text-purple-600 dark:text-purple-400",children:"12 systems across 4 segments"}),e.jsx("p",{className:"text-xs text-purple-500",children:"5 critical, 4 high, 3 medium"})]})]})]})]}),e.jsxs(M,{children:[e.jsx(z,{title:"Business Impact Assessment",description:"Impact across key business dimensions"}),e.jsx("div",{className:"mt-4 grid grid-cols-2 sm:grid-cols-4 gap-4",children:Object.entries(w.businessImpact).map(([x,v])=>e.jsx(tl,{dimension:x,level:v},x))})]}),e.jsxs(M,{children:[e.jsx(z,{title:"Recommendations & Mitigations",description:"Prioritized actions with implementation guidance"}),e.jsx("div",{className:"mt-4 space-y-3",children:Ji.map((x,v)=>e.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>d(c===v?null:v),className:"w-full flex items-center gap-3 p-3 hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsx(q,{variant:x.priority==="immediate"?"danger":x.priority==="short_term"?"warning":"info",size:"sm",children:x.priority.replace("_"," ")}),e.jsx("span",{className:"flex-1 text-sm text-slate-700 dark:text-slate-300 text-left",children:x.title}),e.jsx(S,{content:x.tooltip,children:e.jsx(Ft,{className:"w-4 h-4 text-slate-400 hover:text-forensic-500"})}),e.jsx(q,{variant:"secondary",size:"sm",children:x.status}),c===v?e.jsx(je,{className:"w-4 h-4 text-slate-400"}):e.jsx(me,{className:"w-4 h-4 text-slate-400"})]}),c===v&&e.jsxs("div",{className:"px-4 pb-4 space-y-4 border-t border-slate-200 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-800/30",children:[e.jsxs("div",{className:"pt-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Lt,{className:"w-4 h-4 text-forensic-500"}),e.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase",children:"Implementation Steps"})]}),e.jsx("ol",{className:"space-y-1.5 ml-4",children:x.steps.map((y,T)=>e.jsxs("li",{className:"text-xs text-slate-600 dark:text-slate-400 flex gap-2",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-forensic-100 dark:bg-forensic-900/30 text-forensic-600 dark:text-forensic-400 flex items-center justify-center text-[10px] font-bold flex-shrink-0",children:T+1}),y]},T))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(bt,{className:"w-4 h-4 text-yellow-500"}),e.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase",children:"Practical Example"})]}),e.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/10 border border-yellow-200 dark:border-yellow-900/50 rounded-lg",children:e.jsx("p",{className:"text-xs text-yellow-800 dark:text-yellow-300 leading-relaxed",children:x.example})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ze,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{className:"text-xs font-medium text-slate-500 uppercase",children:["Affected Assets (",x.affectedAssets.length,")"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-slate-400 uppercase",children:[e.jsx("th",{className:"pb-1.5 pr-3",children:"Asset"}),e.jsx("th",{className:"pb-1.5 pr-3",children:"Type"}),e.jsx("th",{className:"pb-1.5 pr-3",children:"OS/Platform"}),e.jsx("th",{className:"pb-1.5 pr-3",children:"IP"}),e.jsx("th",{className:"pb-1.5",children:"Severity"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:x.affectedAssets.map((y,T)=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-1.5 pr-3 font-medium text-slate-700 dark:text-slate-300",children:y.name}),e.jsx("td",{className:"py-1.5 pr-3 text-slate-500",children:y.type}),e.jsx("td",{className:"py-1.5 pr-3 text-slate-500",children:y.os}),e.jsx("td",{className:"py-1.5 pr-3 font-mono text-slate-500",children:y.ip}),e.jsx("td",{className:"py-1.5",children:e.jsx("span",{className:u("px-1.5 py-0.5 rounded text-[10px] font-medium",y.severity==="critical"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":y.severity==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"),children:y.severity})})]},T))})]})})]})]})]},v))})]}),e.jsxs(M,{children:[e.jsx(z,{title:"Gap Analysis",description:"Security maturity assessment with remediation guidance"}),e.jsx("div",{className:"mt-4 space-y-4",children:Zi.map((x,v)=>e.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>p(h===v?null:v),className:"w-full p-3 hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:x.category}),e.jsx(S,{content:x.remediation,children:e.jsx(Ft,{className:"w-3.5 h-3.5 text-slate-400 hover:text-forensic-500"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-slate-500",children:[x.current,"/",x.target]}),h===v?e.jsx(je,{className:"w-4 h-4 text-slate-400"}):e.jsx(me,{className:"w-4 h-4 text-slate-400"})]})]}),e.jsx(Je,{value:x.current/x.target*100,variant:x.current<x.target*.5?"danger":"warning"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1 text-left",children:x.gap})]}),h===v&&e.jsxs("div",{className:"px-4 pb-4 space-y-3 border-t border-slate-200 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-800/30",children:[e.jsxs("div",{className:"pt-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Lt,{className:"w-4 h-4 text-forensic-500"}),e.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase",children:"Remediation Plan"})]}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400 leading-relaxed",children:x.remediation})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(bt,{className:"w-4 h-4 text-yellow-500"}),e.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase",children:"Example Configuration"})]}),e.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/10 border border-yellow-200 dark:border-yellow-900/50 rounded-lg",children:e.jsx("p",{className:"text-xs text-yellow-800 dark:text-yellow-300 leading-relaxed",children:x.example})})]})]})]},v))})]})]}),e.jsx("div",{children:e.jsxs(M,{className:"sticky top-24",children:[e.jsx(z,{title:"Export Options"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 block",children:"Format"}),e.jsx("div",{className:"space-y-2",children:[{id:"pdf",icon:e.jsx(at,{className:"w-4 h-4"}),label:"PDF Document"},{id:"html",icon:e.jsx(_t,{className:"w-4 h-4"}),label:"Interactive HTML"},{id:"json",icon:e.jsx(_t,{className:"w-4 h-4"}),label:"JSON Data"}].map(x=>e.jsx(S,{content:`Export as ${x.label}`,children:e.jsxs("button",{onClick:()=>r(x.id),className:u("w-full flex items-center gap-2 p-2 rounded-lg border transition-colors",a===x.id?"border-forensic-500 bg-forensic-50 dark:bg-forensic-900/20":"border-slate-200 dark:border-slate-700 hover:border-slate-300"),children:[x.icon,e.jsx("span",{className:"text-sm",children:x.label}),a===x.id&&e.jsx(V,{className:"w-4 h-4 text-forensic-500 ml-auto"})]})},x.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 block",children:"Content Options"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{content:"Include raw log data in export",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:n,onChange:x=>i(x.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Include raw logs"})]})}),e.jsx(S,{content:"Automatically redact sensitive data",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:x=>l(x.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Redact sensitive data"})]})})]})]}),e.jsxs("div",{className:"pt-4 border-t border-slate-200 dark:border-slate-700 space-y-2",children:[e.jsx(S,{content:"Generate downloadable PDF report with current findings",children:e.jsx(P,{fullWidth:!0,onClick:f,leftIcon:e.jsx(qe,{className:"w-4 h-4"}),children:"Export Report"})}),e.jsx(S,{content:"Open print preview",children:e.jsx(P,{variant:"outline",fullWidth:!0,leftIcon:e.jsx(Da,{className:"w-4 h-4"}),children:"Print Preview"})}),e.jsx(S,{content:"Generate shareable link",children:e.jsx(P,{variant:"ghost",fullWidth:!0,leftIcon:e.jsx(Pa,{className:"w-4 h-4"}),children:"Share Link"})})]})]})]})})]})})}function $e({icon:t,label:s,value:a,subValue:r,small:n}){return e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-1",children:[t,e.jsx("span",{className:"text-xs",children:s})]}),e.jsx("p",{className:u("font-bold text-slate-900 dark:text-slate-100",n?"text-sm":"text-lg"),children:a}),r&&e.jsx("p",{className:"text-xs text-red-500",children:r})]})}function tl({dimension:t,level:s}){const a={low:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",high:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"};return e.jsxs("div",{className:"text-center p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase mb-1 capitalize",children:t}),e.jsx("span",{className:u("px-3 py-1 rounded-full text-sm font-medium capitalize",a[s]),children:s})]})}function sl(){return e.jsx(lr,{delayDuration:300,children:e.jsxs(Qs,{children:[e.jsx($,{path:"/",element:e.jsx(Ti,{})}),e.jsx($,{path:"/context",element:e.jsx(Fi,{})}),e.jsx($,{path:"/incident",element:e.jsx(_i,{})}),e.jsx($,{path:"/connectors",element:e.jsx(zi,{})}),e.jsx($,{path:"/validation",element:e.jsx(Vi,{})}),e.jsx($,{path:"/triage",element:e.jsx(Ui,{})}),e.jsx($,{path:"/timeline",element:e.jsx(qi,{})}),e.jsx($,{path:"/verification",element:e.jsx(Ki,{})}),e.jsx($,{path:"/report",element:e.jsx(el,{})}),e.jsx($,{path:"*",element:e.jsx(Ks,{to:"/",replace:!0})})]})})}js.getState().initializeTheme();const al="/".replace(/\/$/,"")||"/";jt.createRoot(document.getElementById("root")).render(e.jsx(Oe.StrictMode,{children:e.jsx(Js,{basename:al,children:e.jsx(sl,{})})}));
