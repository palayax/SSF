import{j as e,R as ca,T as da,P as ma,C as xa,A as ua,a as ha,b as pa,I as ga,c as fa,d as ba,O as ja,e as va,f as ya,D as wa,g as Na}from"./radix-uGlnZHxF.js";import{a as ka,r as v,c as qe,L as Sa,u as be,d as Ca,e as ne,N as Da,B as Pa}from"./vendor-DrAsnYEO.js";import{c as Ia,A as Ma,m as as,a as at,T as Aa,L as ie,U as Oe,b as Zt,G as le,B as Ta,C as rt,d as Ea,e as X,S as re,N as he,f as fe,g as Je,K as kt,h as Ra,F as St,E as nt,X as Fe,i as pe,j as oe,k as Oa,l as Fa,n as jt,o as Is,M as Ms,P as La,R as gt,p as rs,q as ft,H as we,r as Me,s as K,t as Wa,W as vt,u as Vt,D as Ze,v as Ht,w as za,x as Mt,y as _a,z as Ba,I as ge,J as Va,O as Ut,Q as We,V as Ha,Y as Ke,Z as et,_ as es,$ as Ua,a0 as Ga,a1 as As,a2 as ns,a3 as $a,a4 as Ts,a5 as Ne,a6 as Ya,a7 as is,a8 as tt,a9 as Gt,aa as Es,ab as Rs,ac as qa,ad as Xa,ae as Ka,af as $t,ag as Yt,ah as Qa,ai as Ja,aj as Za,ak as qt,al as er,am as ls,an as os,ao as tr,ap as sr}from"./ui-jMa2efRa.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function a(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=a(n);fetch(n.href,i)}})();var Xt={},cs=ka;Xt.createRoot=cs.createRoot,Xt.hydrateRoot=cs.hydrateRoot;const ts="-",ar=t=>{const s=nr(t),{conflictingClassGroups:a,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:o=>{const l=o.split(ts);return l[0]===""&&l.length!==1&&l.shift(),Os(l,s)||rr(o)},getConflictingClassGroupIds:(o,l)=>{const c=a[o]||[];return l&&r[o]?[...c,...r[o]]:c}}},Os=(t,s)=>{var o;if(t.length===0)return s.classGroupId;const a=t[0],r=s.nextPart.get(a),n=r?Os(t.slice(1),r):void 0;if(n)return n;if(s.validators.length===0)return;const i=t.join(ts);return(o=s.validators.find(({validator:l})=>l(i)))==null?void 0:o.classGroupId},ds=/^\[(.+)\]$/,rr=t=>{if(ds.test(t)){const s=ds.exec(t)[1],a=s==null?void 0:s.substring(0,s.indexOf(":"));if(a)return"arbitrary.."+a}},nr=t=>{const{theme:s,prefix:a}=t,r={nextPart:new Map,validators:[]};return lr(Object.entries(t.classGroups),a).forEach(([i,o])=>{Kt(o,r,i,s)}),r},Kt=(t,s,a,r)=>{t.forEach(n=>{if(typeof n=="string"){const i=n===""?s:ms(s,n);i.classGroupId=a;return}if(typeof n=="function"){if(ir(n)){Kt(n(r),s,a,r);return}s.validators.push({validator:n,classGroupId:a});return}Object.entries(n).forEach(([i,o])=>{Kt(o,ms(s,i),a,r)})})},ms=(t,s)=>{let a=t;return s.split(ts).forEach(r=>{a.nextPart.has(r)||a.nextPart.set(r,{nextPart:new Map,validators:[]}),a=a.nextPart.get(r)}),a},ir=t=>t.isThemeGetter,lr=(t,s)=>s?t.map(([a,r])=>{const n=r.map(i=>typeof i=="string"?s+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,l])=>[s+o,l])):i);return[a,n]}):t,or=t=>{if(t<1)return{get:()=>{},set:()=>{}};let s=0,a=new Map,r=new Map;const n=(i,o)=>{a.set(i,o),s++,s>t&&(s=0,r=a,a=new Map)};return{get(i){let o=a.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return n(i,o),o},set(i,o){a.has(i)?a.set(i,o):n(i,o)}}},Fs="!",cr=t=>{const{separator:s,experimentalParseClassName:a}=t,r=s.length===1,n=s[0],i=s.length,o=l=>{const c=[];let d=0,p=0,f;for(let N=0;N<l.length;N++){let P=l[N];if(d===0){if(P===n&&(r||l.slice(N,N+i)===s)){c.push(l.slice(p,N)),p=N+i;continue}if(P==="/"){f=N;continue}}P==="["?d++:P==="]"&&d--}const g=c.length===0?l:l.substring(p),D=g.startsWith(Fs),w=D?g.substring(1):g,b=f&&f>p?f-p:void 0;return{modifiers:c,hasImportantModifier:D,baseClassName:w,maybePostfixModifierPosition:b}};return a?l=>a({className:l,parseClassName:o}):o},dr=t=>{if(t.length<=1)return t;const s=[];let a=[];return t.forEach(r=>{r[0]==="["?(s.push(...a.sort(),r),a=[]):a.push(r)}),s.push(...a.sort()),s},mr=t=>({cache:or(t.cacheSize),parseClassName:cr(t),...ar(t)}),xr=/\s+/,ur=(t,s)=>{const{parseClassName:a,getClassGroupId:r,getConflictingClassGroupIds:n}=s,i=[],o=t.trim().split(xr);let l="";for(let c=o.length-1;c>=0;c-=1){const d=o[c],{modifiers:p,hasImportantModifier:f,baseClassName:g,maybePostfixModifierPosition:D}=a(d);let w=!!D,b=r(w?g.substring(0,D):g);if(!b){if(!w){l=d+(l.length>0?" "+l:l);continue}if(b=r(g),!b){l=d+(l.length>0?" "+l:l);continue}w=!1}const N=dr(p).join(":"),P=f?N+Fs:N,u=P+b;if(i.includes(u))continue;i.push(u);const k=n(b,w);for(let S=0;S<k.length;++S){const O=k[S];i.push(P+O)}l=d+(l.length>0?" "+l:l)}return l};function hr(){let t=0,s,a,r="";for(;t<arguments.length;)(s=arguments[t++])&&(a=Ls(s))&&(r&&(r+=" "),r+=a);return r}const Ls=t=>{if(typeof t=="string")return t;let s,a="";for(let r=0;r<t.length;r++)t[r]&&(s=Ls(t[r]))&&(a&&(a+=" "),a+=s);return a};function pr(t,...s){let a,r,n,i=o;function o(c){const d=s.reduce((p,f)=>f(p),t());return a=mr(d),r=a.cache.get,n=a.cache.set,i=l,l(c)}function l(c){const d=r(c);if(d)return d;const p=ur(c,a);return n(c,p),p}return function(){return i(hr.apply(null,arguments))}}const V=t=>{const s=a=>a[t]||[];return s.isThemeGetter=!0,s},Ws=/^\[(?:([a-z-]+):)?(.+)\]$/i,gr=/^\d+\/\d+$/,fr=new Set(["px","full","screen"]),br=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,jr=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,vr=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,yr=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,wr=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,xe=t=>Le(t)||fr.has(t)||gr.test(t),je=t=>ze(t,"length",Mr),Le=t=>!!t&&!Number.isNaN(Number(t)),At=t=>ze(t,"number",Le),Be=t=>!!t&&Number.isInteger(Number(t)),Nr=t=>t.endsWith("%")&&Le(t.slice(0,-1)),A=t=>Ws.test(t),ve=t=>br.test(t),kr=new Set(["length","size","percentage"]),Sr=t=>ze(t,kr,zs),Cr=t=>ze(t,"position",zs),Dr=new Set(["image","url"]),Pr=t=>ze(t,Dr,Tr),Ir=t=>ze(t,"",Ar),Ve=()=>!0,ze=(t,s,a)=>{const r=Ws.exec(t);return r?r[1]?typeof s=="string"?r[1]===s:s.has(r[1]):a(r[2]):!1},Mr=t=>jr.test(t)&&!vr.test(t),zs=()=>!1,Ar=t=>yr.test(t),Tr=t=>wr.test(t),Er=()=>{const t=V("colors"),s=V("spacing"),a=V("blur"),r=V("brightness"),n=V("borderColor"),i=V("borderRadius"),o=V("borderSpacing"),l=V("borderWidth"),c=V("contrast"),d=V("grayscale"),p=V("hueRotate"),f=V("invert"),g=V("gap"),D=V("gradientColorStops"),w=V("gradientColorStopPositions"),b=V("inset"),N=V("margin"),P=V("opacity"),u=V("padding"),k=V("saturate"),S=V("scale"),O=V("sepia"),$=V("skew"),E=V("space"),x=V("translate"),W=()=>["auto","contain","none"],se=()=>["auto","hidden","clip","visible","scroll"],Q=()=>["auto",A,s],F=()=>[A,s],h=()=>["",xe,je],M=()=>["auto",Le,A],y=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],B=()=>["solid","dashed","dotted","double","none"],Y=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],J=()=>["start","end","center","between","around","evenly","stretch"],_=()=>["","0",A],q=()=>["auto","avoid","all","avoid-page","page","left","right","column"],H=()=>[Le,A];return{cacheSize:500,separator:":",theme:{colors:[Ve],spacing:[xe,je],blur:["none","",ve,A],brightness:H(),borderColor:[t],borderRadius:["none","","full",ve,A],borderSpacing:F(),borderWidth:h(),contrast:H(),grayscale:_(),hueRotate:H(),invert:_(),gap:F(),gradientColorStops:[t],gradientColorStopPositions:[Nr,je],inset:Q(),margin:Q(),opacity:H(),padding:F(),saturate:H(),scale:H(),sepia:_(),skew:H(),space:F(),translate:F()},classGroups:{aspect:[{aspect:["auto","square","video",A]}],container:["container"],columns:[{columns:[ve]}],"break-after":[{"break-after":q()}],"break-before":[{"break-before":q()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...y(),A]}],overflow:[{overflow:se()}],"overflow-x":[{"overflow-x":se()}],"overflow-y":[{"overflow-y":se()}],overscroll:[{overscroll:W()}],"overscroll-x":[{"overscroll-x":W()}],"overscroll-y":[{"overscroll-y":W()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Be,A]}],basis:[{basis:Q()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",A]}],grow:[{grow:_()}],shrink:[{shrink:_()}],order:[{order:["first","last","none",Be,A]}],"grid-cols":[{"grid-cols":[Ve]}],"col-start-end":[{col:["auto",{span:["full",Be,A]},A]}],"col-start":[{"col-start":M()}],"col-end":[{"col-end":M()}],"grid-rows":[{"grid-rows":[Ve]}],"row-start-end":[{row:["auto",{span:[Be,A]},A]}],"row-start":[{"row-start":M()}],"row-end":[{"row-end":M()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",A]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",A]}],gap:[{gap:[g]}],"gap-x":[{"gap-x":[g]}],"gap-y":[{"gap-y":[g]}],"justify-content":[{justify:["normal",...J()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...J(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...J(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[u]}],px:[{px:[u]}],py:[{py:[u]}],ps:[{ps:[u]}],pe:[{pe:[u]}],pt:[{pt:[u]}],pr:[{pr:[u]}],pb:[{pb:[u]}],pl:[{pl:[u]}],m:[{m:[N]}],mx:[{mx:[N]}],my:[{my:[N]}],ms:[{ms:[N]}],me:[{me:[N]}],mt:[{mt:[N]}],mr:[{mr:[N]}],mb:[{mb:[N]}],ml:[{ml:[N]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",A,s]}],"min-w":[{"min-w":[A,s,"min","max","fit"]}],"max-w":[{"max-w":[A,s,"none","full","min","max","fit","prose",{screen:[ve]},ve]}],h:[{h:[A,s,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[A,s,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[A,s,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[A,s,"auto","min","max","fit"]}],"font-size":[{text:["base",ve,je]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",At]}],"font-family":[{font:[Ve]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",A]}],"line-clamp":[{"line-clamp":["none",Le,At]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",xe,A]}],"list-image":[{"list-image":["none",A]}],"list-style-type":[{list:["none","disc","decimal",A]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[P]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[P]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...B(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",xe,je]}],"underline-offset":[{"underline-offset":["auto",xe,A]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:F()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",A]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",A]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[P]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...y(),Cr]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Sr]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Pr]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[w]}],"gradient-via-pos":[{via:[w]}],"gradient-to-pos":[{to:[w]}],"gradient-from":[{from:[D]}],"gradient-via":[{via:[D]}],"gradient-to":[{to:[D]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[P]}],"border-style":[{border:[...B(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[P]}],"divide-style":[{divide:B()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-s":[{"border-s":[n]}],"border-color-e":[{"border-e":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["",...B()]}],"outline-offset":[{"outline-offset":[xe,A]}],"outline-w":[{outline:[xe,je]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:h()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[P]}],"ring-offset-w":[{"ring-offset":[xe,je]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",ve,Ir]}],"shadow-color":[{shadow:[Ve]}],opacity:[{opacity:[P]}],"mix-blend":[{"mix-blend":[...Y(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Y()}],filter:[{filter:["","none"]}],blur:[{blur:[a]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",ve,A]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[p]}],invert:[{invert:[f]}],saturate:[{saturate:[k]}],sepia:[{sepia:[O]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[a]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[p]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[P]}],"backdrop-saturate":[{"backdrop-saturate":[k]}],"backdrop-sepia":[{"backdrop-sepia":[O]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",A]}],duration:[{duration:H()}],ease:[{ease:["linear","in","out","in-out",A]}],delay:[{delay:H()}],animate:[{animate:["none","spin","ping","pulse","bounce",A]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[S]}],"scale-x":[{"scale-x":[S]}],"scale-y":[{"scale-y":[S]}],rotate:[{rotate:[Be,A]}],"translate-x":[{"translate-x":[x]}],"translate-y":[{"translate-y":[x]}],"skew-x":[{"skew-x":[$]}],"skew-y":[{"skew-y":[$]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",A]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",A]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":F()}],"scroll-mx":[{"scroll-mx":F()}],"scroll-my":[{"scroll-my":F()}],"scroll-ms":[{"scroll-ms":F()}],"scroll-me":[{"scroll-me":F()}],"scroll-mt":[{"scroll-mt":F()}],"scroll-mr":[{"scroll-mr":F()}],"scroll-mb":[{"scroll-mb":F()}],"scroll-ml":[{"scroll-ml":F()}],"scroll-p":[{"scroll-p":F()}],"scroll-px":[{"scroll-px":F()}],"scroll-py":[{"scroll-py":F()}],"scroll-ps":[{"scroll-ps":F()}],"scroll-pe":[{"scroll-pe":F()}],"scroll-pt":[{"scroll-pt":F()}],"scroll-pr":[{"scroll-pr":F()}],"scroll-pb":[{"scroll-pb":F()}],"scroll-pl":[{"scroll-pl":F()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",A]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[xe,je,At]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Rr=pr(Er);function m(...t){return Rr(Ia(t))}const Or=ha;function C({content:t,children:s,side:a="top",align:r="center",delayDuration:n=300,disabled:i=!1,className:o}){return i||!t?e.jsx(e.Fragment,{children:s}):e.jsxs(ca,{delayDuration:n,children:[e.jsx(da,{asChild:!0,children:s}),e.jsx(ma,{children:e.jsxs(xa,{side:a,align:r,sideOffset:5,className:m("z-50 overflow-hidden rounded-md px-3 py-1.5 text-sm","bg-slate-900 text-slate-50 dark:bg-slate-50 dark:text-slate-900","shadow-md animate-fade-in","max-w-xs",o),children:[t,e.jsx(ua,{className:"fill-slate-900 dark:fill-slate-50",width:10,height:5})]})})]})}function _s({content:t,icon:s,className:a}){return e.jsx(C,{content:t,children:e.jsx("span",{className:m("inline-flex items-center justify-center","text-slate-400 hover:text-slate-600 dark:text-slate-500 dark:hover:text-slate-300","cursor-help",a),children:s||e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),e.jsx("path",{d:"M12 17h.01"})]})})})}const Fr={primary:m("bg-forensic-500 hover:bg-forensic-600 active:bg-forensic-700","text-white","border border-transparent","shadow-sm"),secondary:m("bg-slate-100 hover:bg-slate-200 active:bg-slate-300","dark:bg-slate-700 dark:hover:bg-slate-600 dark:active:bg-slate-500","text-slate-900 dark:text-slate-100","border border-transparent"),ghost:m("bg-transparent hover:bg-slate-100 active:bg-slate-200","dark:hover:bg-slate-800 dark:active:bg-slate-700","text-slate-700 dark:text-slate-300","border border-transparent"),danger:m("bg-red-500 hover:bg-red-600 active:bg-red-700","text-white","border border-transparent","shadow-sm"),outline:m("bg-transparent hover:bg-slate-50 active:bg-slate-100","dark:hover:bg-slate-800 dark:active:bg-slate-700","text-slate-700 dark:text-slate-300","border border-slate-300 dark:border-slate-600")},Lr={sm:"h-8 px-3 text-sm gap-1.5",md:"h-10 px-4 text-sm gap-2",lg:"h-12 px-6 text-base gap-2.5"},I=v.forwardRef(({className:t,variant:s="primary",size:a="md",leftIcon:r,rightIcon:n,isLoading:i,tooltip:o,fullWidth:l,disabled:c,children:d,...p},f)=>{const g=e.jsxs("button",{ref:f,disabled:c||i,className:m("inline-flex items-center justify-center","font-medium rounded-lg","transition-colors duration-200","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-forensic-500 focus-visible:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none",Fr[s],Lr[a],l&&"w-full",t),...p,children:[i?e.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):r,d,!i&&n]});return o?e.jsx(C,{content:o,children:g}):g});I.displayName="Button";const Wr=v.forwardRef(({className:t,size:s="md",icon:a,...r},n)=>{const i={sm:"h-8 w-8",md:"h-10 w-10",lg:"h-12 w-12"};return e.jsx(I,{ref:n,size:s,className:m("!p-0",i[s],t),...r,children:a})});Wr.displayName="IconButton";const zr={none:"",sm:"p-3",md:"p-4",lg:"p-6"},T=v.forwardRef(({className:t,hoverable:s=!1,selected:a=!1,padding:r="md",children:n,...i},o)=>e.jsx("div",{ref:o,className:m("bg-white dark:bg-slate-800","rounded-lg","border border-slate-200 dark:border-slate-700","shadow-sm",zr[r],s&&["transition-all duration-200","hover:shadow-md hover:border-slate-300 dark:hover:border-slate-600","cursor-pointer"],a&&["ring-2 ring-forensic-500 ring-offset-2 dark:ring-offset-slate-900","border-forensic-500"],t),...i,children:n}));T.displayName="Card";function Z({className:t,title:s,description:a,action:r,children:n,...i}){return e.jsxs("div",{className:m("flex items-start justify-between gap-4",t),...i,children:[e.jsxs("div",{className:"space-y-1",children:[s&&e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:s}),a&&e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:a}),n]}),r&&e.jsx("div",{className:"flex-shrink-0",children:r})]})}const _r={default:"bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300",primary:"bg-forensic-100 text-forensic-800 dark:bg-forensic-900/30 dark:text-forensic-400",secondary:"bg-slate-100 text-slate-600 dark:bg-slate-700 dark:text-slate-400",success:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",warning:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",danger:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",info:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",critical:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",high:"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",low:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400"},Br={sm:"px-1.5 py-0.5 text-xs",md:"px-2.5 py-0.5 text-xs",lg:"px-3 py-1 text-sm"},Vr={default:"bg-slate-500",primary:"bg-forensic-500",secondary:"bg-slate-400",success:"bg-green-500",warning:"bg-yellow-500",danger:"bg-red-500",info:"bg-blue-500",critical:"bg-red-500",high:"bg-orange-500",medium:"bg-yellow-500",low:"bg-green-500"};function ce({className:t,variant:s="default",size:a="md",icon:r,dot:n,dotColor:i,children:o,...l}){return e.jsxs("span",{className:m("inline-flex items-center gap-1.5 font-medium rounded-full",_r[s],Br[a],t),...l,children:[n&&e.jsx("span",{className:m("w-1.5 h-1.5 rounded-full",i||Vr[s])}),r&&e.jsx("span",{className:"flex-shrink-0",children:r}),o]})}function Qt({severity:t,size:s="md",className:a}){const r={critical:"Critical",high:"High",medium:"Medium",low:"Low",info:"Info"},n={critical:"critical",high:"high",medium:"medium",low:"low",info:"info"};return e.jsx(ce,{variant:n[t],size:s,className:a,children:r[t]})}const Hr={sm:"h-1",md:"h-2",lg:"h-3"},Ur={default:"bg-forensic-500",success:"bg-green-500",warning:"bg-yellow-500",danger:"bg-red-500"};function yt({value:t,max:s=100,size:a="md",variant:r="default",showLabel:n=!1,animated:i=!0,className:o}){const l=Math.min(Math.max(t/s*100,0),100);return e.jsxs("div",{className:m("w-full",o),children:[n&&e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Progress"}),e.jsxs("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:[Math.round(l),"%"]})]}),e.jsx(pa,{value:t,max:s,className:m("w-full overflow-hidden rounded-full bg-slate-200 dark:bg-slate-700",Hr[a]),children:e.jsx(ga,{className:m("h-full rounded-full",Ur[r],i&&"transition-all duration-300 ease-out"),style:{width:`${l}%`}})})]})}const Gr={default:"stroke-forensic-500",success:"stroke-green-500",warning:"stroke-yellow-500",danger:"stroke-red-500"};function $r({value:t,size:s=120,strokeWidth:a=8,showLabel:r=!0,variant:n="default",label:i,className:o}){const l=Math.min(Math.max(t,0),100),c=(s-a)/2,d=c*2*Math.PI,p=d-l/100*d;return e.jsxs("div",{className:m("relative inline-flex",o),children:[e.jsxs("svg",{width:s,height:s,className:"transform -rotate-90",children:[e.jsx("circle",{cx:s/2,cy:s/2,r:c,fill:"none",strokeWidth:a,className:"stroke-slate-200 dark:stroke-slate-700"}),e.jsx("circle",{cx:s/2,cy:s/2,r:c,fill:"none",strokeWidth:a,strokeLinecap:"round",className:m(Gr[n],"transition-all duration-500 ease-out"),style:{strokeDasharray:d,strokeDashoffset:p}})]}),r&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:i||e.jsxs("span",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:[Math.round(l),"%"]})})]})}const Yr={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"};function qr({size:t="md",className:s}){return e.jsxs("svg",{className:m("animate-spin text-forensic-500",Yr[t],s),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}const Xr={sm:"h-8 text-sm px-2",md:"h-10 text-sm px-3",lg:"h-12 text-base px-4"},Qe=v.forwardRef(({className:t,label:s,helperText:a,error:r,tooltip:n,required:i,leftAddon:o,rightAddon:l,inputSize:c="md",disabled:d,id:p,...f},g)=>{const D=p||v.useId();return e.jsxs("div",{className:m("w-full",t),children:[s&&e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsxs("label",{htmlFor:D,className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:[s,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),n&&e.jsx(_s,{content:n})]}),e.jsxs("div",{className:"relative",children:[o&&e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none text-slate-400",children:o}),e.jsx("input",{ref:g,id:D,disabled:d,className:m("w-full rounded-lg","bg-white dark:bg-slate-800","border border-slate-300 dark:border-slate-600","text-slate-900 dark:text-slate-100","placeholder:text-slate-400 dark:placeholder:text-slate-500","focus:ring-2 focus:ring-forensic-500 focus:border-transparent","disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-slate-50 dark:disabled:bg-slate-900","transition-colors duration-200",Xr[c],o&&"pl-10",l&&"pr-10",r&&"border-red-500 focus:ring-red-500"),"aria-invalid":!!r,"aria-describedby":r?`${D}-error`:void 0,...f}),l&&e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-slate-400",children:l})]}),(a||r)&&e.jsx("p",{id:r?`${D}-error`:void 0,className:m("mt-1 text-sm",r?"text-red-500":"text-slate-500 dark:text-slate-400"),children:r||a})]})});Qe.displayName="Input";const Bs=v.forwardRef(({className:t,label:s,helperText:a,error:r,tooltip:n,required:i,minRows:o=3,disabled:l,id:c,...d},p)=>{const f=c||v.useId();return e.jsxs("div",{className:m("w-full",t),children:[s&&e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsxs("label",{htmlFor:f,className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:[s,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),n&&e.jsx(_s,{content:n})]}),e.jsx("textarea",{ref:p,id:f,disabled:l,rows:o,className:m("w-full rounded-lg px-3 py-2","bg-white dark:bg-slate-800","border border-slate-300 dark:border-slate-600","text-slate-900 dark:text-slate-100","placeholder:text-slate-400 dark:placeholder:text-slate-500","focus:ring-2 focus:ring-forensic-500 focus:border-transparent","disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-slate-50 dark:disabled:bg-slate-900","transition-colors duration-200","resize-y",r&&"border-red-500 focus:ring-red-500"),"aria-invalid":!!r,"aria-describedby":r?`${f}-error`:void 0,...d}),(a||r)&&e.jsx("p",{id:r?`${f}-error`:void 0,className:m("mt-1 text-sm",r?"text-red-500":"text-slate-500 dark:text-slate-400"),children:r||a})]})});Bs.displayName="Textarea";function Kr({onSearch:t,onKeyDown:s,...a}){const r=n=>{n.key==="Enter"&&t&&t(n.currentTarget.value),s==null||s(n)};return e.jsx(Qe,{type:"search",leftAddon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),onKeyDown:r,...a})}const Qr={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl",full:"max-w-4xl"};function Tt({open:t,onOpenChange:s,title:a,description:r,children:n,size:i="md",closeOnOverlayClick:o=!0,showCloseButton:l=!0,footer:c}){return e.jsx(fa,{open:t,onOpenChange:s,children:e.jsx(Ma,{children:t&&e.jsxs(ba,{forceMount:!0,children:[e.jsx(ja,{asChild:!0,children:e.jsx(as.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm",onClick:o?()=>s(!1):void 0})}),e.jsx(va,{asChild:!0,children:e.jsx(as.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2,ease:"easeOut"},className:m("fixed z-50 inset-0","flex items-center justify-center","pointer-events-none"),onClick:d=>d.stopPropagation(),children:e.jsxs("div",{className:m("w-full pointer-events-auto","bg-white dark:bg-slate-800","rounded-xl shadow-xl","border border-slate-200 dark:border-slate-700","focus:outline-none","max-h-[85vh] overflow-hidden flex flex-col",Qr[i]),children:[(a||l)&&e.jsxs("div",{className:"flex items-start justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{children:[a&&e.jsx(ya,{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:a}),r&&e.jsx(wa,{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:r})]}),l&&e.jsx(Na,{asChild:!0,children:e.jsx("button",{className:m("rounded-lg p-1.5","text-slate-400 hover:text-slate-600 dark:text-slate-500 dark:hover:text-slate-300","hover:bg-slate-100 dark:hover:bg-slate-700","transition-colors duration-200","focus:outline-none focus:ring-2 focus:ring-forensic-500"),"aria-label":"Close",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:n}),c&&e.jsx("div",{className:"flex items-center justify-end gap-2 p-4 border-t border-slate-200 dark:border-slate-700",children:c})]})})})]})})})}const xs=t=>{let s;const a=new Set,r=(d,p)=>{const f=typeof d=="function"?d(s):d;if(!Object.is(f,s)){const g=s;s=p??(typeof f!="object"||f===null)?f:Object.assign({},s,f),a.forEach(D=>D(s,g))}},n=()=>s,l={setState:r,getState:n,getInitialState:()=>c,subscribe:d=>(a.add(d),()=>a.delete(d))},c=s=t(r,n,l);return l},Jr=t=>t?xs(t):xs,Zr=t=>t;function en(t,s=Zr){const a=qe.useSyncExternalStore(t.subscribe,qe.useCallback(()=>s(t.getState()),[t,s]),qe.useCallback(()=>s(t.getInitialState()),[t,s]));return qe.useDebugValue(a),a}const us=t=>{const s=Jr(t),a=r=>en(s,r);return Object.assign(a,s),a},Ct=t=>t?us(t):us;function tn(t,s){let a;try{a=t()}catch{return}return{getItem:n=>{var i;const o=c=>c===null?null:JSON.parse(c,void 0),l=(i=a.getItem(n))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(n,i)=>a.setItem(n,JSON.stringify(i,void 0)),removeItem:n=>a.removeItem(n)}}const Jt=t=>s=>{try{const a=t(s);return a instanceof Promise?a:{then(r){return Jt(r)(a)},catch(r){return this}}}catch(a){return{then(r){return this},catch(r){return Jt(r)(a)}}}},sn=(t,s)=>(a,r,n)=>{let i={storage:tn(()=>window.localStorage),partialize:N=>N,version:0,merge:(N,P)=>({...P,...N}),...s},o=!1,l=0;const c=new Set,d=new Set;let p=i.storage;if(!p)return t((...N)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),a(...N)},r,n);const f=()=>{const N=i.partialize({...r()});return p.setItem(i.name,{state:N,version:i.version})},g=n.setState;n.setState=(N,P)=>(g(N,P),f());const D=t((...N)=>(a(...N),f()),r,n);n.getInitialState=()=>D;let w;const b=()=>{var N,P;if(!p)return;const u=++l;o=!1,c.forEach(S=>{var O;return S((O=r())!=null?O:D)});const k=((P=i.onRehydrateStorage)==null?void 0:P.call(i,(N=r())!=null?N:D))||void 0;return Jt(p.getItem.bind(p))(i.name).then(S=>{if(S)if(typeof S.version=="number"&&S.version!==i.version){if(i.migrate){const O=i.migrate(S.state,S.version);return O instanceof Promise?O.then($=>[!0,$]):[!0,O]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,S.state];return[!1,void 0]}).then(S=>{var O;if(u!==l)return;const[$,E]=S;if(w=i.merge(E,(O=r())!=null?O:D),a(w,!0),$)return f()}).then(()=>{u===l&&(k==null||k(w,void 0),w=r(),o=!0,d.forEach(S=>S(w)))}).catch(S=>{u===l&&(k==null||k(void 0,S))})};return n.persist={setOptions:N=>{i={...i,...N},N.storage&&(p=N.storage)},clearStorage:()=>{p==null||p.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>b(),hasHydrated:()=>o,onHydrate:N=>(c.add(N),()=>{c.delete(N)}),onFinishHydration:N=>(d.add(N),()=>{d.delete(N)})},i.skipHydration||b(),w||D},Vs=sn,Hs={THEME:"forensic-theme",SESSION:"forensic-session"},hs=[{id:"endpoints",name:"Endpoints",description:"Collect data from workstations and servers",connectors:["windows","linux","macos"]},{id:"cloud",name:"Cloud Services",description:"Connect to cloud platforms and SaaS applications",connectors:["aws","azure","gcp","o365","gsuite"]},{id:"peripherals",name:"Network & Peripherals",description:"Access network devices and security appliances",connectors:["firewall","storage","email_gateway","proxy_waf"]}],ps={windows:{name:"Windows",icon:"Monitor",description:"Windows Event Logs, Registry, File System"},linux:{name:"Linux",icon:"Terminal",description:"Auth logs, Syslog, File System artifacts"},macos:{name:"macOS",icon:"Apple",description:"Unified Logs, FSEvents, Keychain"},aws:{name:"AWS",icon:"Cloud",description:"CloudTrail, CloudWatch, VPC Flow Logs"},azure:{name:"Azure",icon:"Cloud",description:"Activity Logs, Azure AD, Sentinel"},gcp:{name:"Google Cloud",icon:"Cloud",description:"Cloud Audit Logs, VPC Flow Logs"},o365:{name:"Microsoft 365",icon:"Mail",description:"Unified Audit Logs, Exchange, SharePoint"},gsuite:{name:"Google Workspace",icon:"Mail",description:"Admin Reports, Gmail, Drive Activity"},firewall:{name:"Firewall",icon:"Shield",description:"Traffic logs, Rule changes, Threat events"},storage:{name:"Storage/NAS",icon:"HardDrive",description:"Access logs, File activity, Quota changes"},email_gateway:{name:"Email Gateway",icon:"MailWarning",description:"Message tracking, Threat filtering"},proxy_waf:{name:"Proxy/WAF",icon:"Globe",description:"Web traffic, Blocked requests, Attacks"}},an={ping:{name:"Ping/ICMP",description:"Send ICMP echo request to verify host is reachable"},dns:{name:"DNS Resolution",description:"Verify hostname resolves to documented IP address"},spn:{name:"SPN Check",description:"Validate Service Principal Name in Active Directory"},ad_lookup:{name:"AD Lookup",description:"Verify computer object exists in Active Directory"},port_scan:{name:"Port Scan",description:"Check if expected services are listening"},cert_check:{name:"Certificate Check",description:"Validate SSL/TLS certificate is valid"}},rn={pdf:{name:"PDF",icon:"FileText",color:"text-red-500"},docx:{name:"Word",icon:"FileText",color:"text-blue-500"},xlsx:{name:"Excel",icon:"FileSpreadsheet",color:"text-green-500"},json:{name:"JSON",icon:"FileJson",color:"text-yellow-500"},yaml:{name:"YAML",icon:"FileCode",color:"text-purple-500"},visio:{name:"Visio",icon:"Network",color:"text-blue-600"}},nn={github:{name:"GitHub",icon:"Github"},gitlab:{name:"GitLab",icon:"GitBranch"},sharepoint:{name:"SharePoint",icon:"FileStack"},bitbucket:{name:"Bitbucket",icon:"GitBranch"}},Ee=[{id:"data_collection",name:"Data Collection",description:"Gathering logs and artifacts from configured sources",estimatedDuration:3e3,steps:5},{id:"log_analysis",name:"Log Analysis",description:"Parsing and analyzing collected log data",estimatedDuration:4e3,steps:8},{id:"artifact_extraction",name:"Artifact Extraction",description:"Extracting forensic artifacts from systems",estimatedDuration:2500,steps:4},{id:"correlation",name:"Correlation Engine",description:"Correlating events and building timeline",estimatedDuration:3500,steps:6},{id:"anomaly_detection",name:"Anomaly Detection",description:"Identifying suspicious patterns and behaviors",estimatedDuration:2e3,steps:3}];function ln(){return typeof window>"u"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Et(t){if(typeof document>"u")return;const s=document.documentElement;t==="dark"?s.classList.add("dark"):s.classList.remove("dark")}function gs(t){return t==="auto"?ln():t}const Us=Ct()(Vs((t,s)=>({mode:"auto",effectiveTheme:"light",setMode:a=>{const r=gs(a);Et(r),t({mode:a,effectiveTheme:r})},initializeTheme:()=>{const{mode:a}=s(),r=gs(a);Et(r),t({effectiveTheme:r}),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",i=>{const{mode:o}=s();if(o==="auto"){const l=i.matches?"dark":"light";Et(l),t({effectiveTheme:l})}})}}),{name:Hs.THEME,partialize:t=>({mode:t.mode})})),Ce=["dashboard","organization_context","incident_description","connector_config","infrastructure_validation","triage","timeline","verification","report"];function on(){return`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function cn(t){const s=new Date;return{id:on(),createdAt:s,lastModified:s,scenarioType:t||"custom",currentStep:1,isComplete:!1,connectors:[],timelineEvents:[],findings:[],verificationDecisions:[]}}const me=Ct()(Vs((t,s)=>({currentSession:null,recentSessions:[],currentStep:"dashboard",createSession:a=>{const r=cn(a);t(n=>({currentSession:r,currentStep:"organization_context",recentSessions:[r,...n.recentSessions.slice(0,9)]}))},loadSession:a=>{const{recentSessions:r}=s(),n=r.find(i=>i.id===a);if(n){const i=n.currentStep,o=Ce[i]||"dashboard";t({currentSession:{...n,lastModified:new Date},currentStep:o})}},updateSession:a=>{t(r=>{if(!r.currentSession)return r;const n={...r.currentSession,...a,lastModified:new Date};return{currentSession:n,recentSessions:r.recentSessions.map(i=>i.id===n.id?n:i)}})},deleteSession:a=>{t(r=>{var n;return{currentSession:((n=r.currentSession)==null?void 0:n.id)===a?null:r.currentSession,recentSessions:r.recentSessions.filter(i=>i.id!==a)}})},clearRecentSessions:()=>{t({recentSessions:[],currentSession:null})},setCurrentStep:a=>{const r=Ce.indexOf(a);t(n=>({currentStep:a,currentSession:n.currentSession?{...n.currentSession,currentStep:r,lastModified:new Date}:null}))},goToNextStep:()=>{const{currentStep:a}=s(),r=Ce.indexOf(a);if(r<Ce.length-1){const n=Ce[r+1];t(i=>({currentStep:n,currentSession:i.currentSession?{...i.currentSession,currentStep:r+1,lastModified:new Date}:null}))}},goToPreviousStep:()=>{const{currentStep:a}=s(),r=Ce.indexOf(a);if(r>0){const n=Ce[r-1];t(i=>({currentStep:n,currentSession:i.currentSession?{...i.currentSession,currentStep:r-1,lastModified:new Date}:null}))}},updateIncidentDescription:a=>{t(r=>{if(!r.currentSession)return r;const n=r.currentSession.incidentDescription||{naturalLanguage:"",startDate:new Date,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,patientZero:{hostname:"",type:"workstation"},iocs:[],criticalSystems:[],compromisedCredentials:[]};return{currentSession:{...r.currentSession,incidentDescription:{...n,...a},lastModified:new Date}}})},updateConnectors:a=>{t(r=>r.currentSession?{currentSession:{...r.currentSession,connectors:a,lastModified:new Date}}:r)},updateTriageState:a=>{t(r=>{if(!r.currentSession)return r;const n=r.currentSession.triageState||{status:"idle",overallProgress:0,phases:[],activityLog:[],findings:[],errors:[]};return{currentSession:{...r.currentSession,triageState:{...n,...a},lastModified:new Date}}})},addTimelineEvent:a=>{t(r=>r.currentSession?{currentSession:{...r.currentSession,timelineEvents:[...r.currentSession.timelineEvents,a],lastModified:new Date}}:r)},addFinding:a=>{t(r=>r.currentSession?{currentSession:{...r.currentSession,findings:[...r.currentSession.findings,a],lastModified:new Date}}:r)},addVerificationDecision:a=>{t(r=>r.currentSession?{currentSession:{...r.currentSession,verificationDecisions:[...r.currentSession.verificationDecisions,a],lastModified:new Date}}:r)}}),{name:Hs.SESSION,partialize:t=>({currentSession:t.currentSession,recentSessions:t.recentSessions})})),fs={systems:[],networks:[],processes:[],compliance:[],recoveryObjectives:[]};function ue(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function dn(t){await new Promise(i=>setTimeout(i,2e3+Math.random()*2e3));const s=[{id:ue(),hostname:"DC-MAIN-01",ip:"10.0.1.10",role:"Domain Controller",criticality:"critical",sourceDocument:t.filename,os:"Windows Server 2022"},{id:ue(),hostname:"FS-FINANCE-01",ip:"10.0.2.20",role:"File Server",criticality:"high",sourceDocument:t.filename,os:"Windows Server 2019"},{id:ue(),hostname:"WEB-APP-01",ip:"10.0.3.30",role:"Web Application Server",criticality:"high",sourceDocument:t.filename,os:"Ubuntu 22.04"}],a=[{id:ue(),name:"Corporate LAN",cidr:"10.0.0.0/16",vlan:10,description:"Main corporate network",sourceDocument:t.filename},{id:ue(),name:"DMZ",cidr:"192.168.1.0/24",vlan:50,description:"Demilitarized zone for public services",sourceDocument:t.filename}],r=[{id:ue(),name:"Financial Reporting",description:"Monthly financial reporting and compliance",criticality:"critical",rto:4,rpo:1,dependentSystems:["FS-FINANCE-01","DC-MAIN-01"],sourceDocument:t.filename}],n=[{id:ue(),framework:"SOC2",requirement:"CC6.1",description:"Logical and physical access controls",applicableSystems:["DC-MAIN-01"],sourceDocument:t.filename}];return{systems:s,networks:a,processes:r,compliance:n,recoveryObjectives:r.map(i=>({processId:i.id,processName:i.name,rto:i.rto,rpo:i.rpo,tier:i.criticality==="critical"?1:i.criticality==="high"?2:3}))}}const Gs=Ct((t,s)=>({documents:[],repositories:[],extractedEntities:fs,isParsingDocument:!1,isSyncingRepo:!1,addDocument:async a=>{var o;const r=ue(),n=(o=a.name.split(".").pop())==null?void 0:o.toLowerCase(),i={id:r,filename:a.name,type:n||"pdf",size:a.size,uploadedAt:new Date,status:"uploading"};t(l=>({documents:[...l.documents,i]})),await new Promise(l=>setTimeout(l,500)),t(l=>({documents:l.documents.map(c=>c.id===r?{...c,status:"parsing"}:c),isParsingDocument:!0}));try{const l=await dn(i);t(c=>({documents:c.documents.map(d=>d.id===r?{...d,status:"parsed",extractedData:l}:d),extractedEntities:{systems:[...c.extractedEntities.systems,...l.systems],networks:[...c.extractedEntities.networks,...l.networks],processes:[...c.extractedEntities.processes,...l.processes],compliance:[...c.extractedEntities.compliance,...l.compliance],recoveryObjectives:[...c.extractedEntities.recoveryObjectives,...l.recoveryObjectives]},isParsingDocument:!1}))}catch{t(l=>({documents:l.documents.map(c=>c.id===r?{...c,status:"error",errorMessage:"Failed to parse document"}:c),isParsingDocument:!1}))}},removeDocument:a=>{const r=s().documents.find(n=>n.id===a);r&&t(n=>({documents:n.documents.filter(i=>i.id!==a),extractedEntities:{systems:n.extractedEntities.systems.filter(i=>i.sourceDocument!==r.filename),networks:n.extractedEntities.networks.filter(i=>i.sourceDocument!==r.filename),processes:n.extractedEntities.processes.filter(i=>i.sourceDocument!==r.filename),compliance:n.extractedEntities.compliance.filter(i=>i.sourceDocument!==r.filename),recoveryObjectives:n.extractedEntities.recoveryObjectives.filter(i=>{const o=n.extractedEntities.processes.find(l=>l.id===i.processId);return(o==null?void 0:o.sourceDocument)!==r.filename})}}))},updateDocumentStatus:(a,r,n)=>{t(i=>({documents:i.documents.map(o=>o.id===a?{...o,status:r,errorMessage:n}:o)}))},connectRepository:async(a,r,n)=>{const i=ue(),o={id:i,type:a,name:n,url:r,status:"syncing"};t(l=>({repositories:[...l.repositories,o],isSyncingRepo:!0})),await new Promise(l=>setTimeout(l,2e3)),t(l=>({repositories:l.repositories.map(c=>c.id===i?{...c,status:"connected",lastSync:new Date,filesCount:Math.floor(Math.random()*50)+10}:c),isSyncingRepo:!1}))},disconnectRepository:a=>{t(r=>({repositories:r.repositories.filter(n=>n.id!==a)}))},syncRepository:async a=>{t(r=>({repositories:r.repositories.map(n=>n.id===a?{...n,status:"syncing"}:n),isSyncingRepo:!0})),await new Promise(r=>setTimeout(r,1500)),t(r=>({repositories:r.repositories.map(n=>n.id===a?{...n,status:"connected",lastSync:new Date}:n),isSyncingRepo:!1}))},addExtractedSystem:a=>{t(r=>({extractedEntities:{...r.extractedEntities,systems:[...r.extractedEntities.systems,a]}}))},addExtractedNetwork:a=>{t(r=>({extractedEntities:{...r.extractedEntities,networks:[...r.extractedEntities.networks,a]}}))},addBusinessProcess:a=>{t(r=>({extractedEntities:{...r.extractedEntities,processes:[...r.extractedEntities.processes,a]}}))},addComplianceRequirement:a=>{t(r=>({extractedEntities:{...r.extractedEntities,compliance:[...r.extractedEntities.compliance,a]}}))},loadScenarioContext:a=>{t({documents:a.documents,repositories:a.repositories,extractedEntities:a.extractedEntities})},resetContext:()=>{t({documents:[],repositories:[],extractedEntities:fs,isParsingDocument:!1,isSyncingRepo:!1})}}));function mn(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function xn(t,s){await new Promise(i=>setTimeout(i,500+Math.random()*1e3));const a=Math.random()>.2,r={method:s,status:a?"success":"failed",timestamp:new Date,message:a?un(s,t):hn(s,t),details:a?pn(s,t):gn(s,t)};let n;return a||(n={id:mn(),systemId:t.systemId,hostname:t.hostname,type:fn(s),severity:s==="ad_lookup"||s==="cert_check"?"critical":"warning",description:r.message||"Validation failed",documented:t.documentedIP,actual:bn(s)}),{result:r,discrepancy:n}}function un(t,s){return{ping:`Host ${s.hostname} (${s.documentedIP}) is reachable`,dns:`Hostname ${s.hostname} resolves to ${s.documentedIP}`,spn:`SPN registered for ${s.hostname} in Active Directory`,ad_lookup:`Computer object ${s.hostname} found in Active Directory`,port_scan:`Expected services responding on ${s.hostname}`,cert_check:`SSL/TLS certificate valid for ${s.hostname}`}[t]}function hn(t,s){return{ping:`Host ${s.hostname} (${s.documentedIP}) is not responding`,dns:`Hostname ${s.hostname} does not resolve to documented IP`,spn:`No SPN found for ${s.hostname} in Active Directory`,ad_lookup:`Computer object ${s.hostname} not found in Active Directory`,port_scan:`Expected services not responding on ${s.hostname}`,cert_check:`SSL/TLS certificate expired or invalid for ${s.hostname}`}[t]}function pn(t,s){return{ping:{latency:`${Math.floor(Math.random()*50)+1}ms`,packetLoss:"0%"},dns:{resolvedIP:s.documentedIP,ttl:3600},spn:{spn:`HOST/${s.hostname}`,realm:"CORP.LOCAL"},ad_lookup:{ou:"OU=Servers,DC=corp,DC=local",enabled:!0},port_scan:{openPorts:[22,80,443],closedPorts:[]},cert_check:{issuer:"Corp Internal CA",expiresIn:"180 days"}}[t]}function gn(t,s){return{ping:{packetLoss:"100%",timeout:"3000ms"},dns:{resolvedIP:`10.0.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`,expected:s.documentedIP},spn:{searched:`HOST/${s.hostname}`,found:null},ad_lookup:{searched:s.hostname,found:!1},port_scan:{openPorts:[],expectedPorts:[22,80,443]},cert_check:{error:"Certificate expired",expiredDays:Math.floor(Math.random()*30)+1}}[t]}function fn(t){return{ping:"ip_mismatch",dns:"dns_mismatch",spn:"missing_spn",ad_lookup:"not_in_ad",port_scan:"missing_service",cert_check:"cert_expired"}[t]}function bn(t,s){return{ping:"No response",dns:`10.0.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`,spn:"Not found",ad_lookup:"Not found",port_scan:"No services responding",cert_check:"Expired"}[t]}function jn(t){return t==="critical"?["ping","dns","ad_lookup","spn","port_scan","cert_check"]:t==="high"?["ping","dns","ad_lookup","port_scan"]:["ping","dns"]}function vn(t){return t.length===0||t.some(s=>s.status==="pending")?"pending":t.every(s=>s.status==="success")?"verified":t.some(s=>s.status==="failed")?"failed":"unknown"}const yn=Ct((t,s)=>({systems:[],autoValidateEnabled:!1,discrepancies:[],isValidating:!1,initializeFromSystems:a=>{const r=a.map(n=>({systemId:n.id,hostname:n.hostname,documentedIP:n.ip||"N/A",role:n.role,criticality:n.criticality,validationMethods:jn(n.criticality),results:[],overallStatus:"pending"}));t({systems:r,discrepancies:[]})},setAutoValidate:a=>{t({autoValidateEnabled:a}),a&&s().validateAllSystems()},validateSystem:async(a,r)=>{const n=s().systems.find(o=>o.systemId===a);if(!n)return;const i=r||n.validationMethods;t({isValidating:!0}),t(o=>({systems:o.systems.map(l=>l.systemId===a?{...l,results:l.results.filter(c=>!i.includes(c.method)),overallStatus:"pending"}:l),discrepancies:o.discrepancies.filter(l=>l.systemId!==a)}));for(const o of i){const{result:l,discrepancy:c}=await xn(n,o);t(d=>{const p=d.systems.map(g=>{if(g.systemId!==a)return g;const D=[...g.results,l];return{...g,results:D,overallStatus:vn(D),lastChecked:new Date}}),f=c?[...d.discrepancies,c]:d.discrepancies;return{systems:p,discrepancies:f}})}t({isValidating:!1,lastFullValidation:new Date})},validateAllSystems:async()=>{const{systems:a}=s();t({isValidating:!0});for(const r of a)await s().validateSystem(r.systemId);t({isValidating:!1,lastFullValidation:new Date})},revalidateFailed:async()=>{const{systems:a}=s(),r=a.filter(n=>n.overallStatus==="failed");t({isValidating:!0});for(const n of r){const i=n.results.filter(o=>o.status==="failed").map(o=>o.method);await s().validateSystem(n.systemId,i)}t({isValidating:!1})},clearValidation:a=>{t(r=>({systems:r.systems.map(n=>n.systemId===a?{...n,results:[],overallStatus:"pending",lastChecked:void 0}:n),discrepancies:r.discrepancies.filter(n=>n.systemId!==a)}))},resetValidation:()=>{t({systems:[],autoValidateEnabled:!1,discrepancies:[],isValidating:!1,lastFullValidation:void 0})}})),wn={sm:"h-8 w-8",md:"h-10 w-10",lg:"h-12 w-12"},Rt={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"};function Nn({size:t="md",className:s}){const{mode:a,setMode:r}=Us(),n=()=>{const l=["light","dark","auto"],d=(l.indexOf(a)+1)%l.length;r(l[d])},i={light:"Switch to dark mode",dark:"Switch to auto mode",auto:"Switch to light mode"},o={light:e.jsx("svg",{className:Rt[t],fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),dark:e.jsx("svg",{className:Rt[t],fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),auto:e.jsx("svg",{className:Rt[t],fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})};return e.jsx(C,{content:i[a],children:e.jsx("button",{onClick:n,className:m("inline-flex items-center justify-center","rounded-lg","text-slate-600 dark:text-slate-400","hover:bg-slate-100 dark:hover:bg-slate-800","hover:text-slate-900 dark:hover:text-slate-100","transition-colors duration-200","focus:outline-none focus:ring-2 focus:ring-forensic-500 focus:ring-offset-2 dark:focus:ring-offset-slate-900",wn[t],s),"aria-label":`Current theme: ${a}. Click to change.`,children:o[a]})})}const Xe=[{step:"organization_context",label:"Context",number:1},{step:"incident_description",label:"Incident",number:2},{step:"connector_config",label:"Connectors",number:3},{step:"infrastructure_validation",label:"Validation",number:4},{step:"triage",label:"Triage",number:5},{step:"timeline",label:"Timeline",number:6},{step:"verification",label:"Verify",number:7},{step:"report",label:"Report",number:8}];function $s({showProgress:t=!0,className:s}){var o;const{currentSession:a,currentStep:r}=me(),n=Xe.findIndex(l=>l.step===r),i=n>=0;return e.jsxs("header",{className:m("sticky top-0 z-40","bg-white/80 dark:bg-slate-900/80 backdrop-blur-md","border-b border-slate-200 dark:border-slate-700",s),children:[e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs(Sa,{to:"/",className:"flex items-center gap-2 text-slate-900 dark:text-slate-100 hover:opacity-80 transition-opacity",children:[e.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-forensic-500",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"m21 21-4.3-4.3"}),e.jsx("path",{d:"M11 8v6",className:"text-red-500",stroke:"currentColor"}),e.jsx("path",{d:"M8 11h6",className:"text-red-500",stroke:"currentColor"})]})}),e.jsx("span",{className:"font-semibold text-lg hidden sm:inline",children:"Forensic Triage"})]}),t&&i&&a&&e.jsx("div",{className:"hidden md:flex items-center",children:e.jsx(kn,{currentStepIndex:n,totalSteps:Xe.length})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{content:"Get help and documentation",children:e.jsx(I,{variant:"ghost",size:"sm","aria-label":"Help",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),e.jsx(Nn,{size:"sm"})]})]})}),t&&i&&a&&e.jsx("div",{className:"md:hidden px-4 pb-3",children:e.jsx(Sn,{currentStepIndex:n,currentStepLabel:((o=Xe[n])==null?void 0:o.label)||"",totalSteps:Xe.length})})]})}function kn({currentStepIndex:t,totalSteps:s}){return e.jsx("div",{className:"flex items-center gap-1",children:Xe.map((a,r)=>e.jsxs(v.Fragment,{children:[e.jsx(C,{content:a.label,children:e.jsx("div",{className:m("w-3 h-3 rounded-full transition-colors duration-200",r<t?"bg-forensic-500":r===t?"bg-forensic-500 ring-2 ring-forensic-200 dark:ring-forensic-800":"bg-slate-200 dark:bg-slate-700")})}),r<s-1&&e.jsx("div",{className:m("w-4 h-0.5",r<t?"bg-forensic-500":"bg-slate-200 dark:bg-slate-700")})]},a.step))})}function Sn({currentStepIndex:t,currentStepLabel:s,totalSteps:a}){return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-1 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-forensic-500 transition-all duration-300",style:{width:`${(t+1)/a*100}%`}})}),e.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400 whitespace-nowrap",children:["Step ",t+1,"/",a,": ",s]})]})}const bs={sm:"max-w-2xl",md:"max-w-4xl",lg:"max-w-5xl",xl:"max-w-6xl","2xl":"max-w-7xl",full:"max-w-full"};function ke({title:t,subtitle:s,showProgress:a=!0,actions:r,footer:n,children:i,maxWidth:o="2xl",className:l}){return e.jsxs("div",{className:"min-h-screen flex flex-col bg-slate-50 dark:bg-slate-900",children:[e.jsx($s,{showProgress:a}),e.jsxs("main",{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:m("flex-1 w-full mx-auto px-4 sm:px-6 lg:px-8 py-6",bs[o],l),children:[(t||r)&&e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[t&&e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:t}),s&&e.jsx("p",{className:"mt-1 text-slate-500 dark:text-slate-400",children:s})]}),r&&e.jsx("div",{className:"flex items-center gap-2 flex-shrink-0",children:r})]})}),e.jsx("div",{className:"flex-1",children:i})]}),n&&e.jsx("div",{className:"sticky bottom-0 bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-slate-700",children:e.jsx("div",{className:m("w-full mx-auto px-4 sm:px-6 lg:px-8 py-4",bs[o]),children:n})})]})]})}function Ae({onBack:t,backLabel:s="Back",onContinue:a,continueLabel:r="Continue",continueDisabled:n,continueLoading:i,middleContent:o}){return e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{children:t&&e.jsxs("button",{onClick:t,className:m("inline-flex items-center gap-2","px-4 py-2 text-sm font-medium","text-slate-600 dark:text-slate-400","hover:text-slate-900 dark:hover:text-slate-100","transition-colors duration-200"),children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),s]})}),o&&e.jsx("div",{className:"flex-1 flex justify-center",children:o}),e.jsx("div",{children:a&&e.jsxs("button",{onClick:a,disabled:n||i,className:m("inline-flex items-center gap-2","px-6 py-2 text-sm font-medium","bg-forensic-500 hover:bg-forensic-600 text-white","rounded-lg","transition-colors duration-200","disabled:opacity-50 disabled:cursor-not-allowed"),children:[i?e.jsxs("svg",{className:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):null,r,e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]})})]})}function Cn({icon:t,title:s,description:a,action:r,className:n}){return e.jsxs("div",{className:m("flex flex-col items-center justify-center text-center py-12",n),children:[t&&e.jsx("div",{className:"w-16 h-16 flex items-center justify-center text-slate-400 dark:text-slate-500 mb-4",children:t}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-1",children:s}),a&&e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 max-w-sm mb-4",children:a}),r]})}const Ys=6048e5,Dn=864e5,qs=6e4,Xs=36e5,lt=43200,js=1440,vs=Symbol.for("constructDateFrom");function de(t,s){return typeof t=="function"?t(s):t&&typeof t=="object"&&vs in t?t[vs](s):t instanceof Date?new t.constructor(s):new Date(s)}function G(t,s){return de(s||t,t)}let Pn={};function it(){return Pn}function st(t,s){var l,c,d,p;const a=it(),r=(s==null?void 0:s.weekStartsOn)??((c=(l=s==null?void 0:s.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??a.weekStartsOn??((p=(d=a.locale)==null?void 0:d.options)==null?void 0:p.weekStartsOn)??0,n=G(t,s==null?void 0:s.in),i=n.getDay(),o=(i<r?7:0)+i-r;return n.setDate(n.getDate()-o),n.setHours(0,0,0,0),n}function wt(t,s){return st(t,{...s,weekStartsOn:1})}function Ks(t,s){const a=G(t,s==null?void 0:s.in),r=a.getFullYear(),n=de(a,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const i=wt(n),o=de(a,0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);const l=wt(o);return a.getTime()>=i.getTime()?r+1:a.getTime()>=l.getTime()?r:r-1}function Nt(t){const s=G(t),a=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return a.setUTCFullYear(s.getFullYear()),+t-+a}function Dt(t,...s){const a=de.bind(null,t||s.find(r=>typeof r=="object"));return s.map(a)}function ys(t,s){const a=G(t,s==null?void 0:s.in);return a.setHours(0,0,0,0),a}function In(t,s,a){const[r,n]=Dt(a==null?void 0:a.in,t,s),i=ys(r),o=ys(n),l=+i-Nt(i),c=+o-Nt(o);return Math.round((l-c)/Dn)}function Mn(t,s){const a=Ks(t,s),r=de(t,0);return r.setFullYear(a,0,4),r.setHours(0,0,0,0),wt(r)}function bt(t,s){const a=+G(t)-+G(s);return a<0?-1:a>0?1:a}function An(t){return de(t,Date.now())}function Tn(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function En(t){return!(!Tn(t)&&typeof t!="number"||isNaN(+G(t)))}function Rn(t,s,a){const[r,n]=Dt(a==null?void 0:a.in,t,s),i=r.getFullYear()-n.getFullYear(),o=r.getMonth()-n.getMonth();return i*12+o}function On(t){return s=>{const r=(t?Math[t]:Math.trunc)(s);return r===0?0:r}}function Fn(t,s){return+G(t)-+G(s)}function Ln(t,s){const a=G(t,s==null?void 0:s.in);return a.setHours(23,59,59,999),a}function Wn(t,s){const a=G(t,s==null?void 0:s.in),r=a.getMonth();return a.setFullYear(a.getFullYear(),r+1,0),a.setHours(23,59,59,999),a}function zn(t,s){const a=G(t,s==null?void 0:s.in);return+Ln(a,s)==+Wn(a,s)}function _n(t,s,a){const[r,n,i]=Dt(a==null?void 0:a.in,t,t,s),o=bt(n,i),l=Math.abs(Rn(n,i));if(l<1)return 0;n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-o*l);let c=bt(n,i)===-o;zn(r)&&l===1&&bt(r,i)===1&&(c=!1);const d=o*(l-+c);return d===0?0:d}function Bn(t,s,a){const r=Fn(t,s)/1e3;return On(a==null?void 0:a.roundingMethod)(r)}function Vn(t,s){const a=G(t,s==null?void 0:s.in);return a.setFullYear(a.getFullYear(),0,1),a.setHours(0,0,0,0),a}const Hn={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Un=(t,s,a)=>{let r;const n=Hn[t];return typeof n=="string"?r=n:s===1?r=n.one:r=n.other.replace("{{count}}",s.toString()),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"in "+r:r+" ago":r};function Ot(t){return(s={})=>{const a=s.width?String(s.width):t.defaultWidth;return t.formats[a]||t.formats[t.defaultWidth]}}const Gn={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},$n={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Yn={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},qn={date:Ot({formats:Gn,defaultWidth:"full"}),time:Ot({formats:$n,defaultWidth:"full"}),dateTime:Ot({formats:Yn,defaultWidth:"full"})},Xn={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Kn=(t,s,a,r)=>Xn[t];function He(t){return(s,a)=>{const r=a!=null&&a.context?String(a.context):"standalone";let n;if(r==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=a!=null&&a.width?String(a.width):o;n=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=a!=null&&a.width?String(a.width):t.defaultWidth;n=t.values[l]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(s):s;return n[i]}}const Qn={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Jn={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Zn={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},ei={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},ti={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},si={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ai=(t,s)=>{const a=Number(t),r=a%100;if(r>20||r<10)switch(r%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},ri={ordinalNumber:ai,era:He({values:Qn,defaultWidth:"wide"}),quarter:He({values:Jn,defaultWidth:"wide",argumentCallback:t=>t-1}),month:He({values:Zn,defaultWidth:"wide"}),day:He({values:ei,defaultWidth:"wide"}),dayPeriod:He({values:ti,defaultWidth:"wide",formattingValues:si,defaultFormattingWidth:"wide"})};function Ue(t){return(s,a={})=>{const r=a.width,n=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],i=s.match(n);if(!i)return null;const o=i[0],l=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?ii(l,f=>f.test(o)):ni(l,f=>f.test(o));let d;d=t.valueCallback?t.valueCallback(c):c,d=a.valueCallback?a.valueCallback(d):d;const p=s.slice(o.length);return{value:d,rest:p}}}function ni(t,s){for(const a in t)if(Object.prototype.hasOwnProperty.call(t,a)&&s(t[a]))return a}function ii(t,s){for(let a=0;a<t.length;a++)if(s(t[a]))return a}function li(t){return(s,a={})=>{const r=s.match(t.matchPattern);if(!r)return null;const n=r[0],i=s.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=a.valueCallback?a.valueCallback(o):o;const l=s.slice(n.length);return{value:o,rest:l}}}const oi=/^(\d+)(th|st|nd|rd)?/i,ci=/\d+/i,di={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},mi={any:[/^b/i,/^(a|c)/i]},xi={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},ui={any:[/1/i,/2/i,/3/i,/4/i]},hi={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},pi={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},gi={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},fi={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},bi={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},ji={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},vi={ordinalNumber:li({matchPattern:oi,parsePattern:ci,valueCallback:t=>parseInt(t,10)}),era:Ue({matchPatterns:di,defaultMatchWidth:"wide",parsePatterns:mi,defaultParseWidth:"any"}),quarter:Ue({matchPatterns:xi,defaultMatchWidth:"wide",parsePatterns:ui,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ue({matchPatterns:hi,defaultMatchWidth:"wide",parsePatterns:pi,defaultParseWidth:"any"}),day:Ue({matchPatterns:gi,defaultMatchWidth:"wide",parsePatterns:fi,defaultParseWidth:"any"}),dayPeriod:Ue({matchPatterns:bi,defaultMatchWidth:"any",parsePatterns:ji,defaultParseWidth:"any"})},Qs={code:"en-US",formatDistance:Un,formatLong:qn,formatRelative:Kn,localize:ri,match:vi,options:{weekStartsOn:0,firstWeekContainsDate:1}};function yi(t,s){const a=G(t,s==null?void 0:s.in);return In(a,Vn(a))+1}function wi(t,s){const a=G(t,s==null?void 0:s.in),r=+wt(a)-+Mn(a);return Math.round(r/Ys)+1}function Js(t,s){var p,f,g,D;const a=G(t,s==null?void 0:s.in),r=a.getFullYear(),n=it(),i=(s==null?void 0:s.firstWeekContainsDate)??((f=(p=s==null?void 0:s.locale)==null?void 0:p.options)==null?void 0:f.firstWeekContainsDate)??n.firstWeekContainsDate??((D=(g=n.locale)==null?void 0:g.options)==null?void 0:D.firstWeekContainsDate)??1,o=de((s==null?void 0:s.in)||t,0);o.setFullYear(r+1,0,i),o.setHours(0,0,0,0);const l=st(o,s),c=de((s==null?void 0:s.in)||t,0);c.setFullYear(r,0,i),c.setHours(0,0,0,0);const d=st(c,s);return+a>=+l?r+1:+a>=+d?r:r-1}function Ni(t,s){var l,c,d,p;const a=it(),r=(s==null?void 0:s.firstWeekContainsDate)??((c=(l=s==null?void 0:s.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??a.firstWeekContainsDate??((p=(d=a.locale)==null?void 0:d.options)==null?void 0:p.firstWeekContainsDate)??1,n=Js(t,s),i=de((s==null?void 0:s.in)||t,0);return i.setFullYear(n,0,r),i.setHours(0,0,0,0),st(i,s)}function ki(t,s){const a=G(t,s==null?void 0:s.in),r=+st(a,s)-+Ni(a,s);return Math.round(r/Ys)+1}function z(t,s){const a=t<0?"-":"",r=Math.abs(t).toString().padStart(s,"0");return a+r}const ye={y(t,s){const a=t.getFullYear(),r=a>0?a:1-a;return z(s==="yy"?r%100:r,s.length)},M(t,s){const a=t.getMonth();return s==="M"?String(a+1):z(a+1,2)},d(t,s){return z(t.getDate(),s.length)},a(t,s){const a=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];case"aaaa":default:return a==="am"?"a.m.":"p.m."}},h(t,s){return z(t.getHours()%12||12,s.length)},H(t,s){return z(t.getHours(),s.length)},m(t,s){return z(t.getMinutes(),s.length)},s(t,s){return z(t.getSeconds(),s.length)},S(t,s){const a=s.length,r=t.getMilliseconds(),n=Math.trunc(r*Math.pow(10,a-3));return z(n,s.length)}},Re={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},ws={G:function(t,s,a){const r=t.getFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"});case"GGGGG":return a.era(r,{width:"narrow"});case"GGGG":default:return a.era(r,{width:"wide"})}},y:function(t,s,a){if(s==="yo"){const r=t.getFullYear(),n=r>0?r:1-r;return a.ordinalNumber(n,{unit:"year"})}return ye.y(t,s)},Y:function(t,s,a,r){const n=Js(t,r),i=n>0?n:1-n;if(s==="YY"){const o=i%100;return z(o,2)}return s==="Yo"?a.ordinalNumber(i,{unit:"year"}):z(i,s.length)},R:function(t,s){const a=Ks(t);return z(a,s.length)},u:function(t,s){const a=t.getFullYear();return z(a,s.length)},Q:function(t,s,a){const r=Math.ceil((t.getMonth()+1)/3);switch(s){case"Q":return String(r);case"QQ":return z(r,2);case"Qo":return a.ordinalNumber(r,{unit:"quarter"});case"QQQ":return a.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,s,a){const r=Math.ceil((t.getMonth()+1)/3);switch(s){case"q":return String(r);case"qq":return z(r,2);case"qo":return a.ordinalNumber(r,{unit:"quarter"});case"qqq":return a.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,s,a){const r=t.getMonth();switch(s){case"M":case"MM":return ye.M(t,s);case"Mo":return a.ordinalNumber(r+1,{unit:"month"});case"MMM":return a.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(r,{width:"wide",context:"formatting"})}},L:function(t,s,a){const r=t.getMonth();switch(s){case"L":return String(r+1);case"LL":return z(r+1,2);case"Lo":return a.ordinalNumber(r+1,{unit:"month"});case"LLL":return a.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(r,{width:"wide",context:"standalone"})}},w:function(t,s,a,r){const n=ki(t,r);return s==="wo"?a.ordinalNumber(n,{unit:"week"}):z(n,s.length)},I:function(t,s,a){const r=wi(t);return s==="Io"?a.ordinalNumber(r,{unit:"week"}):z(r,s.length)},d:function(t,s,a){return s==="do"?a.ordinalNumber(t.getDate(),{unit:"date"}):ye.d(t,s)},D:function(t,s,a){const r=yi(t);return s==="Do"?a.ordinalNumber(r,{unit:"dayOfYear"}):z(r,s.length)},E:function(t,s,a){const r=t.getDay();switch(s){case"E":case"EE":case"EEE":return a.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(r,{width:"short",context:"formatting"});case"EEEE":default:return a.day(r,{width:"wide",context:"formatting"})}},e:function(t,s,a,r){const n=t.getDay(),i=(n-r.weekStartsOn+8)%7||7;switch(s){case"e":return String(i);case"ee":return z(i,2);case"eo":return a.ordinalNumber(i,{unit:"day"});case"eee":return a.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(n,{width:"short",context:"formatting"});case"eeee":default:return a.day(n,{width:"wide",context:"formatting"})}},c:function(t,s,a,r){const n=t.getDay(),i=(n-r.weekStartsOn+8)%7||7;switch(s){case"c":return String(i);case"cc":return z(i,s.length);case"co":return a.ordinalNumber(i,{unit:"day"});case"ccc":return a.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(n,{width:"narrow",context:"standalone"});case"cccccc":return a.day(n,{width:"short",context:"standalone"});case"cccc":default:return a.day(n,{width:"wide",context:"standalone"})}},i:function(t,s,a){const r=t.getDay(),n=r===0?7:r;switch(s){case"i":return String(n);case"ii":return z(n,s.length);case"io":return a.ordinalNumber(n,{unit:"day"});case"iii":return a.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(r,{width:"short",context:"formatting"});case"iiii":default:return a.day(r,{width:"wide",context:"formatting"})}},a:function(t,s,a){const n=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(t,s,a){const r=t.getHours();let n;switch(r===12?n=Re.noon:r===0?n=Re.midnight:n=r/12>=1?"pm":"am",s){case"b":case"bb":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(t,s,a){const r=t.getHours();let n;switch(r>=17?n=Re.evening:r>=12?n=Re.afternoon:r>=4?n=Re.morning:n=Re.night,s){case"B":case"BB":case"BBB":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(t,s,a){if(s==="ho"){let r=t.getHours()%12;return r===0&&(r=12),a.ordinalNumber(r,{unit:"hour"})}return ye.h(t,s)},H:function(t,s,a){return s==="Ho"?a.ordinalNumber(t.getHours(),{unit:"hour"}):ye.H(t,s)},K:function(t,s,a){const r=t.getHours()%12;return s==="Ko"?a.ordinalNumber(r,{unit:"hour"}):z(r,s.length)},k:function(t,s,a){let r=t.getHours();return r===0&&(r=24),s==="ko"?a.ordinalNumber(r,{unit:"hour"}):z(r,s.length)},m:function(t,s,a){return s==="mo"?a.ordinalNumber(t.getMinutes(),{unit:"minute"}):ye.m(t,s)},s:function(t,s,a){return s==="so"?a.ordinalNumber(t.getSeconds(),{unit:"second"}):ye.s(t,s)},S:function(t,s){return ye.S(t,s)},X:function(t,s,a){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(s){case"X":return ks(r);case"XXXX":case"XX":return Ie(r);case"XXXXX":case"XXX":default:return Ie(r,":")}},x:function(t,s,a){const r=t.getTimezoneOffset();switch(s){case"x":return ks(r);case"xxxx":case"xx":return Ie(r);case"xxxxx":case"xxx":default:return Ie(r,":")}},O:function(t,s,a){const r=t.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+Ns(r,":");case"OOOO":default:return"GMT"+Ie(r,":")}},z:function(t,s,a){const r=t.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+Ns(r,":");case"zzzz":default:return"GMT"+Ie(r,":")}},t:function(t,s,a){const r=Math.trunc(+t/1e3);return z(r,s.length)},T:function(t,s,a){return z(+t,s.length)}};function Ns(t,s=""){const a=t>0?"-":"+",r=Math.abs(t),n=Math.trunc(r/60),i=r%60;return i===0?a+String(n):a+String(n)+s+z(i,2)}function ks(t,s){return t%60===0?(t>0?"-":"+")+z(Math.abs(t)/60,2):Ie(t,s)}function Ie(t,s=""){const a=t>0?"-":"+",r=Math.abs(t),n=z(Math.trunc(r/60),2),i=z(r%60,2);return a+n+s+i}const Ss=(t,s)=>{switch(t){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},Zs=(t,s)=>{switch(t){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},Si=(t,s)=>{const a=t.match(/(P+)(p+)?/)||[],r=a[1],n=a[2];if(!n)return Ss(t,s);let i;switch(r){case"P":i=s.dateTime({width:"short"});break;case"PP":i=s.dateTime({width:"medium"});break;case"PPP":i=s.dateTime({width:"long"});break;case"PPPP":default:i=s.dateTime({width:"full"});break}return i.replace("{{date}}",Ss(r,s)).replace("{{time}}",Zs(n,s))},Ci={p:Zs,P:Si},Di=/^D+$/,Pi=/^Y+$/,Ii=["D","DD","YY","YYYY"];function Mi(t){return Di.test(t)}function Ai(t){return Pi.test(t)}function Ti(t,s,a){const r=Ei(t,s,a);if(console.warn(r),Ii.includes(t))throw new RangeError(r)}function Ei(t,s,a){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${s}\`) for formatting ${r} to the input \`${a}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Ri=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Oi=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Fi=/^'([^]*?)'?$/,Li=/''/g,Wi=/[a-zA-Z]/;function ea(t,s,a){var p,f,g,D;const r=it(),n=r.locale??Qs,i=r.firstWeekContainsDate??((f=(p=r.locale)==null?void 0:p.options)==null?void 0:f.firstWeekContainsDate)??1,o=r.weekStartsOn??((D=(g=r.locale)==null?void 0:g.options)==null?void 0:D.weekStartsOn)??0,l=G(t,a==null?void 0:a.in);if(!En(l))throw new RangeError("Invalid time value");let c=s.match(Oi).map(w=>{const b=w[0];if(b==="p"||b==="P"){const N=Ci[b];return N(w,n.formatLong)}return w}).join("").match(Ri).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const b=w[0];if(b==="'")return{isToken:!1,value:zi(w)};if(ws[b])return{isToken:!0,value:w};if(b.match(Wi))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:w}});n.localize.preprocessor&&(c=n.localize.preprocessor(l,c));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:n};return c.map(w=>{if(!w.isToken)return w.value;const b=w.value;(Ai(b)||Mi(b))&&Ti(b,s,String(t));const N=ws[b[0]];return N(l,b,n.localize,d)}).join("")}function zi(t){const s=t.match(Fi);return s?s[1].replace(Li,"'"):t}function _i(t,s,a){const r=it(),n=(a==null?void 0:a.locale)??r.locale??Qs,i=2520,o=bt(t,s);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},a,{addSuffix:a==null?void 0:a.addSuffix,comparison:o}),[c,d]=Dt(a==null?void 0:a.in,...o>0?[s,t]:[t,s]),p=Bn(d,c),f=(Nt(d)-Nt(c))/1e3,g=Math.round((p-f)/60);let D;if(g<2)return a!=null&&a.includeSeconds?p<5?n.formatDistance("lessThanXSeconds",5,l):p<10?n.formatDistance("lessThanXSeconds",10,l):p<20?n.formatDistance("lessThanXSeconds",20,l):p<40?n.formatDistance("halfAMinute",0,l):p<60?n.formatDistance("lessThanXMinutes",1,l):n.formatDistance("xMinutes",1,l):g===0?n.formatDistance("lessThanXMinutes",1,l):n.formatDistance("xMinutes",g,l);if(g<45)return n.formatDistance("xMinutes",g,l);if(g<90)return n.formatDistance("aboutXHours",1,l);if(g<js){const w=Math.round(g/60);return n.formatDistance("aboutXHours",w,l)}else{if(g<i)return n.formatDistance("xDays",1,l);if(g<lt){const w=Math.round(g/js);return n.formatDistance("xDays",w,l)}else if(g<lt*2)return D=Math.round(g/lt),n.formatDistance("aboutXMonths",D,l)}if(D=_n(d,c),D<12){const w=Math.round(g/lt);return n.formatDistance("xMonths",w,l)}else{const w=D%12,b=Math.trunc(D/12);return w<3?n.formatDistance("aboutXYears",b,l):w<9?n.formatDistance("overXYears",b,l):n.formatDistance("almostXYears",b+1,l)}}function Bi(t,s){return _i(t,An(t),s)}function ss(t,s){const a=()=>de(s==null?void 0:s.in,NaN),n=Gi(t);let i;if(n.date){const d=$i(n.date,2);i=Yi(d.restDateString,d.year)}if(!i||isNaN(+i))return a();const o=+i;let l=0,c;if(n.time&&(l=qi(n.time),isNaN(l)))return a();if(n.timezone){if(c=Xi(n.timezone),isNaN(c))return a()}else{const d=new Date(o+l),p=G(0,s==null?void 0:s.in);return p.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),p.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),p}return G(o+l+c,s==null?void 0:s.in)}const ot={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Vi=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Hi=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Ui=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Gi(t){const s={},a=t.split(ot.dateTimeDelimiter);let r;if(a.length>2)return s;if(/:/.test(a[0])?r=a[0]:(s.date=a[0],r=a[1],ot.timeZoneDelimiter.test(s.date)&&(s.date=t.split(ot.timeZoneDelimiter)[0],r=t.substr(s.date.length,t.length))),r){const n=ot.timezone.exec(r);n?(s.time=r.replace(n[1],""),s.timezone=n[1]):s.time=r}return s}function $i(t,s){const a=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+s)+"})|(\\d{2}|[+-]\\d{"+(2+s)+"})$)"),r=t.match(a);if(!r)return{year:NaN,restDateString:""};const n=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:i===null?n:i*100,restDateString:t.slice((r[1]||r[2]).length)}}function Yi(t,s){if(s===null)return new Date(NaN);const a=t.match(Vi);if(!a)return new Date(NaN);const r=!!a[4],n=Ge(a[1]),i=Ge(a[2])-1,o=Ge(a[3]),l=Ge(a[4]),c=Ge(a[5])-1;if(r)return el(s,l,c)?Ki(s,l,c):new Date(NaN);{const d=new Date(0);return!Ji(s,i,o)||!Zi(s,n)?new Date(NaN):(d.setUTCFullYear(s,i,Math.max(n,o)),d)}}function Ge(t){return t?parseInt(t):1}function qi(t){const s=t.match(Hi);if(!s)return NaN;const a=Ft(s[1]),r=Ft(s[2]),n=Ft(s[3]);return tl(a,r,n)?a*Xs+r*qs+n*1e3:NaN}function Ft(t){return t&&parseFloat(t.replace(",","."))||0}function Xi(t){if(t==="Z")return 0;const s=t.match(Ui);if(!s)return 0;const a=s[1]==="+"?-1:1,r=parseInt(s[2]),n=s[3]&&parseInt(s[3])||0;return sl(r,n)?a*(r*Xs+n*qs):NaN}function Ki(t,s,a){const r=new Date(0);r.setUTCFullYear(t,0,4);const n=r.getUTCDay()||7,i=(s-1)*7+a+1-n;return r.setUTCDate(r.getUTCDate()+i),r}const Qi=[31,null,31,30,31,30,31,31,30,31,30,31];function ta(t){return t%400===0||t%4===0&&t%100!==0}function Ji(t,s,a){return s>=0&&s<=11&&a>=1&&a<=(Qi[s]||(ta(t)?29:28))}function Zi(t,s){return s>=1&&s<=(ta(t)?366:365)}function el(t,s,a){return s>=1&&s<=53&&a>=0&&a<=6}function tl(t,s,a){return t===24?s===0&&a===0:a>=0&&a<60&&s>=0&&s<60&&t>=0&&t<25}function sl(t,s){return s>=0&&s<=59}function al(t){const s=typeof t=="string"?ss(t):t;return ea(s,"PPP p")}function sa(t){const s=typeof t=="string"?ss(t):t;return ea(s,"HH:mm:ss")}function rl(t){const s=typeof t=="string"?ss(t):t;return Bi(s,{addSuffix:!0})}function nl(t){if(t===0)return"0 Bytes";const s=1024,a=["Bytes","KB","MB","GB","TB"],r=Math.floor(Math.log(t)/Math.log(s));return`${parseFloat((t/Math.pow(s,r)).toFixed(2))} ${a[r]}`}function il(){const t=be(),{createSession:s,recentSessions:a,loadSession:r,clearRecentSessions:n}=me(),i=()=>{s(),t("/context")},o=c=>{s(c),t("/context")},l=c=>{r(c),t("/context")};return e.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900",children:[e.jsx($s,{showProgress:!1}),e.jsxs("main",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-slate-900 dark:text-slate-100 mb-4",children:"Self-Service Forensic Triage"}),e.jsx("p",{className:"text-lg text-slate-600 dark:text-slate-400 max-w-2xl mx-auto mb-8",children:"Quick diagnostic before professional incident response. Upload organizational context, configure data sources, and get actionable insights."}),e.jsx(C,{content:"Begin a new forensic investigation from scratch",children:e.jsx(I,{size:"lg",onClick:i,rightIcon:e.jsx(at,{className:"w-5 h-5"}),children:"Start New Investigation"})})]}),e.jsxs("section",{className:"mb-12",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-4",children:"Select a Scenario"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-6",children:"Choose a pre-populated scenario to see the full workflow with realistic demo data."}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:ll.map(c=>e.jsx(ol,{scenario:c,onSelect:()=>o(c.id)},c.id))})]}),a.length>0&&e.jsxs("section",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Recent Sessions"}),e.jsx(C,{content:"Remove all saved session history",children:e.jsx(I,{variant:"ghost",size:"sm",onClick:n,leftIcon:e.jsx(Aa,{className:"w-4 h-4"}),children:"Clear"})})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:a.slice(0,6).map(c=>e.jsx(cl,{session:c,onResume:()=>l(c.id)},c.id))})]})]})]})}const ll=[{id:"ransomware",title:"Ransomware Attack",description:"Enterprise ransomware infection with lateral movement and file encryption",icon:e.jsx(ie,{className:"w-8 h-8"}),difficulty:"intermediate"},{id:"data_exfiltration",title:"Data Exfiltration",description:"Sensitive data theft via compromised cloud storage and sync tools",icon:e.jsx(Oe,{className:"w-8 h-8"}),difficulty:"advanced"},{id:"insider_threat",title:"Insider Threat",description:"Malicious activity by authorized user with privileged access",icon:e.jsx(Zt,{className:"w-8 h-8"}),difficulty:"advanced"},{id:"web_dos",title:"Web Resource DOS",description:"Application-layer denial of service attack on public web services",icon:e.jsx(le,{className:"w-8 h-8"}),difficulty:"beginner"},{id:"ai_breach",title:"AI-Related Breach",description:"Security incident involving AI/ML systems and data poisoning",icon:e.jsx(Ta,{className:"w-8 h-8"}),difficulty:"advanced"}];function ol({scenario:t,onSelect:s}){const a={beginner:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",intermediate:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",advanced:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"};return e.jsx(C,{content:`Load ${t.title} scenario with pre-populated data`,children:e.jsx(T,{hoverable:!0,onClick:s,className:"cursor-pointer text-center h-full",children:e.jsxs("div",{className:"flex flex-col items-center gap-3 p-2",children:[e.jsx("div",{className:"text-forensic-500 dark:text-forensic-400",children:t.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-slate-100",children:t.title}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1 line-clamp-2",children:t.description})]}),e.jsx("span",{className:m("px-2 py-0.5 rounded-full text-xs font-medium capitalize",a[t.difficulty]),children:t.difficulty})]})})})}function cl({session:t,onResume:s}){const a={ransomware:"Ransomware Attack",data_exfiltration:"Data Exfiltration",insider_threat:"Insider Threat",web_dos:"Web Resource DOS",ai_breach:"AI-Related Breach",custom:"Custom Investigation"};return e.jsx(C,{content:"Continue this investigation session",children:e.jsx(T,{hoverable:!0,onClick:s,className:"cursor-pointer",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-slate-900 dark:text-slate-100 truncate",children:a[t.scenarioType]||"Investigation"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-sm text-slate-500 dark:text-slate-400",children:[e.jsx(rt,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:rl(t.lastModified)})]})]}),e.jsx("div",{className:"flex flex-col items-end gap-1",children:e.jsx("span",{className:m("px-2 py-0.5 rounded text-xs font-medium",t.isComplete?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"),children:t.isComplete?"Complete":`Step ${t.currentStep+1}`})})]})})})}function dl(){const t=be(),{goToNextStep:s,goToPreviousStep:a}=me(),{documents:r,repositories:n,extractedEntities:i,addDocument:o,removeDocument:l}=Gs(),c=v.useRef(null),d=()=>{a(),t("/")},p=()=>{s(),t("/incident")},f=v.useCallback(async u=>{const k=u.target.files;if(k){for(const S of Array.from(k))await o(S);c.current&&(c.current.value="")}},[o]),g=v.useCallback(async u=>{u.preventDefault();const k=u.dataTransfer.files;for(const S of Array.from(k))await o(S)},[o]),D=u=>{u.preventDefault()},w=i.systems.length,b=i.networks.length,N=i.processes.length,P=i.compliance.length;return e.jsxs(ke,{title:"Organization Context",subtitle:"Upload documents to help AI understand your environment",footer:e.jsx(Ae,{onBack:d,backLabel:"Dashboard",onContinue:p,continueLabel:"Continue"}),children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs(T,{children:[e.jsx(Z,{title:"Upload Documents",description:"Drag and drop or browse files"}),e.jsxs("div",{className:"mt-4",children:[e.jsx(C,{content:"Drag and drop files or click to browse. Supports PDF, DOCX, XLSX, JSON, YAML, Visio",children:e.jsxs("div",{onDrop:g,onDragOver:D,onClick:()=>{var u;return(u=c.current)==null?void 0:u.click()},className:m("border-2 border-dashed rounded-lg p-8 text-center cursor-pointer","border-slate-300 dark:border-slate-600","hover:border-forensic-400 dark:hover:border-forensic-500","transition-colors duration-200"),children:[e.jsx(Oe,{className:"w-10 h-10 mx-auto text-slate-400 mb-3"}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Drag & Drop or"," ",e.jsx("span",{className:"text-forensic-500 font-medium",children:"Browse"})]}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"PDF, DOCX, XLSX, JSON, YAML, Visio"})]})}),e.jsx("input",{ref:c,type:"file",multiple:!0,accept:".pdf,.docx,.xlsx,.json,.yaml,.yml,.vsdx",onChange:f,className:"hidden"})]})]}),e.jsxs(T,{children:[e.jsx(Z,{title:"Connect Repository",description:"Access documentation from code repos"}),e.jsx("div",{className:"mt-4 grid grid-cols-2 gap-3",children:["github","gitlab","sharepoint","bitbucket"].map(u=>{const k=nn[u],S=n.some(O=>O.type===u&&O.status==="connected");return e.jsx(C,{content:`Connect to ${k.name} for infrastructure documentation`,children:e.jsxs("button",{className:m("flex items-center gap-2 p-3 rounded-lg border","transition-colors duration-200",S?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-slate-200 dark:border-slate-700 hover:border-forensic-400"),children:[e.jsx(Ea,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:k.name}),S&&e.jsx(X,{className:"w-4 h-4 text-green-500 ml-auto"})]})},u)})})]})]}),r.length>0&&e.jsxs("section",{className:"mb-8",children:[e.jsxs("h3",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:["Uploaded Documents (",r.length,")"]}),e.jsx("div",{className:"space-y-2",children:r.map(u=>e.jsx(ml,{document:u,onRemove:()=>l(u.id)},u.id))})]}),(w>0||b>0||N>0||P>0)&&e.jsxs("section",{children:[e.jsx("h3",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Extracted Context"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsx(ct,{icon:e.jsx(re,{className:"w-5 h-5"}),label:"Systems",count:w,tooltip:"Systems, servers, and workstations identified"}),e.jsx(ct,{icon:e.jsx(he,{className:"w-5 h-5"}),label:"Networks",count:b,tooltip:"Network segments and VLANs identified"}),e.jsx(ct,{icon:e.jsx(rt,{className:"w-5 h-5"}),label:"Processes",count:N,tooltip:"Critical business processes identified"}),e.jsx(ct,{icon:e.jsx(fe,{className:"w-5 h-5"}),label:"Compliance",count:P,tooltip:"Compliance requirements identified"})]})]}),(w>0||r.length>0)&&e.jsxs("section",{className:"mt-8 mb-8",children:[e.jsx("h3",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Identity & Access Management"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(Lt,{icon:e.jsx(Je,{className:"w-6 h-6"}),title:"Active Directory",subtitle:"On-Premises AD",status:"detected",details:[{label:"Domain Controllers",value:"2 detected"},{label:"Forest",value:"corp.local"},{label:"Functional Level",value:"2016"},{label:"User Accounts",value:"~1,250"},{label:"Service Accounts",value:"~45"},{label:"Group Policies",value:"38 linked"}]}),e.jsx(Lt,{icon:e.jsx(kt,{className:"w-6 h-6"}),title:"Azure AD / Entra ID",subtitle:"Cloud Identity",status:"detected",details:[{label:"Tenant",value:"company.onmicrosoft.com"},{label:"Synced Users",value:"~1,180"},{label:"Cloud-Only Users",value:"~70"},{label:"MFA Enforced",value:"62%"},{label:"Conditional Access",value:"8 policies"},{label:"App Registrations",value:"24"}]}),e.jsx(Lt,{icon:e.jsx(Ra,{className:"w-6 h-6"}),title:"Hybrid Identity",subtitle:"AD Connect Sync",status:"synced",details:[{label:"Sync Status",value:"Healthy"},{label:"Last Sync",value:"12 min ago"},{label:"Sync Method",value:"Password Hash"},{label:"Privileged Roles",value:"15 Global Admins"},{label:"Guest Accounts",value:"34"},{label:"Stale Accounts (90d)",value:"127"}]})]})]}),r.length===0&&n.length===0&&e.jsx(Cn,{icon:e.jsx(St,{className:"w-12 h-12"}),title:"No context uploaded yet",description:"Upload documents or connect repositories to provide organizational context for better analysis."})]})}function ml({document:t,onRemove:s}){const a=rn[t.type]||{name:"File",color:"text-slate-500"},r={uploading:e.jsx(jt,{className:"w-4 h-4 animate-spin text-blue-500"}),parsing:e.jsx(jt,{className:"w-4 h-4 animate-spin text-yellow-500"}),parsed:e.jsx(X,{className:"w-4 h-4 text-green-500"}),error:e.jsx(Fa,{className:"w-4 h-4 text-red-500"})},n={uploading:"Uploading...",parsing:"Parsing...",parsed:"Parsed",error:"Error"};return e.jsxs("div",{className:m("flex items-center gap-3 p-3 rounded-lg","bg-slate-50 dark:bg-slate-800/50","border border-slate-200 dark:border-slate-700"),children:[e.jsx(St,{className:m("w-5 h-5",a.color)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100 truncate",children:t.filename}),e.jsxs("p",{className:"text-xs text-slate-500",children:[nl(t.size)," "," ",e.jsx("span",{className:"capitalize",children:a.name})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{content:"Document is being analyzed to extract context",children:e.jsxs("div",{className:"flex items-center gap-1",children:[r[t.status],e.jsx("span",{className:"text-xs text-slate-500",children:n[t.status]})]})}),t.status==="parsed"&&e.jsx(C,{content:"Preview extracted data",children:e.jsx("button",{className:"p-1 hover:bg-slate-200 dark:hover:bg-slate-700 rounded",children:e.jsx(nt,{className:"w-4 h-4 text-slate-500"})})}),e.jsx(C,{content:"Remove document",children:e.jsx("button",{onClick:s,className:"p-1 hover:bg-red-100 dark:hover:bg-red-900/30 rounded text-slate-400 hover:text-red-500",children:e.jsx(Fe,{className:"w-4 h-4"})})})]})]})}function ct({icon:t,label:s,count:a,tooltip:r}){return e.jsx(C,{content:r,children:e.jsx(T,{className:"text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"text-forensic-500",children:t}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:a}),e.jsx("p",{className:"text-xs text-slate-500",children:s})]})]})})})}function Lt({icon:t,title:s,subtitle:a,status:r,details:n}){var p,f;const[i,o]=v.useState(!1),l={detected:"border-green-400 dark:border-green-600",synced:"border-blue-400 dark:border-blue-600",error:"border-red-400 dark:border-red-600",not_found:"border-slate-300 dark:border-slate-600"},c={detected:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",synced:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",error:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",not_found:"bg-slate-100 text-slate-600 dark:bg-slate-800 dark:text-slate-400"},d={detected:"Detected",synced:"Synced",error:"Error",not_found:"Not Found"};return e.jsx(T,{className:m("relative border-2 transition-all duration-300 cursor-pointer","hover:shadow-lg hover:-translate-y-0.5","bg-gradient-to-br from-white to-slate-50 dark:from-slate-800 dark:to-slate-800/50",l[r]),children:e.jsxs("div",{onClick:()=>o(!i),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:m("p-2 rounded-lg",r==="detected"?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":r==="synced"?"bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":"bg-slate-100 text-slate-500 dark:bg-slate-700 dark:text-slate-400"),children:t}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100 text-sm",children:s}),e.jsx("p",{className:"text-xs text-slate-500",children:a})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:m("px-2 py-0.5 rounded-full text-xs font-medium",c[r]),children:d[r]}),i?e.jsx(pe,{className:"w-4 h-4 text-slate-400"}):e.jsx(oe,{className:"w-4 h-4 text-slate-400"})]})]}),!i&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[e.jsx(Oa,{className:"w-3 h-3"}),e.jsx("span",{children:(p=n[0])==null?void 0:p.value}),e.jsx("span",{className:"text-slate-300 dark:text-slate-600",children:"|"}),e.jsx("span",{children:(f=n[1])==null?void 0:f.value})]}),i&&e.jsx("div",{className:"mt-3 pt-3 border-t border-slate-200 dark:border-slate-700 space-y-2",children:n.map((g,D)=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-slate-500",children:g.label}),e.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:g.value})]},D))})]})})}function xl(){var $;const t=be(),{goToNextStep:s,goToPreviousStep:a,updateIncidentDescription:r,currentSession:n}=me(),[i,o]=v.useState((($=n==null?void 0:n.incidentDescription)==null?void 0:$.naturalLanguage)||""),[l,c]=v.useState(""),[d,p]=v.useState(""),[f,g]=v.useState([]),[D,w]=v.useState("hash"),[b,N]=v.useState(""),P=()=>{a(),t("/context")},u=()=>{r({naturalLanguage:i,startDate:l?new Date(l):new Date,patientZero:{hostname:d,type:"workstation"},iocs:f.map((E,x)=>({id:`ioc-${x}`,type:E.type,value:E.value,confidence:"medium"}))}),s(),t("/connectors")},k=()=>{b.trim()&&(g([...f,{type:D,value:b}]),N(""))},S=E=>{g(f.filter((x,W)=>W!==E))},O=["Ransomware detected","Unauthorized access","Data exfiltration suspected","Malicious email received","System compromise"];return e.jsx(ke,{title:"Incident Description",subtitle:"Describe the security incident in detail",footer:e.jsx(Ae,{onBack:P,backLabel:"Context",onContinue:u,continueLabel:"Continue"}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(T,{children:[e.jsx(Z,{title:"Describe the Incident",description:"Provide a detailed description of what happened"}),e.jsxs("div",{className:"mt-4",children:[e.jsx(Bs,{value:i,onChange:E=>o(E.target.value),placeholder:"Our finance department reported that multiple file servers became inaccessible around 2:30 AM on Tuesday. Users discovered ransom notes demanding Bitcoin payment...",minRows:5,tooltip:"Describe the incident in your own words. Include what happened, when it was discovered, and any initial observations."}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:O.map(E=>e.jsx(C,{content:"Click to add this common phrase",children:e.jsx("button",{onClick:()=>o(x=>x?`${x} ${E}.`:E),className:m("px-3 py-1 text-sm rounded-full","bg-slate-100 dark:bg-slate-700","text-slate-600 dark:text-slate-300","hover:bg-forensic-100 dark:hover:bg-forensic-900/30","hover:text-forensic-700 dark:hover:text-forensic-300","transition-colors duration-200"),children:E})},E))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(T,{children:[e.jsx(Z,{title:"Incident Start Date",description:"When was the incident first discovered?"}),e.jsx("div",{className:"mt-4",children:e.jsx(Qe,{type:"datetime-local",value:l,onChange:E=>c(E.target.value),leftAddon:e.jsx(Is,{className:"w-4 h-4"}),tooltip:"When did the first indicator of the incident appear?"})})]}),e.jsxs(T,{children:[e.jsx(Z,{title:"Patient Zero",description:"First affected system identified"}),e.jsx("div",{className:"mt-4",children:e.jsx(Qe,{value:d,onChange:E=>p(E.target.value),placeholder:"e.g., ACCT-WS-042 or 10.20.30.42",leftAddon:e.jsx(Ms,{className:"w-4 h-4"}),tooltip:"Enter the hostname or IP of the first affected system"})})]})]}),e.jsxs(T,{children:[e.jsx(Z,{title:"Indicators of Compromise (IOCs)",description:"Add known IOCs associated with this incident"}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{content:"Type of Indicator of Compromise",children:e.jsxs("select",{value:D,onChange:E=>w(E.target.value),className:"input w-32",children:[e.jsx("option",{value:"hash",children:"Hash"}),e.jsx("option",{value:"ip",children:"IP Address"}),e.jsx("option",{value:"domain",children:"Domain"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"url",children:"URL"}),e.jsx("option",{value:"file_path",children:"File Path"})]})}),e.jsx(Qe,{value:b,onChange:E=>N(E.target.value),placeholder:"Enter IOC value...",className:"flex-1",tooltip:"Enter the IOC value"}),e.jsx(C,{content:"Add another Indicator of Compromise to the list",children:e.jsx(I,{onClick:k,leftIcon:e.jsx(La,{className:"w-4 h-4"}),children:"Add"})})]}),f.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:f.map((E,x)=>e.jsxs(ce,{variant:"secondary",children:[e.jsxs("span",{className:"font-medium capitalize",children:[E.type,":"]})," ",e.jsx("span",{className:"font-mono text-xs",children:E.value}),e.jsx("button",{onClick:()=>S(x),className:"ml-1 hover:text-red-500",children:e.jsx(Fe,{className:"w-3 h-3"})})]},x))})]})]})]})})}const ul={servers:[{id:"d1",name:"DC-MAIN-01",type:"Domain Controller",ip:"10.0.1.10",os:"Windows Server 2022",status:"online",ports:[53,88,389,445,636],services:["DNS","Kerberos","LDAP","SMB"],risk:"critical"},{id:"d2",name:"DC-BACKUP-01",type:"Domain Controller",ip:"10.0.1.11",os:"Windows Server 2022",status:"online",ports:[53,88,389,445],services:["DNS","Kerberos","LDAP","SMB"],risk:"critical"},{id:"d3",name:"FS-FINANCE-01",type:"File Server",ip:"10.0.2.20",os:"Windows Server 2019",status:"online",ports:[445,3389],services:["SMB","RDP"],risk:"high"},{id:"d4",name:"SQL-DB-01",type:"Database Server",ip:"10.0.3.30",os:"Windows Server 2019",status:"online",ports:[1433,3389],services:["MSSQL","RDP"],risk:"high"},{id:"d5",name:"WEB-APP-01",type:"Web Server",ip:"10.0.4.40",os:"Ubuntu 22.04",status:"online",ports:[80,443,22],services:["HTTP","HTTPS","SSH"],risk:"medium"},{id:"d6",name:"EXCH-01",type:"Exchange Server",ip:"10.0.1.15",os:"Windows Server 2019",status:"online",ports:[25,443,587],services:["SMTP","HTTPS","Submission"],risk:"high"}],endpoints:[{id:"e1",name:"WS-FIN-042",type:"Workstation",ip:"10.0.10.42",os:"Windows 11 Pro",status:"online",ports:[135,445],services:["RPC","SMB"],risk:"high"},{id:"e2",name:"WS-HR-015",type:"Workstation",ip:"10.0.10.15",os:"Windows 11 Pro",status:"online",ports:[135,445],services:["RPC","SMB"],risk:"medium"},{id:"e3",name:"WS-IT-001",type:"Workstation",ip:"10.0.10.1",os:"Windows 11 Pro",status:"online",ports:[135,445,3389],services:["RPC","SMB","RDP"],risk:"medium"},{id:"e4",name:"LPT-EXEC-003",type:"Laptop",ip:"10.0.11.3",os:"macOS Sonoma",status:"offline",ports:[],services:[],risk:"low"}],peripherals:[{id:"p1",name:"FW-EDGE-01",type:"Firewall",ip:"10.0.0.1",status:"online",ports:[443,8443],services:["HTTPS Mgmt","VPN"],risk:"critical"},{id:"p2",name:"SW-CORE-01",type:"Core Switch",ip:"10.0.0.2",status:"online",ports:[22,443],services:["SSH","HTTPS"],risk:"high"},{id:"p3",name:"WAF-01",type:"Web App Firewall",ip:"10.0.0.5",status:"online",ports:[443,8443],services:["HTTPS","Mgmt"],risk:"high"},{id:"p4",name:"IDS-01",type:"IDS/IPS",ip:"10.0.0.6",status:"online",ports:[443],services:["HTTPS Mgmt"],risk:"medium"}],cloud:[{id:"c1",name:"AWS Account (Prod)",type:"AWS",ip:"aws:123456789012",status:"online",ports:[],services:["EC2","S3","RDS","Lambda","CloudTrail"],risk:"high"},{id:"c2",name:"Azure Tenant",type:"Azure",ip:"azure:tenant-abc-123",status:"online",ports:[],services:["Azure AD","VMs","Storage","Key Vault"],risk:"critical"},{id:"c3",name:"O365 Tenant",type:"Office 365",ip:"o365:tenant-abc-123",status:"online",ports:[],services:["Exchange Online","SharePoint","Teams","OneDrive"],risk:"high"}],internet:[{id:"i1",name:"mail.company.com",type:"SMTP Gateway",ip:"203.0.113.10",status:"online",ports:[25,443,587],services:["SMTP","HTTPS","Submission"],risk:"high"},{id:"i2",name:"vpn.company.com",type:"VPN Gateway",ip:"203.0.113.11",status:"online",ports:[443,1194],services:["HTTPS","OpenVPN"],risk:"critical"},{id:"i3",name:"app.company.com",type:"Web Application",ip:"203.0.113.20",status:"online",ports:[80,443],services:["HTTP","HTTPS"],risk:"high"},{id:"i4",name:"api.company.com",type:"REST API",ip:"203.0.113.21",status:"online",ports:[443],services:["HTTPS"],risk:"medium"},{id:"i5",name:"ftp.company.com",type:"FTP Server",ip:"203.0.113.30",status:"filtered",ports:[21,990],services:["FTP","FTPS"],risk:"high"}]};function hl(){const t=be(),{goToNextStep:s,goToPreviousStep:a}=me(),[r,n]=v.useState("endpoints"),[i,o]=v.useState(new Set),[l,c]=v.useState(!1),[d,p]=v.useState(null),[f,g]=v.useState("credentials"),[D,w]=v.useState(!1),[b,N]=v.useState("windows"),[P,u]=v.useState(!1),[k,S]=v.useState([]),[O,$]=v.useState(!1),[E,x]=v.useState(!1),[W,se]=v.useState({}),[Q,F]=v.useState(""),[h,M]=v.useState(null),[y,B]=v.useState("servers"),[Y,J]=v.useState(!1),[_,q]=v.useState([]),[H,R]=v.useState(""),[L,ee]=v.useState(""),[U,Se]=v.useState(null),Te=()=>{a(),t("/incident")},ae=()=>{s(),t("/validation")},aa=j=>{p(j),c(!0)},ra=()=>{d&&o(new Set([...i,d])),c(!1),p(null)},na=j=>{if(Q.trim()){const te=W[j]||[];te.includes(Q.trim())||se({...W,[j]:[...te,Q.trim()]}),F("")}},ia=(j,te)=>{const It=W[j]||[];se({...W,[j]:It.filter(_e=>_e!==te)})},la=()=>{J(!0),q([]),setTimeout(()=>{q(ul[y]||[]),J(!1)},3e3)},oa=j=>({windows:e.jsx(Me,{className:"w-6 h-6"}),linux:e.jsx(Mt,{className:"w-6 h-6"}),macos:e.jsx(Va,{className:"w-6 h-6"}),aws:e.jsx(K,{className:"w-6 h-6"}),azure:e.jsx(K,{className:"w-6 h-6"}),gcp:e.jsx(K,{className:"w-6 h-6"}),o365:e.jsx(ge,{className:"w-6 h-6"}),gsuite:e.jsx(ge,{className:"w-6 h-6"}),firewall:e.jsx(fe,{className:"w-6 h-6"}),storage:e.jsx(we,{className:"w-6 h-6"}),email_gateway:e.jsx(Ba,{className:"w-6 h-6"}),proxy_waf:e.jsx(le,{className:"w-6 h-6"})})[j],Pt=hs.find(j=>j.id===r);return e.jsxs(ke,{title:"Connector Configuration",subtitle:"Configure data sources for forensic analysis",footer:e.jsx(Ae,{onBack:Te,backLabel:"Incident",onContinue:ae,continueLabel:"Continue",middleContent:e.jsxs("span",{className:"text-sm text-slate-500",children:[i.size," connector",i.size!==1?"s":""," configured"]})}),children:[e.jsxs("div",{className:"flex gap-2 mb-6 border-b border-slate-200 dark:border-slate-700 overflow-x-auto",children:[hs.map(j=>e.jsx(C,{content:j.description,children:e.jsx("button",{onClick:()=>n(j.id),className:m("px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors whitespace-nowrap",r===j.id?"border-forensic-500 text-forensic-600 dark:text-forensic-400":"border-transparent text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"),children:j.name})},j.id)),e.jsx(C,{content:"Agentless collection via portable tools or disk images",children:e.jsx("button",{onClick:()=>n("collector"),className:m("px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors whitespace-nowrap",r==="collector"?"border-forensic-500 text-forensic-600 dark:text-forensic-400":"border-transparent text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"),children:"Agentless / Offline"})}),e.jsx(C,{content:"Auto-discover servers, endpoints, peripherals, cloud, and internet-facing assets",children:e.jsxs("button",{onClick:()=>n("discovery"),className:m("px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors whitespace-nowrap flex items-center gap-1.5",r==="discovery"?"border-forensic-500 text-forensic-600 dark:text-forensic-400":"border-transparent text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"),children:[e.jsx(gt,{className:"w-3.5 h-3.5"}),"Auto-Discovery"]})})]}),r!=="collector"&&r!=="discovery"&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:Pt==null?void 0:Pt.connectors.map(j=>{const te=ps[j],It=i.has(j);return e.jsx(pl,{type:j,name:te.name,description:te.description,icon:oa(j),isConfigured:It,onConfigure:()=>aa(j),tags:W[j]||[],isEditingTags:h===j,onToggleEditTags:()=>M(h===j?null:j),tagInput:h===j?Q:"",onTagInputChange:_e=>F(_e),onAddTag:()=>na(j),onRemoveTag:_e=>ia(j,_e)},j)})}),r==="collector"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(T,{className:"border-2 border-dashed border-slate-300 dark:border-slate-600 hover:border-forensic-400 dark:hover:border-forensic-500 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-forensic-100 dark:bg-forensic-900/30 rounded-lg",children:e.jsx(rs,{className:"w-8 h-8 text-forensic-600 dark:text-forensic-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Craft Portable Collector"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1 mb-3",children:"Build a lightweight executable that collects forensic artifacts without installing an agent. Run on any Windows or Linux system via USB or network share."}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsx("span",{className:"px-2 py-0.5 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 text-xs rounded-full",children:"No Installation"}),e.jsx("span",{className:"px-2 py-0.5 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 text-xs rounded-full",children:"USB Portable"}),e.jsx("span",{className:"px-2 py-0.5 bg-purple-50 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400 text-xs rounded-full",children:"Customizable"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(C,{content:"Configure and build a portable forensic collector",children:e.jsx(I,{size:"sm",onClick:()=>w(!0),leftIcon:e.jsx(ft,{className:"w-4 h-4"}),children:"Configure & Build"})})})]})]})}),e.jsx(T,{className:"border-2 border-dashed border-slate-300 dark:border-slate-600 hover:border-forensic-400 dark:hover:border-forensic-500 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-900/30 rounded-lg",children:e.jsx(re,{className:"w-8 h-8 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Upload Disk Image"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1 mb-3",children:"Upload VM disk images or forensic images for triage without connecting to live systems. Supports VMDK, VHD, VHDX, E01, RAW, and more."}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsx("span",{className:"px-2 py-0.5 bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 text-xs rounded-full",children:"VMDK"}),e.jsx("span",{className:"px-2 py-0.5 bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 text-xs rounded-full",children:"VHD/VHDX"}),e.jsx("span",{className:"px-2 py-0.5 bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 text-xs rounded-full",children:"E01"}),e.jsx("span",{className:"px-2 py-0.5 bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 text-xs rounded-full",children:"RAW/DD"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(C,{content:"Upload a forensic disk image for offline analysis",children:e.jsx(I,{size:"sm",onClick:()=>u(!0),leftIcon:e.jsx(Oe,{className:"w-4 h-4"}),children:"Upload Image"})})})]})]})})]}),k.length>0&&e.jsxs(T,{children:[e.jsxs("h4",{className:"font-medium text-slate-900 dark:text-slate-100 mb-3",children:["Uploaded Images (",k.length,")"]}),e.jsx("div",{className:"space-y-2",children:k.map((j,te)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsx(we,{className:"w-5 h-5 text-slate-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:j}),e.jsx("p",{className:"text-xs text-slate-500",children:"VMDK  42.5 GB  Uploaded just now"})]}),e.jsx(X,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-xs text-green-600 dark:text-green-400",children:"Ready for triage"})]},te))})]})]}),r==="discovery"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(T,{className:"bg-gradient-to-br from-forensic-50 to-white dark:from-forensic-900/20 dark:to-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-forensic-100 dark:bg-forensic-900/30 rounded-lg",children:e.jsx(gt,{className:"w-6 h-6 text-forensic-600 dark:text-forensic-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:"Auto-Discovery"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Discover assets automatically based on domain, IP ranges, and credentials"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Domain / Tenant"}),e.jsx("input",{type:"text",className:"input",placeholder:"e.g., company.com or Azure Tenant ID",value:H,onChange:j=>R(j.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"IP Range / CIDR"}),e.jsx("input",{type:"text",className:"input",placeholder:"e.g., 10.0.0.0/16 or 192.168.1.0/24",value:L,onChange:j=>ee(j.target.value)})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"label mb-2 block",children:"Discovery Scope"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-2",children:[{id:"servers",label:"Servers",icon:e.jsx(re,{className:"w-4 h-4"}),desc:"DCs, File Servers, DBs"},{id:"endpoints",label:"Endpoints",icon:e.jsx(Me,{className:"w-4 h-4"}),desc:"Workstations, Laptops"},{id:"peripherals",label:"Peripherals",icon:e.jsx(fe,{className:"w-4 h-4"}),desc:"Firewalls, Switches, IDS"},{id:"cloud",label:"Cloud Services",icon:e.jsx(K,{className:"w-4 h-4"}),desc:"AWS, Azure, O365, GCP"},{id:"internet",label:"Internet-Facing",icon:e.jsx(le,{className:"w-4 h-4"}),desc:"Public IPs & Services"}].map(j=>e.jsxs("button",{onClick:()=>B(j.id),className:m("flex flex-col items-center gap-1.5 p-3 rounded-lg border text-xs font-medium transition-colors",y===j.id?"border-forensic-500 bg-forensic-50 text-forensic-700 dark:bg-forensic-900/20 dark:text-forensic-300":"border-slate-200 dark:border-slate-700 text-slate-500 hover:border-slate-300"),children:[j.icon,j.label,e.jsx("span",{className:"text-[10px] text-slate-400 font-normal",children:j.desc})]},j.id))})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Username / Access Key"}),e.jsx("input",{type:"text",className:"input",placeholder:"Discovery account credentials"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Password / Secret Key"}),e.jsx("input",{type:"password",className:"input",placeholder:"Authentication secret"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(C,{content:`Run discovery scan for ${y}`,children:e.jsx(I,{onClick:la,isLoading:Y,leftIcon:e.jsx(Wa,{className:"w-4 h-4"}),className:"w-full",children:Y?"Scanning...":"Run Discovery"})})})]})]}),Y&&e.jsx(T,{className:"border-forensic-200 dark:border-forensic-800",children:e.jsxs("div",{className:"flex items-center gap-3 p-2",children:[e.jsx(jt,{className:"w-5 h-5 animate-spin text-forensic-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:["Scanning network for ",y,"..."]}),e.jsxs("div",{className:"flex gap-4 mt-1 text-xs text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(vt,{className:"w-3 h-3"})," Sending probes"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Vt,{className:"w-3 h-3"})," Resolving hostnames"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(nt,{className:"w-3 h-3"})," Fingerprinting services"]})]})]})]})}),_.length>0&&e.jsxs(T,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5 text-forensic-500"}),e.jsxs("h3",{className:"font-semibold text-slate-900 dark:text-slate-100",children:["Discovery Results  ",_.length," assets found"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{size:"sm",variant:"outline",leftIcon:e.jsx(Ze,{className:"w-3 h-3"}),children:"Export"}),e.jsx(I,{size:"sm",leftIcon:e.jsx(ft,{className:"w-3 h-3"}),children:"Configure All"})]})]}),e.jsx("div",{className:"space-y-2",children:_.map(j=>e.jsxs("div",{className:m("border rounded-lg transition-all",j.risk==="critical"?"border-red-200 dark:border-red-900/50":j.risk==="high"?"border-orange-200 dark:border-orange-900/50":"border-slate-200 dark:border-slate-700"),children:[e.jsxs("button",{onClick:()=>Se(U===j.id?null:j.id),className:"w-full flex items-center gap-3 p-3 text-left",children:[e.jsx("div",{className:m("w-2 h-2 rounded-full",j.status==="online"?"bg-green-500":j.status==="filtered"?"bg-yellow-500":"bg-slate-300")}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-sm text-slate-900 dark:text-slate-100",children:j.name}),e.jsx("span",{className:"text-xs text-slate-400",children:j.type})]}),e.jsx("span",{className:"text-xs font-mono text-slate-500",children:j.ip})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:m("px-2 py-0.5 rounded text-xs font-medium",j.risk==="critical"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":j.risk==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":j.risk==="medium"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"),children:j.risk}),e.jsx("span",{className:m("px-2 py-0.5 rounded text-xs",j.status==="online"?"bg-green-50 text-green-600 dark:bg-green-900/20 dark:text-green-400":j.status==="filtered"?"bg-yellow-50 text-yellow-600":"bg-slate-100 text-slate-400"),children:j.status}),U===j.id?e.jsx(pe,{className:"w-4 h-4 text-slate-400"}):e.jsx(oe,{className:"w-4 h-4 text-slate-400"})]})]}),U===j.id&&e.jsx("div",{className:"px-3 pb-3 pt-0",children:e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg space-y-2 text-xs",children:[j.os&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-slate-500 w-20",children:"OS:"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:j.os})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-slate-500 w-20",children:"Open Ports:"}),e.jsx("span",{className:"font-mono text-slate-700 dark:text-slate-300",children:j.ports.length>0?j.ports.join(", "):"N/A (Cloud)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-slate-500 w-20",children:"Services:"}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:j.services.join(", ")})]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(I,{size:"sm",variant:"outline",leftIcon:e.jsx(ft,{className:"w-3 h-3"}),children:"Configure Connector"}),e.jsx(I,{size:"sm",variant:"ghost",leftIcon:e.jsx(Ht,{className:"w-3 h-3"}),children:"Add Tags"})]})]})})]},j.id))})]}),!Y&&_.length===0&&e.jsxs(T,{className:"text-center py-12",children:[e.jsx(gt,{className:"w-12 h-12 mx-auto text-slate-300 mb-3"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Configure domain, IP range, and credentials above, then run discovery"}),e.jsx("p",{className:"text-slate-400 text-xs mt-1",children:"Scans for servers, endpoints, peripherals, cloud services, and internet-facing assets"})]})]}),e.jsx(Tt,{open:l,onOpenChange:c,title:`Configure ${d?ps[d].name:""}`,description:"Enter connection details for this data source",size:"md",footer:e.jsxs(e.Fragment,{children:[e.jsx(I,{variant:"secondary",onClick:()=>c(!1),children:"Cancel"}),e.jsx(C,{content:"Verify connectivity to this system (simulated)",children:e.jsx(I,{variant:"outline",children:"Test Connection"})}),e.jsx(I,{onClick:ra,children:"Save"})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Hostname / IP"}),e.jsx("input",{type:"text",className:"input",placeholder:"e.g., 10.0.1.10 or server.domain.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label mb-2 block",children:"Authentication Method"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("button",{onClick:()=>g("credentials"),className:m("flex flex-col items-center gap-1.5 p-3 rounded-lg border text-xs font-medium transition-colors",f==="credentials"?"border-forensic-500 bg-forensic-50 text-forensic-700 dark:bg-forensic-900/20 dark:text-forensic-300":"border-slate-200 dark:border-slate-700 text-slate-500 hover:border-slate-300"),children:[e.jsx(kt,{className:"w-4 h-4"}),"Credentials"]}),e.jsxs("button",{onClick:()=>g("certificate"),className:m("flex flex-col items-center gap-1.5 p-3 rounded-lg border text-xs font-medium transition-colors",f==="certificate"?"border-forensic-500 bg-forensic-50 text-forensic-700 dark:bg-forensic-900/20 dark:text-forensic-300":"border-slate-200 dark:border-slate-700 text-slate-500 hover:border-slate-300"),children:[e.jsx(za,{className:"w-4 h-4"}),"Certificate"]}),e.jsxs("button",{onClick:()=>g("ssh_key"),className:m("flex flex-col items-center gap-1.5 p-3 rounded-lg border text-xs font-medium transition-colors",f==="ssh_key"?"border-forensic-500 bg-forensic-50 text-forensic-700 dark:bg-forensic-900/20 dark:text-forensic-300":"border-slate-200 dark:border-slate-700 text-slate-500 hover:border-slate-300"),children:[e.jsx(Mt,{className:"w-4 h-4"}),"SSH Key"]})]})]}),f==="credentials"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Username"}),e.jsx("input",{type:"text",className:"input",placeholder:"Service account username"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Password"}),e.jsx("input",{type:"password",className:"input",placeholder:"Service account password"})]})]}),f==="certificate"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Certificate File (.pem, .pfx, .p12)"}),e.jsxs("div",{className:m("border-2 border-dashed rounded-lg p-4 text-center cursor-pointer","border-slate-300 dark:border-slate-600","hover:border-forensic-400 dark:hover:border-forensic-500","transition-colors duration-200"),children:[e.jsx(Oe,{className:"w-6 h-6 mx-auto text-slate-400 mb-2"}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Drag & drop or ",e.jsx("span",{className:"text-forensic-500 font-medium",children:"browse"})," certificate file"]}),e.jsx("input",{type:"file",accept:".pem,.pfx,.p12,.cer,.crt",className:"hidden"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Certificate Password (if applicable)"}),e.jsx("input",{type:"password",className:"input",placeholder:"Private key passphrase"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"CA Bundle (optional)"}),e.jsx("input",{type:"text",className:"input",placeholder:"Path to CA bundle or paste CA cert"})]})]}),f==="ssh_key"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Username"}),e.jsx("input",{type:"text",className:"input",placeholder:"SSH username (e.g., root, forensic-svc)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"SSH Private Key"}),e.jsxs("div",{className:m("border-2 border-dashed rounded-lg p-4 text-center cursor-pointer","border-slate-300 dark:border-slate-600","hover:border-forensic-400 dark:hover:border-forensic-500","transition-colors duration-200"),children:[e.jsx(Oe,{className:"w-6 h-6 mx-auto text-slate-400 mb-2"}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Upload ",e.jsx("span",{className:"text-forensic-500 font-medium",children:"id_rsa"}),", ",e.jsx("span",{className:"text-forensic-500 font-medium",children:"id_ed25519"}),", or other key file"]}),e.jsx("input",{type:"file",accept:".pem,.key,.pub",className:"hidden"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Key Passphrase (if applicable)"}),e.jsx("input",{type:"password",className:"input",placeholder:"SSH key passphrase"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"SSH Port"}),e.jsx("input",{type:"number",className:"input",placeholder:"22",defaultValue:22})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"mockMode",className:"rounded",defaultChecked:!0}),e.jsx("label",{htmlFor:"mockMode",className:"text-sm text-slate-600 dark:text-slate-400",children:"Use simulated data for demo"})]})]})}),e.jsx(Tt,{open:D,onOpenChange:w,title:"Craft Portable Collector",description:"Build a lightweight forensic collector for offline triage",size:"md",footer:e.jsxs(e.Fragment,{children:[e.jsx(I,{variant:"secondary",onClick:()=>w(!1),children:"Cancel"}),e.jsx(C,{content:"Generate a portable collector package",children:e.jsx(I,{onClick:()=>{x(!0),setTimeout(()=>{x(!1),$(!0)},2e3)},isLoading:E,leftIcon:e.jsx(rs,{className:"w-4 h-4"}),children:"Build Collector"})})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label mb-2 block",children:"Target Platform"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>N("windows"),className:m("flex items-center gap-3 p-4 rounded-lg border transition-colors",b==="windows"?"border-forensic-500 bg-forensic-50 dark:bg-forensic-900/20":"border-slate-200 dark:border-slate-700 hover:border-slate-300"),children:[e.jsx(Me,{className:"w-6 h-6"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-sm font-medium",children:"Windows"}),e.jsx("p",{className:"text-xs text-slate-500",children:".exe portable"})]})]}),e.jsxs("button",{onClick:()=>N("linux"),className:m("flex items-center gap-3 p-4 rounded-lg border transition-colors",b==="linux"?"border-forensic-500 bg-forensic-50 dark:bg-forensic-900/20":"border-slate-200 dark:border-slate-700 hover:border-slate-300"),children:[e.jsx(Mt,{className:"w-6 h-6"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-sm font-medium",children:"Linux"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Shell script / binary"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label mb-2 block",children:"Collection Scope"}),e.jsx("div",{className:"space-y-2",children:[{id:"evtlogs",label:"Event Logs / Syslog",checked:!0},{id:"registry",label:b==="windows"?"Registry Hives":"Config Files (/etc)",checked:!0},{id:"filesystem",label:"File System Metadata (MFT / Inodes)",checked:!0},{id:"memory",label:"Memory Dump (RAM)",checked:!1},{id:"network",label:"Network Connections & ARP Table",checked:!0},{id:"processes",label:"Running Processes & Services",checked:!0},{id:"persistence",label:"Persistence Mechanisms (Startup, Cron, Tasks)",checked:!0},{id:"browser",label:"Browser Artifacts",checked:!1}].map(j=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",defaultChecked:j.checked,className:"rounded"}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:j.label})]},j.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Output Format"}),e.jsxs("select",{className:"input",defaultValue:"zip",children:[e.jsx("option",{value:"zip",children:"ZIP Archive (compressed)"}),e.jsx("option",{value:"tar",children:"TAR.GZ Archive"}),e.jsx("option",{value:"raw",children:"Raw directory structure"})]})]}),O&&e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(X,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Collector Ready"})]}),e.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 mb-2",children:[b==="windows"?"forensic-collector-win-x64.exe":"forensic-collector-linux-x64.sh"," (2.4 MB)"]}),e.jsx(I,{size:"sm",variant:"outline",leftIcon:e.jsx(Ze,{className:"w-3 h-3"}),children:"Download Collector"})]})]})}),e.jsx(Tt,{open:P,onOpenChange:u,title:"Upload Disk Image",description:"Upload a forensic disk image for offline triage analysis",size:"md",footer:e.jsxs(e.Fragment,{children:[e.jsx(I,{variant:"secondary",onClick:()=>u(!1),children:"Cancel"}),e.jsx(I,{onClick:()=>{S([...k,"server-backup-2024.vmdk"]),u(!1)},leftIcon:e.jsx(Oe,{className:"w-4 h-4"}),children:"Upload & Analyze"})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label mb-2 block",children:"Supported Formats"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{format:"VMDK",desc:"VMware disk"},{format:"VHD",desc:"Hyper-V (Gen1)"},{format:"VHDX",desc:"Hyper-V (Gen2)"},{format:"E01",desc:"EnCase image"},{format:"RAW/DD",desc:"Raw disk image"},{format:"QCOW2",desc:"QEMU disk"},{format:"OVA",desc:"Open Virtual"},{format:"ISO",desc:"Disk image"}].map(j=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-slate-50 dark:bg-slate-800/50 rounded text-xs",children:[e.jsx(we,{className:"w-3 h-3 text-slate-400"}),e.jsx("span",{className:"font-medium",children:j.format}),e.jsxs("span",{className:"text-slate-400",children:["- ",j.desc]})]},j.format))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Disk Image File"}),e.jsxs("div",{className:m("border-2 border-dashed rounded-lg p-8 text-center cursor-pointer","border-slate-300 dark:border-slate-600","hover:border-forensic-400 dark:hover:border-forensic-500","transition-colors duration-200"),children:[e.jsx(_a,{className:"w-10 h-10 mx-auto text-slate-400 mb-3"}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Drag & Drop or ",e.jsx("span",{className:"text-forensic-500 font-medium",children:"browse"})]}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"VMDK, VHD, VHDX, E01, RAW, QCOW2, OVA, ISO"}),e.jsx("input",{type:"file",accept:".vmdk,.vhd,.vhdx,.e01,.dd,.raw,.qcow2,.ova,.iso",className:"hidden"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Image Description"}),e.jsx("input",{type:"text",className:"input",placeholder:"e.g., Finance Server backup from Jan 15"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Source System Hostname (optional)"}),e.jsx("input",{type:"text",className:"input",placeholder:"e.g., FS-FINANCE-01"})]}),k.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"label",children:"Uploaded Images"}),k.map((j,te)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 dark:bg-green-900/20 rounded text-sm",children:[e.jsx(X,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-green-700 dark:text-green-300",children:j})]},te))]})]})})]})}function pl({name:t,description:s,icon:a,isConfigured:r,onConfigure:n,tags:i,isEditingTags:o,onToggleEditTags:l,tagInput:c,onTagInputChange:d,onAddTag:p,onRemoveTag:f}){return e.jsxs(T,{className:m(r&&"ring-2 ring-green-500 ring-offset-2 dark:ring-offset-slate-900"),children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:m("text-slate-400",r&&"text-green-500"),children:a}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100",children:t}),r&&e.jsx(X,{className:"w-4 h-4 text-green-500"})]}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:s}),i.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:i.map(g=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-forensic-50 dark:bg-forensic-900/20 text-forensic-600 dark:text-forensic-400 text-xs rounded-full border border-forensic-200 dark:border-forensic-800",children:[e.jsx(Ht,{className:"w-2.5 h-2.5"}),g,e.jsx("button",{onClick:D=>{D.stopPropagation(),f(g)},className:"hover:text-red-500 transition-colors ml-0.5",children:e.jsx(Fe,{className:"w-2.5 h-2.5"})})]},g))}),o&&e.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[e.jsx("input",{type:"text",value:c,onChange:g=>d(g.target.value),onKeyDown:g=>{g.key==="Enter"&&(g.preventDefault(),p())},placeholder:"Add tag...",className:"flex-1 text-xs px-2 py-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 focus:outline-none focus:border-forensic-400"}),e.jsx(I,{size:"sm",variant:"ghost",onClick:p,children:e.jsx(X,{className:"w-3 h-3"})})]})]})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[e.jsx(C,{content:"Open configuration form for this data source",children:e.jsx(I,{size:"sm",variant:r?"secondary":"primary",onClick:n,leftIcon:e.jsx(ft,{className:"w-4 h-4"}),children:r?"Reconfigure":"Configure"})}),e.jsx(C,{content:"Add tags to categorize this resource",children:e.jsx(I,{size:"sm",variant:"ghost",onClick:l,leftIcon:e.jsx(Ht,{className:"w-3.5 h-3.5"}),children:"Tags"})}),e.jsx(C,{content:"Use simulated data instead of real connection",children:e.jsxs("label",{className:"flex items-center gap-1 text-xs text-slate-500 cursor-pointer ml-auto",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded w-3 h-3"}),"Mock"]})})]})]})}const dt=[{id:"sys-1",hostname:"DC-MAIN-01",ip:"10.0.1.10",role:"Primary Domain Controller",os:"Windows Server 2022",criticality:"critical",status:"verified",services:["DNS","Kerberos","LDAP","GPO"],lastSeen:"2 min ago",cpu:12,memory:68,disk:45},{id:"sys-2",hostname:"DC-BACKUP-01",ip:"10.0.1.11",role:"Backup Domain Controller",os:"Windows Server 2022",criticality:"critical",status:"verified",services:["DNS","Kerberos","LDAP"],lastSeen:"2 min ago",cpu:8,memory:52,disk:38},{id:"sys-3",hostname:"FS-FINANCE-01",ip:"10.0.2.20",role:"Finance File Server",os:"Windows Server 2019",criticality:"high",status:"verified",services:["SMB","DFS"],lastSeen:"2 min ago",cpu:25,memory:71,disk:82},{id:"sys-4",hostname:"SQL-DB-01",ip:"10.0.3.30",role:"Primary Database Server",os:"Windows Server 2019",criticality:"high",status:"verified",services:["MSSQL","SQL Agent"],lastSeen:"2 min ago",cpu:45,memory:85,disk:67},{id:"sys-5",hostname:"WEB-APP-01",ip:"10.0.4.40",role:"Web Application Server",os:"Ubuntu 22.04 LTS",criticality:"medium",status:"verified",services:["Apache","Node.js","Redis"],lastSeen:"2 min ago",cpu:18,memory:45,disk:34},{id:"sys-6",hostname:"EXCH-01",ip:"10.0.1.15",role:"Exchange Server",os:"Windows Server 2019",criticality:"high",status:"failed",services:["SMTP","IMAP","OWA"],lastSeen:"15 min ago",cpu:0,memory:0,disk:72},{id:"sys-7",hostname:"BKP-SERVER-01",ip:"10.0.5.50",role:"Backup Server",os:"Windows Server 2022",criticality:"high",status:"verified",services:["Veeam B&R","SMB"],lastSeen:"2 min ago",cpu:5,memory:32,disk:89},{id:"sys-8",hostname:"PRINT-SRV-01",ip:"10.0.1.25",role:"Print Server",os:"Windows Server 2016",criticality:"low",status:"verified",services:["Spooler"],lastSeen:"5 min ago",cpu:2,memory:18,disk:12}],mt=[{id:"net-1",name:"Corporate LAN",cidr:"10.0.0.0/16",vlan:"10",description:"Main corporate network segment",devices:342,gateway:"10.0.0.1",dhcp:!0},{id:"net-2",name:"Server VLAN",cidr:"10.0.1.0/24",vlan:"20",description:"Server and infrastructure VLAN",devices:28,gateway:"10.0.1.1",dhcp:!1},{id:"net-3",name:"Finance VLAN",cidr:"10.0.2.0/24",vlan:"30",description:"Isolated finance department network",devices:45,gateway:"10.0.2.1",dhcp:!0},{id:"net-4",name:"DMZ",cidr:"10.0.4.0/24",vlan:"40",description:"De-militarized zone for public-facing services",devices:8,gateway:"10.0.4.1",dhcp:!1},{id:"net-5",name:"Guest WiFi",cidr:"192.168.100.0/24",vlan:"99",description:"Isolated guest wireless network",devices:12,gateway:"192.168.100.1",dhcp:!0}],xt=[{id:"cld-1",name:"AWS Production",type:"AWS",region:"us-east-1",services:["EC2 (12)","S3 (8 buckets)","RDS (3)","Lambda (15)","CloudTrail"],status:"active",risk:"high"},{id:"cld-2",name:"Azure AD Tenant",type:"Azure",region:"Global",services:["Azure AD (1,250 users)","Conditional Access","MFA","PIM"],status:"active",risk:"critical"},{id:"cld-3",name:"Office 365",type:"O365",region:"Global",services:["Exchange Online","SharePoint","Teams","OneDrive"],status:"active",risk:"high"},{id:"cld-4",name:"GCP Analytics",type:"GCP",region:"us-central1",services:["BigQuery","Cloud Functions (4)","Storage (2 buckets)"],status:"active",risk:"medium"}],Wt=[{id:"ds-1",name:"Finance Share",path:"\\\\FS-FINANCE-01\\Finance",type:"SMB File Share",size:"2.3 TB",classification:"Confidential",encryption:"No",backup:"Daily"},{id:"ds-2",name:"SQL-DB-01\\Production",path:"MSSQL Instance",type:"SQL Database",size:"450 GB",classification:"Highly Confidential",encryption:"TDE Enabled",backup:"Hourly"},{id:"ds-3",name:"SharePoint Docs",path:"SharePoint Online",type:"Cloud Storage",size:"850 GB",classification:"Internal",encryption:"At Rest",backup:"Continuous"},{id:"ds-4",name:"Backup Repository",path:"\\\\BKP-SERVER-01\\Backups",type:"Backup Storage",size:"8.5 TB",classification:"Critical",encryption:"AES-256",backup:"Immutable"},{id:"ds-5",name:"AWS S3 - Reports",path:"s3://company-reports",type:"Object Storage",size:"120 GB",classification:"Internal",encryption:"SSE-S3",backup:"Versioned"}],ut=[{name:"John Smith",role:"IT Director",dept:"IT",access:"Domain Admin",risk:"high",lastLogon:"2024-01-15 02:15",mfa:!0},{name:"Sarah Johnson",role:"CISO",dept:"Security",access:"Security Admin",risk:"high",lastLogon:"2024-01-14 18:30",mfa:!0},{name:"Mike Chen",role:"Sr. Network Engineer",dept:"IT",access:"Network Admin",risk:"medium",lastLogon:"2024-01-15 01:45",mfa:!0},{name:"Lisa Williams",role:"Finance Manager",dept:"Finance",access:"Finance Share (RW)",risk:"medium",lastLogon:"2024-01-14 17:00",mfa:!0},{name:"svc-backup",role:"Service Account",dept:"System",access:"Backup Operator",risk:"high",lastLogon:"2024-01-15 02:30",mfa:!1},{name:"svc-sql",role:"Service Account",dept:"System",access:"SQL Server Agent",risk:"high",lastLogon:"2024-01-15 02:00",mfa:!1},{name:"admin.jsmith",role:"Privileged Account",dept:"IT",access:"Domain Admin",risk:"critical",lastLogon:"2024-01-15 02:28",mfa:!0},{name:"helpdesk-svc",role:"Service Account",dept:"IT",access:"Password Reset",risk:"medium",lastLogon:"2024-01-14 16:00",mfa:!1}],zt=[{id:"sc-1",name:"Endpoint Protection",vendor:"CrowdStrike Falcon",coverage:"92%",status:"active",lastUpdate:"2024-01-14",health:"good"},{id:"sc-2",name:"Firewall (Edge)",vendor:"Palo Alto PA-5220",coverage:"100%",status:"active",lastUpdate:"2024-01-13",health:"good"},{id:"sc-3",name:"SIEM",vendor:"Splunk Enterprise",coverage:"85%",status:"active",lastUpdate:"2024-01-15",health:"warning"},{id:"sc-4",name:"Email Security",vendor:"Proofpoint",coverage:"100%",status:"active",lastUpdate:"2024-01-14",health:"good"},{id:"sc-5",name:"WAF",vendor:"AWS WAF + CloudFront",coverage:"100%",status:"active",lastUpdate:"2024-01-12",health:"good"},{id:"sc-6",name:"Backup Solution",vendor:"Veeam B&R v12",coverage:"95%",status:"active",lastUpdate:"2024-01-15",health:"critical"},{id:"sc-7",name:"PAM",vendor:"CyberArk",coverage:"78%",status:"degraded",lastUpdate:"2024-01-10",health:"warning"}],_t=[{id:"comp-1",framework:"PCI-DSS",requirement:"Requirement 10 - Logging",description:"Track all access to network resources and cardholder data",applicableSystems:["DC-MAIN-01","SQL-DB-01","FS-FINANCE-01"],status:"partial"},{id:"comp-2",framework:"SOX",requirement:"Section 404 - IT Controls",description:"Internal controls over financial reporting systems",applicableSystems:["SQL-DB-01","FS-FINANCE-01","EXCH-01"],status:"compliant"},{id:"comp-3",framework:"GDPR",requirement:"Article 32 - Security",description:"Appropriate technical measures for data protection",applicableSystems:["All Systems"],status:"partial"},{id:"comp-4",framework:"NIST 800-53",requirement:"IR-4 Incident Handling",description:"Implement incident handling capability",applicableSystems:["SIEM","All Servers"],status:"compliant"}];function gl(){const t=be(),{goToNextStep:s,goToPreviousStep:a}=me(),{extractedEntities:r}=Gs(),{systems:n,autoValidateEnabled:i,discrepancies:o,isValidating:l,initializeFromSystems:c,setAutoValidate:d,validateSystem:p,validateAllSystems:f}=yn(),[g,D]=v.useState(!1),[w,b]=v.useState(null);v.useEffect(()=>{r.systems.length>0&&n.length===0&&c(r.systems)},[r.systems,n.length,c]);const N=()=>{if(g){D(!1);return}a(),t("/connectors")},P=()=>{if(!g){D(!0);return}s(),t("/triage")},u=n.filter(x=>x.overallStatus==="verified").length,k=n.filter(x=>x.overallStatus==="failed").length,S=n.filter(x=>x.overallStatus==="pending").length,O=n.filter(x=>x.overallStatus==="unknown").length,$=Math.max(r.systems.length,dt.length),E=Math.max(r.networks.length,mt.length);return e.jsxs(ke,{title:"Infrastructure Validation",subtitle:"Verify documented systems exist and match reality",actions:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{content:"Automatically validate all documented systems when page loads",children:e.jsxs("button",{onClick:()=>d(!i),className:m("flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors",i?"bg-forensic-100 text-forensic-700 dark:bg-forensic-900/30 dark:text-forensic-300":"bg-slate-100 text-slate-600 dark:bg-slate-800 dark:text-slate-400"),children:[i?e.jsx(Ua,{className:"w-5 h-5"}):e.jsx(Ga,{className:"w-5 h-5"}),"Auto-Validate"]})}),e.jsx(C,{content:"Run validation checks on all documented systems",children:e.jsx(I,{variant:"primary",size:"sm",onClick:f,isLoading:l,leftIcon:e.jsx(As,{className:"w-4 h-4"}),children:"Validate All"})}),e.jsx(C,{content:"Export validation results as CSV",children:e.jsx(I,{variant:"secondary",size:"sm",leftIcon:e.jsx(Ze,{className:"w-4 h-4"}),children:"Export"})})]}),footer:e.jsx(Ae,{onBack:N,backLabel:g?"Back to Validation":"Connectors",onContinue:P,continueLabel:g?"Proceed to Triage":"View Summary"}),children:[g&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(T,{className:"bg-gradient-to-br from-forensic-50 to-white dark:from-forensic-900/20 dark:to-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-forensic-100 dark:bg-forensic-900/30 rounded-lg",children:e.jsx(Ut,{className:"w-6 h-6 text-forensic-600 dark:text-forensic-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:"Infrastructure Summary"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Complete overview of discovered resources before triage begins"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-8 gap-3",children:[e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(re,{className:"w-5 h-5 mx-auto text-blue-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:$}),e.jsx("p",{className:"text-xs text-slate-500",children:"Systems"})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(he,{className:"w-5 h-5 mx-auto text-green-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:E}),e.jsx("p",{className:"text-xs text-slate-500",children:"Networks"})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(K,{className:"w-5 h-5 mx-auto text-cyan-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:xt.length}),e.jsx("p",{className:"text-xs text-slate-500",children:"Cloud"})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(Je,{className:"w-5 h-5 mx-auto text-purple-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"1,250"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Users"})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(We,{className:"w-5 h-5 mx-auto text-orange-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:Wt.length}),e.jsx("p",{className:"text-xs text-slate-500",children:"Data Stores"})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(fe,{className:"w-5 h-5 mx-auto text-indigo-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:zt.length}),e.jsx("p",{className:"text-xs text-slate-500",children:"Security"})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(Ha,{className:"w-5 h-5 mx-auto text-amber-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:ut.length}),e.jsx("p",{className:"text-xs text-slate-500",children:"Accounts"})]}),e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-center",children:[e.jsx(ie,{className:"w-5 h-5 mx-auto text-red-500 mb-1"}),e.jsx("p",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:_t.length}),e.jsx("p",{className:"text-xs text-slate-500",children:"Compliance"})]})]})]}),e.jsx(De,{title:"Systems & Servers",icon:e.jsx(re,{className:"w-5 h-5 text-blue-500"}),count:dt.length,isExpanded:w==="systems",onToggle:()=>b(w==="systems"?null:"systems"),children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-slate-500 uppercase",children:[e.jsx("th",{className:"pb-2",children:"Hostname"}),e.jsx("th",{className:"pb-2",children:"IP"}),e.jsx("th",{className:"pb-2",children:"Role"}),e.jsx("th",{className:"pb-2",children:"OS"}),e.jsx("th",{className:"pb-2",children:"Services"}),e.jsx("th",{className:"pb-2",children:"Criticality"}),e.jsx("th",{className:"pb-2",children:"CPU"}),e.jsx("th",{className:"pb-2",children:"Memory"}),e.jsx("th",{className:"pb-2",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:dt.map(x=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30",children:[e.jsx("td",{className:"py-2 font-medium",children:x.hostname}),e.jsx("td",{className:"py-2 font-mono text-xs text-slate-500",children:x.ip}),e.jsx("td",{className:"py-2 text-slate-600 dark:text-slate-400 text-xs",children:x.role}),e.jsx("td",{className:"py-2 text-slate-500 text-xs",children:x.os}),e.jsx("td",{className:"py-2",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[x.services.slice(0,3).map(W=>e.jsx("span",{className:"px-1.5 py-0.5 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 text-[10px] rounded",children:W},W)),x.services.length>3&&e.jsxs("span",{className:"text-[10px] text-slate-400",children:["+",x.services.length-3]})]})}),e.jsx("td",{className:"py-2",children:e.jsx("span",{className:m("px-2 py-0.5 rounded-full text-xs font-medium",x.criticality==="critical"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":x.criticality==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":x.criticality==="medium"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-slate-100 text-slate-700 dark:bg-slate-700 dark:text-slate-300"),children:x.criticality})}),e.jsx("td",{className:"py-2",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-12 h-1.5 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:m("h-full rounded-full",x.cpu>80?"bg-red-500":x.cpu>50?"bg-yellow-500":"bg-green-500"),style:{width:`${x.cpu}%`}})}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:[x.cpu,"%"]})]})}),e.jsx("td",{className:"py-2",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-12 h-1.5 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:m("h-full rounded-full",x.memory>80?"bg-red-500":x.memory>60?"bg-yellow-500":"bg-green-500"),style:{width:`${x.memory}%`}})}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:[x.memory,"%"]})]})}),e.jsx("td",{className:"py-2",children:e.jsxs("span",{className:m("flex items-center gap-1 text-xs",x.status==="verified"?"text-green-600":"text-red-600"),children:[x.status==="verified"?e.jsx(X,{className:"w-3 h-3"}):e.jsx(Ke,{className:"w-3 h-3"}),x.status]})})]},x.id))})]})})}),e.jsx(De,{title:"Network Segments",icon:e.jsx(he,{className:"w-5 h-5 text-green-500"}),count:mt.length,isExpanded:w==="networks",onToggle:()=>b(w==="networks"?null:"networks"),children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-slate-500 uppercase",children:[e.jsx("th",{className:"pb-2",children:"Name"}),e.jsx("th",{className:"pb-2",children:"CIDR"}),e.jsx("th",{className:"pb-2",children:"VLAN"}),e.jsx("th",{className:"pb-2",children:"Gateway"}),e.jsx("th",{className:"pb-2",children:"Devices"}),e.jsx("th",{className:"pb-2",children:"DHCP"}),e.jsx("th",{className:"pb-2",children:"Description"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:mt.map(x=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30",children:[e.jsx("td",{className:"py-2 font-medium",children:x.name}),e.jsx("td",{className:"py-2 font-mono text-xs text-slate-500",children:x.cidr}),e.jsx("td",{className:"py-2",children:e.jsxs("span",{className:"px-1.5 py-0.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 text-xs rounded",children:["VLAN ",x.vlan]})}),e.jsx("td",{className:"py-2 font-mono text-xs text-slate-500",children:x.gateway}),e.jsx("td",{className:"py-2 text-sm font-semibold",children:x.devices}),e.jsx("td",{className:"py-2",children:x.dhcp?e.jsx(X,{className:"w-3 h-3 text-green-500"}):e.jsx(Ke,{className:"w-3 h-3 text-slate-300"})}),e.jsx("td",{className:"py-2 text-xs text-slate-400",children:x.description})]},x.id))})]})})}),e.jsx(De,{title:"Cloud Services & Tenants",icon:e.jsx(K,{className:"w-5 h-5 text-cyan-500"}),count:xt.length,isExpanded:w==="cloud",onToggle:()=>b(w==="cloud"?null:"cloud"),children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:xt.map(x=>e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4 text-cyan-500"}),e.jsx("span",{className:"font-medium text-sm",children:x.name})]}),e.jsx("span",{className:m("px-2 py-0.5 rounded text-xs font-medium",x.risk==="critical"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":x.risk==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"),children:x.risk})]}),e.jsxs("p",{className:"text-xs text-slate-500 mb-2",children:["Region: ",x.region]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:x.services.map(W=>e.jsx("span",{className:"px-1.5 py-0.5 bg-cyan-50 dark:bg-cyan-900/20 text-cyan-600 dark:text-cyan-400 text-[10px] rounded",children:W},W))})]},x.id))})}),e.jsx(De,{title:"Data Stores & Repositories",icon:e.jsx(We,{className:"w-5 h-5 text-orange-500"}),count:Wt.length,isExpanded:w==="datastores",onToggle:()=>b(w==="datastores"?null:"datastores"),children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-slate-500 uppercase",children:[e.jsx("th",{className:"pb-2",children:"Name"}),e.jsx("th",{className:"pb-2",children:"Type"}),e.jsx("th",{className:"pb-2",children:"Size"}),e.jsx("th",{className:"pb-2",children:"Classification"}),e.jsx("th",{className:"pb-2",children:"Encryption"}),e.jsx("th",{className:"pb-2",children:"Backup"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:Wt.map(x=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30",children:[e.jsx("td",{className:"py-2 font-medium text-xs",children:x.name}),e.jsx("td",{className:"py-2 text-xs text-slate-500",children:x.type}),e.jsx("td",{className:"py-2 text-xs font-semibold",children:x.size}),e.jsx("td",{className:"py-2",children:e.jsx("span",{className:m("px-2 py-0.5 rounded text-[10px] font-medium",x.classification==="Highly Confidential"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":x.classification==="Confidential"||x.classification==="Critical"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"),children:x.classification})}),e.jsx("td",{className:"py-2 text-xs",children:x.encryption==="No"?e.jsx("span",{className:"text-red-500 font-medium",children:"None"}):e.jsx("span",{className:"text-green-600",children:x.encryption})}),e.jsx("td",{className:"py-2 text-xs text-slate-500",children:x.backup})]},x.id))})]})})}),e.jsx(De,{title:"Key Personnel & Privileged Accounts",icon:e.jsx(Je,{className:"w-5 h-5 text-purple-500"}),count:ut.length,isExpanded:w==="employees",onToggle:()=>b(w==="employees"?null:"employees"),children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-slate-500 uppercase",children:[e.jsx("th",{className:"pb-2",children:"Account"}),e.jsx("th",{className:"pb-2",children:"Role"}),e.jsx("th",{className:"pb-2",children:"Dept"}),e.jsx("th",{className:"pb-2",children:"Access Level"}),e.jsx("th",{className:"pb-2",children:"Last Logon"}),e.jsx("th",{className:"pb-2",children:"MFA"}),e.jsx("th",{className:"pb-2",children:"Risk"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:ut.map((x,W)=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30",children:[e.jsx("td",{className:"py-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:m("w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-medium",x.role.includes("Service")||x.role.includes("Privileged")?"bg-orange-100 text-orange-600 dark:bg-orange-900/30":"bg-blue-100 text-blue-600 dark:bg-blue-900/30"),children:x.name.slice(0,2).toUpperCase()}),e.jsx("span",{className:"font-medium text-xs",children:x.name})]})}),e.jsx("td",{className:"py-2 text-xs text-slate-500",children:x.role}),e.jsx("td",{className:"py-2 text-xs text-slate-500",children:x.dept}),e.jsx("td",{className:"py-2 text-xs",children:x.access}),e.jsx("td",{className:"py-2 text-xs font-mono text-slate-400",children:x.lastLogon}),e.jsx("td",{className:"py-2",children:x.mfa?e.jsx(X,{className:"w-3 h-3 text-green-500"}):e.jsx(et,{className:"w-3 h-3 text-yellow-500"})}),e.jsx("td",{className:"py-2",children:e.jsx("span",{className:m("px-1.5 py-0.5 rounded text-xs font-medium",x.risk==="critical"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":x.risk==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"),children:x.risk})})]},W))})]})})}),e.jsx(De,{title:"Security Controls & Tools",icon:e.jsx(fe,{className:"w-5 h-5 text-indigo-500"}),count:zt.length,isExpanded:w==="security",onToggle:()=>b(w==="security"?null:"security"),children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-slate-500 uppercase",children:[e.jsx("th",{className:"pb-2",children:"Control"}),e.jsx("th",{className:"pb-2",children:"Vendor / Product"}),e.jsx("th",{className:"pb-2",children:"Coverage"}),e.jsx("th",{className:"pb-2",children:"Status"}),e.jsx("th",{className:"pb-2",children:"Last Update"}),e.jsx("th",{className:"pb-2",children:"Health"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:zt.map(x=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30",children:[e.jsx("td",{className:"py-2 font-medium text-xs",children:x.name}),e.jsx("td",{className:"py-2 text-xs text-slate-500",children:x.vendor}),e.jsx("td",{className:"py-2",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-16 h-1.5 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:m("h-full rounded-full",parseInt(x.coverage)>90?"bg-green-500":parseInt(x.coverage)>80?"bg-yellow-500":"bg-orange-500"),style:{width:x.coverage}})}),e.jsx("span",{className:"text-[10px] text-slate-400",children:x.coverage})]})}),e.jsx("td",{className:"py-2",children:e.jsx("span",{className:m("px-1.5 py-0.5 rounded text-[10px] font-medium",x.status==="active"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"),children:x.status})}),e.jsx("td",{className:"py-2 text-xs font-mono text-slate-400",children:x.lastUpdate}),e.jsx("td",{className:"py-2",children:e.jsxs("span",{className:m("flex items-center gap-1 text-xs",x.health==="good"?"text-green-600":x.health==="warning"?"text-yellow-600":"text-red-600"),children:[e.jsx("span",{className:m("w-2 h-2 rounded-full",x.health==="good"?"bg-green-500":x.health==="warning"?"bg-yellow-500":"bg-red-500")}),x.health]})})]},x.id))})]})})}),e.jsx(De,{title:"Compliance & Regulatory",icon:e.jsx(ie,{className:"w-5 h-5 text-red-500"}),count:_t.length,isExpanded:w==="compliance",onToggle:()=>b(w==="compliance"?null:"compliance"),children:_t.map(x=>e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"px-2 py-0.5 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 text-xs font-medium rounded",children:x.framework}),e.jsx("span",{className:"font-medium text-sm",children:x.requirement}),e.jsx("span",{className:m("ml-auto px-2 py-0.5 rounded text-xs font-medium",x.status==="compliant"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"),children:x.status})]}),e.jsx("p",{className:"text-xs text-slate-500",children:x.description}),e.jsxs("p",{className:"text-xs text-slate-400 mt-1",children:["Applies to: ",x.applicableSystems.join(", ")]})]},x.id))}),e.jsx(T,{className:"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border-green-200 dark:border-green-800",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(X,{className:"w-8 h-8 text-green-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-green-800 dark:text-green-200",children:"Ready for Triage"}),e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400",children:[dt.length," systems, ",mt.length," networks, ",xt.length," cloud services, and ",ut.length,' privileged accounts documented. All key resources have been validated. Click "Proceed to Triage" to begin forensic analysis.']})]}),e.jsx(at,{className:"w-5 h-5 text-green-500"})]})})]}),!g&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6",children:[e.jsx(ht,{icon:e.jsx(X,{className:"w-5 h-5"}),count:u,label:"Verified",color:"green"}),e.jsx(ht,{icon:e.jsx(Ke,{className:"w-5 h-5"}),count:k,label:"Failed",color:"red"}),e.jsx(ht,{icon:e.jsx(rt,{className:"w-5 h-5"}),count:S,label:"Pending",color:"yellow"}),e.jsx(ht,{icon:e.jsx(es,{className:"w-5 h-5"}),count:O,label:"Unknown",color:"slate"})]}),o.length>0&&e.jsx(T,{className:"mb-6 border-yellow-300 dark:border-yellow-700 bg-yellow-50 dark:bg-yellow-900/20",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(et,{className:"w-5 h-5 text-yellow-500 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:["Discrepancy Alerts (",o.length,")"]}),e.jsxs("ul",{className:"mt-2 space-y-1 text-sm text-yellow-700 dark:text-yellow-300",children:[o.slice(0,3).map(x=>e.jsxs("li",{children:[e.jsxs("span",{className:"font-medium",children:[x.hostname,":"]})," ",x.description]},x.id)),o.length>3&&e.jsxs("li",{className:"text-yellow-600 dark:text-yellow-400",children:["+",o.length-3," more discrepancies"]})]})]})]})}),e.jsx(T,{padding:"none",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 dark:bg-slate-800/50 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"System"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"IP"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Methods"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:n.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-4 py-12 text-center",children:[e.jsx(re,{className:"w-10 h-10 mx-auto text-slate-300 mb-3"}),e.jsx("p",{className:"text-slate-500",children:"No systems to validate"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Upload documents with system information first"})]})}):n.map(x=>e.jsx(fl,{system:x,onValidate:()=>p(x.systemId),isValidating:l},x.systemId))})]})})})]})]})}function De({title:t,icon:s,count:a,isExpanded:r,onToggle:n,children:i}){return e.jsxs(T,{children:[e.jsxs("button",{onClick:n,className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s,e.jsx("span",{className:"font-semibold text-slate-900 dark:text-slate-100",children:t}),e.jsx("span",{className:"text-xs bg-slate-100 dark:bg-slate-700 px-2 py-0.5 rounded-full text-slate-500",children:a})]}),r?e.jsx(pe,{className:"w-5 h-5 text-slate-400"}):e.jsx(oe,{className:"w-5 h-5 text-slate-400"})]}),r&&e.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200 dark:border-slate-700",children:i})]})}function ht({icon:t,count:s,label:a,color:r}){const n={green:"text-green-500 bg-green-50 dark:bg-green-900/20",red:"text-red-500 bg-red-50 dark:bg-red-900/20",yellow:"text-yellow-500 bg-yellow-50 dark:bg-yellow-900/20",slate:"text-slate-400 bg-slate-50 dark:bg-slate-800/50"};return e.jsx(T,{className:m("text-center",n[r]),children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[t,e.jsx("span",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:s}),e.jsx("span",{className:"text-xs text-slate-500",children:a})]})})}function fl({system:t,onValidate:s,isValidating:a}){const r={verified:e.jsx(X,{className:"w-4 h-4 text-green-500"}),failed:e.jsx(Ke,{className:"w-4 h-4 text-red-500"}),pending:e.jsx(rt,{className:"w-4 h-4 text-yellow-500"}),unknown:e.jsx(es,{className:"w-4 h-4 text-slate-400"})};return e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"font-medium text-slate-900 dark:text-slate-100",children:t.hostname})}),e.jsx("td",{className:"px-4 py-3 font-mono text-sm text-slate-600 dark:text-slate-400",children:t.documentedIP}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-400",children:t.role}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-1",children:[t.validationMethods.slice(0,3).map(n=>e.jsx(C,{content:an[n].description,children:e.jsx(ce,{variant:"secondary",size:"sm",children:n.toUpperCase().slice(0,3)})},n)),t.validationMethods.length>3&&e.jsxs(ce,{variant:"secondary",size:"sm",children:["+",t.validationMethods.length-3]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[r[t.overallStatus],e.jsx("span",{className:m("text-sm capitalize",t.overallStatus==="verified"&&"text-green-600",t.overallStatus==="failed"&&"text-red-600",t.overallStatus==="pending"&&"text-yellow-600",t.overallStatus==="unknown"&&"text-slate-500"),children:t.overallStatus})]})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx(C,{content:"Run validation checks on this system",children:e.jsx(I,{variant:"ghost",size:"sm",onClick:s,disabled:a,leftIcon:a&&t.overallStatus==="pending"?e.jsx(qr,{size:"sm"}):e.jsx(As,{className:"w-3 h-3"}),children:"Validate"})})})]})}const Cs=[{id:"cti-1",type:"leaked_credentials",source:"BreachDB (OSINT)",severity:"critical",title:"Compromised credentials found in 2024 data breach",description:"12 corporate email addresses with password hashes found in recent breach dump. Includes admin accounts.",date:"2024-01-10",indicators:["admin.jsmith@company.com","svc-backup@company.com","sarah.j@company.com"]},{id:"cti-2",type:"darknet_mention",source:"Darknet Forum Monitoring",severity:"high",title:"Company network access for sale on darknet forum",description:"Initial access broker offering VPN credentials and internal network maps. Listed 3 days before the incident.",date:"2024-01-12",indicators:["vpn.company.com","RDP access - Finance segment","$5,000 asking price"]},{id:"cti-3",type:"pii_exposure",source:"Public Paste Sites",severity:"high",title:"Employee PII leaked on paste site",description:"Partial employee directory with names, email addresses, phone numbers, and department info found on public paste site.",date:"2024-01-08",indicators:["~250 employee records","Names, emails, phone numbers","Department structure"]},{id:"cti-4",type:"breach_database",source:"Have I Been Pwned (OSINT)",severity:"medium",title:"Domain appears in 3 known breach databases",description:"company.com domain found across multiple breach databases with varying dates and data types exposed.",date:"2023-11-15",indicators:["LinkedIn breach (2023)","Third-party SaaS breach (2024)","Marketing platform leak (2023)"]},{id:"cti-5",type:"paste_site",source:"GitHub/Gist OSINT",severity:"medium",title:"Internal API keys found in public GitHub repos",description:"AWS access keys and internal API tokens committed to public repositories by developers.",date:"2024-01-05",indicators:["AWS Access Key: AKIA****","Slack webhook URL","Internal API bearer token"]}];function bl(){var H;const t=be(),{goToNextStep:s,goToPreviousStep:a}=me(),[r,n]=v.useState(!1),[i,o]=v.useState(!1),[l,c]=v.useState(0),[d,p]=v.useState(0),[f,g]=v.useState(Ee.map(()=>0)),[D,w]=v.useState([]),[b,N]=v.useState({critical:0,high:0,medium:0,low:0,ambiguous:0}),[P,u]=v.useState(""),[k,S]=v.useState(!1),[O,$]=v.useState([]),[E,x]=v.useState("all"),[W,se]=v.useState(!1),Q=v.useRef(null),F=v.useRef(null);v.useEffect(()=>{Q.current&&(Q.current.scrollTop=Q.current.scrollHeight)},[D]),v.useEffect(()=>{if(!r||i){F.current&&clearInterval(F.current);return}return F.current=setInterval(()=>{if(c(R=>{const L=R+1;return L>=100?(n(!1),100):L}),g(R=>{const L=[...R],ee=100/Ee.length;for(let U=0;U<Ee.length;U++){const Se=U*ee,Te=(U+1)*ee,ae=l+1;ae>=Te?L[U]=100:ae>Se&&(L[U]=(ae-Se)/ee*100,p(U))}return L}),Math.random()>.5){const R=[{message:"Collecting Windows Security Event Logs...",severity:"info"},{message:"Analyzing authentication patterns...",severity:"info"},{message:"Found suspicious process execution",severity:"warning"},{message:"Extracting registry artifacts...",severity:"info"},{message:"Correlating network connections...",severity:"info"},{message:"Detected potential lateral movement",severity:"warning"},{message:"Identified scheduled task persistence",severity:"warning"},{message:"Phase completed successfully",severity:"success"}],L=R[Math.floor(Math.random()*R.length)];w(ee=>{var U;return[...ee.slice(-49),{id:`${Date.now()}-${Math.random()}`,timestamp:new Date,phase:((U=Ee[d])==null?void 0:U.name)||"Analysis",...L}]}),Math.random()>.85&&N(ee=>{const U=["critical","high","medium","low","ambiguous"][Math.floor(Math.random()*5)];return{...ee,[U]:ee[U]+1}})}},200),()=>{F.current&&clearInterval(F.current)}},[r,i,l,d]);const h=()=>{a(),t("/validation")},M=()=>{s(),t("/timeline")},y=()=>{n(!0),o(!1)},B=()=>{o(!i)},Y=R=>{const L=[e.jsx(We,{className:"w-5 h-5"},"db"),e.jsx(Ts,{className:"w-5 h-5"},"search"),e.jsx(Ne,{className:"w-5 h-5"},"activity"),e.jsx(Ya,{className:"w-5 h-5"},"git"),e.jsx(gt,{className:"w-5 h-5"},"radar")];return L[R]||L[0]},J=R=>f[R]>=100?"complete":f[R]>0?"running":"pending",_=v.useCallback(()=>{S(!0),$([]),setTimeout(()=>{const R=E==="all"?Cs:Cs.filter(L=>E==="credentials"?L.type==="leaked_credentials"||L.type==="breach_database":E==="pii"?L.type==="pii_exposure"||L.type==="paste_site":E==="darknet"?L.type==="darknet_mention":!0);$(R),S(!1)},2500)},[E]),q=b.critical+b.high+b.medium+b.low;return e.jsxs(ke,{title:"Triage Process",subtitle:"Automated forensic analysis in progress",footer:e.jsx(Ae,{onBack:h,backLabel:"Validation",onContinue:M,continueLabel:"View Timeline",continueDisabled:l<100}),children:[e.jsxs(T,{className:"mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-6",children:[e.jsx($r,{value:l,size:140,variant:l>=100?"success":"default"}),e.jsxs("div",{className:"flex-1 text-center sm:text-left",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:l>=100?"Analysis Complete":i?"Paused":r?((H=Ee[d])==null?void 0:H.name)||"Analyzing...":"Ready to Start"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:l>=100?`Found ${q} findings (${b.ambiguous} require verification)`:r?"Processing forensic data...":"Click Start to begin the automated triage process"}),e.jsxs("div",{className:"mt-4 flex gap-2 justify-center sm:justify-start flex-wrap",children:[!r&&l<100&&e.jsx(C,{content:"Begin automated forensic triage",children:e.jsx(I,{onClick:y,leftIcon:e.jsx(ns,{className:"w-4 h-4"}),children:"Start Triage"})}),r&&e.jsx(C,{content:i?"Resume the triage process":"Pause the triage process",children:e.jsx(I,{variant:"secondary",onClick:B,leftIcon:i?e.jsx(ns,{className:"w-4 h-4"}):e.jsx($a,{className:"w-4 h-4"}),children:i?"Resume":"Pause"})}),e.jsx(C,{content:"Open Cyber Threat Intelligence (CTI) OSINT search",children:e.jsx(I,{variant:W?"primary":"outline",onClick:()=>se(!W),leftIcon:e.jsx(le,{className:"w-4 h-4"}),children:"CTI / OSINT"})})]})]})]}),W&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(le,{className:"w-5 h-5 text-forensic-500"}),e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Cyber Threat Intelligence (CTI)"}),e.jsx("span",{className:"text-xs text-slate-400",children:"OSINT search for PII, credentials, darknet mentions"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[e.jsxs("div",{className:"flex-1 min-w-[200px] relative",children:[e.jsx(Vt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",value:P,onChange:R=>u(R.target.value),placeholder:"Search domain, email, IP, or keyword...",className:"input pl-10"})]}),e.jsx("div",{className:"flex gap-1",children:[{id:"all",label:"All Sources",icon:e.jsx(le,{className:"w-3 h-3"})},{id:"pii",label:"PII / Leaks",icon:e.jsx(Zt,{className:"w-3 h-3"})},{id:"credentials",label:"Credentials",icon:e.jsx(kt,{className:"w-3 h-3"})},{id:"darknet",label:"Darknet",icon:e.jsx(nt,{className:"w-3 h-3"})}].map(R=>e.jsx(C,{content:`Search ${R.label}`,children:e.jsxs("button",{onClick:()=>x(R.id),className:m("flex items-center gap-1.5 px-3 py-2 rounded-lg text-xs font-medium transition-colors",E===R.id?"bg-forensic-100 text-forensic-700 dark:bg-forensic-900/30 dark:text-forensic-300":"bg-slate-100 dark:bg-slate-800 text-slate-500 hover:text-slate-700"),children:[R.icon,R.label]})},R.id))}),e.jsx(C,{content:"Search public OSINT sources and darknet databases",children:e.jsx(I,{onClick:_,isLoading:k,leftIcon:e.jsx(Vt,{className:"w-4 h-4"}),size:"sm",children:"Search CTI"})})]}),k&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg mb-3",children:[e.jsx(jt,{className:"w-5 h-5 animate-spin text-forensic-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Searching threat intelligence sources..."}),e.jsx("p",{className:"text-xs text-slate-500",children:"Querying OSINT databases, breach databases, paste sites, darknet forums"})]})]}),O.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[e.jsx(et,{className:"w-4 h-4 text-yellow-500"}),e.jsxs("span",{children:[O.length," results found across open and dark sources"]})]}),O.map(R=>e.jsx(jl,{result:R},R.id))]}),!k&&O.length===0&&e.jsxs("div",{className:"text-center py-4 text-slate-400",children:[e.jsx(le,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Run a CTI search to discover exposed data, leaked credentials, and darknet mentions"}),e.jsx("p",{className:"text-xs mt-1",children:"Sources: OSINT databases, breach databases, paste sites, darknet forums, public repos"})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:Ee.map((R,L)=>e.jsx(vl,{name:R.name,icon:Y(L),progress:f[L],status:J(L)},R.id))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(T,{className:"h-[400px] flex flex-col",children:[e.jsx(Z,{title:"Activity Feed",description:"Real-time log of triage operations"}),e.jsx("div",{ref:Q,className:"flex-1 overflow-y-auto mt-4 space-y-2",children:D.length===0?e.jsx("p",{className:"text-sm text-slate-400 text-center py-8",children:"Activity will appear here when triage starts..."}):D.map(R=>e.jsx(yl,{log:R},R.id))})]})}),e.jsx("div",{children:e.jsxs(T,{className:"h-[400px]",children:[e.jsx(Z,{title:"Findings",description:"Detected issues and anomalies"}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx($e,{label:"Critical",count:b.critical,color:"red"}),e.jsx($e,{label:"High",count:b.high,color:"orange"}),e.jsx($e,{label:"Medium",count:b.medium,color:"yellow"}),e.jsx($e,{label:"Low",count:b.low,color:"green"}),e.jsx("hr",{className:"border-slate-200 dark:border-slate-700"}),e.jsx($e,{label:"Ambiguous",count:b.ambiguous,color:"purple",tooltip:"Findings requiring manual review"})]})]})})]})]})}function jl({result:t}){const[s,a]=v.useState(!1),r={pii_exposure:e.jsx(Zt,{className:"w-4 h-4"}),leaked_credentials:e.jsx(kt,{className:"w-4 h-4"}),darknet_mention:e.jsx(nt,{className:"w-4 h-4"}),paste_site:e.jsx(Ts,{className:"w-4 h-4"}),breach_database:e.jsx(We,{className:"w-4 h-4"})},n={pii_exposure:"PII Exposure",leaked_credentials:"Leaked Credentials",darknet_mention:"Darknet Mention",paste_site:"Paste Site",breach_database:"Breach Database"},i={critical:"border-l-red-500 bg-red-50/50 dark:bg-red-900/10",high:"border-l-orange-500 bg-orange-50/50 dark:bg-orange-900/10",medium:"border-l-yellow-500 bg-yellow-50/50 dark:bg-yellow-900/10",low:"border-l-green-500 bg-green-50/50 dark:bg-green-900/10"};return e.jsx("div",{className:m("border-l-4 rounded-lg p-3 cursor-pointer transition-colors",i[t.severity]),onClick:()=>a(!s),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-slate-400 mt-0.5",children:r[t.type]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("span",{className:m("px-2 py-0.5 rounded text-xs font-medium",t.severity==="critical"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":t.severity==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"),children:t.severity}),e.jsx("span",{className:"text-xs text-slate-400 bg-slate-100 dark:bg-slate-700 px-2 py-0.5 rounded",children:n[t.type]}),e.jsx("span",{className:"text-xs text-slate-400 ml-auto",children:t.date}),s?e.jsx(pe,{className:"w-3 h-3 text-slate-400"}):e.jsx(oe,{className:"w-3 h-3 text-slate-400"})]}),e.jsx("h4",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:t.title}),e.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:t.description}),e.jsxs("p",{className:"text-xs text-slate-400 mt-0.5",children:["Source: ",t.source]}),s&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase mb-1",children:"Indicators Found"}),e.jsx("div",{className:"space-y-1",children:t.indicators.map((o,l)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-red-400"}),e.jsx("span",{className:"font-mono text-slate-600 dark:text-slate-400",children:o})]},l))})]})]})]})})}function vl({name:t,icon:s,progress:a,status:r}){return e.jsx(T,{className:m("text-center",r==="complete"&&"ring-2 ring-green-500 ring-offset-2 dark:ring-offset-slate-900"),children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:m(r==="complete"&&"text-green-500",r==="running"&&"text-forensic-500 animate-pulse",r==="pending"&&"text-slate-300 dark:text-slate-600"),children:r==="complete"?e.jsx(X,{className:"w-5 h-5"}):s}),e.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:t}),e.jsx(yt,{value:a,size:"sm",variant:r==="complete"?"success":"default"})]})})}function yl({log:t}){const s={info:"text-slate-400",warning:"text-yellow-500",success:"text-green-500",error:"text-red-500"};return e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx("span",{className:"text-xs font-mono text-slate-400 whitespace-nowrap",children:sa(t.timestamp)}),e.jsx("span",{className:m("flex-1",s[t.severity]),children:t.message})]})}function $e({label:t,count:s,color:a,tooltip:r}){const n={red:"bg-red-500",orange:"bg-orange-500",yellow:"bg-yellow-500",green:"bg-green-500",purple:"bg-purple-500"},i=e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:m("w-2 h-2 rounded-full",n[a])}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:t})]}),e.jsx("span",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:s})]});return r?e.jsx(C,{content:r,children:i}):i}const Ds=[{id:"attacker",name:"Threat Actor",type:"attacker",icon:e.jsx(tt,{className:"w-4 h-4"}),ip:"185.220.101.42",role:"External Attacker",severity:"critical"},{id:"email",name:"Email Gateway",type:"service",icon:e.jsx(ge,{className:"w-4 h-4"}),role:"Proofpoint",severity:"none"},{id:"jsmith",name:"jsmith",type:"user",icon:e.jsx(Je,{className:"w-4 h-4"}),role:"Finance User",severity:"high"},{id:"ws-fin-042",name:"WS-FIN-042",type:"workstation",icon:e.jsx(Me,{className:"w-4 h-4"}),ip:"10.0.10.42",role:"Patient Zero",severity:"critical"},{id:"c2",name:"C2 Server",type:"attacker",icon:e.jsx(le,{className:"w-4 h-4"}),ip:"185.220.101.42",role:"update-service.xyz",severity:"critical"},{id:"dc-main",name:"DC-MAIN-01",type:"server",icon:e.jsx(re,{className:"w-4 h-4"}),ip:"10.0.1.10",role:"Domain Controller",severity:"critical"},{id:"fs-finance",name:"FS-FINANCE-01",type:"server",icon:e.jsx(we,{className:"w-4 h-4"}),ip:"10.0.2.20",role:"File Server",severity:"high"},{id:"sharepoint",name:"SharePoint",type:"cloud",icon:e.jsx(K,{className:"w-4 h-4"}),role:"O365 SharePoint",severity:"high"},{id:"sql-db",name:"SQL-DB-01",type:"server",icon:e.jsx(We,{className:"w-4 h-4"}),ip:"10.0.3.30",role:"Database Server",severity:"medium"},{id:"web-app",name:"WEB-APP-01",type:"server",icon:e.jsx(K,{className:"w-4 h-4"}),ip:"10.0.4.40",role:"Web Server",severity:"medium"},{id:"exch",name:"EXCH-01",type:"server",icon:e.jsx(ge,{className:"w-4 h-4"}),ip:"10.0.1.15",role:"Exchange",severity:"medium"},{id:"bkp",name:"BKP-SERVER-01",type:"server",icon:e.jsx(re,{className:"w-4 h-4"}),ip:"10.0.5.50",role:"Backup Server",severity:"high"}],Ps=[{id:"af-1",time:"02:15",date:"2024-01-15",timestamp:new Date("2024-01-15T02:15:00"),phase:"Initial Access",title:"Phishing Email Delivered",description:"Spear-phishing email with malicious .xlsm attachment",riskScore:85,severity:"high",color:"bg-red-500",icon:e.jsx(ge,{className:"w-3.5 h-3.5"}),sourceResource:"attacker",targetResource:"email",process:"Phishing Email",processIcon:e.jsx(ge,{className:"w-3 h-3"}),iocs:[{type:"From",value:"invoice-update@mail-service.xyz"},{type:"Hash",value:"a1b2c3d4e5f6..."},{type:"Domain",value:"mail-service.xyz"}],ttps:[{id:"T1566.001",name:"Spear-phishing Attachment",tactic:"Initial Access"}],details:"Email impersonated vendor invoice. Macro-enabled .xlsm with obfuscated PowerShell payload. Passed SPF/DKIM checks."},{id:"af-1b",time:"02:16",date:"2024-01-15",timestamp:new Date("2024-01-15T02:16:00"),phase:"Initial Access",title:"Email Delivered to User",description:"Phishing email bypasses gateway and reaches jsmith inbox",riskScore:80,severity:"high",color:"bg-red-500",icon:e.jsx(ge,{className:"w-3.5 h-3.5"}),sourceResource:"email",targetResource:"jsmith",process:"Email Delivery",processIcon:e.jsx(at,{className:"w-3 h-3"}),iocs:[{type:"Recipient",value:"jsmith@company.com"}],ttps:[{id:"T1566.001",name:"Spear-phishing Attachment",tactic:"Initial Access"}],details:"Email passed through Proofpoint gateway and was delivered to jsmith's Outlook inbox."},{id:"af-2",time:"02:18",date:"2024-01-15",timestamp:new Date("2024-01-15T02:18:00"),phase:"Execution",title:"Macro  PowerShell Stager",description:"jsmith opened attachment, macro spawned PowerShell on WS-FIN-042",riskScore:90,severity:"critical",color:"bg-red-600",icon:e.jsx(Ne,{className:"w-3.5 h-3.5"}),sourceResource:"jsmith",targetResource:"ws-fin-042",process:"Macro Exec",processIcon:e.jsx(Ne,{className:"w-3 h-3"}),iocs:[{type:"Process",value:"powershell.exe -enc <base64>"},{type:"URL",value:"https://cdn-update.xyz/payload.ps1"},{type:"Hash",value:"payload.ps1: e7f8a9b0..."}],ttps:[{id:"T1059.001",name:"PowerShell",tactic:"Execution"},{id:"T1204.002",name:"User Execution: Malicious File",tactic:"Execution"}],details:"Excel macro used WMI to spawn powershell.exe with encoded command. Cobalt Strike beacon loaded via reflective DLL injection. Process tree: EXCEL.EXE  cmd.exe  powershell.exe."},{id:"af-3",time:"02:22",date:"2024-01-15",timestamp:new Date("2024-01-15T02:22:00"),phase:"Command & Control",title:"C2 Channel Established",description:"Cobalt Strike beacon phones home from WS-FIN-042 to attacker C2",riskScore:92,severity:"critical",color:"bg-purple-600",icon:e.jsx(vt,{className:"w-3.5 h-3.5"}),sourceResource:"ws-fin-042",targetResource:"c2",process:"HTTPS Beacon",processIcon:e.jsx(vt,{className:"w-3 h-3"}),iocs:[{type:"C2",value:"update-service.xyz:443"},{type:"IP",value:"185.220.101.42"},{type:"Config",value:"Sleep:60s Jitter:25%"}],ttps:[{id:"T1071.001",name:"Web Protocols (HTTPS)",tactic:"C2"},{id:"T1573.002",name:"Encrypted Channel",tactic:"C2"}],details:"Cobalt Strike HTTPS beacon. JA3 fingerprint matches known malleable profile. DNS over HTTPS for resolution."},{id:"af-4",time:"02:25",date:"2024-01-15",timestamp:new Date("2024-01-15T02:25:00"),phase:"Persistence",title:"Scheduled Task Created",description:"Persistence mechanism installed on WS-FIN-042",riskScore:75,severity:"high",color:"bg-orange-500",icon:e.jsx($t,{className:"w-3.5 h-3.5"}),sourceResource:"ws-fin-042",targetResource:"ws-fin-042",process:"Sched Task",processIcon:e.jsx($t,{className:"w-3 h-3"}),iocs:[{type:"Task",value:"WindowsUpdate"},{type:"Path",value:"C:\\Users\\Public\\update.exe"}],ttps:[{id:"T1053.005",name:"Scheduled Task/Job",tactic:"Persistence"},{id:"T1036.005",name:"Masquerading",tactic:"Defense Evasion"}],details:'Scheduled task "WindowsUpdate" runs at startup with SYSTEM privileges. Binary is packed Cobalt Strike loader.'},{id:"af-5",time:"02:28",date:"2024-01-15",timestamp:new Date("2024-01-15T02:28:00"),phase:"Priv. Escalation",title:"DCSync  Domain Admin",description:"Mimikatz DCSync from WS-FIN-042 targeting DC-MAIN-01",riskScore:98,severity:"critical",color:"bg-orange-600",icon:e.jsx(Yt,{className:"w-3.5 h-3.5"}),sourceResource:"ws-fin-042",targetResource:"dc-main",process:"DCSync",processIcon:e.jsx(Yt,{className:"w-3 h-3"}),iocs:[{type:"Tool",value:"Mimikatz 2.2.0"},{type:"Account",value:"admin.jsmith"},{type:"Account",value:"svc-backup"},{type:"Hash",value:"NTLM + AES256"}],ttps:[{id:"T1003.006",name:"DCSync",tactic:"Credential Access"},{id:"T1078.002",name:"Domain Accounts",tactic:"Priv. Escalation"}],details:"In-memory Mimikatz performed DCSync against DC-MAIN-01. Harvested NTLM hashes and Kerberos AES256 keys for admin.jsmith and svc-backup."},{id:"af-6",time:"02:30",date:"2024-01-15",timestamp:new Date("2024-01-15T02:30:00"),phase:"Lateral Movement",title:"PsExec  DC-MAIN-01",description:"Lateral movement from WS-FIN-042 to Domain Controller via SMB",riskScore:95,severity:"critical",color:"bg-yellow-500",icon:e.jsx(he,{className:"w-3.5 h-3.5"}),sourceResource:"ws-fin-042",targetResource:"dc-main",process:"PsExec SMB",processIcon:e.jsx(he,{className:"w-3 h-3"}),iocs:[{type:"Tool",value:"PsExec.exe"},{type:"Port",value:"TCP 445 (SMB)"},{type:"Creds",value:"admin.jsmith"}],ttps:[{id:"T1021.002",name:"SMB/Admin Shares",tactic:"Lateral Movement"},{id:"T1570",name:"Lateral Tool Transfer",tactic:"Lateral Movement"}],details:"PsExec used admin.jsmith credentials to create PSEXESVC on DC-MAIN-01 via port 445."},{id:"af-6b",time:"02:31",date:"2024-01-15",timestamp:new Date("2024-01-15T02:31:00"),phase:"Lateral Movement",title:"PsExec  FS-FINANCE-01",description:"Lateral movement from WS-FIN-042 to File Server via SMB",riskScore:92,severity:"critical",color:"bg-yellow-500",icon:e.jsx(he,{className:"w-3.5 h-3.5"}),sourceResource:"ws-fin-042",targetResource:"fs-finance",process:"PsExec SMB",processIcon:e.jsx(he,{className:"w-3 h-3"}),iocs:[{type:"Tool",value:"PsExec.exe"},{type:"Port",value:"TCP 445 (SMB)"},{type:"Creds",value:"admin.jsmith"}],ttps:[{id:"T1021.002",name:"SMB/Admin Shares",tactic:"Lateral Movement"}],details:"PsExec used admin.jsmith credentials to create PSEXESVC on FS-FINANCE-01 via port 445."},{id:"af-7",time:"02:33",date:"2024-01-15",timestamp:new Date("2024-01-15T02:33:00"),phase:"Discovery",title:"AD Enumeration",description:"ADFind + SharpHound ran on DC-MAIN-01 to map entire domain",riskScore:70,severity:"high",color:"bg-yellow-600",icon:e.jsx(Rs,{className:"w-3.5 h-3.5"}),sourceResource:"dc-main",targetResource:"dc-main",process:"AD Enum",processIcon:e.jsx(nt,{className:"w-3 h-3"}),iocs:[{type:"Tools",value:"ADFind.exe, SharpHound"},{type:"Output",value:"ad_enum.json"}],ttps:[{id:"T1087.002",name:"Domain Account Discovery",tactic:"Discovery"},{id:"T1482",name:"Domain Trust Discovery",tactic:"Discovery"}],details:"Full AD enumeration: domain trusts, GPOs, OUs, high-value targets mapped. BloodHound data collected."},{id:"af-8",time:"02:35",date:"2024-01-15",timestamp:new Date("2024-01-15T02:35:00"),phase:"Collection",title:"Finance Data Harvested",description:"Bulk file download from FS-FINANCE-01 share",riskScore:88,severity:"critical",color:"bg-purple-500",icon:e.jsx(we,{className:"w-3.5 h-3.5"}),sourceResource:"fs-finance",targetResource:"ws-fin-042",process:"1,247 files",processIcon:e.jsx(we,{className:"w-3 h-3"}),iocs:[{type:"Files",value:"1,247 (4.2 GB)"},{type:"Source",value:"\\\\FS-FINANCE-01\\Finance"},{type:"Staging",value:"C:\\Windows\\Temp\\exfil\\"}],ttps:[{id:"T1039",name:"Data from Network Share",tactic:"Collection"},{id:"T1074.001",name:"Local Data Staging",tactic:"Collection"}],details:"Finance reports, customer PII, contracts, strategy docs. Staged in C:\\Windows\\Temp\\exfil\\ as split RAR archives."},{id:"af-8b",time:"02:35",date:"2024-01-15",timestamp:new Date("2024-01-15T02:35:30"),phase:"Collection",title:"SharePoint Data Harvested",description:"Bulk file download from SharePoint Online using stolen creds",riskScore:85,severity:"high",color:"bg-purple-500",icon:e.jsx(K,{className:"w-3.5 h-3.5"}),sourceResource:"sharepoint",targetResource:"ws-fin-042",process:"SharePoint DL",processIcon:e.jsx(K,{className:"w-3 h-3"}),iocs:[{type:"Source",value:"SharePoint Online - Finance"},{type:"User",value:"jsmith@company.com"}],ttps:[{id:"T1213.002",name:"Data from SharePoint",tactic:"Collection"}],details:"SharePoint Online Finance site accessed using jsmith's session token. Documents synced to local staging directory."},{id:"af-9",time:"02:37",date:"2024-01-15",timestamp:new Date("2024-01-15T02:37:00"),phase:"Exfiltration",title:"Data Exfiltrated",description:"Compressed data exfiltrated from WS-FIN-042 to C2 server",riskScore:93,severity:"critical",color:"bg-purple-600",icon:e.jsx(K,{className:"w-3.5 h-3.5"}),sourceResource:"ws-fin-042",targetResource:"c2",process:"1.8 GB  C2",processIcon:e.jsx(K,{className:"w-3 h-3"}),iocs:[{type:"Method",value:"HTTPS via C2"},{type:"Volume",value:"~1.8 GB compressed"},{type:"Duration",value:"~15 min"}],ttps:[{id:"T1041",name:"Exfil Over C2 Channel",tactic:"Exfiltration"},{id:"T1560.001",name:"Archive via RAR",tactic:"Collection"}],details:"Split RAR archives sent through Cobalt Strike HTTPS C2 channel. Blended with normal HTTPS traffic."},{id:"af-10a",time:"02:40",date:"2024-01-15",timestamp:new Date("2024-01-15T02:40:00"),phase:"Impact",title:"GPO Ransomware Push",description:'Malicious GPO "Windows Update Policy" deployed from DC-MAIN-01',riskScore:100,severity:"critical",color:"bg-red-700",icon:e.jsx(ie,{className:"w-3.5 h-3.5"}),sourceResource:"dc-main",targetResource:"fs-finance",process:"GPO Deploy",processIcon:e.jsx(ie,{className:"w-3 h-3"}),iocs:[{type:"Ransomware",value:"BlackCat/ALPHV"},{type:"GPO",value:"Windows Update Policy"},{type:"Extension",value:".encrypted"}],ttps:[{id:"T1486",name:"Data Encrypted for Impact",tactic:"Impact"},{id:"T1484.001",name:"GPO Modification",tactic:"Defense Evasion"}],details:"Ransomware deployed via malicious GPO from DC-MAIN-01. Volume shadow copies deleted. BKP-SERVER-01 targeted first."},{id:"af-10b",time:"02:40",date:"2024-01-15",timestamp:new Date("2024-01-15T02:40:10"),phase:"Impact",title:"Backup Server Encrypted",description:"BKP-SERVER-01 targeted first to prevent recovery",riskScore:100,severity:"critical",color:"bg-red-700",icon:e.jsx(ie,{className:"w-3.5 h-3.5"}),sourceResource:"dc-main",targetResource:"bkp",process:"Encrypt",processIcon:e.jsx(ie,{className:"w-3 h-3"}),iocs:[{type:"Target",value:"BKP-SERVER-01"},{type:"Note",value:"RECOVER-FILES.txt"}],ttps:[{id:"T1490",name:"Inhibit System Recovery",tactic:"Impact"}],details:"Backup server encrypted first to prevent recovery. Veeam repositories destroyed."},{id:"af-10c",time:"02:41",date:"2024-01-15",timestamp:new Date("2024-01-15T02:41:00"),phase:"Impact",title:"Domain-wide Encryption",description:"SQL-DB-01, WEB-APP-01, EXCH-01 encrypted via GPO",riskScore:100,severity:"critical",color:"bg-red-700",icon:e.jsx(ie,{className:"w-3.5 h-3.5"}),sourceResource:"dc-main",targetResource:"sql-db",process:"Encrypt All",processIcon:e.jsx(ie,{className:"w-3 h-3"}),iocs:[{type:"Targets",value:"SQL-DB-01, WEB-APP-01, EXCH-01"},{type:"BTC",value:"bc1q...xyz"}],ttps:[{id:"T1486",name:"Data Encrypted for Impact",tactic:"Impact"}],details:"Remaining servers encrypted. Recovery Environment disabled. Ransom note dropped in every directory."}],Ye=[{id:"dn-attacker",label:"Threat Actor",type:"attacker",icon:e.jsx(tt,{className:"w-5 h-5"}),x:5,y:15,severity:"critical",sublabel:"185.220.101.42"},{id:"dn-internet",label:"Internet",type:"external",icon:e.jsx(le,{className:"w-5 h-5"}),x:20,y:8,severity:"none",sublabel:"Public Network"},{id:"dn-email-gw",label:"Email Gateway",type:"network",icon:e.jsx(fe,{className:"w-5 h-5"}),x:35,y:8,severity:"none",sublabel:"Proofpoint"},{id:"dn-firewall",label:"FW-EDGE-01",type:"network",icon:e.jsx(fe,{className:"w-5 h-5"}),x:35,y:30,severity:"high",sublabel:"Palo Alto"},{id:"dn-vpn",label:"VPN Gateway",type:"network",icon:e.jsx(vt,{className:"w-5 h-5"}),x:20,y:30,severity:"high",sublabel:"vpn.company.com"},{id:"dn-jsmith",label:"jsmith",type:"user",icon:e.jsx(Je,{className:"w-5 h-5"}),x:50,y:8,severity:"high",sublabel:"Finance User"},{id:"dn-ws042",label:"WS-FIN-042",type:"workstation",icon:e.jsx(Me,{className:"w-5 h-5"}),x:50,y:30,severity:"critical",sublabel:"Patient Zero"},{id:"dn-dc",label:"DC-MAIN-01",type:"server",icon:e.jsx(re,{className:"w-5 h-5"}),x:72,y:30,severity:"critical",sublabel:"Domain Controller"},{id:"dn-fs",label:"FS-FINANCE-01",type:"server",icon:e.jsx(we,{className:"w-5 h-5"}),x:60,y:55,severity:"critical",sublabel:"File Server"},{id:"dn-sp",label:"SharePoint",type:"cloud",icon:e.jsx(K,{className:"w-5 h-5"}),x:40,y:55,severity:"high",sublabel:"O365"},{id:"dn-bkp",label:"BKP-SERVER",type:"server",icon:e.jsx(re,{className:"w-5 h-5"}),x:88,y:55,severity:"critical",sublabel:"Backup"},{id:"dn-sql",label:"SQL-DB-01",type:"server",icon:e.jsx(We,{className:"w-5 h-5"}),x:72,y:55,severity:"high",sublabel:"Database"},{id:"dn-web",label:"WEB-APP-01",type:"server",icon:e.jsx(K,{className:"w-5 h-5"}),x:88,y:30,severity:"medium",sublabel:"Web Server"},{id:"dn-exch",label:"EXCH-01",type:"server",icon:e.jsx(ge,{className:"w-5 h-5"}),x:50,y:75,severity:"medium",sublabel:"Exchange"},{id:"dn-c2",label:"C2 Server",type:"attacker",icon:e.jsx(le,{className:"w-5 h-5"}),x:5,y:55,severity:"critical",sublabel:"update-service.xyz"}],Bt=[{from:"dn-attacker",to:"dn-internet",label:"Phishing",type:"attack",order:1},{from:"dn-internet",to:"dn-email-gw",label:"SMTP",type:"attack",order:2},{from:"dn-email-gw",to:"dn-jsmith",label:"Deliver",type:"attack",order:3},{from:"dn-jsmith",to:"dn-ws042",label:"Open .xlsm",type:"attack",order:4},{from:"dn-ws042",to:"dn-c2",label:"C2 Beacon",type:"c2",order:5},{from:"dn-ws042",to:"dn-dc",label:"DCSync + PsExec",type:"lateral",order:6},{from:"dn-ws042",to:"dn-fs",label:"PsExec",type:"lateral",order:7},{from:"dn-fs",to:"dn-ws042",label:"1,247 files",type:"exfil",order:8},{from:"dn-sp",to:"dn-ws042",label:"SharePoint DL",type:"exfil",order:9},{from:"dn-ws042",to:"dn-c2",label:"1.8 GB exfil",type:"exfil",order:10},{from:"dn-dc",to:"dn-fs",label:"GPO Encrypt",type:"attack",order:11},{from:"dn-dc",to:"dn-bkp",label:"Encrypt",type:"attack",order:12},{from:"dn-dc",to:"dn-sql",label:"Encrypt",type:"attack",order:13},{from:"dn-dc",to:"dn-web",label:"Encrypt",type:"attack",order:14},{from:"dn-dc",to:"dn-exch",label:"Encrypt",type:"attack",order:15}],wl=[{id:"1",timestamp:new Date("2024-01-15T02:30:15"),source:"windows_security",severity:"critical",title:"Suspicious Process Execution",summary:"PsExec.exe executed with SYSTEM privileges",category:"process_execution",rawLog:`EventID: 4688
Process Name: C:\\Windows\\System32\\PsExec.exe
User: NT AUTHORITY\\SYSTEM`,relatedCount:3},{id:"2",timestamp:new Date("2024-01-15T02:31:00"),source:"firewall",severity:"high",title:"Outbound Connection to Known C2",summary:"Connection to 185.220.101.42:443 blocked",category:"network_connection",rawLog:`Action: Block
Direction: Outbound
Dest IP: 185.220.101.42
Dest Port: 443`,relatedCount:5},{id:"3",timestamp:new Date("2024-01-15T02:32:30"),source:"windows_security",severity:"medium",title:"Scheduled Task Created",summary:'New scheduled task "WindowsUpdate" created',category:"persistence",rawLog:`Task Name: WindowsUpdate
Action: C:\\Users\\Public\\update.exe
Trigger: At startup`,relatedCount:1},{id:"4",timestamp:new Date("2024-01-15T02:35:00"),source:"azure_activity",severity:"high",title:"Bulk File Download",summary:"1,247 files downloaded from SharePoint",category:"data_exfiltration",rawLog:`Operation: FileDownloaded
Count: 1247
User: jsmith@company.com`,relatedCount:2},{id:"5",timestamp:new Date("2024-01-15T02:40:00"),source:"windows_security",severity:"critical",title:"Lateral Movement Detected",summary:"Remote WMI execution on DC-MAIN-01",category:"lateral_movement",rawLog:`EventID: 4624
Logon Type: 3
Target: DC-MAIN-01
Source: ACCT-WS-042`,relatedCount:8}];function Nl(){var Q,F;const t=be(),{goToNextStep:s,goToPreviousStep:a}=me(),[r,n]=v.useState(null),[i,o]=v.useState(null),[l,c]=v.useState(null),[d,p]=v.useState(""),[f,g]=v.useState(1),[D,w]=v.useState(!0),[b,N]=v.useState(!0),[P,u]=v.useState("flow"),k=()=>{a(),t("/triage")},S=()=>{s(),t("/verification")},O=wl.filter(h=>h.title.toLowerCase().includes(d.toLowerCase())||h.summary.toLowerCase().includes(d.toLowerCase())),$=h=>h.includes("windows")?e.jsx(Me,{className:"w-4 h-4"}):h.includes("azure")||h.includes("cloud")?e.jsx(K,{className:"w-4 h-4"}):h.includes("firewall")?e.jsx(fe,{className:"w-4 h-4"}):e.jsx(Ne,{className:"w-4 h-4"}),E=h=>{const M={critical:"bg-red-500",high:"bg-orange-500",medium:"bg-yellow-500",low:"bg-green-500",info:"bg-blue-500"};return M[h]||M.info},x=h=>h>=90?{text:"text-red-700 dark:text-red-400",bg:"bg-red-100 dark:bg-red-900/30"}:h>=75?{text:"text-orange-700 dark:text-orange-400",bg:"bg-orange-100 dark:bg-orange-900/30"}:h>=50?{text:"text-yellow-700 dark:text-yellow-400",bg:"bg-yellow-100 dark:bg-yellow-900/30"}:{text:"text-green-700 dark:text-green-400",bg:"bg-green-100 dark:bg-green-900/30"},W=h=>Ds.find(M=>M.id===h),se=h=>{const M={critical:"border-red-400 bg-red-50 dark:bg-red-900/20 dark:border-red-700 shadow-red-200 dark:shadow-red-900/50",high:"border-orange-400 bg-orange-50 dark:bg-orange-900/20 dark:border-orange-700",medium:"border-yellow-400 bg-yellow-50 dark:bg-yellow-900/20 dark:border-yellow-700",low:"border-green-400 bg-green-50 dark:bg-green-900/20 dark:border-green-700",none:"border-slate-300 bg-white dark:bg-slate-800 dark:border-slate-600"};return M[h]||M.none};return e.jsxs(ke,{title:"Timeline View",subtitle:"Interactive timeline of security events",actions:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{content:"Zoom out",children:e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>g(Math.max(.5,f-.25)),children:e.jsx(Xa,{className:"w-4 h-4"})})}),e.jsxs("span",{className:"text-sm text-slate-500",children:[Math.round(f*100),"%"]}),e.jsx(C,{content:"Zoom in",children:e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>g(Math.min(2,f+.25)),children:e.jsx(Ka,{className:"w-4 h-4"})})})]}),footer:e.jsx(Ae,{onBack:k,backLabel:"Triage",onContinue:S,continueLabel:"Proceed to Review"}),children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[e.jsx("div",{className:"flex-1 min-w-[200px] max-w-md",children:e.jsx(Kr,{value:d,onChange:h=>p(h.target.value),placeholder:"Search events...",tooltip:"Search events by keyword"})}),e.jsx(C,{content:"Filter by data source",children:e.jsx(I,{variant:"outline",size:"sm",leftIcon:e.jsx(is,{className:"w-4 h-4"}),children:"Source"})}),e.jsx(C,{content:"Filter by severity",children:e.jsx(I,{variant:"outline",size:"sm",leftIcon:e.jsx(is,{className:"w-4 h-4"}),children:"Severity"})}),e.jsx(C,{content:"Filter by date",children:e.jsx(I,{variant:"outline",size:"sm",leftIcon:e.jsx(Is,{className:"w-4 h-4"}),children:"Date Range"})})]}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx(I,{variant:P==="flow"?"primary":"outline",size:"sm",onClick:()=>u("flow"),leftIcon:e.jsx(Ne,{className:"w-4 h-4"}),children:"Attack Flow Timeline"}),e.jsx(I,{variant:P==="diagram"?"primary":"outline",size:"sm",onClick:()=>u("diagram"),leftIcon:e.jsx(Ut,{className:"w-4 h-4"}),children:"Incident Diagram"})]}),P==="flow"&&e.jsxs(T,{className:"mb-6",children:[e.jsxs("button",{onClick:()=>w(!D),className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tt,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Attack Flow Timeline"}),e.jsx("span",{className:"text-xs bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 px-2 py-0.5 rounded-full",children:"Resource View"})]}),D?e.jsx(pe,{className:"w-5 h-5 text-slate-400"}):e.jsx(oe,{className:"w-5 h-5 text-slate-400"})]}),D&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-slate-500",children:"AXIS:"}),e.jsx("span",{className:"text-slate-400",children:"Vertical  = Date & Time"}),e.jsx("span",{className:"text-slate-300",children:"|"}),e.jsx("span",{className:"text-slate-400",children:"Horizontal  = Resources & Processes"})]}),e.jsxs("div",{className:"flex items-center gap-3 ml-auto",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-red-500"})," Critical"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-orange-500"})," High"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-yellow-500"})," Medium"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-slate-200 dark:bg-slate-700 px-1 font-bold text-slate-600",children:"95"})," Risk"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{style:{minWidth:"900px"},children:(()=>{const h=new Set;Ps.forEach(y=>{h.add(y.sourceResource),h.add(y.targetResource)});const M=Ds.filter(y=>h.has(y.id));return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-end mb-2",children:[e.jsx("div",{className:"w-[80px] flex-shrink-0"})," ",e.jsx("div",{className:"flex-1 grid",style:{gridTemplateColumns:`repeat(${M.length}, 1fr)`},children:M.map(y=>e.jsx(C,{content:`${y.name}  ${y.role}${y.ip?" ("+y.ip+")":""}`,children:e.jsxs("button",{onClick:()=>c(Ye.find(B=>B.label===y.name||B.sublabel===y.name)||null),className:m("flex flex-col items-center gap-0.5 py-1.5 px-1 rounded-lg border transition-all hover:scale-105 mx-0.5",se(y.severity)),children:[e.jsx("span",{className:m("text-slate-500",y.severity==="critical"&&"text-red-500",y.severity==="high"&&"text-orange-500",y.type==="attacker"&&"text-red-600"),children:y.icon}),e.jsx("span",{className:"text-[9px] font-medium text-slate-700 dark:text-slate-300 truncate max-w-full leading-tight",children:y.name}),e.jsx("span",{className:"text-[8px] text-slate-400 truncate max-w-full",children:y.role})]})},y.id))})]}),e.jsx("div",{className:"ml-[80px] mb-1 h-px bg-slate-200 dark:bg-slate-700"}),e.jsx("div",{className:"space-y-0",children:Ps.map(y=>{var ee,U,Se,Te;const B=M.findIndex(ae=>ae.id===y.sourceResource),Y=M.findIndex(ae=>ae.id===y.targetResource),J=x(y.riskScore),_=(i==null?void 0:i.id)===y.id,q=y.sourceResource===y.targetResource,H=Math.min(B,Y),R=Math.max(B,Y),L=M.length;return e.jsxs("div",{className:m("flex items-center border-b border-slate-100 dark:border-slate-800 transition-colors",_&&"bg-forensic-50/50 dark:bg-forensic-900/10"),children:[e.jsxs("div",{className:"w-[80px] flex-shrink-0 pr-2 text-right py-2",children:[e.jsx("span",{className:"text-[10px] font-mono font-bold text-slate-600 dark:text-slate-300",children:y.time}),e.jsx("br",{}),e.jsx("span",{className:"text-[9px] text-slate-400",children:y.phase})]}),e.jsxs("div",{className:"flex-1 relative py-2",style:{display:"grid",gridTemplateColumns:`repeat(${L}, 1fr)`},children:[!q&&e.jsx("div",{className:m("absolute top-1/2 -translate-y-1/2 h-1 rounded-full z-0",y.severity==="critical"?"bg-red-200 dark:bg-red-900/40":y.severity==="high"?"bg-orange-200 dark:bg-orange-900/40":"bg-yellow-200 dark:bg-yellow-900/40"),style:{left:`${(H+.5)/L*100}%`,width:`${(R-H)/L*100}%`}}),e.jsx(C,{content:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:(ee=W(y.sourceResource))==null?void 0:ee.name}),e.jsxs("div",{className:"text-xs opacity-80",children:["Source  ",(U=W(y.sourceResource))==null?void 0:U.role]})]}),children:e.jsx("button",{onClick:()=>o(_?null:y),className:"absolute z-10 top-1/2 -translate-y-1/2 -translate-x-1/2",style:{left:`${(B+.5)/L*100}%`},children:e.jsx("div",{className:m("w-6 h-6 rounded-full flex items-center justify-center text-white transition-all",y.color,_&&"ring-2 ring-offset-1 ring-forensic-500 scale-125"),children:y.icon})})}),!q&&e.jsx(C,{content:e.jsxs("div",{className:"max-w-xs",children:[e.jsx("div",{className:"font-semibold",children:y.title}),e.jsx("div",{className:"text-xs mt-1 opacity-80",children:y.description}),e.jsxs("div",{className:"text-xs mt-1 font-mono opacity-60",children:["Risk: ",y.riskScore,"/100 | ",y.ttps.map(ae=>ae.id).join(", ")]}),e.jsx("div",{className:"text-xs mt-1 opacity-60",children:"Click for details "})]}),children:e.jsxs("button",{onClick:()=>o(_?null:y),className:m("absolute z-20 top-1/2 -translate-y-1/2 -translate-x-1/2","flex items-center gap-1 px-1.5 py-0.5 rounded-md border text-[9px] font-semibold transition-all whitespace-nowrap",_?"bg-forensic-100 border-forensic-400 dark:bg-forensic-900/30 dark:border-forensic-600 scale-110":"bg-white dark:bg-slate-800 border-slate-300 dark:border-slate-600 hover:scale-105 hover:border-slate-400"),style:{left:`${(H+R+1)/2/L*100}%`},children:[y.processIcon,e.jsx("span",{children:y.process}),e.jsx("span",{className:m("font-black tabular-nums text-[10px]",J.text),children:y.riskScore})]})}),q&&e.jsx(C,{content:e.jsxs("div",{className:"max-w-xs",children:[e.jsx("div",{className:"font-semibold",children:y.title}),e.jsx("div",{className:"text-xs mt-1 opacity-80",children:y.description}),e.jsxs("div",{className:"text-xs mt-1 font-mono opacity-60",children:["Risk: ",y.riskScore,"/100"]})]}),children:e.jsxs("button",{onClick:()=>o(_?null:y),className:m("absolute z-20 top-1/2 -translate-y-1/2","flex items-center gap-1 px-1.5 py-0.5 rounded-md border text-[9px] font-semibold transition-all whitespace-nowrap",_?"bg-forensic-100 border-forensic-400 dark:bg-forensic-900/30":"bg-white dark:bg-slate-800 border-slate-300 dark:border-slate-600 hover:scale-105"),style:{left:`${(B+.8)/L*100}%`},children:[y.processIcon,e.jsx("span",{children:y.process}),e.jsx("span",{className:m("font-black tabular-nums text-[10px]",J.text),children:y.riskScore})]})}),!q&&e.jsx(C,{content:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:(Se=W(y.targetResource))==null?void 0:Se.name}),e.jsxs("div",{className:"text-xs opacity-80",children:["Target  ",(Te=W(y.targetResource))==null?void 0:Te.role]})]}),children:e.jsx("button",{onClick:()=>o(_?null:y),className:"absolute z-10 top-1/2 -translate-y-1/2 -translate-x-1/2",style:{left:`${(Y+.5)/L*100}%`},children:e.jsx("div",{className:m("w-5 h-5 rounded-full flex items-center justify-center border-2 transition-all",y.severity==="critical"?"bg-red-100 border-red-500 text-red-600 dark:bg-red-900/30":y.severity==="high"?"bg-orange-100 border-orange-500 text-orange-600 dark:bg-orange-900/30":"bg-yellow-100 border-yellow-500 text-yellow-600 dark:bg-yellow-900/30",_&&"ring-2 ring-offset-1 ring-forensic-500 scale-125"),children:e.jsx(Ms,{className:"w-2.5 h-2.5"})})})}),!q&&e.jsx("div",{className:"absolute z-5 top-1/2 -translate-y-1/2 flex items-center pointer-events-none",style:{left:`${(B+.65)/L*100}%`},children:e.jsx(at,{className:m("w-3 h-3",y.severity==="critical"?"text-red-400":y.severity==="high"?"text-orange-400":"text-yellow-400")})})]})]},y.id)})})]})})()})}),i&&e.jsxs("div",{className:"border-2 border-forensic-300 dark:border-forensic-700 rounded-xl overflow-hidden",children:[e.jsx("div",{className:m("p-4",i.severity==="critical"?"bg-red-50 dark:bg-red-900/10":i.severity==="high"?"bg-orange-50 dark:bg-orange-900/10":"bg-yellow-50 dark:bg-yellow-900/10"),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:m("w-10 h-10 rounded-full flex items-center justify-center text-white",i.color),children:i.icon}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-slate-100",children:i.title}),e.jsx("span",{className:m("px-2 py-0.5 rounded text-xs font-bold",i.severity==="critical"?"bg-red-200 text-red-800 dark:bg-red-900/40 dark:text-red-300":"bg-orange-200 text-orange-800 dark:bg-orange-900/40 dark:text-orange-300"),children:i.severity.toUpperCase()})]}),e.jsxs("p",{className:"text-sm text-slate-500 mt-0.5",children:[i.phase,"  ",i.date," at ",i.time,e.jsx("span",{className:"mx-2",children:"|"}),e.jsx("span",{className:"font-medium",children:(Q=W(i.sourceResource))==null?void 0:Q.name}),i.sourceResource!==i.targetResource&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-1",children:""}),e.jsx("span",{className:"font-medium",children:(F=W(i.targetResource))==null?void 0:F.name})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:m("text-3xl font-black tabular-nums",x(i.riskScore).text),children:i.riskScore}),e.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-medium",children:"Risk"})]}),e.jsx("button",{onClick:()=>o(null),className:"p-1 hover:bg-white/50 rounded",children:e.jsx(Fe,{className:"w-5 h-5 text-slate-400"})})]})]})}),e.jsxs("div",{className:"p-4 bg-white dark:bg-slate-800 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-semibold text-slate-500 uppercase mb-1 flex items-center gap-1",children:[e.jsx(Gt,{className:"w-3 h-3"})," Details"]}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:i.details})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-semibold text-slate-500 uppercase mb-2 flex items-center gap-1",children:[e.jsx(Es,{className:"w-3 h-3"})," IOCs (",i.iocs.length,")"]}),e.jsx("div",{className:"space-y-1",children:i.iocs.map((h,M)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-slate-50 dark:bg-slate-700/50 rounded text-xs",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-red-400 flex-shrink-0"}),e.jsxs("span",{className:"text-slate-500 w-16 flex-shrink-0",children:[h.type,":"]}),e.jsx("span",{className:"font-mono text-slate-700 dark:text-slate-300 truncate",children:h.value})]},M))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-semibold text-slate-500 uppercase mb-2 flex items-center gap-1",children:[e.jsx(Rs,{className:"w-3 h-3"})," MITRE ATT&CK (",i.ttps.length,")"]}),e.jsx("div",{className:"space-y-1",children:i.ttps.map((h,M)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-slate-50 dark:bg-slate-700/50 rounded text-xs",children:[e.jsx("span",{className:"px-1.5 py-0.5 bg-forensic-100 dark:bg-forensic-900/30 text-forensic-700 dark:text-forensic-300 rounded font-mono font-bold text-[10px]",children:h.id}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300 flex-1",children:h.name}),e.jsx("span",{className:"text-slate-400 text-[10px]",children:h.tactic})]},M))})]})]})]})]})]})]}),P==="diagram"&&e.jsxs(T,{className:"mb-6",children:[e.jsxs("button",{onClick:()=>N(!b),className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ut,{className:"w-5 h-5 text-forensic-500"}),e.jsx("span",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Incident Diagram"}),e.jsx("span",{className:"text-xs bg-forensic-100 dark:bg-forensic-900/30 text-forensic-600 dark:text-forensic-400 px-2 py-0.5 rounded-full",children:"Interactive Infographic"})]}),b?e.jsx(pe,{className:"w-5 h-5 text-slate-400"}):e.jsx(oe,{className:"w-5 h-5 text-slate-400"})]}),b&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"})," Compromised (Critical)"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-500"})," Affected (High)"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"})," Touched (Medium)"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded border border-slate-300"})," Clean"]}),e.jsxs("div",{className:"ml-auto flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-4 h-0.5 bg-red-400"})," Attack"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-4 h-0.5 bg-yellow-400"})," Lateral"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-4 h-0.5 bg-purple-400"})," Exfil"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-4 h-0.5 bg-blue-400 border-dashed border-b"})," C2"]})]})]}),e.jsxs("div",{className:"relative bg-slate-50 dark:bg-slate-900/50 rounded-xl border border-slate-200 dark:border-slate-700 overflow-hidden",style:{minHeight:"480px"},children:[e.jsx("div",{className:"absolute top-2 left-2 text-[10px] font-medium text-slate-400 uppercase flex flex-col gap-1",children:e.jsx("span",{className:"bg-red-100 dark:bg-red-900/20 text-red-500 px-1.5 py-0.5 rounded",children:"External / Internet"})}),e.jsx("div",{className:"absolute top-2 right-2 text-[10px] font-medium text-slate-400 uppercase",children:e.jsx("span",{className:"bg-blue-100 dark:bg-blue-900/20 text-blue-500 px-1.5 py-0.5 rounded",children:"Internal Network"})}),e.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 text-[10px] font-medium text-slate-400 uppercase",children:e.jsx("span",{className:"bg-purple-100 dark:bg-purple-900/20 text-purple-500 px-1.5 py-0.5 rounded",children:"Data / Services Tier"})}),e.jsx("div",{className:"absolute top-[22%] left-[30%] right-0 h-px border-t border-dashed border-slate-300 dark:border-slate-600"}),e.jsx("div",{className:"absolute top-[22%] left-[30%] text-[8px] text-slate-400 bg-slate-50 dark:bg-slate-900/50 px-1 -translate-y-1/2",children:"DMZ / Perimeter"}),e.jsx("div",{className:"absolute top-[45%] left-0 right-0 h-px border-t border-dashed border-slate-300 dark:border-slate-600"}),e.jsx("div",{className:"absolute top-[45%] left-2 text-[8px] text-slate-400 bg-slate-50 dark:bg-slate-900/50 px-1 -translate-y-1/2",children:"Server VLAN"}),Bt.map((h,M)=>{const y=Ye.find(R=>R.id===h.from),B=Ye.find(R=>R.id===h.to);if(!y||!B)return null;const Y=h.type==="attack"?"bg-red-300 dark:bg-red-700":h.type==="lateral"?"bg-yellow-300 dark:bg-yellow-700":h.type==="exfil"?"bg-purple-300 dark:bg-purple-700":"bg-blue-300 dark:bg-blue-700",J=y.x,_=y.y,q=B.x,H=B.y;return e.jsxs("div",{className:"absolute pointer-events-none z-0",children:[e.jsx("div",{className:m("absolute h-[2px] rounded",Y),style:{top:`${_}%`,left:`${Math.min(J,q)}%`,width:`${Math.abs(q-J)}%`,opacity:.6}}),_!==H&&e.jsx("div",{className:m("absolute w-[2px] rounded",Y),style:{left:`${q}%`,top:`${Math.min(_,H)}%`,height:`${Math.abs(H-_)}%`,opacity:.6}}),e.jsx("div",{className:"absolute text-[7px] font-medium text-slate-500 bg-white/80 dark:bg-slate-800/80 px-0.5 rounded whitespace-nowrap",style:{top:`${(_+H)/2}%`,left:`${(J+q)/2}%`,transform:"translate(-50%, -50%)"},children:h.label})]},M)}),Ye.map(h=>{const M=(l==null?void 0:l.id)===h.id;return e.jsx(C,{content:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:h.label}),e.jsx("div",{className:"text-xs opacity-80",children:h.sublabel}),e.jsx("div",{className:"text-xs opacity-60",children:"Click for details"})]}),children:e.jsxs("button",{onClick:()=>c(M?null:h),className:m("absolute z-10 flex flex-col items-center gap-0.5 p-2 rounded-xl border-2 transition-all shadow-sm","hover:scale-110 hover:shadow-md min-w-[60px]",se(h.severity),M&&"ring-2 ring-forensic-500 ring-offset-2 scale-110 shadow-lg",h.type==="attacker"&&"border-red-500 bg-red-100 dark:bg-red-900/30"),style:{left:`${h.x}%`,top:`${h.y}%`,transform:"translate(-50%, -50%)"},children:[e.jsx("span",{className:m(h.type==="attacker"?"text-red-600":h.severity==="critical"?"text-red-500":h.severity==="high"?"text-orange-500":"text-slate-500"),children:h.icon}),e.jsx("span",{className:"text-[9px] font-bold text-slate-700 dark:text-slate-200 leading-none",children:h.label}),h.sublabel&&e.jsx("span",{className:"text-[7px] text-slate-400 leading-none",children:h.sublabel}),h.severity!=="none"&&e.jsx("span",{className:m("w-2 h-2 rounded-full absolute -top-0.5 -right-0.5",h.severity==="critical"?"bg-red-500 animate-pulse":h.severity==="high"?"bg-orange-500":h.severity==="medium"?"bg-yellow-500":"bg-green-500")})]})},h.id)})]}),l&&e.jsxs("div",{className:"p-4 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:m("w-10 h-10 rounded-full flex items-center justify-center",l.type==="attacker"?"bg-red-500 text-white":l.severity==="critical"?"bg-red-100 text-red-600 dark:bg-red-900/30":l.severity==="high"?"bg-orange-100 text-orange-600 dark:bg-orange-900/30":"bg-slate-100 text-slate-600 dark:bg-slate-700"),children:l.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-slate-100",children:l.label}),e.jsxs("p",{className:"text-sm text-slate-500",children:[l.sublabel,"  ",l.type]})]})]}),e.jsx("button",{onClick:()=>c(null),className:"p-1 hover:bg-slate-100 dark:hover:bg-slate-700 rounded",children:e.jsx(Fe,{className:"w-4 h-4 text-slate-400"})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-700/50 rounded-lg",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"Severity:"}),e.jsx("span",{className:m("ml-2 font-bold",l.severity==="critical"?"text-red-600":l.severity==="high"?"text-orange-600":"text-yellow-600"),children:l.severity.toUpperCase()})]}),e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-700/50 rounded-lg",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"Connections:"}),e.jsxs("span",{className:"ml-2 text-slate-700 dark:text-slate-300",children:[Bt.filter(h=>h.from===l.id||h.to===l.id).length," edges"]})]}),e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-700/50 rounded-lg col-span-2",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"Related Events:"}),e.jsx("div",{className:"mt-1 space-y-1",children:Bt.filter(h=>h.from===l.id||h.to===l.id).map((h,M)=>{const y=h.from===l.id?h.to:h.from,B=Ye.find(Y=>Y.id===y);return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:m("w-1.5 h-1.5 rounded-full",h.type==="attack"?"bg-red-500":h.type==="lateral"?"bg-yellow-500":h.type==="exfil"?"bg-purple-500":"bg-blue-500")}),e.jsxs("span",{className:"text-slate-600 dark:text-slate-400",children:[h.from===l.id?"":""," ",B==null?void 0:B.label,": ",e.jsx("span",{className:"font-medium",children:h.label})]})]},M)})})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(T,{className:"min-h-[500px]",children:[e.jsx(Z,{title:"Event Timeline",description:`${O.length} events  Jan 15, 2024`}),e.jsxs("div",{className:"mt-6 relative",children:[e.jsxs("div",{className:"flex justify-between text-xs text-slate-400 mb-4",children:[e.jsx("span",{children:"02:30"}),e.jsx("span",{children:"02:35"}),e.jsx("span",{children:"02:40"}),e.jsx("span",{children:"02:45"})]}),e.jsx("div",{className:"space-y-4",children:["Windows","Cloud","Network"].map(h=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-16 text-xs text-slate-500 text-right",children:h}),e.jsx("div",{className:"flex-1 h-10 bg-slate-100 dark:bg-slate-800 rounded relative",children:O.filter(M=>h==="Windows"?M.source.includes("windows"):h==="Cloud"?M.source.includes("azure"):M.source.includes("firewall")).map(M=>e.jsx(C,{content:M.title,children:e.jsx("button",{onClick:()=>n(M),className:m("absolute top-1/2 -translate-y-1/2 w-4 h-4 rounded-full transition-transform hover:scale-150 ring-2 ring-white dark:ring-slate-900",E(M.severity),(r==null?void 0:r.id)===M.id&&"ring-4 ring-forensic-400"),style:{left:`${(M.timestamp.getMinutes()-30)/15*100}%`}})},M.id))})]},h))})]}),e.jsx("div",{className:"mt-8 space-y-2",children:O.map(h=>e.jsxs("button",{onClick:()=>n(h),className:m("w-full flex items-center gap-3 p-3 rounded-lg text-left transition-colors",(r==null?void 0:r.id)===h.id?"bg-forensic-50 dark:bg-forensic-900/20 ring-1 ring-forensic-500":"hover:bg-slate-50 dark:hover:bg-slate-800/50"),children:[e.jsx("span",{className:"text-slate-400",children:$(h.source)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100 truncate",children:h.title}),e.jsx("p",{className:"text-xs text-slate-500 truncate",children:h.summary})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qt,{severity:h.severity,size:"sm"}),e.jsx("span",{className:"text-xs text-slate-400",children:sa(h.timestamp)})]})]},h.id))})]})}),e.jsx("div",{children:e.jsx(T,{className:"sticky top-24 min-h-[500px]",children:r?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-slate-100",children:r.title}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:al(r.timestamp)})]}),e.jsx("button",{onClick:()=>n(null),className:"p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded",children:e.jsx(Fe,{className:"w-4 h-4 text-slate-400"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsx(Qt,{severity:r.severity})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 uppercase mb-1",children:"Summary"}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:r.summary})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 uppercase mb-1",children:"Source"}),e.jsx(ce,{variant:"secondary",children:r.source.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 uppercase mb-1",children:"Category"}),e.jsx(ce,{variant:"info",children:r.category.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 uppercase mb-1",children:"Related Events"}),e.jsxs("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:[r.relatedCount," correlated event",r.relatedCount!==1?"s":""]})]}),e.jsxs("div",{children:[e.jsx(C,{content:"View full raw log data",children:e.jsxs(I,{variant:"outline",size:"sm",fullWidth:!0,children:[e.jsx(qa,{className:"w-3 h-3 mr-1"})," View Raw Log"]})}),e.jsx("pre",{className:"mt-2 text-xs bg-slate-900 text-slate-100 p-3 rounded-lg overflow-x-auto",children:r.rawLog})]})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center py-12",children:[e.jsx(Ne,{className:"w-12 h-12 text-slate-300 mb-3"}),e.jsx("p",{className:"text-slate-500",children:"Select an event to view details"})]})})})]})]})}const Pe=[{id:"1",title:"PsExec Remote Execution",category:"dual_use_tool",severity:"medium",confidence:65,description:"PsExec was used to execute commands on remote systems. This tool has legitimate administrative uses but is commonly abused by attackers.",evidence:[{type:"Event Log",content:"EventID 4688: Process PsExec.exe created"},{type:"Process",content:"Parent: cmd.exe, User: CORP\\admin_jsmith"}],historicalContext:"This user has used PsExec 3 times in the past month for legitimate patching.",expertGuidance:"Review the target systems and timing. PsExec usage outside maintenance windows is suspicious.",legitimateUseCases:["System patching","Remote administration","Incident response"],suspiciousIndicators:["Unusual timing (2:30 AM)","Multiple targets in sequence","SYSTEM privilege usage"]},{id:"2",title:"Bulk File Access",category:"data_theft",severity:"high",confidence:72,description:"Large number of files accessed from finance share in short timeframe.",evidence:[{type:"File Access",content:"1,247 files accessed in 15 minutes"},{type:"User Activity",content:"User: jsmith, Time: 02:35-02:50 AM"}],historicalContext:"User typically accesses 20-30 files per day during business hours.",expertGuidance:"This is a significant deviation from baseline. Check if there was authorized backup or migration.",legitimateUseCases:["Quarter-end reporting","Authorized backup","Department migration"],suspiciousIndicators:["Off-hours activity","6000% above baseline","Sensitive file types"]},{id:"3",title:"Scheduled Task Persistence",category:"persistence_mechanism",severity:"high",confidence:85,description:"New scheduled task created pointing to executable in Public folder.",evidence:[{type:"Task Details",content:"Task: WindowsUpdate, Action: C:\\Users\\Public\\update.exe"},{type:"Timing",content:"Created 3 minutes after initial compromise indicator"}],historicalContext:"No legitimate tasks have been created in Public folder in past year.",expertGuidance:"Tasks in Public folder are highly suspicious. Likely malicious persistence mechanism.",legitimateUseCases:["IT deployment scripts","Third-party installers"],suspiciousIndicators:["Public folder location","Generic task name","Timing correlation"]}];function kl(){const t=be(),{goToNextStep:s,goToPreviousStep:a}=me(),[r,n]=v.useState(0),[i,o]=v.useState({}),[l,c]=v.useState(""),d=Pe[r],p=Pe.length,f=Object.keys(i).length,g=()=>{a(),t("/timeline")},D=()=>{s(),t("/report")},w=()=>{r>0&&(n(r-1),c(""))},b=()=>{r<p-1&&(n(r+1),c(""))},N=k=>{o({...i,[d.id]:k})},P=()=>{const k={...i};Pe.forEach(S=>{k[S.id]||(k[S.id]="needs_investigation")}),o(k)},u=i[d.id];return e.jsxs(ke,{title:"Verification Wizard",subtitle:"Review and classify ambiguous findings",footer:e.jsx(Ae,{onBack:g,backLabel:"Timeline",onContinue:D,continueLabel:"Generate Report",continueDisabled:f<p}),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:["Finding ",r+1," of ",p]}),e.jsx(yt,{value:f/p*100,className:"w-32"}),e.jsxs("span",{className:"text-sm text-slate-500",children:[f," reviewed"]})]}),e.jsx(C,{content:"Accept defaults for remaining items",children:e.jsx(I,{variant:"ghost",size:"sm",onClick:P,leftIcon:e.jsx(Qa,{className:"w-4 h-4"}),children:"Skip All"})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(T,{className:"min-h-[500px]",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs(ce,{variant:"secondary",children:["#",r+1]}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:d.title})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qt,{severity:d.severity}),e.jsx(ce,{variant:"info",children:d.category.replace("_"," ")})]})]}),e.jsx("div",{className:"text-right",children:e.jsx(C,{content:"Automated confidence level",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-slate-500",children:"Confidence"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(yt,{value:d.confidence,size:"sm",className:"w-16",variant:d.confidence>75?"danger":d.confidence>50?"warning":"default"}),e.jsxs("span",{className:"text-sm font-medium",children:[d.confidence,"%"]})]})]})})})]}),e.jsx("div",{className:"mb-6",children:e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:d.description})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Evidence"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:d.evidence.map((k,S)=>e.jsx(C,{content:"View complete evidence",children:e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(St,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:k.type})]}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300 line-clamp-2",children:k.content})]})},S))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Classification"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(C,{content:"Confirm this activity as malicious based on evidence",children:e.jsxs("button",{onClick:()=>N("malicious"),className:m("flex-1 flex items-center justify-center gap-2 p-3 rounded-lg border-2 transition-colors",u==="malicious"?"border-red-500 bg-red-50 dark:bg-red-900/20":"border-slate-200 dark:border-slate-700 hover:border-red-300"),children:[e.jsx(Ke,{className:m("w-5 h-5",u==="malicious"?"text-red-500":"text-slate-400")}),e.jsx("span",{className:m("font-medium",u==="malicious"?"text-red-700 dark:text-red-300":"text-slate-600 dark:text-slate-400"),children:"Malicious"})]})}),e.jsx(C,{content:"Mark as legitimate activity",children:e.jsxs("button",{onClick:()=>N("benign"),className:m("flex-1 flex items-center justify-center gap-2 p-3 rounded-lg border-2 transition-colors",u==="benign"?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-slate-200 dark:border-slate-700 hover:border-green-300"),children:[e.jsx(X,{className:m("w-5 h-5",u==="benign"?"text-green-500":"text-slate-400")}),e.jsx("span",{className:m("font-medium",u==="benign"?"text-green-700 dark:text-green-300":"text-slate-600 dark:text-slate-400"),children:"Benign"})]})}),e.jsx(C,{content:"Flag for deeper analysis",children:e.jsxs("button",{onClick:()=>N("needs_investigation"),className:m("flex-1 flex items-center justify-center gap-2 p-3 rounded-lg border-2 transition-colors",u==="needs_investigation"?"border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20":"border-slate-200 dark:border-slate-700 hover:border-yellow-300"),children:[e.jsx(es,{className:m("w-5 h-5",u==="needs_investigation"?"text-yellow-500":"text-slate-400")}),e.jsx("span",{className:m("font-medium",u==="needs_investigation"?"text-yellow-700 dark:text-yellow-300":"text-slate-600 dark:text-slate-400"),children:"Investigate"})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 block",children:"Justification (optional)"}),e.jsx("textarea",{value:l,onChange:k=>c(k.target.value),placeholder:"Add notes for your decision...",className:"input min-h-[80px]"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(I,{variant:"ghost",onClick:w,disabled:r===0,leftIcon:e.jsx(Ja,{className:"w-4 h-4"}),children:"Previous"}),e.jsx("div",{className:"flex gap-1",children:Pe.map((k,S)=>e.jsx("button",{onClick:()=>n(S),className:m("w-3 h-3 rounded-full transition-colors",S===r?"bg-forensic-500":i[Pe[S].id]?i[Pe[S].id]==="malicious"?"bg-red-500":i[Pe[S].id]==="benign"?"bg-green-500":"bg-yellow-500":"bg-slate-300 dark:bg-slate-600")},S))}),e.jsx(I,{variant:"ghost",onClick:b,disabled:r===p-1,rightIcon:e.jsx(oe,{className:"w-4 h-4"}),children:"Next"})]})]})}),e.jsx("div",{children:e.jsxs(T,{className:"sticky top-24",children:[e.jsx(Z,{title:"Context"}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Za,{className:"w-4 h-4 text-slate-400"}),e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Historical Context"})]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:d.historicalContext})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(qt,{className:"w-4 h-4 text-yellow-500"}),e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Expert Guidance"})]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:d.expertGuidance})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Legitimate Use Cases"}),e.jsx("ul",{className:"space-y-1",children:d.legitimateUseCases.map((k,S)=>e.jsxs("li",{className:"text-sm text-slate-600 dark:text-slate-400 flex items-center gap-2",children:[e.jsx(X,{className:"w-3 h-3 text-green-500"}),k]},S))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Suspicious Indicators"}),e.jsx("ul",{className:"space-y-1",children:d.suspiciousIndicators.map((k,S)=>e.jsxs("li",{className:"text-sm text-slate-600 dark:text-slate-400 flex items-center gap-2",children:[e.jsx(et,{className:"w-3 h-3 text-red-500"}),k]},S))})]})]})]})})]})]})}const Sl=[{priority:"immediate",title:"Isolate affected systems",status:"pending",tooltip:"Network-isolate all compromised systems to prevent further lateral movement and data exfiltration.",example:'Disable network ports for WS-FIN-042, DC-MAIN-01 on the switch. Use firewall rules to block inter-VLAN traffic from Finance segment. In Palo Alto: set security policy deny from zone "Finance" to zone "any".',steps:["Identify all confirmed compromised hosts","Disable switch ports or apply ACLs","Block C2 IPs at perimeter firewall","Monitor for new outbound connections"],affectedAssets:[{name:"WS-FIN-042",type:"Workstation",os:"Windows 10",ip:"10.0.2.42",severity:"critical"},{name:"DC-MAIN-01",type:"Domain Controller",os:"Windows Server 2022",ip:"10.0.1.10",severity:"critical"},{name:"FS-FINANCE-01",type:"File Server",os:"Windows Server 2019",ip:"10.0.2.20",severity:"high"}]},{priority:"immediate",title:"Reset compromised credentials",status:"pending",tooltip:"Force password reset for all compromised accounts including service accounts. Revoke all active tokens and sessions.",example:'In Active Directory: Right-click user  Reset Password  Check "User must change password at next logon". For service accounts: Update password in AD and all services referencing it. Revoke Azure AD tokens: Revoke-AzureADUserAllRefreshToken -ObjectId <user-object-id>',steps:["Reset passwords for jsmith, admin.jsmith, svc-backup","Revoke all OAuth tokens and API keys","Invalidate Kerberos TGTs (krbtgt reset twice)","Update service account passwords in all dependent services"],affectedAssets:[{name:"jsmith@company.com",type:"User Account",os:"AD/Azure AD",ip:"-",severity:"critical"},{name:"admin.jsmith",type:"Admin Account",os:"Active Directory",ip:"-",severity:"critical"},{name:"svc-backup",type:"Service Account",os:"Active Directory",ip:"-",severity:"high"}]},{priority:"short_term",title:"Implement MFA for all admin accounts",status:"pending",tooltip:"Deploy multi-factor authentication for all privileged accounts to prevent credential-based attacks.",example:'Azure AD: Security  MFA  Conditional Access  New Policy  Target: "All Admin Roles"  Grant: "Require MFA". For on-prem: Deploy Duo or Azure MFA Server for RDP and VPN access. Use FIDO2 keys for domain admins.',steps:["Audit all accounts with admin privileges","Enable Azure AD Conditional Access with MFA requirement","Deploy hardware tokens (FIDO2) for domain admins","Configure MFA for VPN and RDP gateways"],affectedAssets:[{name:"All Admin Accounts",type:"Identity",os:"Azure AD / AD",ip:"-",severity:"high"},{name:"VPN Gateway",type:"Network Device",os:"Palo Alto GlobalProtect",ip:"10.0.0.1",severity:"high"}]},{priority:"short_term",title:"Deploy EDR solution",status:"pending",tooltip:"Install endpoint detection and response (EDR) on all endpoints for real-time threat detection and automated response.",example:'Deploy CrowdStrike Falcon or Microsoft Defender for Endpoint. Use Group Policy to push MSI: msiexec /i WindowsSensor.exe CID=<your-customer-id> /quiet. Set detection policy to "Extra Aggressive" during incident recovery.',steps:["Select EDR vendor (CrowdStrike, SentinelOne, MDE)","Deploy agent to all Windows and Linux endpoints via GPO/SCCM","Configure detection policies and automated response","Integrate with SIEM for centralized alerting"],affectedAssets:[{name:"All Endpoints",type:"Fleet",os:"Windows/Linux",ip:"Multiple",severity:"medium"},{name:"DC-MAIN-01",type:"Domain Controller",os:"Windows Server 2022",ip:"10.0.1.10",severity:"critical"}]},{priority:"long_term",title:"Security awareness training",status:"pending",tooltip:"Conduct organization-wide security awareness training with focus on phishing identification and reporting procedures.",example:'Use KnowBe4 or Proofpoint Security Awareness: Set up monthly phishing simulations. Track click rates by department. Finance dept gets additional targeted training due to this incident. Add "Report Phish" button to Outlook.',steps:["Select awareness training platform","Conduct baseline phishing simulation","Deploy monthly phishing tests with increasing difficulty","Require completion of anti-phishing training module","Implement phishing report button in email client"],affectedAssets:[{name:"Finance Department",type:"Department",os:"-",ip:"-",severity:"high"},{name:"All Employees",type:"Organization",os:"-",ip:"-",severity:"medium"}]}],Cl=[{category:"Detection",current:2,target:4,gap:"No behavioral analytics",remediation:"Deploy UEBA solution (e.g., Microsoft Sentinel UEBA, Exabeam) to detect anomalous user behavior patterns like unusual login times, impossible travel, and mass file access.",example:"In Microsoft Sentinel: Analytics  UEBA  Enable for all users. Configure detection rules for: Anomalous login locations, First-time VPN connections, Mass file downloads exceeding baseline by 3x."},{category:"Response",current:3,target:4,gap:"Manual playbooks only",remediation:"Implement SOAR platform (e.g., Palo Alto XSOAR, Splunk SOAR) to automate incident response playbooks for common scenarios like phishing, ransomware, and unauthorized access.",example:"Create automated playbook: Phishing detected  Extract IOCs  Block sender in email gateway  Search mailboxes for similar  Isolate affected endpoints  Notify SOC analyst  Create ticket."},{category:"Prevention",current:2,target:5,gap:"Limited email security",remediation:"Upgrade email security with advanced threat protection: sandboxing, URL rewriting, impersonation protection, and DMARC/DKIM/SPF enforcement.",example:"Deploy Proofpoint or Mimecast ATP. Configure: Attachment sandboxing (detonate in VM), URL rewriting with click-time analysis, Brand impersonation protection, DMARC policy p=reject."}];function Dl(){const t=be(),{goToPreviousStep:s}=me(),[a,r]=v.useState("pdf"),[n,i]=v.useState(!1),[o,l]=v.useState(!0),[c,d]=v.useState(null),[p,f]=v.useState(null),[g,D]=v.useState(!1),w=()=>{s(),t("/verification")},b=()=>{alert(`Exporting report as ${a.toUpperCase()}...`)},N=()=>{t("/")},P={incidentSummary:"Ransomware attack via phishing email targeting finance department",affectedSystems:12,totalFindings:23,criticalFindings:5,timeToDetection:"4 hours",dataAtRisk:"Customer PII, Financial Records",businessImpact:{operational:"high",financial:"medium",reputational:"low",regulatory:"high"}};return e.jsx(ke,{title:"Report Generation",subtitle:"Review and export the investigation report",footer:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(I,{variant:"ghost",onClick:w,children:"Back to Verification"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{variant:"secondary",onClick:N,children:"New Investigation"}),e.jsx(C,{content:`Export report as ${a.toUpperCase()}`,children:e.jsx(I,{onClick:b,leftIcon:e.jsx(Ze,{className:"w-4 h-4"}),children:"Export Report"})})]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsx(T,{className:"bg-gradient-to-br from-slate-50 to-white dark:from-slate-800 dark:to-slate-800/50",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-forensic-100 dark:bg-forensic-900/30 rounded-lg",children:e.jsx(fe,{className:"w-6 h-6 text-forensic-600 dark:text-forensic-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 mb-2",children:"Executive Summary"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-4",children:P.incidentSummary}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsx(pt,{icon:e.jsx(Es,{className:"w-4 h-4"}),label:"Affected Systems",value:P.affectedSystems}),e.jsx(pt,{icon:e.jsx(et,{className:"w-4 h-4"}),label:"Total Findings",value:P.totalFindings,subValue:`${P.criticalFindings} critical`}),e.jsx(pt,{icon:e.jsx(rt,{className:"w-4 h-4"}),label:"Time to Detect",value:P.timeToDetection}),e.jsx(pt,{icon:e.jsx(Ne,{className:"w-4 h-4"}),label:"Data at Risk",value:P.dataAtRisk,small:!0})]})]})]})}),e.jsxs(T,{children:[e.jsxs("button",{onClick:()=>D(!g),className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tt,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Attack Chain Visualization"})]}),g?e.jsx(pe,{className:"w-5 h-5 text-slate-400"}):e.jsx(oe,{className:"w-5 h-5 text-slate-400"})]}),g&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsx("div",{className:"flex items-center gap-1 overflow-x-auto pb-2",children:[{phase:"Initial Access",icon:e.jsx(ge,{className:"w-3 h-3"}),color:"bg-red-500"},{phase:"Execution",icon:e.jsx(Ne,{className:"w-3 h-3"}),color:"bg-red-600"},{phase:"Persistence",icon:e.jsx($t,{className:"w-3 h-3"}),color:"bg-orange-500"},{phase:"Priv. Escalation",icon:e.jsx(Yt,{className:"w-3 h-3"}),color:"bg-orange-600"},{phase:"Lateral Movement",icon:e.jsx(he,{className:"w-3 h-3"}),color:"bg-yellow-500"},{phase:"Collection",icon:e.jsx(we,{className:"w-3 h-3"}),color:"bg-yellow-600"},{phase:"Exfiltration",icon:e.jsx(K,{className:"w-3 h-3"}),color:"bg-purple-500"},{phase:"Impact",icon:e.jsx(ie,{className:"w-3 h-3"}),color:"bg-red-700"}].map((u,k,S)=>e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:m("flex items-center gap-1 px-2 py-1 rounded text-white text-[10px] font-medium whitespace-nowrap",u.color),children:[u.icon,u.phase]}),k<S.length-1&&e.jsx(at,{className:"w-3 h-3 text-slate-300 mx-0.5 flex-shrink-0"})]},k))}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/10 rounded-lg border border-red-200 dark:border-red-900/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(tt,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"text-xs font-medium text-red-700 dark:text-red-400",children:"Threat Actor"})]}),e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400",children:"External, IP: 185.220.101.42"}),e.jsx("p",{className:"text-xs text-red-500",children:"Tools: PsExec, Mimikatz"})]}),e.jsxs("div",{className:"p-3 bg-orange-50 dark:bg-orange-900/10 rounded-lg border border-orange-200 dark:border-orange-900/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(er,{className:"w-4 h-4 text-orange-500"}),e.jsx("span",{className:"text-xs font-medium text-orange-700 dark:text-orange-400",children:"Compromised Users"})]}),e.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400",children:"jsmith, admin.jsmith, svc-backup"}),e.jsx("p",{className:"text-xs text-orange-500",children:"3 accounts compromised"})]}),e.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900/10 rounded-lg border border-purple-200 dark:border-purple-900/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(re,{className:"w-4 h-4 text-purple-500"}),e.jsx("span",{className:"text-xs font-medium text-purple-700 dark:text-purple-400",children:"Affected Systems"})]}),e.jsx("p",{className:"text-xs text-purple-600 dark:text-purple-400",children:"12 systems across 4 segments"}),e.jsx("p",{className:"text-xs text-purple-500",children:"5 critical, 4 high, 3 medium"})]})]})]})]}),e.jsxs(T,{children:[e.jsx(Z,{title:"Business Impact Assessment",description:"Impact across key business dimensions"}),e.jsx("div",{className:"mt-4 grid grid-cols-2 sm:grid-cols-4 gap-4",children:Object.entries(P.businessImpact).map(([u,k])=>e.jsx(Pl,{dimension:u,level:k},u))})]}),e.jsxs(T,{children:[e.jsx(Z,{title:"Recommendations & Mitigations",description:"Prioritized actions with implementation guidance"}),e.jsx("div",{className:"mt-4 space-y-3",children:Sl.map((u,k)=>e.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>d(c===k?null:k),className:"w-full flex items-center gap-3 p-3 hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsx(ce,{variant:u.priority==="immediate"?"danger":u.priority==="short_term"?"warning":"info",size:"sm",children:u.priority.replace("_"," ")}),e.jsx("span",{className:"flex-1 text-sm text-slate-700 dark:text-slate-300 text-left",children:u.title}),e.jsx(C,{content:u.tooltip,children:e.jsx(Gt,{className:"w-4 h-4 text-slate-400 hover:text-forensic-500"})}),e.jsx(ce,{variant:"secondary",size:"sm",children:u.status}),c===k?e.jsx(pe,{className:"w-4 h-4 text-slate-400"}):e.jsx(oe,{className:"w-4 h-4 text-slate-400"})]}),c===k&&e.jsxs("div",{className:"px-4 pb-4 space-y-4 border-t border-slate-200 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-800/30",children:[e.jsxs("div",{className:"pt-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ls,{className:"w-4 h-4 text-forensic-500"}),e.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase",children:"Implementation Steps"})]}),e.jsx("ol",{className:"space-y-1.5 ml-4",children:u.steps.map((S,O)=>e.jsxs("li",{className:"text-xs text-slate-600 dark:text-slate-400 flex gap-2",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-forensic-100 dark:bg-forensic-900/30 text-forensic-600 dark:text-forensic-400 flex items-center justify-center text-[10px] font-bold flex-shrink-0",children:O+1}),S]},O))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(qt,{className:"w-4 h-4 text-yellow-500"}),e.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase",children:"Practical Example"})]}),e.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/10 border border-yellow-200 dark:border-yellow-900/50 rounded-lg",children:e.jsx("p",{className:"text-xs text-yellow-800 dark:text-yellow-300 leading-relaxed",children:u.example})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Me,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{className:"text-xs font-medium text-slate-500 uppercase",children:["Affected Assets (",u.affectedAssets.length,")"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-slate-400 uppercase",children:[e.jsx("th",{className:"pb-1.5 pr-3",children:"Asset"}),e.jsx("th",{className:"pb-1.5 pr-3",children:"Type"}),e.jsx("th",{className:"pb-1.5 pr-3",children:"OS/Platform"}),e.jsx("th",{className:"pb-1.5 pr-3",children:"IP"}),e.jsx("th",{className:"pb-1.5",children:"Severity"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:u.affectedAssets.map((S,O)=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-1.5 pr-3 font-medium text-slate-700 dark:text-slate-300",children:S.name}),e.jsx("td",{className:"py-1.5 pr-3 text-slate-500",children:S.type}),e.jsx("td",{className:"py-1.5 pr-3 text-slate-500",children:S.os}),e.jsx("td",{className:"py-1.5 pr-3 font-mono text-slate-500",children:S.ip}),e.jsx("td",{className:"py-1.5",children:e.jsx("span",{className:m("px-1.5 py-0.5 rounded text-[10px] font-medium",S.severity==="critical"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":S.severity==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"),children:S.severity})})]},O))})]})})]})]})]},k))})]}),e.jsxs(T,{children:[e.jsx(Z,{title:"Gap Analysis",description:"Security maturity assessment with remediation guidance"}),e.jsx("div",{className:"mt-4 space-y-4",children:Cl.map((u,k)=>e.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>f(p===k?null:k),className:"w-full p-3 hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:u.category}),e.jsx(C,{content:u.remediation,children:e.jsx(Gt,{className:"w-3.5 h-3.5 text-slate-400 hover:text-forensic-500"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-slate-500",children:[u.current,"/",u.target]}),p===k?e.jsx(pe,{className:"w-4 h-4 text-slate-400"}):e.jsx(oe,{className:"w-4 h-4 text-slate-400"})]})]}),e.jsx(yt,{value:u.current/u.target*100,variant:u.current<u.target*.5?"danger":"warning"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1 text-left",children:u.gap})]}),p===k&&e.jsxs("div",{className:"px-4 pb-4 space-y-3 border-t border-slate-200 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-800/30",children:[e.jsxs("div",{className:"pt-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ls,{className:"w-4 h-4 text-forensic-500"}),e.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase",children:"Remediation Plan"})]}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400 leading-relaxed",children:u.remediation})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(qt,{className:"w-4 h-4 text-yellow-500"}),e.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase",children:"Example Configuration"})]}),e.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/10 border border-yellow-200 dark:border-yellow-900/50 rounded-lg",children:e.jsx("p",{className:"text-xs text-yellow-800 dark:text-yellow-300 leading-relaxed",children:u.example})})]})]})]},k))})]})]}),e.jsx("div",{children:e.jsxs(T,{className:"sticky top-24",children:[e.jsx(Z,{title:"Export Options"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 block",children:"Format"}),e.jsx("div",{className:"space-y-2",children:[{id:"pdf",icon:e.jsx(St,{className:"w-4 h-4"}),label:"PDF Document"},{id:"html",icon:e.jsx(os,{className:"w-4 h-4"}),label:"Interactive HTML"},{id:"json",icon:e.jsx(os,{className:"w-4 h-4"}),label:"JSON Data"}].map(u=>e.jsx(C,{content:`Export as ${u.label}`,children:e.jsxs("button",{onClick:()=>r(u.id),className:m("w-full flex items-center gap-2 p-2 rounded-lg border transition-colors",a===u.id?"border-forensic-500 bg-forensic-50 dark:bg-forensic-900/20":"border-slate-200 dark:border-slate-700 hover:border-slate-300"),children:[u.icon,e.jsx("span",{className:"text-sm",children:u.label}),a===u.id&&e.jsx(X,{className:"w-4 h-4 text-forensic-500 ml-auto"})]})},u.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 block",children:"Content Options"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{content:"Include raw log data in export",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:n,onChange:u=>i(u.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Include raw logs"})]})}),e.jsx(C,{content:"Automatically redact sensitive data",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:u=>l(u.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Redact sensitive data"})]})})]})]}),e.jsxs("div",{className:"pt-4 border-t border-slate-200 dark:border-slate-700 space-y-2",children:[e.jsx(C,{content:"Generate downloadable PDF report with current findings",children:e.jsx(I,{fullWidth:!0,onClick:b,leftIcon:e.jsx(Ze,{className:"w-4 h-4"}),children:"Export Report"})}),e.jsx(C,{content:"Open print preview",children:e.jsx(I,{variant:"outline",fullWidth:!0,leftIcon:e.jsx(tr,{className:"w-4 h-4"}),children:"Print Preview"})}),e.jsx(C,{content:"Generate shareable link",children:e.jsx(I,{variant:"ghost",fullWidth:!0,leftIcon:e.jsx(sr,{className:"w-4 h-4"}),children:"Share Link"})})]})]})]})})]})})}function pt({icon:t,label:s,value:a,subValue:r,small:n}){return e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-1",children:[t,e.jsx("span",{className:"text-xs",children:s})]}),e.jsx("p",{className:m("font-bold text-slate-900 dark:text-slate-100",n?"text-sm":"text-lg"),children:a}),r&&e.jsx("p",{className:"text-xs text-red-500",children:r})]})}function Pl({dimension:t,level:s}){const a={low:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",high:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"};return e.jsxs("div",{className:"text-center p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase mb-1 capitalize",children:t}),e.jsx("span",{className:m("px-3 py-1 rounded-full text-sm font-medium capitalize",a[s]),children:s})]})}function Il(){return e.jsx(Or,{delayDuration:300,children:e.jsxs(Ca,{children:[e.jsx(ne,{path:"/",element:e.jsx(il,{})}),e.jsx(ne,{path:"/context",element:e.jsx(dl,{})}),e.jsx(ne,{path:"/incident",element:e.jsx(xl,{})}),e.jsx(ne,{path:"/connectors",element:e.jsx(hl,{})}),e.jsx(ne,{path:"/validation",element:e.jsx(gl,{})}),e.jsx(ne,{path:"/triage",element:e.jsx(bl,{})}),e.jsx(ne,{path:"/timeline",element:e.jsx(Nl,{})}),e.jsx(ne,{path:"/verification",element:e.jsx(kl,{})}),e.jsx(ne,{path:"/report",element:e.jsx(Dl,{})}),e.jsx(ne,{path:"*",element:e.jsx(Da,{to:"/",replace:!0})})]})})}Us.getState().initializeTheme();const Ml="/SSF/".replace(/\/$/,"")||"/";Xt.createRoot(document.getElementById("root")).render(e.jsx(qe.StrictMode,{children:e.jsx(Pa,{basename:Ml,children:e.jsx(Il,{})})}));
//# sourceMappingURL=index-B6mbmz7w.js.map
