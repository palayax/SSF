import{j as e,R as ts,T as ss,P as ns,C as rs,A as as,a as is,b as os,I as cs,c as ls,d as ds,O as us,e as ms,f as hs,D as xs,g as fs}from"./radix-uGlnZHxF.js";import{a as gs,r as N,c as we,L as ps,u as q,d as bs,e as W,N as ws,B as vs}from"./vendor-DrAsnYEO.js";import{c as ys,A as js,m as rt,a as Ns,T as ks,L as Ss,U as Dt,b as Cs,G as Mt,B as Ds,C as Ne,d as Ms,e as U,S as Pt,N as Ps,f as Le,F as Fe,E as Is,X as Qe,g as Ts,h as at,i as It,M as Es,P as Os,j as As,k as Rs,H as Ls,l as it,n as Ie,o as Fs,p as _s,q as Tt,r as Je,s as Ze,t as Ke,u as zs,v as Ws,R as Et,D as He,w as ot,x as Ys,y as Bs,z as $s,I as Ee,J as Vs,K as Gs,O as ct,Z as Hs,Q as Us,V as qs,W as Xs,Y as Qs,_ as Js,$ as Zs,a0 as Ks,a1 as en,a2 as lt,a3 as tn,a4 as sn}from"./ui-G1fd7QJO.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var Ue={},dt=gs;Ue.createRoot=dt.createRoot,Ue.hydrateRoot=dt.hydrateRoot;const et="-",nn=t=>{const s=an(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:c=>{const o=c.split(et);return o[0]===""&&o.length!==1&&o.shift(),Ot(o,s)||rn(c)},getConflictingClassGroupIds:(c,o)=>{const l=n[c]||[];return o&&r[c]?[...l,...r[c]]:l}}},Ot=(t,s)=>{var c;if(t.length===0)return s.classGroupId;const n=t[0],r=s.nextPart.get(n),a=r?Ot(t.slice(1),r):void 0;if(a)return a;if(s.validators.length===0)return;const i=t.join(et);return(c=s.validators.find(({validator:o})=>o(i)))==null?void 0:c.classGroupId},ut=/^\[(.+)\]$/,rn=t=>{if(ut.test(t)){const s=ut.exec(t)[1],n=s==null?void 0:s.substring(0,s.indexOf(":"));if(n)return"arbitrary.."+n}},an=t=>{const{theme:s,prefix:n}=t,r={nextPart:new Map,validators:[]};return cn(Object.entries(t.classGroups),n).forEach(([i,c])=>{qe(c,r,i,s)}),r},qe=(t,s,n,r)=>{t.forEach(a=>{if(typeof a=="string"){const i=a===""?s:mt(s,a);i.classGroupId=n;return}if(typeof a=="function"){if(on(a)){qe(a(r),s,n,r);return}s.validators.push({validator:a,classGroupId:n});return}Object.entries(a).forEach(([i,c])=>{qe(c,mt(s,i),n,r)})})},mt=(t,s)=>{let n=t;return s.split(et).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},on=t=>t.isThemeGetter,cn=(t,s)=>s?t.map(([n,r])=>{const a=r.map(i=>typeof i=="string"?s+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([c,o])=>[s+c,o])):i);return[n,a]}):t,ln=t=>{if(t<1)return{get:()=>{},set:()=>{}};let s=0,n=new Map,r=new Map;const a=(i,c)=>{n.set(i,c),s++,s>t&&(s=0,r=n,n=new Map)};return{get(i){let c=n.get(i);if(c!==void 0)return c;if((c=r.get(i))!==void 0)return a(i,c),c},set(i,c){n.has(i)?n.set(i,c):a(i,c)}}},At="!",dn=t=>{const{separator:s,experimentalParseClassName:n}=t,r=s.length===1,a=s[0],i=s.length,c=o=>{const l=[];let d=0,m=0,h;for(let p=0;p<o.length;p++){let v=o[p];if(d===0){if(v===a&&(r||o.slice(p,p+i)===s)){l.push(o.slice(m,p)),m=p+i;continue}if(v==="/"){h=p;continue}}v==="["?d++:v==="]"&&d--}const u=l.length===0?o:o.substring(m),w=u.startsWith(At),f=w?u.substring(1):u,x=h&&h>m?h-m:void 0;return{modifiers:l,hasImportantModifier:w,baseClassName:f,maybePostfixModifierPosition:x}};return n?o=>n({className:o,parseClassName:c}):c},un=t=>{if(t.length<=1)return t;const s=[];let n=[];return t.forEach(r=>{r[0]==="["?(s.push(...n.sort(),r),n=[]):n.push(r)}),s.push(...n.sort()),s},mn=t=>({cache:ln(t.cacheSize),parseClassName:dn(t),...nn(t)}),hn=/\s+/,xn=(t,s)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:a}=s,i=[],c=t.trim().split(hn);let o="";for(let l=c.length-1;l>=0;l-=1){const d=c[l],{modifiers:m,hasImportantModifier:h,baseClassName:u,maybePostfixModifierPosition:w}=n(d);let f=!!w,x=r(f?u.substring(0,w):u);if(!x){if(!f){o=d+(o.length>0?" "+o:o);continue}if(x=r(u),!x){o=d+(o.length>0?" "+o:o);continue}f=!1}const p=un(m).join(":"),v=h?p+At:p,g=v+x;if(i.includes(g))continue;i.push(g);const S=a(x,f);for(let j=0;j<S.length;++j){const E=S[j];i.push(v+E)}o=d+(o.length>0?" "+o:o)}return o};function fn(){let t=0,s,n,r="";for(;t<arguments.length;)(s=arguments[t++])&&(n=Rt(s))&&(r&&(r+=" "),r+=n);return r}const Rt=t=>{if(typeof t=="string")return t;let s,n="";for(let r=0;r<t.length;r++)t[r]&&(s=Rt(t[r]))&&(n&&(n+=" "),n+=s);return n};function gn(t,...s){let n,r,a,i=c;function c(l){const d=s.reduce((m,h)=>h(m),t());return n=mn(d),r=n.cache.get,a=n.cache.set,i=o,o(l)}function o(l){const d=r(l);if(d)return d;const m=xn(l,n);return a(l,m),m}return function(){return i(fn.apply(null,arguments))}}const T=t=>{const s=n=>n[t]||[];return s.isThemeGetter=!0,s},Lt=/^\[(?:([a-z-]+):)?(.+)\]$/i,pn=/^\d+\/\d+$/,bn=new Set(["px","full","screen"]),wn=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,vn=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,yn=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,jn=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Nn=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,G=t=>le(t)||bn.has(t)||pn.test(t),X=t=>de(t,"length",Tn),le=t=>!!t&&!Number.isNaN(Number(t)),Ye=t=>de(t,"number",le),he=t=>!!t&&Number.isInteger(Number(t)),kn=t=>t.endsWith("%")&&le(t.slice(0,-1)),k=t=>Lt.test(t),Q=t=>wn.test(t),Sn=new Set(["length","size","percentage"]),Cn=t=>de(t,Sn,Ft),Dn=t=>de(t,"position",Ft),Mn=new Set(["image","url"]),Pn=t=>de(t,Mn,On),In=t=>de(t,"",En),xe=()=>!0,de=(t,s,n)=>{const r=Lt.exec(t);return r?r[1]?typeof s=="string"?r[1]===s:s.has(r[1]):n(r[2]):!1},Tn=t=>vn.test(t)&&!yn.test(t),Ft=()=>!1,En=t=>jn.test(t),On=t=>Nn.test(t),An=()=>{const t=T("colors"),s=T("spacing"),n=T("blur"),r=T("brightness"),a=T("borderColor"),i=T("borderRadius"),c=T("borderSpacing"),o=T("borderWidth"),l=T("contrast"),d=T("grayscale"),m=T("hueRotate"),h=T("invert"),u=T("gap"),w=T("gradientColorStops"),f=T("gradientColorStopPositions"),x=T("inset"),p=T("margin"),v=T("opacity"),g=T("padding"),S=T("saturate"),j=T("scale"),E=T("sepia"),_=T("skew"),M=T("space"),F=T("translate"),K=()=>["auto","contain","none"],re=()=>["auto","hidden","clip","visible","scroll"],O=()=>["auto",k,s],C=()=>[k,s],z=()=>["",G,X],R=()=>["auto",le,k],ue=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ae=()=>["solid","dashed","dotted","double","none"],ie=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],We=()=>["start","end","center","between","around","evenly","stretch"],me=()=>["","0",k],nt=()=>["auto","avoid","all","avoid-page","page","left","right","column"],V=()=>[le,k];return{cacheSize:500,separator:":",theme:{colors:[xe],spacing:[G,X],blur:["none","",Q,k],brightness:V(),borderColor:[t],borderRadius:["none","","full",Q,k],borderSpacing:C(),borderWidth:z(),contrast:V(),grayscale:me(),hueRotate:V(),invert:me(),gap:C(),gradientColorStops:[t],gradientColorStopPositions:[kn,X],inset:O(),margin:O(),opacity:V(),padding:C(),saturate:V(),scale:V(),sepia:me(),skew:V(),space:C(),translate:C()},classGroups:{aspect:[{aspect:["auto","square","video",k]}],container:["container"],columns:[{columns:[Q]}],"break-after":[{"break-after":nt()}],"break-before":[{"break-before":nt()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ue(),k]}],overflow:[{overflow:re()}],"overflow-x":[{"overflow-x":re()}],"overflow-y":[{"overflow-y":re()}],overscroll:[{overscroll:K()}],"overscroll-x":[{"overscroll-x":K()}],"overscroll-y":[{"overscroll-y":K()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",he,k]}],basis:[{basis:O()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",k]}],grow:[{grow:me()}],shrink:[{shrink:me()}],order:[{order:["first","last","none",he,k]}],"grid-cols":[{"grid-cols":[xe]}],"col-start-end":[{col:["auto",{span:["full",he,k]},k]}],"col-start":[{"col-start":R()}],"col-end":[{"col-end":R()}],"grid-rows":[{"grid-rows":[xe]}],"row-start-end":[{row:["auto",{span:[he,k]},k]}],"row-start":[{"row-start":R()}],"row-end":[{"row-end":R()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",k]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",k]}],gap:[{gap:[u]}],"gap-x":[{"gap-x":[u]}],"gap-y":[{"gap-y":[u]}],"justify-content":[{justify:["normal",...We()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...We(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...We(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[g]}],px:[{px:[g]}],py:[{py:[g]}],ps:[{ps:[g]}],pe:[{pe:[g]}],pt:[{pt:[g]}],pr:[{pr:[g]}],pb:[{pb:[g]}],pl:[{pl:[g]}],m:[{m:[p]}],mx:[{mx:[p]}],my:[{my:[p]}],ms:[{ms:[p]}],me:[{me:[p]}],mt:[{mt:[p]}],mr:[{mr:[p]}],mb:[{mb:[p]}],ml:[{ml:[p]}],"space-x":[{"space-x":[M]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[M]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",k,s]}],"min-w":[{"min-w":[k,s,"min","max","fit"]}],"max-w":[{"max-w":[k,s,"none","full","min","max","fit","prose",{screen:[Q]},Q]}],h:[{h:[k,s,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[k,s,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[k,s,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[k,s,"auto","min","max","fit"]}],"font-size":[{text:["base",Q,X]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Ye]}],"font-family":[{font:[xe]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",k]}],"line-clamp":[{"line-clamp":["none",le,Ye]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",G,k]}],"list-image":[{"list-image":["none",k]}],"list-style-type":[{list:["none","disc","decimal",k]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ae(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",G,X]}],"underline-offset":[{"underline-offset":["auto",G,k]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:C()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",k]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",k]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ue(),Dn]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Cn]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Pn]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[f]}],"gradient-via-pos":[{via:[f]}],"gradient-to-pos":[{to:[f]}],"gradient-from":[{from:[w]}],"gradient-via":[{via:[w]}],"gradient-to":[{to:[w]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[...ae(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:ae()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...ae()]}],"outline-offset":[{"outline-offset":[G,k]}],"outline-w":[{outline:[G,X]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[G,X]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Q,In]}],"shadow-color":[{shadow:[xe]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":[...ie(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ie()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Q,k]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[m]}],invert:[{invert:[h]}],saturate:[{saturate:[S]}],sepia:[{sepia:[E]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[m]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[S]}],"backdrop-sepia":[{"backdrop-sepia":[E]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[c]}],"border-spacing-x":[{"border-spacing-x":[c]}],"border-spacing-y":[{"border-spacing-y":[c]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",k]}],duration:[{duration:V()}],ease:[{ease:["linear","in","out","in-out",k]}],delay:[{delay:V()}],animate:[{animate:["none","spin","ping","pulse","bounce",k]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[he,k]}],"translate-x":[{"translate-x":[F]}],"translate-y":[{"translate-y":[F]}],"skew-x":[{"skew-x":[_]}],"skew-y":[{"skew-y":[_]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",k]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",k]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":C()}],"scroll-mx":[{"scroll-mx":C()}],"scroll-my":[{"scroll-my":C()}],"scroll-ms":[{"scroll-ms":C()}],"scroll-me":[{"scroll-me":C()}],"scroll-mt":[{"scroll-mt":C()}],"scroll-mr":[{"scroll-mr":C()}],"scroll-mb":[{"scroll-mb":C()}],"scroll-ml":[{"scroll-ml":C()}],"scroll-p":[{"scroll-p":C()}],"scroll-px":[{"scroll-px":C()}],"scroll-py":[{"scroll-py":C()}],"scroll-ps":[{"scroll-ps":C()}],"scroll-pe":[{"scroll-pe":C()}],"scroll-pt":[{"scroll-pt":C()}],"scroll-pr":[{"scroll-pr":C()}],"scroll-pb":[{"scroll-pb":C()}],"scroll-pl":[{"scroll-pl":C()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",k]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[G,X,Ye]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Rn=gn(An);function b(...t){return Rn(ys(t))}const Ln=is;function y({content:t,children:s,side:n="top",align:r="center",delayDuration:a=300,disabled:i=!1,className:c}){return i||!t?e.jsx(e.Fragment,{children:s}):e.jsxs(ts,{delayDuration:a,children:[e.jsx(ss,{asChild:!0,children:s}),e.jsx(ns,{children:e.jsxs(rs,{side:n,align:r,sideOffset:5,className:b("z-50 overflow-hidden rounded-md px-3 py-1.5 text-sm","bg-slate-900 text-slate-50 dark:bg-slate-50 dark:text-slate-900","shadow-md animate-fade-in","max-w-xs",c),children:[t,e.jsx(as,{className:"fill-slate-900 dark:fill-slate-50",width:10,height:5})]})})]})}function _t({content:t,icon:s,className:n}){return e.jsx(y,{content:t,children:e.jsx("span",{className:b("inline-flex items-center justify-center","text-slate-400 hover:text-slate-600 dark:text-slate-500 dark:hover:text-slate-300","cursor-help",n),children:s||e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),e.jsx("path",{d:"M12 17h.01"})]})})})}const Fn={primary:b("bg-forensic-500 hover:bg-forensic-600 active:bg-forensic-700","text-white","border border-transparent","shadow-sm"),secondary:b("bg-slate-100 hover:bg-slate-200 active:bg-slate-300","dark:bg-slate-700 dark:hover:bg-slate-600 dark:active:bg-slate-500","text-slate-900 dark:text-slate-100","border border-transparent"),ghost:b("bg-transparent hover:bg-slate-100 active:bg-slate-200","dark:hover:bg-slate-800 dark:active:bg-slate-700","text-slate-700 dark:text-slate-300","border border-transparent"),danger:b("bg-red-500 hover:bg-red-600 active:bg-red-700","text-white","border border-transparent","shadow-sm"),outline:b("bg-transparent hover:bg-slate-50 active:bg-slate-100","dark:hover:bg-slate-800 dark:active:bg-slate-700","text-slate-700 dark:text-slate-300","border border-slate-300 dark:border-slate-600")},_n={sm:"h-8 px-3 text-sm gap-1.5",md:"h-10 px-4 text-sm gap-2",lg:"h-12 px-6 text-base gap-2.5"},D=N.forwardRef(({className:t,variant:s="primary",size:n="md",leftIcon:r,rightIcon:a,isLoading:i,tooltip:c,fullWidth:o,disabled:l,children:d,...m},h)=>{const u=e.jsxs("button",{ref:h,disabled:l||i,className:b("inline-flex items-center justify-center","font-medium rounded-lg","transition-colors duration-200","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-forensic-500 focus-visible:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none",Fn[s],_n[n],o&&"w-full",t),...m,children:[i?e.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):r,d,!i&&a]});return c?e.jsx(y,{content:c,children:u}):u});D.displayName="Button";const zn=N.forwardRef(({className:t,size:s="md",icon:n,...r},a)=>{const i={sm:"h-8 w-8",md:"h-10 w-10",lg:"h-12 w-12"};return e.jsx(D,{ref:a,size:s,className:b("!p-0",i[s],t),...r,children:n})});zn.displayName="IconButton";const Wn={none:"",sm:"p-3",md:"p-4",lg:"p-6"},I=N.forwardRef(({className:t,hoverable:s=!1,selected:n=!1,padding:r="md",children:a,...i},c)=>e.jsx("div",{ref:c,className:b("bg-white dark:bg-slate-800","rounded-lg","border border-slate-200 dark:border-slate-700","shadow-sm",Wn[r],s&&["transition-all duration-200","hover:shadow-md hover:border-slate-300 dark:hover:border-slate-600","cursor-pointer"],n&&["ring-2 ring-forensic-500 ring-offset-2 dark:ring-offset-slate-900","border-forensic-500"],t),...i,children:a}));I.displayName="Card";function L({className:t,title:s,description:n,action:r,children:a,...i}){return e.jsxs("div",{className:b("flex items-start justify-between gap-4",t),...i,children:[e.jsxs("div",{className:"space-y-1",children:[s&&e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:s}),n&&e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:n}),a]}),r&&e.jsx("div",{className:"flex-shrink-0",children:r})]})}const Yn={default:"bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300",primary:"bg-forensic-100 text-forensic-800 dark:bg-forensic-900/30 dark:text-forensic-400",secondary:"bg-slate-100 text-slate-600 dark:bg-slate-700 dark:text-slate-400",success:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",warning:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",danger:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",info:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",critical:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",high:"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",low:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400"},Bn={sm:"px-1.5 py-0.5 text-xs",md:"px-2.5 py-0.5 text-xs",lg:"px-3 py-1 text-sm"},$n={default:"bg-slate-500",primary:"bg-forensic-500",secondary:"bg-slate-400",success:"bg-green-500",warning:"bg-yellow-500",danger:"bg-red-500",info:"bg-blue-500",critical:"bg-red-500",high:"bg-orange-500",medium:"bg-yellow-500",low:"bg-green-500"};function Y({className:t,variant:s="default",size:n="md",icon:r,dot:a,dotColor:i,children:c,...o}){return e.jsxs("span",{className:b("inline-flex items-center gap-1.5 font-medium rounded-full",Yn[s],Bn[n],t),...o,children:[a&&e.jsx("span",{className:b("w-1.5 h-1.5 rounded-full",i||$n[s])}),r&&e.jsx("span",{className:"flex-shrink-0",children:r}),c]})}function tt({severity:t,size:s="md",className:n}){const r={critical:"Critical",high:"High",medium:"Medium",low:"Low",info:"Info"},a={critical:"critical",high:"high",medium:"medium",low:"low",info:"info"};return e.jsx(Y,{variant:a[t],size:s,className:n,children:r[t]})}const Vn={sm:"h-1",md:"h-2",lg:"h-3"},Gn={default:"bg-forensic-500",success:"bg-green-500",warning:"bg-yellow-500",danger:"bg-red-500"};function Oe({value:t,max:s=100,size:n="md",variant:r="default",showLabel:a=!1,animated:i=!0,className:c}){const o=Math.min(Math.max(t/s*100,0),100);return e.jsxs("div",{className:b("w-full",c),children:[a&&e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Progress"}),e.jsxs("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:[Math.round(o),"%"]})]}),e.jsx(os,{value:t,max:s,className:b("w-full overflow-hidden rounded-full bg-slate-200 dark:bg-slate-700",Vn[n]),children:e.jsx(cs,{className:b("h-full rounded-full",Gn[r],i&&"transition-all duration-300 ease-out"),style:{width:`${o}%`}})})]})}const Hn={default:"stroke-forensic-500",success:"stroke-green-500",warning:"stroke-yellow-500",danger:"stroke-red-500"};function Un({value:t,size:s=120,strokeWidth:n=8,showLabel:r=!0,variant:a="default",label:i,className:c}){const o=Math.min(Math.max(t,0),100),l=(s-n)/2,d=l*2*Math.PI,m=d-o/100*d;return e.jsxs("div",{className:b("relative inline-flex",c),children:[e.jsxs("svg",{width:s,height:s,className:"transform -rotate-90",children:[e.jsx("circle",{cx:s/2,cy:s/2,r:l,fill:"none",strokeWidth:n,className:"stroke-slate-200 dark:stroke-slate-700"}),e.jsx("circle",{cx:s/2,cy:s/2,r:l,fill:"none",strokeWidth:n,strokeLinecap:"round",className:b(Hn[a],"transition-all duration-500 ease-out"),style:{strokeDasharray:d,strokeDashoffset:m}})]}),r&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:i||e.jsxs("span",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:[Math.round(o),"%"]})})]})}const qn={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"};function Xn({size:t="md",className:s}){return e.jsxs("svg",{className:b("animate-spin text-forensic-500",qn[t],s),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}const Qn={sm:"h-8 text-sm px-2",md:"h-10 text-sm px-3",lg:"h-12 text-base px-4"},ye=N.forwardRef(({className:t,label:s,helperText:n,error:r,tooltip:a,required:i,leftAddon:c,rightAddon:o,inputSize:l="md",disabled:d,id:m,...h},u)=>{const w=m||N.useId();return e.jsxs("div",{className:b("w-full",t),children:[s&&e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsxs("label",{htmlFor:w,className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:[s,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),a&&e.jsx(_t,{content:a})]}),e.jsxs("div",{className:"relative",children:[c&&e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none text-slate-400",children:c}),e.jsx("input",{ref:u,id:w,disabled:d,className:b("w-full rounded-lg","bg-white dark:bg-slate-800","border border-slate-300 dark:border-slate-600","text-slate-900 dark:text-slate-100","placeholder:text-slate-400 dark:placeholder:text-slate-500","focus:ring-2 focus:ring-forensic-500 focus:border-transparent","disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-slate-50 dark:disabled:bg-slate-900","transition-colors duration-200",Qn[l],c&&"pl-10",o&&"pr-10",r&&"border-red-500 focus:ring-red-500"),"aria-invalid":!!r,"aria-describedby":r?`${w}-error`:void 0,...h}),o&&e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-slate-400",children:o})]}),(n||r)&&e.jsx("p",{id:r?`${w}-error`:void 0,className:b("mt-1 text-sm",r?"text-red-500":"text-slate-500 dark:text-slate-400"),children:r||n})]})});ye.displayName="Input";const zt=N.forwardRef(({className:t,label:s,helperText:n,error:r,tooltip:a,required:i,minRows:c=3,disabled:o,id:l,...d},m)=>{const h=l||N.useId();return e.jsxs("div",{className:b("w-full",t),children:[s&&e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsxs("label",{htmlFor:h,className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:[s,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),a&&e.jsx(_t,{content:a})]}),e.jsx("textarea",{ref:m,id:h,disabled:o,rows:c,className:b("w-full rounded-lg px-3 py-2","bg-white dark:bg-slate-800","border border-slate-300 dark:border-slate-600","text-slate-900 dark:text-slate-100","placeholder:text-slate-400 dark:placeholder:text-slate-500","focus:ring-2 focus:ring-forensic-500 focus:border-transparent","disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-slate-50 dark:disabled:bg-slate-900","transition-colors duration-200","resize-y",r&&"border-red-500 focus:ring-red-500"),"aria-invalid":!!r,"aria-describedby":r?`${h}-error`:void 0,...d}),(n||r)&&e.jsx("p",{id:r?`${h}-error`:void 0,className:b("mt-1 text-sm",r?"text-red-500":"text-slate-500 dark:text-slate-400"),children:r||n})]})});zt.displayName="Textarea";function Jn({onSearch:t,onKeyDown:s,...n}){const r=a=>{a.key==="Enter"&&t&&t(a.currentTarget.value),s==null||s(a)};return e.jsx(ye,{type:"search",leftAddon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),onKeyDown:r,...n})}const Zn={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl",full:"max-w-4xl"};function Kn({open:t,onOpenChange:s,title:n,description:r,children:a,size:i="md",closeOnOverlayClick:c=!0,showCloseButton:o=!0,footer:l}){return e.jsx(ls,{open:t,onOpenChange:s,children:e.jsx(js,{children:t&&e.jsxs(ds,{forceMount:!0,children:[e.jsx(us,{asChild:!0,children:e.jsx(rt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm",onClick:c?()=>s(!1):void 0})}),e.jsx(ms,{asChild:!0,children:e.jsxs(rt.div,{initial:{opacity:0,scale:.95,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:10},transition:{duration:.2,ease:"easeOut"},className:b("fixed z-50 w-full","left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2","bg-white dark:bg-slate-800","rounded-xl shadow-xl","border border-slate-200 dark:border-slate-700","focus:outline-none","max-h-[85vh] overflow-hidden flex flex-col",Zn[i]),onClick:d=>d.stopPropagation(),children:[(n||o)&&e.jsxs("div",{className:"flex items-start justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{children:[n&&e.jsx(hs,{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:n}),r&&e.jsx(xs,{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:r})]}),o&&e.jsx(fs,{asChild:!0,children:e.jsx("button",{className:b("rounded-lg p-1.5","text-slate-400 hover:text-slate-600 dark:text-slate-500 dark:hover:text-slate-300","hover:bg-slate-100 dark:hover:bg-slate-700","transition-colors duration-200","focus:outline-none focus:ring-2 focus:ring-forensic-500"),"aria-label":"Close",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a}),l&&e.jsx("div",{className:"flex items-center justify-end gap-2 p-4 border-t border-slate-200 dark:border-slate-700",children:l})]})})]})})})}const ht=t=>{let s;const n=new Set,r=(d,m)=>{const h=typeof d=="function"?d(s):d;if(!Object.is(h,s)){const u=s;s=m??(typeof h!="object"||h===null)?h:Object.assign({},s,h),n.forEach(w=>w(s,u))}},a=()=>s,o={setState:r,getState:a,getInitialState:()=>l,subscribe:d=>(n.add(d),()=>n.delete(d))},l=s=t(r,a,o);return o},er=t=>t?ht(t):ht,tr=t=>t;function sr(t,s=tr){const n=we.useSyncExternalStore(t.subscribe,we.useCallback(()=>s(t.getState()),[t,s]),we.useCallback(()=>s(t.getInitialState()),[t,s]));return we.useDebugValue(n),n}const xt=t=>{const s=er(t),n=r=>sr(s,r);return Object.assign(n,s),n},_e=t=>t?xt(t):xt;function nr(t,s){let n;try{n=t()}catch{return}return{getItem:a=>{var i;const c=l=>l===null?null:JSON.parse(l,void 0),o=(i=n.getItem(a))!=null?i:null;return o instanceof Promise?o.then(c):c(o)},setItem:(a,i)=>n.setItem(a,JSON.stringify(i,void 0)),removeItem:a=>n.removeItem(a)}}const Xe=t=>s=>{try{const n=t(s);return n instanceof Promise?n:{then(r){return Xe(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return Xe(r)(n)}}}},rr=(t,s)=>(n,r,a)=>{let i={storage:nr(()=>window.localStorage),partialize:p=>p,version:0,merge:(p,v)=>({...v,...p}),...s},c=!1,o=0;const l=new Set,d=new Set;let m=i.storage;if(!m)return t((...p)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...p)},r,a);const h=()=>{const p=i.partialize({...r()});return m.setItem(i.name,{state:p,version:i.version})},u=a.setState;a.setState=(p,v)=>(u(p,v),h());const w=t((...p)=>(n(...p),h()),r,a);a.getInitialState=()=>w;let f;const x=()=>{var p,v;if(!m)return;const g=++o;c=!1,l.forEach(j=>{var E;return j((E=r())!=null?E:w)});const S=((v=i.onRehydrateStorage)==null?void 0:v.call(i,(p=r())!=null?p:w))||void 0;return Xe(m.getItem.bind(m))(i.name).then(j=>{if(j)if(typeof j.version=="number"&&j.version!==i.version){if(i.migrate){const E=i.migrate(j.state,j.version);return E instanceof Promise?E.then(_=>[!0,_]):[!0,E]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,j.state];return[!1,void 0]}).then(j=>{var E;if(g!==o)return;const[_,M]=j;if(f=i.merge(M,(E=r())!=null?E:w),n(f,!0),_)return h()}).then(()=>{g===o&&(S==null||S(f,void 0),f=r(),c=!0,d.forEach(j=>j(f)))}).catch(j=>{g===o&&(S==null||S(void 0,j))})};return a.persist={setOptions:p=>{i={...i,...p},p.storage&&(m=p.storage)},clearStorage:()=>{m==null||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>x(),hasHydrated:()=>c,onHydrate:p=>(l.add(p),()=>{l.delete(p)}),onFinishHydration:p=>(d.add(p),()=>{d.delete(p)})},i.skipHydration||x(),f||w},Wt=rr,Yt={THEME:"forensic-theme",SESSION:"forensic-session"},ft=[{id:"endpoints",name:"Endpoints",description:"Collect data from workstations and servers",connectors:["windows","linux","macos"]},{id:"cloud",name:"Cloud Services",description:"Connect to cloud platforms and SaaS applications",connectors:["aws","azure","gcp","o365","gsuite"]},{id:"peripherals",name:"Network & Peripherals",description:"Access network devices and security appliances",connectors:["firewall","storage","email_gateway","proxy_waf"]}],gt={windows:{name:"Windows",icon:"Monitor",description:"Windows Event Logs, Registry, File System"},linux:{name:"Linux",icon:"Terminal",description:"Auth logs, Syslog, File System artifacts"},macos:{name:"macOS",icon:"Apple",description:"Unified Logs, FSEvents, Keychain"},aws:{name:"AWS",icon:"Cloud",description:"CloudTrail, CloudWatch, VPC Flow Logs"},azure:{name:"Azure",icon:"Cloud",description:"Activity Logs, Azure AD, Sentinel"},gcp:{name:"Google Cloud",icon:"Cloud",description:"Cloud Audit Logs, VPC Flow Logs"},o365:{name:"Microsoft 365",icon:"Mail",description:"Unified Audit Logs, Exchange, SharePoint"},gsuite:{name:"Google Workspace",icon:"Mail",description:"Admin Reports, Gmail, Drive Activity"},firewall:{name:"Firewall",icon:"Shield",description:"Traffic logs, Rule changes, Threat events"},storage:{name:"Storage/NAS",icon:"HardDrive",description:"Access logs, File activity, Quota changes"},email_gateway:{name:"Email Gateway",icon:"MailWarning",description:"Message tracking, Threat filtering"},proxy_waf:{name:"Proxy/WAF",icon:"Globe",description:"Web traffic, Blocked requests, Attacks"}},ar={ping:{name:"Ping/ICMP",description:"Send ICMP echo request to verify host is reachable"},dns:{name:"DNS Resolution",description:"Verify hostname resolves to documented IP address"},spn:{name:"SPN Check",description:"Validate Service Principal Name in Active Directory"},ad_lookup:{name:"AD Lookup",description:"Verify computer object exists in Active Directory"},port_scan:{name:"Port Scan",description:"Check if expected services are listening"},cert_check:{name:"Certificate Check",description:"Validate SSL/TLS certificate is valid"}},ir={pdf:{name:"PDF",icon:"FileText",color:"text-red-500"},docx:{name:"Word",icon:"FileText",color:"text-blue-500"},xlsx:{name:"Excel",icon:"FileSpreadsheet",color:"text-green-500"},json:{name:"JSON",icon:"FileJson",color:"text-yellow-500"},yaml:{name:"YAML",icon:"FileCode",color:"text-purple-500"},visio:{name:"Visio",icon:"Network",color:"text-blue-600"}},or={github:{name:"GitHub",icon:"Github"},gitlab:{name:"GitLab",icon:"GitBranch"},sharepoint:{name:"SharePoint",icon:"FileStack"},bitbucket:{name:"Bitbucket",icon:"GitBranch"}},oe=[{id:"data_collection",name:"Data Collection",description:"Gathering logs and artifacts from configured sources",estimatedDuration:3e3,steps:5},{id:"log_analysis",name:"Log Analysis",description:"Parsing and analyzing collected log data",estimatedDuration:4e3,steps:8},{id:"artifact_extraction",name:"Artifact Extraction",description:"Extracting forensic artifacts from systems",estimatedDuration:2500,steps:4},{id:"correlation",name:"Correlation Engine",description:"Correlating events and building timeline",estimatedDuration:3500,steps:6},{id:"anomaly_detection",name:"Anomaly Detection",description:"Identifying suspicious patterns and behaviors",estimatedDuration:2e3,steps:3}];function cr(){return typeof window>"u"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Be(t){if(typeof document>"u")return;const s=document.documentElement;t==="dark"?s.classList.add("dark"):s.classList.remove("dark")}function pt(t){return t==="auto"?cr():t}const Bt=_e()(Wt((t,s)=>({mode:"auto",effectiveTheme:"light",setMode:n=>{const r=pt(n);Be(r),t({mode:n,effectiveTheme:r})},initializeTheme:()=>{const{mode:n}=s(),r=pt(n);Be(r),t({effectiveTheme:r}),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",i=>{const{mode:c}=s();if(c==="auto"){const o=i.matches?"dark":"light";Be(o),t({effectiveTheme:o})}})}}),{name:Yt.THEME,partialize:t=>({mode:t.mode})})),ee=["dashboard","organization_context","incident_description","connector_config","infrastructure_validation","triage","timeline","verification","report"];function lr(){return`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function dr(t){const s=new Date;return{id:lr(),createdAt:s,lastModified:s,scenarioType:t||"custom",currentStep:1,isComplete:!1,connectors:[],timelineEvents:[],findings:[],verificationDecisions:[]}}const $=_e()(Wt((t,s)=>({currentSession:null,recentSessions:[],currentStep:"dashboard",createSession:n=>{const r=dr(n);t(a=>({currentSession:r,currentStep:"organization_context",recentSessions:[r,...a.recentSessions.slice(0,9)]}))},loadSession:n=>{const{recentSessions:r}=s(),a=r.find(i=>i.id===n);if(a){const i=a.currentStep,c=ee[i]||"dashboard";t({currentSession:{...a,lastModified:new Date},currentStep:c})}},updateSession:n=>{t(r=>{if(!r.currentSession)return r;const a={...r.currentSession,...n,lastModified:new Date};return{currentSession:a,recentSessions:r.recentSessions.map(i=>i.id===a.id?a:i)}})},deleteSession:n=>{t(r=>{var a;return{currentSession:((a=r.currentSession)==null?void 0:a.id)===n?null:r.currentSession,recentSessions:r.recentSessions.filter(i=>i.id!==n)}})},clearRecentSessions:()=>{t({recentSessions:[],currentSession:null})},setCurrentStep:n=>{const r=ee.indexOf(n);t(a=>({currentStep:n,currentSession:a.currentSession?{...a.currentSession,currentStep:r,lastModified:new Date}:null}))},goToNextStep:()=>{const{currentStep:n}=s(),r=ee.indexOf(n);if(r<ee.length-1){const a=ee[r+1];t(i=>({currentStep:a,currentSession:i.currentSession?{...i.currentSession,currentStep:r+1,lastModified:new Date}:null}))}},goToPreviousStep:()=>{const{currentStep:n}=s(),r=ee.indexOf(n);if(r>0){const a=ee[r-1];t(i=>({currentStep:a,currentSession:i.currentSession?{...i.currentSession,currentStep:r-1,lastModified:new Date}:null}))}},updateIncidentDescription:n=>{t(r=>{if(!r.currentSession)return r;const a=r.currentSession.incidentDescription||{naturalLanguage:"",startDate:new Date,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,patientZero:{hostname:"",type:"workstation"},iocs:[],criticalSystems:[],compromisedCredentials:[]};return{currentSession:{...r.currentSession,incidentDescription:{...a,...n},lastModified:new Date}}})},updateConnectors:n=>{t(r=>r.currentSession?{currentSession:{...r.currentSession,connectors:n,lastModified:new Date}}:r)},updateTriageState:n=>{t(r=>{if(!r.currentSession)return r;const a=r.currentSession.triageState||{status:"idle",overallProgress:0,phases:[],activityLog:[],findings:[],errors:[]};return{currentSession:{...r.currentSession,triageState:{...a,...n},lastModified:new Date}}})},addTimelineEvent:n=>{t(r=>r.currentSession?{currentSession:{...r.currentSession,timelineEvents:[...r.currentSession.timelineEvents,n],lastModified:new Date}}:r)},addFinding:n=>{t(r=>r.currentSession?{currentSession:{...r.currentSession,findings:[...r.currentSession.findings,n],lastModified:new Date}}:r)},addVerificationDecision:n=>{t(r=>r.currentSession?{currentSession:{...r.currentSession,verificationDecisions:[...r.currentSession.verificationDecisions,n],lastModified:new Date}}:r)}}),{name:Yt.SESSION,partialize:t=>({currentSession:t.currentSession,recentSessions:t.recentSessions})})),bt={systems:[],networks:[],processes:[],compliance:[],recoveryObjectives:[]};function H(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function ur(t){await new Promise(i=>setTimeout(i,2e3+Math.random()*2e3));const s=[{id:H(),hostname:"DC-MAIN-01",ip:"10.0.1.10",role:"Domain Controller",criticality:"critical",sourceDocument:t.filename,os:"Windows Server 2022"},{id:H(),hostname:"FS-FINANCE-01",ip:"10.0.2.20",role:"File Server",criticality:"high",sourceDocument:t.filename,os:"Windows Server 2019"},{id:H(),hostname:"WEB-APP-01",ip:"10.0.3.30",role:"Web Application Server",criticality:"high",sourceDocument:t.filename,os:"Ubuntu 22.04"}],n=[{id:H(),name:"Corporate LAN",cidr:"10.0.0.0/16",vlan:10,description:"Main corporate network",sourceDocument:t.filename},{id:H(),name:"DMZ",cidr:"192.168.1.0/24",vlan:50,description:"Demilitarized zone for public services",sourceDocument:t.filename}],r=[{id:H(),name:"Financial Reporting",description:"Monthly financial reporting and compliance",criticality:"critical",rto:4,rpo:1,dependentSystems:["FS-FINANCE-01","DC-MAIN-01"],sourceDocument:t.filename}],a=[{id:H(),framework:"SOC2",requirement:"CC6.1",description:"Logical and physical access controls",applicableSystems:["DC-MAIN-01"],sourceDocument:t.filename}];return{systems:s,networks:n,processes:r,compliance:a,recoveryObjectives:r.map(i=>({processId:i.id,processName:i.name,rto:i.rto,rpo:i.rpo,tier:i.criticality==="critical"?1:i.criticality==="high"?2:3}))}}const $t=_e((t,s)=>({documents:[],repositories:[],extractedEntities:bt,isParsingDocument:!1,isSyncingRepo:!1,addDocument:async n=>{var c;const r=H(),a=(c=n.name.split(".").pop())==null?void 0:c.toLowerCase(),i={id:r,filename:n.name,type:a||"pdf",size:n.size,uploadedAt:new Date,status:"uploading"};t(o=>({documents:[...o.documents,i]})),await new Promise(o=>setTimeout(o,500)),t(o=>({documents:o.documents.map(l=>l.id===r?{...l,status:"parsing"}:l),isParsingDocument:!0}));try{const o=await ur(i);t(l=>({documents:l.documents.map(d=>d.id===r?{...d,status:"parsed",extractedData:o}:d),extractedEntities:{systems:[...l.extractedEntities.systems,...o.systems],networks:[...l.extractedEntities.networks,...o.networks],processes:[...l.extractedEntities.processes,...o.processes],compliance:[...l.extractedEntities.compliance,...o.compliance],recoveryObjectives:[...l.extractedEntities.recoveryObjectives,...o.recoveryObjectives]},isParsingDocument:!1}))}catch{t(o=>({documents:o.documents.map(l=>l.id===r?{...l,status:"error",errorMessage:"Failed to parse document"}:l),isParsingDocument:!1}))}},removeDocument:n=>{const r=s().documents.find(a=>a.id===n);r&&t(a=>({documents:a.documents.filter(i=>i.id!==n),extractedEntities:{systems:a.extractedEntities.systems.filter(i=>i.sourceDocument!==r.filename),networks:a.extractedEntities.networks.filter(i=>i.sourceDocument!==r.filename),processes:a.extractedEntities.processes.filter(i=>i.sourceDocument!==r.filename),compliance:a.extractedEntities.compliance.filter(i=>i.sourceDocument!==r.filename),recoveryObjectives:a.extractedEntities.recoveryObjectives.filter(i=>{const c=a.extractedEntities.processes.find(o=>o.id===i.processId);return(c==null?void 0:c.sourceDocument)!==r.filename})}}))},updateDocumentStatus:(n,r,a)=>{t(i=>({documents:i.documents.map(c=>c.id===n?{...c,status:r,errorMessage:a}:c)}))},connectRepository:async(n,r,a)=>{const i=H(),c={id:i,type:n,name:a,url:r,status:"syncing"};t(o=>({repositories:[...o.repositories,c],isSyncingRepo:!0})),await new Promise(o=>setTimeout(o,2e3)),t(o=>({repositories:o.repositories.map(l=>l.id===i?{...l,status:"connected",lastSync:new Date,filesCount:Math.floor(Math.random()*50)+10}:l),isSyncingRepo:!1}))},disconnectRepository:n=>{t(r=>({repositories:r.repositories.filter(a=>a.id!==n)}))},syncRepository:async n=>{t(r=>({repositories:r.repositories.map(a=>a.id===n?{...a,status:"syncing"}:a),isSyncingRepo:!0})),await new Promise(r=>setTimeout(r,1500)),t(r=>({repositories:r.repositories.map(a=>a.id===n?{...a,status:"connected",lastSync:new Date}:a),isSyncingRepo:!1}))},addExtractedSystem:n=>{t(r=>({extractedEntities:{...r.extractedEntities,systems:[...r.extractedEntities.systems,n]}}))},addExtractedNetwork:n=>{t(r=>({extractedEntities:{...r.extractedEntities,networks:[...r.extractedEntities.networks,n]}}))},addBusinessProcess:n=>{t(r=>({extractedEntities:{...r.extractedEntities,processes:[...r.extractedEntities.processes,n]}}))},addComplianceRequirement:n=>{t(r=>({extractedEntities:{...r.extractedEntities,compliance:[...r.extractedEntities.compliance,n]}}))},loadScenarioContext:n=>{t({documents:n.documents,repositories:n.repositories,extractedEntities:n.extractedEntities})},resetContext:()=>{t({documents:[],repositories:[],extractedEntities:bt,isParsingDocument:!1,isSyncingRepo:!1})}}));function mr(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function hr(t,s){await new Promise(i=>setTimeout(i,500+Math.random()*1e3));const n=Math.random()>.2,r={method:s,status:n?"success":"failed",timestamp:new Date,message:n?xr(s,t):fr(s,t),details:n?gr(s,t):pr(s,t)};let a;return n||(a={id:mr(),systemId:t.systemId,hostname:t.hostname,type:br(s),severity:s==="ad_lookup"||s==="cert_check"?"critical":"warning",description:r.message||"Validation failed",documented:t.documentedIP,actual:wr(s)}),{result:r,discrepancy:a}}function xr(t,s){return{ping:`Host ${s.hostname} (${s.documentedIP}) is reachable`,dns:`Hostname ${s.hostname} resolves to ${s.documentedIP}`,spn:`SPN registered for ${s.hostname} in Active Directory`,ad_lookup:`Computer object ${s.hostname} found in Active Directory`,port_scan:`Expected services responding on ${s.hostname}`,cert_check:`SSL/TLS certificate valid for ${s.hostname}`}[t]}function fr(t,s){return{ping:`Host ${s.hostname} (${s.documentedIP}) is not responding`,dns:`Hostname ${s.hostname} does not resolve to documented IP`,spn:`No SPN found for ${s.hostname} in Active Directory`,ad_lookup:`Computer object ${s.hostname} not found in Active Directory`,port_scan:`Expected services not responding on ${s.hostname}`,cert_check:`SSL/TLS certificate expired or invalid for ${s.hostname}`}[t]}function gr(t,s){return{ping:{latency:`${Math.floor(Math.random()*50)+1}ms`,packetLoss:"0%"},dns:{resolvedIP:s.documentedIP,ttl:3600},spn:{spn:`HOST/${s.hostname}`,realm:"CORP.LOCAL"},ad_lookup:{ou:"OU=Servers,DC=corp,DC=local",enabled:!0},port_scan:{openPorts:[22,80,443],closedPorts:[]},cert_check:{issuer:"Corp Internal CA",expiresIn:"180 days"}}[t]}function pr(t,s){return{ping:{packetLoss:"100%",timeout:"3000ms"},dns:{resolvedIP:`10.0.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`,expected:s.documentedIP},spn:{searched:`HOST/${s.hostname}`,found:null},ad_lookup:{searched:s.hostname,found:!1},port_scan:{openPorts:[],expectedPorts:[22,80,443]},cert_check:{error:"Certificate expired",expiredDays:Math.floor(Math.random()*30)+1}}[t]}function br(t){return{ping:"ip_mismatch",dns:"dns_mismatch",spn:"missing_spn",ad_lookup:"not_in_ad",port_scan:"missing_service",cert_check:"cert_expired"}[t]}function wr(t,s){return{ping:"No response",dns:`10.0.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`,spn:"Not found",ad_lookup:"Not found",port_scan:"No services responding",cert_check:"Expired"}[t]}function vr(t){return t==="critical"?["ping","dns","ad_lookup","spn","port_scan","cert_check"]:t==="high"?["ping","dns","ad_lookup","port_scan"]:["ping","dns"]}function yr(t){return t.length===0||t.some(s=>s.status==="pending")?"pending":t.every(s=>s.status==="success")?"verified":t.some(s=>s.status==="failed")?"failed":"unknown"}const jr=_e((t,s)=>({systems:[],autoValidateEnabled:!1,discrepancies:[],isValidating:!1,initializeFromSystems:n=>{const r=n.map(a=>({systemId:a.id,hostname:a.hostname,documentedIP:a.ip||"N/A",role:a.role,criticality:a.criticality,validationMethods:vr(a.criticality),results:[],overallStatus:"pending"}));t({systems:r,discrepancies:[]})},setAutoValidate:n=>{t({autoValidateEnabled:n}),n&&s().validateAllSystems()},validateSystem:async(n,r)=>{const a=s().systems.find(c=>c.systemId===n);if(!a)return;const i=r||a.validationMethods;t({isValidating:!0}),t(c=>({systems:c.systems.map(o=>o.systemId===n?{...o,results:o.results.filter(l=>!i.includes(l.method)),overallStatus:"pending"}:o),discrepancies:c.discrepancies.filter(o=>o.systemId!==n)}));for(const c of i){const{result:o,discrepancy:l}=await hr(a,c);t(d=>{const m=d.systems.map(u=>{if(u.systemId!==n)return u;const w=[...u.results,o];return{...u,results:w,overallStatus:yr(w),lastChecked:new Date}}),h=l?[...d.discrepancies,l]:d.discrepancies;return{systems:m,discrepancies:h}})}t({isValidating:!1,lastFullValidation:new Date})},validateAllSystems:async()=>{const{systems:n}=s();t({isValidating:!0});for(const r of n)await s().validateSystem(r.systemId);t({isValidating:!1,lastFullValidation:new Date})},revalidateFailed:async()=>{const{systems:n}=s(),r=n.filter(a=>a.overallStatus==="failed");t({isValidating:!0});for(const a of r){const i=a.results.filter(c=>c.status==="failed").map(c=>c.method);await s().validateSystem(a.systemId,i)}t({isValidating:!1})},clearValidation:n=>{t(r=>({systems:r.systems.map(a=>a.systemId===n?{...a,results:[],overallStatus:"pending",lastChecked:void 0}:a),discrepancies:r.discrepancies.filter(a=>a.systemId!==n)}))},resetValidation:()=>{t({systems:[],autoValidateEnabled:!1,discrepancies:[],isValidating:!1,lastFullValidation:void 0})}})),Nr={sm:"h-8 w-8",md:"h-10 w-10",lg:"h-12 w-12"},$e={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"};function kr({size:t="md",className:s}){const{mode:n,setMode:r}=Bt(),a=()=>{const o=["light","dark","auto"],d=(o.indexOf(n)+1)%o.length;r(o[d])},i={light:"Switch to dark mode",dark:"Switch to auto mode",auto:"Switch to light mode"},c={light:e.jsx("svg",{className:$e[t],fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),dark:e.jsx("svg",{className:$e[t],fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),auto:e.jsx("svg",{className:$e[t],fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})};return e.jsx(y,{content:i[n],children:e.jsx("button",{onClick:a,className:b("inline-flex items-center justify-center","rounded-lg","text-slate-600 dark:text-slate-400","hover:bg-slate-100 dark:hover:bg-slate-800","hover:text-slate-900 dark:hover:text-slate-100","transition-colors duration-200","focus:outline-none focus:ring-2 focus:ring-forensic-500 focus:ring-offset-2 dark:focus:ring-offset-slate-900",Nr[t],s),"aria-label":`Current theme: ${n}. Click to change.`,children:c[n]})})}const ve=[{step:"organization_context",label:"Context",number:1},{step:"incident_description",label:"Incident",number:2},{step:"connector_config",label:"Connectors",number:3},{step:"infrastructure_validation",label:"Validation",number:4},{step:"triage",label:"Triage",number:5},{step:"timeline",label:"Timeline",number:6},{step:"verification",label:"Verify",number:7},{step:"report",label:"Report",number:8}];function Vt({showProgress:t=!0,className:s}){var c;const{currentSession:n,currentStep:r}=$(),a=ve.findIndex(o=>o.step===r),i=a>=0;return e.jsxs("header",{className:b("sticky top-0 z-40","bg-white/80 dark:bg-slate-900/80 backdrop-blur-md","border-b border-slate-200 dark:border-slate-700",s),children:[e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs(ps,{to:"/",className:"flex items-center gap-2 text-slate-900 dark:text-slate-100 hover:opacity-80 transition-opacity",children:[e.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-forensic-500",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"m21 21-4.3-4.3"}),e.jsx("path",{d:"M11 8v6",className:"text-red-500",stroke:"currentColor"}),e.jsx("path",{d:"M8 11h6",className:"text-red-500",stroke:"currentColor"})]})}),e.jsx("span",{className:"font-semibold text-lg hidden sm:inline",children:"Forensic Triage"})]}),t&&i&&n&&e.jsx("div",{className:"hidden md:flex items-center",children:e.jsx(Sr,{currentStepIndex:a,totalSteps:ve.length})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{content:"Get help and documentation",children:e.jsx(D,{variant:"ghost",size:"sm","aria-label":"Help",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),e.jsx(kr,{size:"sm"})]})]})}),t&&i&&n&&e.jsx("div",{className:"md:hidden px-4 pb-3",children:e.jsx(Cr,{currentStepIndex:a,currentStepLabel:((c=ve[a])==null?void 0:c.label)||"",totalSteps:ve.length})})]})}function Sr({currentStepIndex:t,totalSteps:s}){return e.jsx("div",{className:"flex items-center gap-1",children:ve.map((n,r)=>e.jsxs(N.Fragment,{children:[e.jsx(y,{content:n.label,children:e.jsx("div",{className:b("w-3 h-3 rounded-full transition-colors duration-200",r<t?"bg-forensic-500":r===t?"bg-forensic-500 ring-2 ring-forensic-200 dark:ring-forensic-800":"bg-slate-200 dark:bg-slate-700")})}),r<s-1&&e.jsx("div",{className:b("w-4 h-0.5",r<t?"bg-forensic-500":"bg-slate-200 dark:bg-slate-700")})]},n.step))})}function Cr({currentStepIndex:t,currentStepLabel:s,totalSteps:n}){return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-1 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-forensic-500 transition-all duration-300",style:{width:`${(t+1)/n*100}%`}})}),e.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400 whitespace-nowrap",children:["Step ",t+1,"/",n,": ",s]})]})}const wt={sm:"max-w-2xl",md:"max-w-4xl",lg:"max-w-5xl",xl:"max-w-6xl","2xl":"max-w-7xl",full:"max-w-full"};function Z({title:t,subtitle:s,showProgress:n=!0,actions:r,footer:a,children:i,maxWidth:c="2xl",className:o}){return e.jsxs("div",{className:"min-h-screen flex flex-col bg-slate-50 dark:bg-slate-900",children:[e.jsx(Vt,{showProgress:n}),e.jsxs("main",{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:b("flex-1 w-full mx-auto px-4 sm:px-6 lg:px-8 py-6",wt[c],o),children:[(t||r)&&e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[t&&e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:t}),s&&e.jsx("p",{className:"mt-1 text-slate-500 dark:text-slate-400",children:s})]}),r&&e.jsx("div",{className:"flex items-center gap-2 flex-shrink-0",children:r})]})}),e.jsx("div",{className:"flex-1",children:i})]}),a&&e.jsx("div",{className:"sticky bottom-0 bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-slate-700",children:e.jsx("div",{className:b("w-full mx-auto px-4 sm:px-6 lg:px-8 py-4",wt[c]),children:a})})]})]})}function ne({onBack:t,backLabel:s="Back",onContinue:n,continueLabel:r="Continue",continueDisabled:a,continueLoading:i,middleContent:c}){return e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{children:t&&e.jsxs("button",{onClick:t,className:b("inline-flex items-center gap-2","px-4 py-2 text-sm font-medium","text-slate-600 dark:text-slate-400","hover:text-slate-900 dark:hover:text-slate-100","transition-colors duration-200"),children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),s]})}),c&&e.jsx("div",{className:"flex-1 flex justify-center",children:c}),e.jsx("div",{children:n&&e.jsxs("button",{onClick:n,disabled:a||i,className:b("inline-flex items-center gap-2","px-6 py-2 text-sm font-medium","bg-forensic-500 hover:bg-forensic-600 text-white","rounded-lg","transition-colors duration-200","disabled:opacity-50 disabled:cursor-not-allowed"),children:[i?e.jsxs("svg",{className:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):null,r,e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]})})]})}function Dr({icon:t,title:s,description:n,action:r,className:a}){return e.jsxs("div",{className:b("flex flex-col items-center justify-center text-center py-12",a),children:[t&&e.jsx("div",{className:"w-16 h-16 flex items-center justify-center text-slate-400 dark:text-slate-500 mb-4",children:t}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-1",children:s}),n&&e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 max-w-sm mb-4",children:n}),r]})}const Gt=6048e5,Mr=864e5,Ht=6e4,Ut=36e5,Se=43200,vt=1440,yt=Symbol.for("constructDateFrom");function B(t,s){return typeof t=="function"?t(s):t&&typeof t=="object"&&yt in t?t[yt](s):t instanceof Date?new t.constructor(s):new Date(s)}function A(t,s){return B(s||t,t)}let Pr={};function ke(){return Pr}function je(t,s){var o,l,d,m;const n=ke(),r=(s==null?void 0:s.weekStartsOn)??((l=(o=s==null?void 0:s.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((m=(d=n.locale)==null?void 0:d.options)==null?void 0:m.weekStartsOn)??0,a=A(t,s==null?void 0:s.in),i=a.getDay(),c=(i<r?7:0)+i-r;return a.setDate(a.getDate()-c),a.setHours(0,0,0,0),a}function Ae(t,s){return je(t,{...s,weekStartsOn:1})}function qt(t,s){const n=A(t,s==null?void 0:s.in),r=n.getFullYear(),a=B(n,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const i=Ae(a),c=B(n,0);c.setFullYear(r,0,4),c.setHours(0,0,0,0);const o=Ae(c);return n.getTime()>=i.getTime()?r+1:n.getTime()>=o.getTime()?r:r-1}function Re(t){const s=A(t),n=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return n.setUTCFullYear(s.getFullYear()),+t-+n}function ze(t,...s){const n=B.bind(null,t||s.find(r=>typeof r=="object"));return s.map(n)}function jt(t,s){const n=A(t,s==null?void 0:s.in);return n.setHours(0,0,0,0),n}function Ir(t,s,n){const[r,a]=ze(n==null?void 0:n.in,t,s),i=jt(r),c=jt(a),o=+i-Re(i),l=+c-Re(c);return Math.round((o-l)/Mr)}function Tr(t,s){const n=qt(t,s),r=B(t,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),Ae(r)}function Te(t,s){const n=+A(t)-+A(s);return n<0?-1:n>0?1:n}function Er(t){return B(t,Date.now())}function Or(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function Ar(t){return!(!Or(t)&&typeof t!="number"||isNaN(+A(t)))}function Rr(t,s,n){const[r,a]=ze(n==null?void 0:n.in,t,s),i=r.getFullYear()-a.getFullYear(),c=r.getMonth()-a.getMonth();return i*12+c}function Lr(t){return s=>{const r=(t?Math[t]:Math.trunc)(s);return r===0?0:r}}function Fr(t,s){return+A(t)-+A(s)}function _r(t,s){const n=A(t,s==null?void 0:s.in);return n.setHours(23,59,59,999),n}function zr(t,s){const n=A(t,s==null?void 0:s.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function Wr(t,s){const n=A(t,s==null?void 0:s.in);return+_r(n,s)==+zr(n,s)}function Yr(t,s,n){const[r,a,i]=ze(n==null?void 0:n.in,t,t,s),c=Te(a,i),o=Math.abs(Rr(a,i));if(o<1)return 0;a.getMonth()===1&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-c*o);let l=Te(a,i)===-c;Wr(r)&&o===1&&Te(r,i)===1&&(l=!1);const d=c*(o-+l);return d===0?0:d}function Br(t,s,n){const r=Fr(t,s)/1e3;return Lr(n==null?void 0:n.roundingMethod)(r)}function $r(t,s){const n=A(t,s==null?void 0:s.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}const Vr={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Gr=(t,s,n)=>{let r;const a=Vr[t];return typeof a=="string"?r=a:s===1?r=a.one:r=a.other.replace("{{count}}",s.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function Ve(t){return(s={})=>{const n=s.width?String(s.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const Hr={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Ur={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},qr={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Xr={date:Ve({formats:Hr,defaultWidth:"full"}),time:Ve({formats:Ur,defaultWidth:"full"}),dateTime:Ve({formats:qr,defaultWidth:"full"})},Qr={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Jr=(t,s,n,r)=>Qr[t];function fe(t){return(s,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let a;if(r==="formatting"&&t.formattingValues){const c=t.defaultFormattingWidth||t.defaultWidth,o=n!=null&&n.width?String(n.width):c;a=t.formattingValues[o]||t.formattingValues[c]}else{const c=t.defaultWidth,o=n!=null&&n.width?String(n.width):t.defaultWidth;a=t.values[o]||t.values[c]}const i=t.argumentCallback?t.argumentCallback(s):s;return a[i]}}const Zr={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Kr={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},ea={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},ta={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},sa={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},na={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ra=(t,s)=>{const n=Number(t),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},aa={ordinalNumber:ra,era:fe({values:Zr,defaultWidth:"wide"}),quarter:fe({values:Kr,defaultWidth:"wide",argumentCallback:t=>t-1}),month:fe({values:ea,defaultWidth:"wide"}),day:fe({values:ta,defaultWidth:"wide"}),dayPeriod:fe({values:sa,defaultWidth:"wide",formattingValues:na,defaultFormattingWidth:"wide"})};function ge(t){return(s,n={})=>{const r=n.width,a=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],i=s.match(a);if(!i)return null;const c=i[0],o=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(o)?oa(o,h=>h.test(c)):ia(o,h=>h.test(c));let d;d=t.valueCallback?t.valueCallback(l):l,d=n.valueCallback?n.valueCallback(d):d;const m=s.slice(c.length);return{value:d,rest:m}}}function ia(t,s){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&s(t[n]))return n}function oa(t,s){for(let n=0;n<t.length;n++)if(s(t[n]))return n}function ca(t){return(s,n={})=>{const r=s.match(t.matchPattern);if(!r)return null;const a=r[0],i=s.match(t.parsePattern);if(!i)return null;let c=t.valueCallback?t.valueCallback(i[0]):i[0];c=n.valueCallback?n.valueCallback(c):c;const o=s.slice(a.length);return{value:c,rest:o}}}const la=/^(\d+)(th|st|nd|rd)?/i,da=/\d+/i,ua={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},ma={any:[/^b/i,/^(a|c)/i]},ha={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},xa={any:[/1/i,/2/i,/3/i,/4/i]},fa={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},ga={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},pa={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},ba={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},wa={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},va={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},ya={ordinalNumber:ca({matchPattern:la,parsePattern:da,valueCallback:t=>parseInt(t,10)}),era:ge({matchPatterns:ua,defaultMatchWidth:"wide",parsePatterns:ma,defaultParseWidth:"any"}),quarter:ge({matchPatterns:ha,defaultMatchWidth:"wide",parsePatterns:xa,defaultParseWidth:"any",valueCallback:t=>t+1}),month:ge({matchPatterns:fa,defaultMatchWidth:"wide",parsePatterns:ga,defaultParseWidth:"any"}),day:ge({matchPatterns:pa,defaultMatchWidth:"wide",parsePatterns:ba,defaultParseWidth:"any"}),dayPeriod:ge({matchPatterns:wa,defaultMatchWidth:"any",parsePatterns:va,defaultParseWidth:"any"})},Xt={code:"en-US",formatDistance:Gr,formatLong:Xr,formatRelative:Jr,localize:aa,match:ya,options:{weekStartsOn:0,firstWeekContainsDate:1}};function ja(t,s){const n=A(t,s==null?void 0:s.in);return Ir(n,$r(n))+1}function Na(t,s){const n=A(t,s==null?void 0:s.in),r=+Ae(n)-+Tr(n);return Math.round(r/Gt)+1}function Qt(t,s){var m,h,u,w;const n=A(t,s==null?void 0:s.in),r=n.getFullYear(),a=ke(),i=(s==null?void 0:s.firstWeekContainsDate)??((h=(m=s==null?void 0:s.locale)==null?void 0:m.options)==null?void 0:h.firstWeekContainsDate)??a.firstWeekContainsDate??((w=(u=a.locale)==null?void 0:u.options)==null?void 0:w.firstWeekContainsDate)??1,c=B((s==null?void 0:s.in)||t,0);c.setFullYear(r+1,0,i),c.setHours(0,0,0,0);const o=je(c,s),l=B((s==null?void 0:s.in)||t,0);l.setFullYear(r,0,i),l.setHours(0,0,0,0);const d=je(l,s);return+n>=+o?r+1:+n>=+d?r:r-1}function ka(t,s){var o,l,d,m;const n=ke(),r=(s==null?void 0:s.firstWeekContainsDate)??((l=(o=s==null?void 0:s.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((m=(d=n.locale)==null?void 0:d.options)==null?void 0:m.firstWeekContainsDate)??1,a=Qt(t,s),i=B((s==null?void 0:s.in)||t,0);return i.setFullYear(a,0,r),i.setHours(0,0,0,0),je(i,s)}function Sa(t,s){const n=A(t,s==null?void 0:s.in),r=+je(n,s)-+ka(n,s);return Math.round(r/Gt)+1}function P(t,s){const n=t<0?"-":"",r=Math.abs(t).toString().padStart(s,"0");return n+r}const J={y(t,s){const n=t.getFullYear(),r=n>0?n:1-n;return P(s==="yy"?r%100:r,s.length)},M(t,s){const n=t.getMonth();return s==="M"?String(n+1):P(n+1,2)},d(t,s){return P(t.getDate(),s.length)},a(t,s){const n=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,s){return P(t.getHours()%12||12,s.length)},H(t,s){return P(t.getHours(),s.length)},m(t,s){return P(t.getMinutes(),s.length)},s(t,s){return P(t.getSeconds(),s.length)},S(t,s){const n=s.length,r=t.getMilliseconds(),a=Math.trunc(r*Math.pow(10,n-3));return P(a,s.length)}},ce={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Nt={G:function(t,s,n){const r=t.getFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(t,s,n){if(s==="yo"){const r=t.getFullYear(),a=r>0?r:1-r;return n.ordinalNumber(a,{unit:"year"})}return J.y(t,s)},Y:function(t,s,n,r){const a=Qt(t,r),i=a>0?a:1-a;if(s==="YY"){const c=i%100;return P(c,2)}return s==="Yo"?n.ordinalNumber(i,{unit:"year"}):P(i,s.length)},R:function(t,s){const n=qt(t);return P(n,s.length)},u:function(t,s){const n=t.getFullYear();return P(n,s.length)},Q:function(t,s,n){const r=Math.ceil((t.getMonth()+1)/3);switch(s){case"Q":return String(r);case"QQ":return P(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,s,n){const r=Math.ceil((t.getMonth()+1)/3);switch(s){case"q":return String(r);case"qq":return P(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,s,n){const r=t.getMonth();switch(s){case"M":case"MM":return J.M(t,s);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(t,s,n){const r=t.getMonth();switch(s){case"L":return String(r+1);case"LL":return P(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(t,s,n,r){const a=Sa(t,r);return s==="wo"?n.ordinalNumber(a,{unit:"week"}):P(a,s.length)},I:function(t,s,n){const r=Na(t);return s==="Io"?n.ordinalNumber(r,{unit:"week"}):P(r,s.length)},d:function(t,s,n){return s==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):J.d(t,s)},D:function(t,s,n){const r=ja(t);return s==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):P(r,s.length)},E:function(t,s,n){const r=t.getDay();switch(s){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(t,s,n,r){const a=t.getDay(),i=(a-r.weekStartsOn+8)%7||7;switch(s){case"e":return String(i);case"ee":return P(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});case"eeee":default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(t,s,n,r){const a=t.getDay(),i=(a-r.weekStartsOn+8)%7||7;switch(s){case"c":return String(i);case"cc":return P(i,s.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});case"cccc":default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(t,s,n){const r=t.getDay(),a=r===0?7:r;switch(s){case"i":return String(a);case"ii":return P(a,s.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(t,s,n){const a=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,s,n){const r=t.getHours();let a;switch(r===12?a=ce.noon:r===0?a=ce.midnight:a=r/12>=1?"pm":"am",s){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,s,n){const r=t.getHours();let a;switch(r>=17?a=ce.evening:r>=12?a=ce.afternoon:r>=4?a=ce.morning:a=ce.night,s){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,s,n){if(s==="ho"){let r=t.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return J.h(t,s)},H:function(t,s,n){return s==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):J.H(t,s)},K:function(t,s,n){const r=t.getHours()%12;return s==="Ko"?n.ordinalNumber(r,{unit:"hour"}):P(r,s.length)},k:function(t,s,n){let r=t.getHours();return r===0&&(r=24),s==="ko"?n.ordinalNumber(r,{unit:"hour"}):P(r,s.length)},m:function(t,s,n){return s==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):J.m(t,s)},s:function(t,s,n){return s==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):J.s(t,s)},S:function(t,s){return J.S(t,s)},X:function(t,s,n){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(s){case"X":return St(r);case"XXXX":case"XX":return se(r);case"XXXXX":case"XXX":default:return se(r,":")}},x:function(t,s,n){const r=t.getTimezoneOffset();switch(s){case"x":return St(r);case"xxxx":case"xx":return se(r);case"xxxxx":case"xxx":default:return se(r,":")}},O:function(t,s,n){const r=t.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+kt(r,":");case"OOOO":default:return"GMT"+se(r,":")}},z:function(t,s,n){const r=t.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+kt(r,":");case"zzzz":default:return"GMT"+se(r,":")}},t:function(t,s,n){const r=Math.trunc(+t/1e3);return P(r,s.length)},T:function(t,s,n){return P(+t,s.length)}};function kt(t,s=""){const n=t>0?"-":"+",r=Math.abs(t),a=Math.trunc(r/60),i=r%60;return i===0?n+String(a):n+String(a)+s+P(i,2)}function St(t,s){return t%60===0?(t>0?"-":"+")+P(Math.abs(t)/60,2):se(t,s)}function se(t,s=""){const n=t>0?"-":"+",r=Math.abs(t),a=P(Math.trunc(r/60),2),i=P(r%60,2);return n+a+s+i}const Ct=(t,s)=>{switch(t){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},Jt=(t,s)=>{switch(t){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},Ca=(t,s)=>{const n=t.match(/(P+)(p+)?/)||[],r=n[1],a=n[2];if(!a)return Ct(t,s);let i;switch(r){case"P":i=s.dateTime({width:"short"});break;case"PP":i=s.dateTime({width:"medium"});break;case"PPP":i=s.dateTime({width:"long"});break;case"PPPP":default:i=s.dateTime({width:"full"});break}return i.replace("{{date}}",Ct(r,s)).replace("{{time}}",Jt(a,s))},Da={p:Jt,P:Ca},Ma=/^D+$/,Pa=/^Y+$/,Ia=["D","DD","YY","YYYY"];function Ta(t){return Ma.test(t)}function Ea(t){return Pa.test(t)}function Oa(t,s,n){const r=Aa(t,s,n);if(console.warn(r),Ia.includes(t))throw new RangeError(r)}function Aa(t,s,n){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${s}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Ra=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,La=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Fa=/^'([^]*?)'?$/,_a=/''/g,za=/[a-zA-Z]/;function Zt(t,s,n){var m,h,u,w;const r=ke(),a=r.locale??Xt,i=r.firstWeekContainsDate??((h=(m=r.locale)==null?void 0:m.options)==null?void 0:h.firstWeekContainsDate)??1,c=r.weekStartsOn??((w=(u=r.locale)==null?void 0:u.options)==null?void 0:w.weekStartsOn)??0,o=A(t,n==null?void 0:n.in);if(!Ar(o))throw new RangeError("Invalid time value");let l=s.match(La).map(f=>{const x=f[0];if(x==="p"||x==="P"){const p=Da[x];return p(f,a.formatLong)}return f}).join("").match(Ra).map(f=>{if(f==="''")return{isToken:!1,value:"'"};const x=f[0];if(x==="'")return{isToken:!1,value:Wa(f)};if(Nt[x])return{isToken:!0,value:f};if(x.match(za))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");return{isToken:!1,value:f}});a.localize.preprocessor&&(l=a.localize.preprocessor(o,l));const d={firstWeekContainsDate:i,weekStartsOn:c,locale:a};return l.map(f=>{if(!f.isToken)return f.value;const x=f.value;(Ea(x)||Ta(x))&&Oa(x,s,String(t));const p=Nt[x[0]];return p(o,x,a.localize,d)}).join("")}function Wa(t){const s=t.match(Fa);return s?s[1].replace(_a,"'"):t}function Ya(t,s,n){const r=ke(),a=(n==null?void 0:n.locale)??r.locale??Xt,i=2520,c=Te(t,s);if(isNaN(c))throw new RangeError("Invalid time value");const o=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:c}),[l,d]=ze(n==null?void 0:n.in,...c>0?[s,t]:[t,s]),m=Br(d,l),h=(Re(d)-Re(l))/1e3,u=Math.round((m-h)/60);let w;if(u<2)return n!=null&&n.includeSeconds?m<5?a.formatDistance("lessThanXSeconds",5,o):m<10?a.formatDistance("lessThanXSeconds",10,o):m<20?a.formatDistance("lessThanXSeconds",20,o):m<40?a.formatDistance("halfAMinute",0,o):m<60?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",1,o):u===0?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",u,o);if(u<45)return a.formatDistance("xMinutes",u,o);if(u<90)return a.formatDistance("aboutXHours",1,o);if(u<vt){const f=Math.round(u/60);return a.formatDistance("aboutXHours",f,o)}else{if(u<i)return a.formatDistance("xDays",1,o);if(u<Se){const f=Math.round(u/vt);return a.formatDistance("xDays",f,o)}else if(u<Se*2)return w=Math.round(u/Se),a.formatDistance("aboutXMonths",w,o)}if(w=Yr(d,l),w<12){const f=Math.round(u/Se);return a.formatDistance("xMonths",f,o)}else{const f=w%12,x=Math.trunc(w/12);return f<3?a.formatDistance("aboutXYears",x,o):f<9?a.formatDistance("overXYears",x,o):a.formatDistance("almostXYears",x+1,o)}}function Ba(t,s){return Ya(t,Er(t),s)}function st(t,s){const n=()=>B(s==null?void 0:s.in,NaN),a=Ha(t);let i;if(a.date){const d=Ua(a.date,2);i=qa(d.restDateString,d.year)}if(!i||isNaN(+i))return n();const c=+i;let o=0,l;if(a.time&&(o=Xa(a.time),isNaN(o)))return n();if(a.timezone){if(l=Qa(a.timezone),isNaN(l))return n()}else{const d=new Date(c+o),m=A(0,s==null?void 0:s.in);return m.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),m.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),m}return A(c+o+l,s==null?void 0:s.in)}const Ce={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},$a=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Va=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Ga=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Ha(t){const s={},n=t.split(Ce.dateTimeDelimiter);let r;if(n.length>2)return s;if(/:/.test(n[0])?r=n[0]:(s.date=n[0],r=n[1],Ce.timeZoneDelimiter.test(s.date)&&(s.date=t.split(Ce.timeZoneDelimiter)[0],r=t.substr(s.date.length,t.length))),r){const a=Ce.timezone.exec(r);a?(s.time=r.replace(a[1],""),s.timezone=a[1]):s.time=r}return s}function Ua(t,s){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+s)+"})|(\\d{2}|[+-]\\d{"+(2+s)+"})$)"),r=t.match(n);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:i===null?a:i*100,restDateString:t.slice((r[1]||r[2]).length)}}function qa(t,s){if(s===null)return new Date(NaN);const n=t.match($a);if(!n)return new Date(NaN);const r=!!n[4],a=pe(n[1]),i=pe(n[2])-1,c=pe(n[3]),o=pe(n[4]),l=pe(n[5])-1;if(r)return ti(s,o,l)?Ja(s,o,l):new Date(NaN);{const d=new Date(0);return!Ka(s,i,c)||!ei(s,a)?new Date(NaN):(d.setUTCFullYear(s,i,Math.max(a,c)),d)}}function pe(t){return t?parseInt(t):1}function Xa(t){const s=t.match(Va);if(!s)return NaN;const n=Ge(s[1]),r=Ge(s[2]),a=Ge(s[3]);return si(n,r,a)?n*Ut+r*Ht+a*1e3:NaN}function Ge(t){return t&&parseFloat(t.replace(",","."))||0}function Qa(t){if(t==="Z")return 0;const s=t.match(Ga);if(!s)return 0;const n=s[1]==="+"?-1:1,r=parseInt(s[2]),a=s[3]&&parseInt(s[3])||0;return ni(r,a)?n*(r*Ut+a*Ht):NaN}function Ja(t,s,n){const r=new Date(0);r.setUTCFullYear(t,0,4);const a=r.getUTCDay()||7,i=(s-1)*7+n+1-a;return r.setUTCDate(r.getUTCDate()+i),r}const Za=[31,null,31,30,31,30,31,31,30,31,30,31];function Kt(t){return t%400===0||t%4===0&&t%100!==0}function Ka(t,s,n){return s>=0&&s<=11&&n>=1&&n<=(Za[s]||(Kt(t)?29:28))}function ei(t,s){return s>=1&&s<=(Kt(t)?366:365)}function ti(t,s,n){return s>=1&&s<=53&&n>=0&&n<=6}function si(t,s,n){return t===24?s===0&&n===0:n>=0&&n<60&&s>=0&&s<60&&t>=0&&t<25}function ni(t,s){return s>=0&&s<=59}function ri(t){const s=typeof t=="string"?st(t):t;return Zt(s,"PPP p")}function es(t){const s=typeof t=="string"?st(t):t;return Zt(s,"HH:mm:ss")}function ai(t){const s=typeof t=="string"?st(t):t;return Ba(s,{addSuffix:!0})}function ii(t){if(t===0)return"0 Bytes";const s=1024,n=["Bytes","KB","MB","GB","TB"],r=Math.floor(Math.log(t)/Math.log(s));return`${parseFloat((t/Math.pow(s,r)).toFixed(2))} ${n[r]}`}function oi(){const t=q(),{createSession:s,recentSessions:n,loadSession:r,clearRecentSessions:a}=$(),i=()=>{s(),t("/context")},c=l=>{s(l),t("/context")},o=l=>{r(l),t("/context")};return e.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900",children:[e.jsx(Vt,{showProgress:!1}),e.jsxs("main",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-slate-900 dark:text-slate-100 mb-4",children:"Self-Service Forensic Triage"}),e.jsx("p",{className:"text-lg text-slate-600 dark:text-slate-400 max-w-2xl mx-auto mb-8",children:"Quick diagnostic before professional incident response. Upload organizational context, configure data sources, and get actionable insights."}),e.jsx(y,{content:"Begin a new forensic investigation from scratch",children:e.jsx(D,{size:"lg",onClick:i,rightIcon:e.jsx(Ns,{className:"w-5 h-5"}),children:"Start New Investigation"})})]}),e.jsxs("section",{className:"mb-12",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-4",children:"Select a Scenario"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-6",children:"Choose a pre-populated scenario to see the full workflow with realistic demo data."}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:ci.map(l=>e.jsx(li,{scenario:l,onSelect:()=>c(l.id)},l.id))})]}),n.length>0&&e.jsxs("section",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Recent Sessions"}),e.jsx(y,{content:"Remove all saved session history",children:e.jsx(D,{variant:"ghost",size:"sm",onClick:a,leftIcon:e.jsx(ks,{className:"w-4 h-4"}),children:"Clear"})})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:n.slice(0,6).map(l=>e.jsx(di,{session:l,onResume:()=>o(l.id)},l.id))})]})]})]})}const ci=[{id:"ransomware",title:"Ransomware Attack",description:"Enterprise ransomware infection with lateral movement and file encryption",icon:e.jsx(Ss,{className:"w-8 h-8"}),difficulty:"intermediate"},{id:"data_exfiltration",title:"Data Exfiltration",description:"Sensitive data theft via compromised cloud storage and sync tools",icon:e.jsx(Dt,{className:"w-8 h-8"}),difficulty:"advanced"},{id:"insider_threat",title:"Insider Threat",description:"Malicious activity by authorized user with privileged access",icon:e.jsx(Cs,{className:"w-8 h-8"}),difficulty:"advanced"},{id:"web_dos",title:"Web Resource DOS",description:"Application-layer denial of service attack on public web services",icon:e.jsx(Mt,{className:"w-8 h-8"}),difficulty:"beginner"},{id:"ai_breach",title:"AI-Related Breach",description:"Security incident involving AI/ML systems and data poisoning",icon:e.jsx(Ds,{className:"w-8 h-8"}),difficulty:"advanced"}];function li({scenario:t,onSelect:s}){const n={beginner:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",intermediate:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",advanced:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"};return e.jsx(y,{content:`Load ${t.title} scenario with pre-populated data`,children:e.jsx(I,{hoverable:!0,onClick:s,className:"cursor-pointer text-center h-full",children:e.jsxs("div",{className:"flex flex-col items-center gap-3 p-2",children:[e.jsx("div",{className:"text-forensic-500 dark:text-forensic-400",children:t.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-slate-100",children:t.title}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1 line-clamp-2",children:t.description})]}),e.jsx("span",{className:b("px-2 py-0.5 rounded-full text-xs font-medium capitalize",n[t.difficulty]),children:t.difficulty})]})})})}function di({session:t,onResume:s}){const n={ransomware:"Ransomware Attack",data_exfiltration:"Data Exfiltration",insider_threat:"Insider Threat",web_dos:"Web Resource DOS",ai_breach:"AI-Related Breach",custom:"Custom Investigation"};return e.jsx(y,{content:"Continue this investigation session",children:e.jsx(I,{hoverable:!0,onClick:s,className:"cursor-pointer",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-slate-900 dark:text-slate-100 truncate",children:n[t.scenarioType]||"Investigation"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-sm text-slate-500 dark:text-slate-400",children:[e.jsx(Ne,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:ai(t.lastModified)})]})]}),e.jsx("div",{className:"flex flex-col items-end gap-1",children:e.jsx("span",{className:b("px-2 py-0.5 rounded text-xs font-medium",t.isComplete?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"),children:t.isComplete?"Complete":`Step ${t.currentStep+1}`})})]})})})}function ui(){const t=q(),{goToNextStep:s,goToPreviousStep:n}=$(),{documents:r,repositories:a,extractedEntities:i,addDocument:c,removeDocument:o}=$t(),l=N.useRef(null),d=()=>{n(),t("/")},m=()=>{s(),t("/incident")},h=N.useCallback(async g=>{const S=g.target.files;if(S){for(const j of Array.from(S))await c(j);l.current&&(l.current.value="")}},[c]),u=N.useCallback(async g=>{g.preventDefault();const S=g.dataTransfer.files;for(const j of Array.from(S))await c(j)},[c]),w=g=>{g.preventDefault()},f=i.systems.length,x=i.networks.length,p=i.processes.length,v=i.compliance.length;return e.jsxs(Z,{title:"Organization Context",subtitle:"Upload documents to help AI understand your environment",footer:e.jsx(ne,{onBack:d,backLabel:"Dashboard",onContinue:m,continueLabel:"Continue"}),children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs(I,{children:[e.jsx(L,{title:"Upload Documents",description:"Drag and drop or browse files"}),e.jsxs("div",{className:"mt-4",children:[e.jsx(y,{content:"Drag and drop files or click to browse. Supports PDF, DOCX, XLSX, JSON, YAML, Visio",children:e.jsxs("div",{onDrop:u,onDragOver:w,onClick:()=>{var g;return(g=l.current)==null?void 0:g.click()},className:b("border-2 border-dashed rounded-lg p-8 text-center cursor-pointer","border-slate-300 dark:border-slate-600","hover:border-forensic-400 dark:hover:border-forensic-500","transition-colors duration-200"),children:[e.jsx(Dt,{className:"w-10 h-10 mx-auto text-slate-400 mb-3"}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Drag & Drop or"," ",e.jsx("span",{className:"text-forensic-500 font-medium",children:"Browse"})]}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"PDF, DOCX, XLSX, JSON, YAML, Visio"})]})}),e.jsx("input",{ref:l,type:"file",multiple:!0,accept:".pdf,.docx,.xlsx,.json,.yaml,.yml,.vsdx",onChange:h,className:"hidden"})]})]}),e.jsxs(I,{children:[e.jsx(L,{title:"Connect Repository",description:"Access documentation from code repos"}),e.jsx("div",{className:"mt-4 grid grid-cols-2 gap-3",children:["github","gitlab","sharepoint","bitbucket"].map(g=>{const S=or[g],j=a.some(E=>E.type===g&&E.status==="connected");return e.jsx(y,{content:`Connect to ${S.name} for infrastructure documentation`,children:e.jsxs("button",{className:b("flex items-center gap-2 p-3 rounded-lg border","transition-colors duration-200",j?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-slate-200 dark:border-slate-700 hover:border-forensic-400"),children:[e.jsx(Ms,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:S.name}),j&&e.jsx(U,{className:"w-4 h-4 text-green-500 ml-auto"})]})},g)})})]})]}),r.length>0&&e.jsxs("section",{className:"mb-8",children:[e.jsxs("h3",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:["Uploaded Documents (",r.length,")"]}),e.jsx("div",{className:"space-y-2",children:r.map(g=>e.jsx(mi,{document:g,onRemove:()=>o(g.id)},g.id))})]}),(f>0||x>0||p>0||v>0)&&e.jsxs("section",{children:[e.jsx("h3",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Extracted Context"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsx(De,{icon:e.jsx(Pt,{className:"w-5 h-5"}),label:"Systems",count:f,tooltip:"Systems, servers, and workstations identified"}),e.jsx(De,{icon:e.jsx(Ps,{className:"w-5 h-5"}),label:"Networks",count:x,tooltip:"Network segments and VLANs identified"}),e.jsx(De,{icon:e.jsx(Ne,{className:"w-5 h-5"}),label:"Processes",count:p,tooltip:"Critical business processes identified"}),e.jsx(De,{icon:e.jsx(Le,{className:"w-5 h-5"}),label:"Compliance",count:v,tooltip:"Compliance requirements identified"})]})]}),r.length===0&&a.length===0&&e.jsx(Dr,{icon:e.jsx(Fe,{className:"w-12 h-12"}),title:"No context uploaded yet",description:"Upload documents or connect repositories to provide organizational context for better analysis."})]})}function mi({document:t,onRemove:s}){const n=ir[t.type]||{name:"File",color:"text-slate-500"},r={uploading:e.jsx(at,{className:"w-4 h-4 animate-spin text-blue-500"}),parsing:e.jsx(at,{className:"w-4 h-4 animate-spin text-yellow-500"}),parsed:e.jsx(U,{className:"w-4 h-4 text-green-500"}),error:e.jsx(Ts,{className:"w-4 h-4 text-red-500"})},a={uploading:"Uploading...",parsing:"Parsing...",parsed:"Parsed",error:"Error"};return e.jsxs("div",{className:b("flex items-center gap-3 p-3 rounded-lg","bg-slate-50 dark:bg-slate-800/50","border border-slate-200 dark:border-slate-700"),children:[e.jsx(Fe,{className:b("w-5 h-5",n.color)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100 truncate",children:t.filename}),e.jsxs("p",{className:"text-xs text-slate-500",children:[ii(t.size)," "," ",e.jsx("span",{className:"capitalize",children:n.name})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{content:"Document is being analyzed to extract context",children:e.jsxs("div",{className:"flex items-center gap-1",children:[r[t.status],e.jsx("span",{className:"text-xs text-slate-500",children:a[t.status]})]})}),t.status==="parsed"&&e.jsx(y,{content:"Preview extracted data",children:e.jsx("button",{className:"p-1 hover:bg-slate-200 dark:hover:bg-slate-700 rounded",children:e.jsx(Is,{className:"w-4 h-4 text-slate-500"})})}),e.jsx(y,{content:"Remove document",children:e.jsx("button",{onClick:s,className:"p-1 hover:bg-red-100 dark:hover:bg-red-900/30 rounded text-slate-400 hover:text-red-500",children:e.jsx(Qe,{className:"w-4 h-4"})})})]})]})}function De({icon:t,label:s,count:n,tooltip:r}){return e.jsx(y,{content:r,children:e.jsx(I,{className:"text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"text-forensic-500",children:t}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:n}),e.jsx("p",{className:"text-xs text-slate-500",children:s})]})]})})})}function hi(){var _;const t=q(),{goToNextStep:s,goToPreviousStep:n,updateIncidentDescription:r,currentSession:a}=$(),[i,c]=N.useState(((_=a==null?void 0:a.incidentDescription)==null?void 0:_.naturalLanguage)||""),[o,l]=N.useState(""),[d,m]=N.useState(""),[h,u]=N.useState([]),[w,f]=N.useState("hash"),[x,p]=N.useState(""),v=()=>{n(),t("/context")},g=()=>{r({naturalLanguage:i,startDate:o?new Date(o):new Date,patientZero:{hostname:d,type:"workstation"},iocs:h.map((M,F)=>({id:`ioc-${F}`,type:M.type,value:M.value,confidence:"medium"}))}),s(),t("/connectors")},S=()=>{x.trim()&&(u([...h,{type:w,value:x}]),p(""))},j=M=>{u(h.filter((F,K)=>K!==M))},E=["Ransomware detected","Unauthorized access","Data exfiltration suspected","Malicious email received","System compromise"];return e.jsx(Z,{title:"Incident Description",subtitle:"Describe the security incident in detail",footer:e.jsx(ne,{onBack:v,backLabel:"Context",onContinue:g,continueLabel:"Continue"}),children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(I,{children:[e.jsx(L,{title:"Describe the Incident",description:"Provide a detailed description of what happened"}),e.jsxs("div",{className:"mt-4",children:[e.jsx(zt,{value:i,onChange:M=>c(M.target.value),placeholder:"Our finance department reported that multiple file servers became inaccessible around 2:30 AM on Tuesday. Users discovered ransom notes demanding Bitcoin payment...",minRows:5,tooltip:"Describe the incident in your own words. Include what happened, when it was discovered, and any initial observations."}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:E.map(M=>e.jsx(y,{content:"Click to add this common phrase",children:e.jsx("button",{onClick:()=>c(F=>F?`${F} ${M}.`:M),className:b("px-3 py-1 text-sm rounded-full","bg-slate-100 dark:bg-slate-700","text-slate-600 dark:text-slate-300","hover:bg-forensic-100 dark:hover:bg-forensic-900/30","hover:text-forensic-700 dark:hover:text-forensic-300","transition-colors duration-200"),children:M})},M))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(I,{children:[e.jsx(L,{title:"Incident Start Date",description:"When was the incident first discovered?"}),e.jsx("div",{className:"mt-4",children:e.jsx(ye,{type:"datetime-local",value:o,onChange:M=>l(M.target.value),leftAddon:e.jsx(It,{className:"w-4 h-4"}),tooltip:"When did the first indicator of the incident appear?"})})]}),e.jsxs(I,{children:[e.jsx(L,{title:"Patient Zero",description:"First affected system identified"}),e.jsx("div",{className:"mt-4",children:e.jsx(ye,{value:d,onChange:M=>m(M.target.value),placeholder:"e.g., ACCT-WS-042 or 10.20.30.42",leftAddon:e.jsx(Es,{className:"w-4 h-4"}),tooltip:"Enter the hostname or IP of the first affected system"})})]})]}),e.jsxs(I,{children:[e.jsx(L,{title:"Indicators of Compromise (IOCs)",description:"Add known IOCs associated with this incident"}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{content:"Type of Indicator of Compromise",children:e.jsxs("select",{value:w,onChange:M=>f(M.target.value),className:"input w-32",children:[e.jsx("option",{value:"hash",children:"Hash"}),e.jsx("option",{value:"ip",children:"IP Address"}),e.jsx("option",{value:"domain",children:"Domain"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"url",children:"URL"}),e.jsx("option",{value:"file_path",children:"File Path"})]})}),e.jsx(ye,{value:x,onChange:M=>p(M.target.value),placeholder:"Enter IOC value...",className:"flex-1",tooltip:"Enter the IOC value"}),e.jsx(y,{content:"Add another Indicator of Compromise to the list",children:e.jsx(D,{onClick:S,leftIcon:e.jsx(Os,{className:"w-4 h-4"}),children:"Add"})})]}),h.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:h.map((M,F)=>e.jsxs(Y,{variant:"secondary",children:[e.jsxs("span",{className:"font-medium capitalize",children:[M.type,":"]})," ",e.jsx("span",{className:"font-mono text-xs",children:M.value}),e.jsx("button",{onClick:()=>j(F),className:"ml-1 hover:text-red-500",children:e.jsx(Qe,{className:"w-3 h-3"})})]},F))})]})]})]})})}function xi(){const t=q(),{goToNextStep:s,goToPreviousStep:n}=$(),[r,a]=N.useState("endpoints"),[i,c]=N.useState(new Set),[o,l]=N.useState(!1),[d,m]=N.useState(null),h=()=>{n(),t("/incident")},u=()=>{s(),t("/validation")},w=v=>{m(v),l(!0)},f=()=>{d&&c(new Set([...i,d])),l(!1),m(null)},x=v=>({windows:e.jsx(Tt,{className:"w-6 h-6"}),linux:e.jsx(_s,{className:"w-6 h-6"}),macos:e.jsx(Fs,{className:"w-6 h-6"}),aws:e.jsx(Ie,{className:"w-6 h-6"}),azure:e.jsx(Ie,{className:"w-6 h-6"}),gcp:e.jsx(Ie,{className:"w-6 h-6"}),o365:e.jsx(it,{className:"w-6 h-6"}),gsuite:e.jsx(it,{className:"w-6 h-6"}),firewall:e.jsx(Le,{className:"w-6 h-6"}),storage:e.jsx(Ls,{className:"w-6 h-6"}),email_gateway:e.jsx(Rs,{className:"w-6 h-6"}),proxy_waf:e.jsx(Mt,{className:"w-6 h-6"})})[v],p=ft.find(v=>v.id===r);return e.jsxs(Z,{title:"Connector Configuration",subtitle:"Configure data sources for forensic analysis",footer:e.jsx(ne,{onBack:h,backLabel:"Incident",onContinue:u,continueLabel:"Continue",middleContent:e.jsxs("span",{className:"text-sm text-slate-500",children:[i.size," connector",i.size!==1?"s":""," configured"]})}),children:[e.jsx("div",{className:"flex gap-2 mb-6 border-b border-slate-200 dark:border-slate-700",children:ft.map(v=>e.jsx(y,{content:v.description,children:e.jsx("button",{onClick:()=>a(v.id),className:b("px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors",r===v.id?"border-forensic-500 text-forensic-600 dark:text-forensic-400":"border-transparent text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"),children:v.name})},v.id))}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:p==null?void 0:p.connectors.map(v=>{const g=gt[v],S=i.has(v);return e.jsx(fi,{type:v,name:g.name,description:g.description,icon:x(v),isConfigured:S,onConfigure:()=>w(v)},v)})}),e.jsx(Kn,{open:o,onOpenChange:l,title:`Configure ${d?gt[d].name:""}`,description:"Enter connection details for this data source",size:"md",footer:e.jsxs(e.Fragment,{children:[e.jsx(D,{variant:"secondary",onClick:()=>l(!1),children:"Cancel"}),e.jsx(y,{content:"Verify connectivity to this system (simulated)",children:e.jsx(D,{variant:"outline",children:"Test Connection"})}),e.jsx(D,{onClick:f,children:"Save"})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Hostname / IP"}),e.jsx("input",{type:"text",className:"input",placeholder:"e.g., 10.0.1.10 or server.domain.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Username"}),e.jsx("input",{type:"text",className:"input",placeholder:"Service account username"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Password / Key"}),e.jsx("input",{type:"password",className:"input",placeholder:"Service account password"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"mockMode",className:"rounded",defaultChecked:!0}),e.jsx("label",{htmlFor:"mockMode",className:"text-sm text-slate-600 dark:text-slate-400",children:"Use simulated data for demo"})]})]})})]})}function fi({name:t,description:s,icon:n,isConfigured:r,onConfigure:a}){return e.jsxs(I,{className:b(r&&"ring-2 ring-green-500 ring-offset-2 dark:ring-offset-slate-900"),children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:b("text-slate-400",r&&"text-green-500"),children:n}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100",children:t}),r&&e.jsx(U,{className:"w-4 h-4 text-green-500"})]}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:s})]})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[e.jsx(y,{content:"Open configuration form for this data source",children:e.jsx(D,{size:"sm",variant:r?"secondary":"primary",onClick:a,leftIcon:e.jsx(As,{className:"w-4 h-4"}),children:r?"Reconfigure":"Configure"})}),e.jsx(y,{content:"Use simulated data instead of real connection",children:e.jsxs("label",{className:"flex items-center gap-1 text-xs text-slate-500 cursor-pointer",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded w-3 h-3"}),"Mock"]})})]})]})}function gi(){const t=q(),{goToNextStep:s,goToPreviousStep:n}=$(),{extractedEntities:r}=$t(),{systems:a,autoValidateEnabled:i,discrepancies:c,isValidating:o,initializeFromSystems:l,setAutoValidate:d,validateSystem:m,validateAllSystems:h}=jr();N.useEffect(()=>{r.systems.length>0&&a.length===0&&l(r.systems)},[r.systems,a.length,l]);const u=()=>{n(),t("/connectors")},w=()=>{s(),t("/triage")},f=a.filter(g=>g.overallStatus==="verified").length,x=a.filter(g=>g.overallStatus==="failed").length,p=a.filter(g=>g.overallStatus==="pending").length,v=a.filter(g=>g.overallStatus==="unknown").length;return e.jsxs(Z,{title:"Infrastructure Validation",subtitle:"Verify documented systems exist and match reality",actions:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{content:"Automatically validate all documented systems when page loads",children:e.jsxs("button",{onClick:()=>d(!i),className:b("flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors",i?"bg-forensic-100 text-forensic-700 dark:bg-forensic-900/30 dark:text-forensic-300":"bg-slate-100 text-slate-600 dark:bg-slate-800 dark:text-slate-400"),children:[i?e.jsx(zs,{className:"w-5 h-5"}):e.jsx(Ws,{className:"w-5 h-5"}),"Auto-Validate"]})}),e.jsx(y,{content:"Run validation checks on all documented systems",children:e.jsx(D,{variant:"primary",size:"sm",onClick:h,isLoading:o,leftIcon:e.jsx(Et,{className:"w-4 h-4"}),children:"Validate All"})}),e.jsx(y,{content:"Export validation results as CSV",children:e.jsx(D,{variant:"secondary",size:"sm",leftIcon:e.jsx(He,{className:"w-4 h-4"}),children:"Export"})})]}),footer:e.jsx(ne,{onBack:u,backLabel:"Connectors",onContinue:w,continueLabel:c.length>0?"Continue with Warnings":"Continue"}),children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6",children:[e.jsx(Me,{icon:e.jsx(U,{className:"w-5 h-5"}),count:f,label:"Verified",color:"green"}),e.jsx(Me,{icon:e.jsx(Je,{className:"w-5 h-5"}),count:x,label:"Failed",color:"red"}),e.jsx(Me,{icon:e.jsx(Ne,{className:"w-5 h-5"}),count:p,label:"Pending",color:"yellow"}),e.jsx(Me,{icon:e.jsx(Ze,{className:"w-5 h-5"}),count:v,label:"Unknown",color:"slate"})]}),c.length>0&&e.jsx(I,{className:"mb-6 border-yellow-300 dark:border-yellow-700 bg-yellow-50 dark:bg-yellow-900/20",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ke,{className:"w-5 h-5 text-yellow-500 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:["Discrepancy Alerts (",c.length,")"]}),e.jsxs("ul",{className:"mt-2 space-y-1 text-sm text-yellow-700 dark:text-yellow-300",children:[c.slice(0,3).map(g=>e.jsxs("li",{children:[e.jsxs("span",{className:"font-medium",children:[g.hostname,":"]})," ",g.description]},g.id)),c.length>3&&e.jsxs("li",{className:"text-yellow-600 dark:text-yellow-400",children:["+",c.length-3," more discrepancies"]})]})]})]})}),e.jsx(I,{padding:"none",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 dark:bg-slate-800/50 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"System"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"IP"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Methods"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:a.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-4 py-12 text-center",children:[e.jsx(Pt,{className:"w-10 h-10 mx-auto text-slate-300 mb-3"}),e.jsx("p",{className:"text-slate-500",children:"No systems to validate"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Upload documents with system information first"})]})}):a.map(g=>e.jsx(pi,{system:g,onValidate:()=>m(g.systemId),isValidating:o},g.systemId))})]})})})]})}function Me({icon:t,count:s,label:n,color:r}){const a={green:"text-green-500 bg-green-50 dark:bg-green-900/20",red:"text-red-500 bg-red-50 dark:bg-red-900/20",yellow:"text-yellow-500 bg-yellow-50 dark:bg-yellow-900/20",slate:"text-slate-400 bg-slate-50 dark:bg-slate-800/50"};return e.jsx(I,{className:b("text-center",a[r]),children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[t,e.jsx("span",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:s}),e.jsx("span",{className:"text-xs text-slate-500",children:n})]})})}function pi({system:t,onValidate:s,isValidating:n}){const r={verified:e.jsx(U,{className:"w-4 h-4 text-green-500"}),failed:e.jsx(Je,{className:"w-4 h-4 text-red-500"}),pending:e.jsx(Ne,{className:"w-4 h-4 text-yellow-500"}),unknown:e.jsx(Ze,{className:"w-4 h-4 text-slate-400"})};return e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/30",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"font-medium text-slate-900 dark:text-slate-100",children:t.hostname})}),e.jsx("td",{className:"px-4 py-3 font-mono text-sm text-slate-600 dark:text-slate-400",children:t.documentedIP}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 dark:text-slate-400",children:t.role}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-1",children:[t.validationMethods.slice(0,3).map(a=>e.jsx(y,{content:ar[a].description,children:e.jsx(Y,{variant:"secondary",size:"sm",children:a.toUpperCase().slice(0,3)})},a)),t.validationMethods.length>3&&e.jsxs(Y,{variant:"secondary",size:"sm",children:["+",t.validationMethods.length-3]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[r[t.overallStatus],e.jsx("span",{className:b("text-sm capitalize",t.overallStatus==="verified"&&"text-green-600",t.overallStatus==="failed"&&"text-red-600",t.overallStatus==="pending"&&"text-yellow-600",t.overallStatus==="unknown"&&"text-slate-500"),children:t.overallStatus})]})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx(y,{content:"Run validation checks on this system",children:e.jsx(D,{variant:"ghost",size:"sm",onClick:s,disabled:n,leftIcon:n&&t.overallStatus==="pending"?e.jsx(Xn,{size:"sm"}):e.jsx(Et,{className:"w-3 h-3"}),children:"Validate"})})})]})}function bi(){var re;const t=q(),{goToNextStep:s,goToPreviousStep:n}=$(),[r,a]=N.useState(!1),[i,c]=N.useState(!1),[o,l]=N.useState(0),[d,m]=N.useState(0),[h,u]=N.useState(oe.map(()=>0)),[w,f]=N.useState([]),[x,p]=N.useState({critical:0,high:0,medium:0,low:0,ambiguous:0}),v=N.useRef(null),g=N.useRef(null);N.useEffect(()=>{v.current&&(v.current.scrollTop=v.current.scrollHeight)},[w]),N.useEffect(()=>{if(!r||i){g.current&&clearInterval(g.current);return}return g.current=setInterval(()=>{if(l(O=>{const C=O+1;return C>=100?(a(!1),100):C}),u(O=>{const C=[...O],z=100/oe.length;for(let R=0;R<oe.length;R++){const ue=R*z,ae=(R+1)*z,ie=o+1;ie>=ae?C[R]=100:ie>ue&&(C[R]=(ie-ue)/z*100,m(R))}return C}),Math.random()>.5){const O=[{message:"Collecting Windows Security Event Logs...",severity:"info"},{message:"Analyzing authentication patterns...",severity:"info"},{message:"Found suspicious process execution",severity:"warning"},{message:"Extracting registry artifacts...",severity:"info"},{message:"Correlating network connections...",severity:"info"},{message:"Detected potential lateral movement",severity:"warning"},{message:"Identified scheduled task persistence",severity:"warning"},{message:"Phase completed successfully",severity:"success"}],C=O[Math.floor(Math.random()*O.length)];f(z=>{var R;return[...z.slice(-49),{id:`${Date.now()}-${Math.random()}`,timestamp:new Date,phase:((R=oe[d])==null?void 0:R.name)||"Analysis",...C}]}),Math.random()>.85&&p(z=>{const R=["critical","high","medium","low","ambiguous"][Math.floor(Math.random()*5)];return{...z,[R]:z[R]+1}})}},200),()=>{g.current&&clearInterval(g.current)}},[r,i,o,d]);const S=()=>{n(),t("/validation")},j=()=>{s(),t("/timeline")},E=()=>{a(!0),c(!1)},_=()=>{c(!i)},M=O=>{const C=[e.jsx(Bs,{className:"w-5 h-5"},"db"),e.jsx($s,{className:"w-5 h-5"},"search"),e.jsx(Ee,{className:"w-5 h-5"},"activity"),e.jsx(Vs,{className:"w-5 h-5"},"git"),e.jsx(Gs,{className:"w-5 h-5"},"radar")];return C[O]||C[0]},F=O=>h[O]>=100?"complete":h[O]>0?"running":"pending",K=x.critical+x.high+x.medium+x.low;return e.jsxs(Z,{title:"Triage Process",subtitle:"Automated forensic analysis in progress",footer:e.jsx(ne,{onBack:S,backLabel:"Validation",onContinue:j,continueLabel:"View Timeline",continueDisabled:o<100}),children:[e.jsx(I,{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-6",children:[e.jsx(Un,{value:o,size:140,variant:o>=100?"success":"default"}),e.jsxs("div",{className:"flex-1 text-center sm:text-left",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:o>=100?"Analysis Complete":i?"Paused":r?((re=oe[d])==null?void 0:re.name)||"Analyzing...":"Ready to Start"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:o>=100?`Found ${K} findings (${x.ambiguous} require verification)`:r?"Processing forensic data...":"Click Start to begin the automated triage process"}),e.jsxs("div",{className:"mt-4 flex gap-2 justify-center sm:justify-start",children:[!r&&o<100&&e.jsx(y,{content:"Begin automated forensic triage",children:e.jsx(D,{onClick:E,leftIcon:e.jsx(ot,{className:"w-4 h-4"}),children:"Start Triage"})}),r&&e.jsx(y,{content:i?"Resume the triage process":"Pause the triage process",children:e.jsx(D,{variant:"secondary",onClick:_,leftIcon:i?e.jsx(ot,{className:"w-4 h-4"}):e.jsx(Ys,{className:"w-4 h-4"}),children:i?"Resume":"Pause"})})]})]})]})}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:oe.map((O,C)=>e.jsx(wi,{name:O.name,icon:M(C),progress:h[C],status:F(C)},O.id))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(I,{className:"h-[400px] flex flex-col",children:[e.jsx(L,{title:"Activity Feed",description:"Real-time log of triage operations"}),e.jsx("div",{ref:v,className:"flex-1 overflow-y-auto mt-4 space-y-2",children:w.length===0?e.jsx("p",{className:"text-sm text-slate-400 text-center py-8",children:"Activity will appear here when triage starts..."}):w.map(O=>e.jsx(vi,{log:O},O.id))})]})}),e.jsx("div",{children:e.jsxs(I,{className:"h-[400px]",children:[e.jsx(L,{title:"Findings",description:"Detected issues and anomalies"}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx(be,{label:"Critical",count:x.critical,color:"red"}),e.jsx(be,{label:"High",count:x.high,color:"orange"}),e.jsx(be,{label:"Medium",count:x.medium,color:"yellow"}),e.jsx(be,{label:"Low",count:x.low,color:"green"}),e.jsx("hr",{className:"border-slate-200 dark:border-slate-700"}),e.jsx(be,{label:"Ambiguous",count:x.ambiguous,color:"purple",tooltip:"Findings requiring manual review"})]})]})})]})]})}function wi({name:t,icon:s,progress:n,status:r}){return e.jsx(I,{className:b("text-center",r==="complete"&&"ring-2 ring-green-500 ring-offset-2 dark:ring-offset-slate-900"),children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:b(r==="complete"&&"text-green-500",r==="running"&&"text-forensic-500 animate-pulse",r==="pending"&&"text-slate-300 dark:text-slate-600"),children:r==="complete"?e.jsx(U,{className:"w-5 h-5"}):s}),e.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:t}),e.jsx(Oe,{value:n,size:"sm",variant:r==="complete"?"success":"default"})]})})}function vi({log:t}){const s={info:"text-slate-400",warning:"text-yellow-500",success:"text-green-500",error:"text-red-500"};return e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx("span",{className:"text-xs font-mono text-slate-400 whitespace-nowrap",children:es(t.timestamp)}),e.jsx("span",{className:b("flex-1",s[t.severity]),children:t.message})]})}function be({label:t,count:s,color:n,tooltip:r}){const a={red:"bg-red-500",orange:"bg-orange-500",yellow:"bg-yellow-500",green:"bg-green-500",purple:"bg-purple-500"},i=e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:b("w-2 h-2 rounded-full",a[n])}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:t})]}),e.jsx("span",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:s})]});return r?e.jsx(y,{content:r,children:i}):i}const yi=[{id:"1",timestamp:new Date("2024-01-15T02:30:15"),source:"windows_security",severity:"critical",title:"Suspicious Process Execution",summary:"PsExec.exe executed with SYSTEM privileges",category:"process_execution",rawLog:`EventID: 4688
Process Name: C:\\Windows\\System32\\PsExec.exe
User: NT AUTHORITY\\SYSTEM`,relatedCount:3},{id:"2",timestamp:new Date("2024-01-15T02:31:00"),source:"firewall",severity:"high",title:"Outbound Connection to Known C2",summary:"Connection to 185.220.101.42:443 blocked",category:"network_connection",rawLog:`Action: Block
Direction: Outbound
Dest IP: 185.220.101.42
Dest Port: 443`,relatedCount:5},{id:"3",timestamp:new Date("2024-01-15T02:32:30"),source:"windows_security",severity:"medium",title:"Scheduled Task Created",summary:'New scheduled task "WindowsUpdate" created',category:"persistence",rawLog:`Task Name: WindowsUpdate
Action: C:\\Users\\Public\\update.exe
Trigger: At startup`,relatedCount:1},{id:"4",timestamp:new Date("2024-01-15T02:35:00"),source:"azure_activity",severity:"high",title:"Bulk File Download",summary:"1,247 files downloaded from SharePoint",category:"data_exfiltration",rawLog:`Operation: FileDownloaded
Count: 1247
User: jsmith@company.com`,relatedCount:2},{id:"5",timestamp:new Date("2024-01-15T02:40:00"),source:"windows_security",severity:"critical",title:"Lateral Movement Detected",summary:"Remote WMI execution on DC-MAIN-01",category:"lateral_movement",rawLog:`EventID: 4624
Logon Type: 3
Target: DC-MAIN-01
Source: ACCT-WS-042`,relatedCount:8}];function ji(){const t=q(),{goToNextStep:s,goToPreviousStep:n}=$(),[r,a]=N.useState(null),[i,c]=N.useState(""),[o,l]=N.useState(1),d=()=>{n(),t("/triage")},m=()=>{s(),t("/verification")},h=yi.filter(f=>f.title.toLowerCase().includes(i.toLowerCase())||f.summary.toLowerCase().includes(i.toLowerCase())),u=f=>f.includes("windows")?e.jsx(Tt,{className:"w-4 h-4"}):f.includes("azure")||f.includes("cloud")?e.jsx(Ie,{className:"w-4 h-4"}):f.includes("firewall")?e.jsx(Le,{className:"w-4 h-4"}):e.jsx(Ee,{className:"w-4 h-4"}),w=f=>{const x={critical:"bg-red-500",high:"bg-orange-500",medium:"bg-yellow-500",low:"bg-green-500",info:"bg-blue-500"};return x[f]||x.info};return e.jsxs(Z,{title:"Timeline View",subtitle:"Interactive timeline of security events",actions:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{content:"Zoom out on timeline",children:e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>l(Math.max(.5,o-.25)),children:e.jsx(Hs,{className:"w-4 h-4"})})}),e.jsxs("span",{className:"text-sm text-slate-500",children:[Math.round(o*100),"%"]}),e.jsx(y,{content:"Zoom in on timeline",children:e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>l(Math.min(2,o+.25)),children:e.jsx(Us,{className:"w-4 h-4"})})})]}),footer:e.jsx(ne,{onBack:d,backLabel:"Triage",onContinue:m,continueLabel:"Proceed to Review"}),children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[e.jsx("div",{className:"flex-1 min-w-[200px] max-w-md",children:e.jsx(Jn,{value:i,onChange:f=>c(f.target.value),placeholder:"Search events...",tooltip:"Search events by keyword"})}),e.jsx(y,{content:"Filter by data source",children:e.jsx(D,{variant:"outline",size:"sm",leftIcon:e.jsx(ct,{className:"w-4 h-4"}),children:"Source"})}),e.jsx(y,{content:"Filter by severity level",children:e.jsx(D,{variant:"outline",size:"sm",leftIcon:e.jsx(ct,{className:"w-4 h-4"}),children:"Severity"})}),e.jsx(y,{content:"Filter events by date range",children:e.jsx(D,{variant:"outline",size:"sm",leftIcon:e.jsx(It,{className:"w-4 h-4"}),children:"Date Range"})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(I,{className:"min-h-[500px]",children:[e.jsx(L,{title:"Event Timeline",description:`${h.length} events  Jan 15, 2024`}),e.jsxs("div",{className:"mt-6 relative",children:[e.jsxs("div",{className:"flex justify-between text-xs text-slate-400 mb-4",children:[e.jsx("span",{children:"02:30"}),e.jsx("span",{children:"02:35"}),e.jsx("span",{children:"02:40"}),e.jsx("span",{children:"02:45"})]}),e.jsx("div",{className:"space-y-4",children:["Windows","Cloud","Network"].map(f=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-16 text-xs text-slate-500 text-right",children:f}),e.jsx("div",{className:"flex-1 h-10 bg-slate-100 dark:bg-slate-800 rounded relative",children:h.filter(x=>f==="Windows"?x.source.includes("windows"):f==="Cloud"?x.source.includes("azure"):x.source.includes("firewall")).map(x=>e.jsx(y,{content:x.title,children:e.jsx("button",{onClick:()=>a(x),className:b("absolute top-1/2 -translate-y-1/2 w-4 h-4 rounded-full","transition-transform hover:scale-150","ring-2 ring-white dark:ring-slate-900",w(x.severity),(r==null?void 0:r.id)===x.id&&"ring-4 ring-forensic-400"),style:{left:`${(x.timestamp.getMinutes()-30)/15*100}%`}})},x.id))})]},f))}),e.jsx("svg",{className:"absolute inset-0 pointer-events-none opacity-30",children:e.jsx("line",{x1:"20%",y1:"30%",x2:"40%",y2:"70%",stroke:"currentColor",strokeDasharray:"4",className:"text-forensic-500"})})]}),e.jsx("div",{className:"mt-8 space-y-2",children:h.map(f=>e.jsx(Ni,{event:f,isSelected:(r==null?void 0:r.id)===f.id,onClick:()=>a(f),sourceIcon:u(f.source)},f.id))})]})}),e.jsx("div",{children:e.jsx(I,{className:"sticky top-24 min-h-[500px]",children:r?e.jsx(ki,{event:r,onClose:()=>a(null)}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center py-12",children:[e.jsx(Ee,{className:"w-12 h-12 text-slate-300 mb-3"}),e.jsx("p",{className:"text-slate-500",children:"Select an event to view details"})]})})})]})]})}function Ni({event:t,isSelected:s,onClick:n,sourceIcon:r}){return e.jsxs("button",{onClick:n,className:b("w-full flex items-center gap-3 p-3 rounded-lg text-left transition-colors",s?"bg-forensic-50 dark:bg-forensic-900/20 ring-1 ring-forensic-500":"hover:bg-slate-50 dark:hover:bg-slate-800/50"),children:[e.jsx("span",{className:"text-slate-400",children:r}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100 truncate",children:t.title}),e.jsx("p",{className:"text-xs text-slate-500 truncate",children:t.summary})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tt,{severity:t.severity,size:"sm"}),e.jsx("span",{className:"text-xs text-slate-400",children:es(t.timestamp)})]})]})}function ki({event:t,onClose:s}){const[n,r]=N.useState(!1);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-slate-100",children:t.title}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:ri(t.timestamp)})]}),e.jsx("button",{onClick:s,className:"p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded",children:e.jsx(Qe,{className:"w-4 h-4 text-slate-400"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsx(tt,{severity:t.severity})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 uppercase mb-1",children:"Summary"}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:t.summary})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 uppercase mb-1",children:"Source"}),e.jsx(Y,{variant:"secondary",children:t.source.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 uppercase mb-1",children:"Category"}),e.jsx(Y,{variant:"info",children:t.category.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-slate-500 uppercase mb-1",children:"Related Events"}),e.jsxs("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:[t.relatedCount," correlated event",t.relatedCount!==1?"s":""]})]}),e.jsxs("div",{children:[e.jsx(y,{content:"View full raw log data",children:e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>r(!n),fullWidth:!0,children:[n?"Hide":"View"," Raw Log"]})}),n&&e.jsxs("div",{className:"mt-3 relative",children:[e.jsx("pre",{className:"text-xs bg-slate-900 text-slate-100 p-3 rounded-lg overflow-x-auto",children:t.rawLog}),e.jsx(y,{content:"Copy raw log to clipboard",children:e.jsx("button",{onClick:()=>navigator.clipboard.writeText(t.rawLog),className:"absolute top-2 right-2 p-1 hover:bg-slate-700 rounded",children:e.jsx(qs,{className:"w-3 h-3 text-slate-400"})})})]})]})]})]})}const te=[{id:"1",title:"PsExec Remote Execution",category:"dual_use_tool",severity:"medium",confidence:65,description:"PsExec was used to execute commands on remote systems. This tool has legitimate administrative uses but is commonly abused by attackers.",evidence:[{type:"Event Log",content:"EventID 4688: Process PsExec.exe created"},{type:"Process",content:"Parent: cmd.exe, User: CORP\\admin_jsmith"}],historicalContext:"This user has used PsExec 3 times in the past month for legitimate patching.",expertGuidance:"Review the target systems and timing. PsExec usage outside maintenance windows is suspicious.",legitimateUseCases:["System patching","Remote administration","Incident response"],suspiciousIndicators:["Unusual timing (2:30 AM)","Multiple targets in sequence","SYSTEM privilege usage"]},{id:"2",title:"Bulk File Access",category:"data_theft",severity:"high",confidence:72,description:"Large number of files accessed from finance share in short timeframe.",evidence:[{type:"File Access",content:"1,247 files accessed in 15 minutes"},{type:"User Activity",content:"User: jsmith, Time: 02:35-02:50 AM"}],historicalContext:"User typically accesses 20-30 files per day during business hours.",expertGuidance:"This is a significant deviation from baseline. Check if there was authorized backup or migration.",legitimateUseCases:["Quarter-end reporting","Authorized backup","Department migration"],suspiciousIndicators:["Off-hours activity","6000% above baseline","Sensitive file types"]},{id:"3",title:"Scheduled Task Persistence",category:"persistence_mechanism",severity:"high",confidence:85,description:"New scheduled task created pointing to executable in Public folder.",evidence:[{type:"Task Details",content:"Task: WindowsUpdate, Action: C:\\Users\\Public\\update.exe"},{type:"Timing",content:"Created 3 minutes after initial compromise indicator"}],historicalContext:"No legitimate tasks have been created in Public folder in past year.",expertGuidance:"Tasks in Public folder are highly suspicious. Likely malicious persistence mechanism.",legitimateUseCases:["IT deployment scripts","Third-party installers"],suspiciousIndicators:["Public folder location","Generic task name","Timing correlation"]}];function Si(){const t=q(),{goToNextStep:s,goToPreviousStep:n}=$(),[r,a]=N.useState(0),[i,c]=N.useState({}),[o,l]=N.useState(""),d=te[r],m=te.length,h=Object.keys(i).length,u=()=>{n(),t("/timeline")},w=()=>{s(),t("/report")},f=()=>{r>0&&(a(r-1),l(""))},x=()=>{r<m-1&&(a(r+1),l(""))},p=S=>{c({...i,[d.id]:S})},v=()=>{const S={...i};te.forEach(j=>{S[j.id]||(S[j.id]="needs_investigation")}),c(S)},g=i[d.id];return e.jsxs(Z,{title:"Verification Wizard",subtitle:"Review and classify ambiguous findings",footer:e.jsx(ne,{onBack:u,backLabel:"Timeline",onContinue:w,continueLabel:"Generate Report",continueDisabled:h<m}),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:["Finding ",r+1," of ",m]}),e.jsx(Oe,{value:h/m*100,className:"w-32"}),e.jsxs("span",{className:"text-sm text-slate-500",children:[h," reviewed"]})]}),e.jsx(y,{content:"Accept defaults for remaining items",children:e.jsx(D,{variant:"ghost",size:"sm",onClick:v,leftIcon:e.jsx(Xs,{className:"w-4 h-4"}),children:"Skip All"})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(I,{className:"min-h-[500px]",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs(Y,{variant:"secondary",children:["#",r+1]}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:d.title})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tt,{severity:d.severity}),e.jsx(Y,{variant:"info",children:d.category.replace("_"," ")})]})]}),e.jsx("div",{className:"text-right",children:e.jsx(y,{content:"Automated confidence level",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-slate-500",children:"Confidence"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{value:d.confidence,size:"sm",className:"w-16",variant:d.confidence>75?"danger":d.confidence>50?"warning":"default"}),e.jsxs("span",{className:"text-sm font-medium",children:[d.confidence,"%"]})]})]})})})]}),e.jsx("div",{className:"mb-6",children:e.jsx("p",{className:"text-slate-700 dark:text-slate-300",children:d.description})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Evidence"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:d.evidence.map((S,j)=>e.jsx(y,{content:"View complete evidence",children:e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Fe,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:S.type})]}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300 line-clamp-2",children:S.content})]})},j))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Classification"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(y,{content:"Confirm this activity as malicious based on evidence",children:e.jsxs("button",{onClick:()=>p("malicious"),className:b("flex-1 flex items-center justify-center gap-2 p-3 rounded-lg border-2 transition-colors",g==="malicious"?"border-red-500 bg-red-50 dark:bg-red-900/20":"border-slate-200 dark:border-slate-700 hover:border-red-300"),children:[e.jsx(Je,{className:b("w-5 h-5",g==="malicious"?"text-red-500":"text-slate-400")}),e.jsx("span",{className:b("font-medium",g==="malicious"?"text-red-700 dark:text-red-300":"text-slate-600 dark:text-slate-400"),children:"Malicious"})]})}),e.jsx(y,{content:"Mark as legitimate activity",children:e.jsxs("button",{onClick:()=>p("benign"),className:b("flex-1 flex items-center justify-center gap-2 p-3 rounded-lg border-2 transition-colors",g==="benign"?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-slate-200 dark:border-slate-700 hover:border-green-300"),children:[e.jsx(U,{className:b("w-5 h-5",g==="benign"?"text-green-500":"text-slate-400")}),e.jsx("span",{className:b("font-medium",g==="benign"?"text-green-700 dark:text-green-300":"text-slate-600 dark:text-slate-400"),children:"Benign"})]})}),e.jsx(y,{content:"Flag for deeper analysis",children:e.jsxs("button",{onClick:()=>p("needs_investigation"),className:b("flex-1 flex items-center justify-center gap-2 p-3 rounded-lg border-2 transition-colors",g==="needs_investigation"?"border-yellow-500 bg-yellow-50 dark:bg-yellow-900/20":"border-slate-200 dark:border-slate-700 hover:border-yellow-300"),children:[e.jsx(Ze,{className:b("w-5 h-5",g==="needs_investigation"?"text-yellow-500":"text-slate-400")}),e.jsx("span",{className:b("font-medium",g==="needs_investigation"?"text-yellow-700 dark:text-yellow-300":"text-slate-600 dark:text-slate-400"),children:"Investigate"})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 block",children:"Justification (optional)"}),e.jsx("textarea",{value:o,onChange:S=>l(S.target.value),placeholder:"Add notes for your decision...",className:"input min-h-[80px]"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(D,{variant:"ghost",onClick:f,disabled:r===0,leftIcon:e.jsx(Qs,{className:"w-4 h-4"}),children:"Previous"}),e.jsx("div",{className:"flex gap-1",children:te.map((S,j)=>e.jsx("button",{onClick:()=>a(j),className:b("w-3 h-3 rounded-full transition-colors",j===r?"bg-forensic-500":i[te[j].id]?i[te[j].id]==="malicious"?"bg-red-500":i[te[j].id]==="benign"?"bg-green-500":"bg-yellow-500":"bg-slate-300 dark:bg-slate-600")},j))}),e.jsx(D,{variant:"ghost",onClick:x,disabled:r===m-1,rightIcon:e.jsx(Js,{className:"w-4 h-4"}),children:"Next"})]})]})}),e.jsx("div",{children:e.jsxs(I,{className:"sticky top-24",children:[e.jsx(L,{title:"Context"}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Zs,{className:"w-4 h-4 text-slate-400"}),e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Historical Context"})]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:d.historicalContext})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ks,{className:"w-4 h-4 text-yellow-500"}),e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Expert Guidance"})]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:d.expertGuidance})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Legitimate Use Cases"}),e.jsx("ul",{className:"space-y-1",children:d.legitimateUseCases.map((S,j)=>e.jsxs("li",{className:"text-sm text-slate-600 dark:text-slate-400 flex items-center gap-2",children:[e.jsx(U,{className:"w-3 h-3 text-green-500"}),S]},j))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Suspicious Indicators"}),e.jsx("ul",{className:"space-y-1",children:d.suspiciousIndicators.map((S,j)=>e.jsxs("li",{className:"text-sm text-slate-600 dark:text-slate-400 flex items-center gap-2",children:[e.jsx(Ke,{className:"w-3 h-3 text-red-500"}),S]},j))})]})]})]})})]})]})}function Ci(){const t=q(),{goToPreviousStep:s}=$(),[n,r]=N.useState("pdf"),[a,i]=N.useState(!1),[c,o]=N.useState(!0),l=()=>{s(),t("/verification")},d=()=>{alert(`Exporting report as ${n.toUpperCase()}...`)},m=()=>{t("/")},h={incidentSummary:"Ransomware attack via phishing email targeting finance department",affectedSystems:12,totalFindings:23,criticalFindings:5,timeToDetection:"4 hours",dataAtRisk:"Customer PII, Financial Records",businessImpact:{operational:"high",financial:"medium",reputational:"low",regulatory:"high"},recommendations:[{priority:"immediate",title:"Isolate affected systems",status:"pending"},{priority:"immediate",title:"Reset compromised credentials",status:"pending"},{priority:"short_term",title:"Implement MFA for all admin accounts",status:"pending"},{priority:"short_term",title:"Deploy EDR solution",status:"pending"},{priority:"long_term",title:"Security awareness training",status:"pending"}],gaps:[{category:"Detection",current:2,target:4,gap:"No behavioral analytics"},{category:"Response",current:3,target:4,gap:"Manual playbooks only"},{category:"Prevention",current:2,target:5,gap:"Limited email security"}]};return e.jsx(Z,{title:"Report Generation",subtitle:"Review and export the investigation report",footer:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(D,{variant:"ghost",onClick:l,children:"Back to Verification"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{variant:"secondary",onClick:m,children:"New Investigation"}),e.jsx(y,{content:`Export report as ${n.toUpperCase()}`,children:e.jsx(D,{onClick:d,leftIcon:e.jsx(He,{className:"w-4 h-4"}),children:"Export Report"})})]})]}),children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsx(I,{className:"bg-gradient-to-br from-slate-50 to-white dark:from-slate-800 dark:to-slate-800/50",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-forensic-100 dark:bg-forensic-900/30 rounded-lg",children:e.jsx(Le,{className:"w-6 h-6 text-forensic-600 dark:text-forensic-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 mb-2",children:"Executive Summary"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-4",children:h.incidentSummary}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsx(Pe,{icon:e.jsx(en,{className:"w-4 h-4"}),label:"Affected Systems",value:h.affectedSystems}),e.jsx(Pe,{icon:e.jsx(Ke,{className:"w-4 h-4"}),label:"Total Findings",value:h.totalFindings,subValue:`${h.criticalFindings} critical`}),e.jsx(Pe,{icon:e.jsx(Ne,{className:"w-4 h-4"}),label:"Time to Detect",value:h.timeToDetection}),e.jsx(Pe,{icon:e.jsx(Ee,{className:"w-4 h-4"}),label:"Data at Risk",value:h.dataAtRisk,small:!0})]})]})]})}),e.jsxs(I,{children:[e.jsx(L,{title:"Business Impact Assessment",description:"Impact across key business dimensions"}),e.jsx("div",{className:"mt-4 grid grid-cols-2 sm:grid-cols-4 gap-4",children:Object.entries(h.businessImpact).map(([u,w])=>e.jsx(Di,{dimension:u,level:w},u))})]}),e.jsxs(I,{children:[e.jsx(L,{title:"Recommendations",description:"Prioritized actions to remediate and prevent"}),e.jsx("div",{className:"mt-4 space-y-3",children:h.recommendations.map((u,w)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsx(Y,{variant:u.priority==="immediate"?"danger":u.priority==="short_term"?"warning":"info",size:"sm",children:u.priority.replace("_"," ")}),e.jsx("span",{className:"flex-1 text-sm text-slate-700 dark:text-slate-300",children:u.title}),e.jsx(Y,{variant:"secondary",size:"sm",children:u.status})]},w))})]}),e.jsxs(I,{children:[e.jsx(L,{title:"Gap Analysis",description:"Security maturity assessment"}),e.jsx("div",{className:"mt-4 space-y-4",children:h.gaps.map((u,w)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:u.category}),e.jsxs("span",{className:"text-xs text-slate-500",children:[u.current,"/",u.target]})]}),e.jsx(Oe,{value:u.current/u.target*100,variant:u.current<u.target*.5?"danger":"warning"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:u.gap})]},w))})]})]}),e.jsx("div",{children:e.jsxs(I,{className:"sticky top-24",children:[e.jsx(L,{title:"Export Options"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 block",children:"Format"}),e.jsx("div",{className:"space-y-2",children:[{id:"pdf",icon:e.jsx(Fe,{className:"w-4 h-4"}),label:"PDF Document"},{id:"html",icon:e.jsx(lt,{className:"w-4 h-4"}),label:"Interactive HTML"},{id:"json",icon:e.jsx(lt,{className:"w-4 h-4"}),label:"JSON Data"}].map(u=>e.jsx(y,{content:`Export as ${u.label}`,children:e.jsxs("button",{onClick:()=>r(u.id),className:b("w-full flex items-center gap-2 p-2 rounded-lg border transition-colors",n===u.id?"border-forensic-500 bg-forensic-50 dark:bg-forensic-900/20":"border-slate-200 dark:border-slate-700 hover:border-slate-300"),children:[u.icon,e.jsx("span",{className:"text-sm",children:u.label}),n===u.id&&e.jsx(U,{className:"w-4 h-4 text-forensic-500 ml-auto"})]})},u.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2 block",children:"Content Options"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{content:"Include raw log data in export",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a,onChange:u=>i(u.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Include raw logs"})]})}),e.jsx(y,{content:"Automatically redact sensitive data",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:u=>o(u.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Redact sensitive data"})]})})]})]}),e.jsxs("div",{className:"pt-4 border-t border-slate-200 dark:border-slate-700 space-y-2",children:[e.jsx(y,{content:"Generate downloadable PDF report with current findings",children:e.jsx(D,{fullWidth:!0,onClick:d,leftIcon:e.jsx(He,{className:"w-4 h-4"}),children:"Export Report"})}),e.jsx(y,{content:"Open print preview",children:e.jsx(D,{variant:"outline",fullWidth:!0,leftIcon:e.jsx(tn,{className:"w-4 h-4"}),children:"Print Preview"})}),e.jsx(y,{content:"Generate shareable link",children:e.jsx(D,{variant:"ghost",fullWidth:!0,leftIcon:e.jsx(sn,{className:"w-4 h-4"}),children:"Share Link"})})]})]})]})})]})})}function Pe({icon:t,label:s,value:n,subValue:r,small:a}){return e.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-1",children:[t,e.jsx("span",{className:"text-xs",children:s})]}),e.jsx("p",{className:b("font-bold text-slate-900 dark:text-slate-100",a?"text-sm":"text-lg"),children:n}),r&&e.jsx("p",{className:"text-xs text-red-500",children:r})]})}function Di({dimension:t,level:s}){const n={low:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",high:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"};return e.jsxs("div",{className:"text-center p-4 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase mb-1 capitalize",children:t}),e.jsx("span",{className:b("px-3 py-1 rounded-full text-sm font-medium capitalize",n[s]),children:s})]})}function Mi(){return e.jsx(Ln,{delayDuration:300,children:e.jsxs(bs,{children:[e.jsx(W,{path:"/",element:e.jsx(oi,{})}),e.jsx(W,{path:"/context",element:e.jsx(ui,{})}),e.jsx(W,{path:"/incident",element:e.jsx(hi,{})}),e.jsx(W,{path:"/connectors",element:e.jsx(xi,{})}),e.jsx(W,{path:"/validation",element:e.jsx(gi,{})}),e.jsx(W,{path:"/triage",element:e.jsx(bi,{})}),e.jsx(W,{path:"/timeline",element:e.jsx(ji,{})}),e.jsx(W,{path:"/verification",element:e.jsx(Si,{})}),e.jsx(W,{path:"/report",element:e.jsx(Ci,{})}),e.jsx(W,{path:"*",element:e.jsx(ws,{to:"/",replace:!0})})]})})}Bt.getState().initializeTheme();const Pi="/SSF/".replace(/\/$/,"")||"/";Ue.createRoot(document.getElementById("root")).render(e.jsx(we.StrictMode,{children:e.jsx(vs,{basename:Pi,children:e.jsx(Mi,{})})}));
//# sourceMappingURL=index-ZcaB6RYv.js.map
